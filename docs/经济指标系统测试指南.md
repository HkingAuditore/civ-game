# 经济指标系统测试指南

## 📋 测试信息

- **测试版本**: v1.0
- **测试日期**: 2026-02-04
- **测试范围**: Phase 1-3 功能验收

---

## 🎯 测试目标

验证经济指标系统的以下功能：
1. ✅ GDP、CPI、PPI 数据正确计算
2. ✅ 历史数据正确记录和展示
3. ✅ UI 美观且与现有风格一致
4. ✅ 性能良好，不影响游戏流畅度
5. ✅ 可折叠功能正常工作

---

## 🧪 测试步骤

### 测试1: 启动游戏并查看经济指标

**步骤**：
1. 启动游戏：`npm run dev`
2. 开始新游戏或加载存档
3. 点击顶部的国库银币区域（红框标注的区域）
4. 查看是否显示"宏观经济指标"面板

**预期结果**：
- ✅ 面板正确显示
- ✅ 显示GDP、CPI、PPI三个指标
- ✅ 每个指标都有数值和变化率
- ✅ CPI和PPI显示"基准: 90日均价"

**实际结果**：
- [ ] 通过
- [ ] 失败：_________________

---

### 测试2: 验证GDP数据

**步骤**：
1. 在经济指标面板中，点击"展开"按钮
2. 查看GDP构成部分

**预期结果**：
- ✅ 显示消费(C)、投资(I)、政府支出(G)、净出口(NX)
- ✅ 四个部分的总和等于GDP总值
- ✅ 数值合理（不为负数，除了净出口可能为负）

**验证方法**：
```
GDP总值 = 消费 + 投资 + 政府支出 + 净出口
```

**实际结果**：
- [ ] 通过
- [ ] 失败：_________________

---

### 测试3: 验证CPI/PPI数据

**步骤**：
1. 在展开的面板中，查看"CPI主要贡献"
2. 观察不同资源对CPI的影响

**预期结果**：
- ✅ 显示前3个贡献最大的资源
- ✅ 贡献度有正有负（价格上涨为正，下跌为负）
- ✅ 颜色正确（上涨为红色，下跌为绿色）

**实际结果**：
- [ ] 通过
- [ ] 失败：_________________

---

### 测试4: 验证历史数据

**步骤**：
1. 滚动到"经济指标走势"图表
2. 观察GDP、CPI、PPI的历史曲线

**预期结果**：
- ✅ 显示三条不同颜色的曲线
  - 蓝色：GDP
  - 橙色：CPI
  - 紫色：PPI
- ✅ 曲线平滑，无异常跳跃
- ✅ 图例正确显示

**实际结果**：
- [ ] 通过
- [ ] 失败：_________________

---

### 测试5: 验证折叠功能

**步骤**：
1. 点击"收起"按钮
2. 确认详细信息被隐藏
3. 再次点击"展开"按钮
4. 确认详细信息重新显示

**预期结果**：
- ✅ 折叠/展开动画流畅
- ✅ 按钮文字正确切换
- ✅ 详细信息正确显示/隐藏

**实际结果**：
- [ ] 通过
- [ ] 失败：_________________

---

### 测试6: 验证数据更新

**步骤**：
1. 记录当前的GDP、CPI、PPI数值
2. 让游戏运行10-20天
3. 再次打开经济指标面板
4. 对比数值是否发生变化

**预期结果**：
- ✅ GDP数值随经济活动变化
- ✅ CPI/PPI随价格变化而变化
- ✅ 变化率正确计算
- ✅ 历史图表增加新数据点

**实际结果**：
- [ ] 通过
- [ ] 失败：_________________

---

### 测试7: 验证存档兼容性

**步骤**：
1. 保存游戏
2. 关闭游戏
3. 重新启动并加载存档
4. 查看经济指标是否正确恢复

**预期结果**：
- ✅ 经济指标数据正确恢复
- ✅ 历史数据正确恢复
- ✅ 价格历史正确恢复

**实际结果**：
- [ ] 通过
- [ ] 失败：_________________

---

### 测试8: 性能测试

**步骤**：
1. 让游戏运行100天以上
2. 观察游戏流畅度
3. 打开经济指标面板
4. 观察面板打开速度

**预期结果**：
- ✅ 游戏运行流畅，无明显卡顿
- ✅ 面板打开速度快（<100ms）
- ✅ 图表渲染流畅

**实际结果**：
- [ ] 通过
- [ ] 失败：_________________

---

## 🐛 已知问题

### 问题1: 游戏初期数据不足

**描述**: 游戏刚开始时，CPI/PPI可能显示100（基准值）

**原因**: 价格历史数据不足30天，使用basePrice作为基准

**解决方案**: 这是正常现象，30天后会自动使用滚动平均

**状态**: ✅ 预期行为

---

### 问题2: GDP初期较小

**描述**: 游戏初期GDP可能只有几千

**原因**: 经济规模小，消费和投资都较少

**解决方案**: 随着游戏发展，GDP会逐渐增长

**状态**: ✅ 预期行为

---

## 📊 测试数据参考

### 正常范围

| 指标 | 游戏初期 | 游戏中期 | 游戏后期 |
|------|---------|---------|---------|
| GDP | 1千-5千 | 1万-5万 | 10万+ |
| CPI | 95-105 | 90-120 | 80-150 |
| PPI | 95-105 | 90-120 | 80-150 |

### 异常情况

| 情况 | 表现 | 可能原因 |
|------|------|---------|
| GDP为0 | 所有组成部分都为0 | 数据计算错误 |
| CPI/PPI为0 | 指数显示0 | 价格数据缺失 |
| 历史图表空白 | 无曲线显示 | 历史数据未记录 |
| 数值异常大 | GDP>1000万 | 计算溢出或错误 |

---

## 🔍 调试技巧

### 查看控制台日志

打开浏览器控制台（F12），查找以下日志：

```javascript
// 经济指标计算日志
[Economic Indicators] GDP: xxx, CPI: xxx, PPI: xxx

// 价格历史更新日志
[Price History] Updated: food=1.2, wood=2.1, ...

// 均衡价格计算日志
[Equilibrium Prices] Calculated: food=1.15, wood=2.05, ...
```

### 使用浏览器开发工具

1. 打开React DevTools
2. 查找`ResourceDetailModal`组件
3. 检查`economicIndicators` prop的值

### 检查存档数据

1. 打开浏览器的LocalStorage
2. 查找游戏存档
3. 检查是否包含以下字段：
   - `priceHistory`
   - `equilibriumPrices`
   - `economicIndicators`
   - `history.gdp`
   - `history.cpi`
   - `history.ppi`

---

## ✅ 验收标准

### 必须通过的测试

- [ ] 测试1: 启动游戏并查看经济指标
- [ ] 测试2: 验证GDP数据
- [ ] 测试3: 验证CPI/PPI数据
- [ ] 测试4: 验证历史数据
- [ ] 测试5: 验证折叠功能
- [ ] 测试7: 验证存档兼容性

### 建议通过的测试

- [ ] 测试6: 验证数据更新
- [ ] 测试8: 性能测试

---

## 📝 测试报告模板

```markdown
## 经济指标系统测试报告

**测试日期**: YYYY-MM-DD
**测试人员**: [你的名字]
**测试环境**: [浏览器版本]

### 测试结果汇总

- 通过: X/8
- 失败: X/8
- 跳过: X/8

### 详细结果

#### 测试1: 启动游戏并查看经济指标
- 状态: ✅ 通过 / ❌ 失败
- 备注: [如有问题请描述]

#### 测试2: 验证GDP数据
- 状态: ✅ 通过 / ❌ 失败
- 备注: [如有问题请描述]

[... 其他测试 ...]

### 发现的问题

1. [问题描述]
   - 严重程度: 高/中/低
   - 复现步骤: [...]
   - 预期行为: [...]
   - 实际行为: [...]

### 建议

[你的建议和反馈]
```

---

## 🚀 快速验收

如果时间有限，可以只进行以下快速验收：

1. **启动游戏** → 点击银币区域 → 确认面板显示 ✅
2. **点击展开** → 查看GDP构成和CPI贡献 ✅
3. **查看图表** → 确认三条曲线显示 ✅
4. **点击收起** → 确认折叠功能正常 ✅

**快速回复格式**：
```
✅ 全部通过
或
⚠️ 问题: [描述问题]
```

---

**测试完成后，请回复测试结果！** 🎉
