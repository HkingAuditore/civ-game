# 政治系统 - 详尽规则书

> **核心代码**:
> - 政治立场: `src/config/politicalStances.js`
> - 政体效果: `src/config/polityEffects.js`
> - 内阁协同: `src/logic/officials/cabinetSynergy.js`

---

# 第一章：政体系统

## 1.1 政体判定机制

政体由执政联盟成员自动判定（`polityEffects.js` L4-31）：

**判定条件类型**：
- `priority`：优先级（数值越大越优先）
- `exactCoalition`：精确匹配联盟成员
- `minSize` / `maxSize`：联盟成员数范围
- `includes`：必须包含的阶层
- `excludes`：必须不包含的阶层
- `includesAny`：包含任一阶层
- `minCategoryShare`：分类影响力占比最小值
- `includesGroup`：必须包含指定组

---

## 1.2 阶层分类

阶层分为多个类别用于政体判定：

| 类别 | 包含阶层 | 说明 |
|-----|---------|-----|
| aristocracy | 地主、骑士、教士 | 贵族阶层 |
| bourgeoisie | 资本家、商人、航海家 | 资产阶级 |
| proletariat | 农民、工人、矿工、佃农、伐木工 | 无产阶级 |
| intelligentsia | 官员、文书、工程师 | 知识分子 |
| military | 军人、骑士 | 军事阶层 |
| industrial | 工人、工匠、工程师、资本家 | 工业阶层 |
| agrarian | 农民、地主、佃农 | 农业阶层 |
| commercial | 商人、航海家 | 商业阶层 |

---

## 1.3 单一阶层专制政体

优先级1000，需精确匹配单一阶层（`polityEffects.js` L33-255）：

| 政体名称 | 执政阶层 | 主要效果 |
|---------|---------|---------|
| 封建地主专制 | landowner | 采集+15%，农场/大庄园+20% |
| 垄断资本独裁 | capitalist | 工业+20%，工厂+25%，税收+15% |
| 军事贵族专政 | knight | 军事+25%，兵营/训练场+20%，稳定+5% |
| 官僚集权 | official | 生产+10%，税收+12%，文化+8%，官员容量+5 |
| 商业寡头政治 | merchant | 市场+25%，贸易港+20%，税收+15% |
| 神权政治 | cleric | 文化+25%，稳定+10%，科研-15% |
| 军人专政 | soldier | 军事+30%，兵营+25%，稳定-5% |
| 工人无产阶级专政 | worker | 工业+18%，工人消费-12%，税收-10% |
| 农民专政 | peasant | 采集+20%，农场+18%，食物需求-10% |
| 技术官僚政治 | engineer | 科研+25%，工业+12%，官员容量+4 |
| 学者治国 | scribe | 科研+20%，文化+15%，军事-10% |
| 行会共和 | artisan | 纺织/家具/裁缝+15-25%，工业+15% |
| 海上共和国 | navigator | 船坞+30%，贸易港+25%，税收+10% |
| 矿业工人政权 | miner | 矿场+30%，采石场+25%，采集+15% |

---

## 1.4 特定组合政体

优先级900，需满足多个条件（`polityEffects.js` L257-397）：

| 政体名称 | 条件 | 主要效果 |
|---------|-----|---------|
| 工农联合政府 | 含工农，无产占70%+，≤2阶层 | 采集+12%，工业+10%，农工消费-8% |
| 人民民主专政 | 含工农，无产占70%+ | 农工消费-15%，税收-15% |
| 资产阶级共和国 | 资产占60%+，不含地主骑士 | 工业+15%，税收+12%，官员容量+3 |
| 封建神权联盟 | 贵族占60%+，含教士 | 采集+12%，文化+15%，稳定+8%，科研-10% |
| 军事-精英联盟 | 军事占50%+，含资本家/地主 | 军事+20%，税收+8% |

---

## 1.5 大联盟政体

优先级800-850，需5+阶层（`polityEffects.js` L400-463）：

| 政体名称 | 条件 | 主要效果 |
|---------|-----|---------|
| 全民联合政府 | ≥8阶层，含上中下层各至少1个 | 生产+8%，稳定+12%，官员容量+4 |
| 民族团结政府 | ≥5阶层，含上中下层 | 生产+5%，稳定+10%，人口上限+15 |
| 人民阵线 | ≥5阶层，无产占50%+ | 采集+10%，工业+10%，农工消费-10% |
| 大联盟政府 | ≥5阶层 | 生产+5%，稳定+5% |

---

## 1.6 产业主导政体

优先级700（`polityEffects.js` L465-574）：

| 政体名称 | 条件 | 主要效果 |
|---------|-----|---------|
| 工业资本主义政府 | 工业占60%+，含资本家 | 工业+20%，税收+12%，食物需求+10% |
| 劳工联合政府 | 工业占60%+，含工匠工人 | 工业+15%，工匠工人消费-8% |
| 地主-农民联盟 | 农业占60%+，含地主 | 采集+18%，食物需求-8% |
| 商业共和国 | 商业占50%+ | 市场+20%，贸易港+18%，税收+12% |
| 技术精英政府 | 含文书+工程师 | 科研+18%，工业+10%，官员容量+3 |

---

## 1.7 默认政体

优先级100及以下（`polityEffects.js` L611-656）：

| 政体名称 | 条件 | 效果 |
|---------|-----|-----|
| 双头政治 | exactSize: 2 | 稳定+3% |
| 三方联盟 | exactSize: 3 | 稳定+5% |
| 联合政府 | 无条件 | 稳定+3% |
| 无执政联盟 | maxSize: 0 | 生产-10%，税收-20%，稳定-15% |

---

## 1.8 政体效果类型

政体可提供的效果类型（`polityEffects.js` L670-785）：

| 效果类型 | 配置键 | 说明 |
|---------|-------|-----|
| 产业类别加成 | categories | 采集/工业等类别产出 |
| 建筑产出修正 | buildingProductionMod | 特定建筑产出 |
| 全局生产 | production | 所有生产 |
| 工业产出 | industry | 工业类产出 |
| 税收收入 | taxIncome | 税收收入 |
| 科研加成 | scienceBonus | 科研产出 |
| 文化加成 | cultureBonus | 文化产出 |
| 军事加成 | militaryBonus | 军事力量 |
| 稳定度 | stability | 稳定度 |
| 人口上限 | maxPop | 人口上限 |
| 资源需求修正 | resourceDemandMod | 资源需求 |
| 阶层需求修正 | stratumDemandMod | 阶层消费 |
| 官员容量 | officialCapacity | 官员上限 |

---

# 第二章：政治立场系统

## 2.1 立场派系

政治立场分为三个派系（`politicalStances.js` L369等）：

| 派系 | 代表立场 | 特点 |
|-----|---------|-----|
| left（左派） | 原始公社、平民派、马克思主义 | 倾向平等、福利、底层阶层 |
| center（建制派） | 共和主义、儒家、人文主义 | 倾向稳定、法治、中间路线 |
| right（右派） | 贵族寡头、封建主义、民族主义 | 倾向传统、等级、上层阶层 |

---

## 2.2 时代立场列表

### 石器时代（Epoch 0）

| 立场 | 派系 | 解锁 | 过时 | 核心议题 | 满足效果 |
|-----|-----|-----|-----|---------|---------|
| primitive_communism | 左 | 0 | 3 | 平等、集体 | 稳定+5%，农工满意+4 |
| tribal_elder | 右 | 0 | 2 | 传统、等级 | 稳定+4%，合法性+4% |
| animism | 中 | 0 | 3 | 灵性、自然 | 教士满意+6，需求-2% |
| warrior_cult | 右 | 0 | 5 | 军事、扩张 | 军事+15% |

### 青铜时代（Epoch 1）

| 立场 | 派系 | 核心议题 | 满足效果 |
|-----|-----|---------|---------|
| aristocratic_oligarchy | 右 | 等级、传统 | 军事+12%，税效+8% |
| theocracy | 右 | 灵性、等级 | 合法性+15%，教士满意+15 |

### 古典时代（Epoch 2）

| 立场 | 派系 | 历史参考 | 满足效果 |
|-----|-----|---------|---------|
| republicanism | 中 | 罗马共和国 | 合法性+12%，稳定+8% |
| populares | 左 | 格拉古兄弟 | 人口增长+8%，农工满意+8 |
| legalism | 右 | 商鞅变法 | 税效+15%，稳定-6% |
| confucianism | 中 | 孔孟之道 | 稳定+15%，科研+8% |
| mohism | 左 | 墨子兼爱 | 工业+12%，建筑成本-8%，原料消耗-15% |
| taoism | 中 | 老庄无为 | 需求-12%，稳定+8% |

### 封建时代（Epoch 3）

| 立场 | 派系 | 历史参考 | 满足效果 |
|-----|-----|---------|---------|
| feudalism | 右 | 中世纪分封 | 采集+8%，地主满意+12 |
| peasant_revolt | 左 | 黄巾起义 | 组织度衰减-22%（帮助叛军） |
| guild_corporatism | 中 | 中世纪行会 | 贸易+12%，原料消耗-15-18% |

### 探索时代（Epoch 4）

| 立场 | 派系 | 历史参考 | 满足效果 |
|-----|-----|---------|---------|
| mercantilism | 中 | 东印度公司 | 贸易+18%，收入+8% |
| absolutism | 右 | 路易十四 | 税效+15%，建筑成本-12% |
| humanism | 中 | 文艺复兴 | 科研+15%，文化+12% |
| colonialism | 右 | 大航海时代 | 贸易+15%，外交+0.8 |

### 启蒙时代（Epoch 5）

| 立场 | 派系 | 历史参考 | 满足效果 |
|-----|-----|---------|---------|
| classical_liberalism | 中 | 洛克、亚当斯密 | 收入+12%，人口增长+8% |
| enlightened_despotism | 中 | 腓特烈大帝 | 科研+18%，建筑成本-8% |
| conservatism | 右 | 伯克、梅特涅 | 稳定+12%，合法性+8% |
| utopian_socialism | 左 | 莫尔乌托邦 | 科研+12%，工人满意+8 |
| physiocracy | 中 | 魁奈学派 | 采集+15%，农民地主满意+8 |

### 工业时代（Epoch 6）

| 立场 | 派系 | 历史参考 | 满足效果 |
|-----|-----|---------|---------|
| marxism | 左 | 共产党宣言 | 工业+18%，工矿满意+12-15，原料消耗-18-22% |
| social_democracy | 左 | 伯恩斯坦 | 工农满意+8-12，稳定+8% |
| anarchism | 左 | 巴枯宁 | 需求-15%（条件：稳定低） |
| nationalism | 右 | 俾斯麦 | 军事+22%，军人满意+12 |
| neoliberalism | 右 | 哈耶克 | 收入+18%，贸易+12% |
| technocracy | 中 | 圣西门 | 科研+22%，工业+12%，原料消耗-15-28% |

### 信息时代（Epoch 7）

| 立场 | 派系 | 历史参考 | 满足效果 |
|-----|-----|---------|---------|
| digital_democracy | 中 | 电子政务 | 合法性+18%，稳定+12% |
| eco_socialism | 左 | 绿色新政 | 需求-15%，稳定+8% |
| transhumanism | 右 | 技术奇点 | 科研+28%，人口增长+8% |

---

## 2.3 条件类型

立场满足条件类型（`politicalStances.js` L46-361）：

### 阶层条件

| 类型 | 生成范围 | 判定逻辑 |
|-----|---------|---------|
| stratum_approval_above | 40-80 | 阶层满意度≥阈值 |
| stratum_approval_below | 20-50 | 阶层满意度<阈值 |
| stratum_influence_above | 10-35% | 阶层影响力占比≥阈值 |
| stratum_influence_below | 5-20% | 阶层影响力占比<阈值 |
| stratum_living_standard | 赤贫-小康 | 生活水平≥指定等级 |
| stratum_income_above | 50-250 | 日均收入≥阈值 |

### 政策条件

| 类型 | 生成范围 | 判定逻辑 |
|-----|---------|---------|
| avg_tax_above | 8-23% | 平均税率≥阈值 |
| avg_tax_below | 5-15% | 平均税率<阈值 |
| coalition_size_above | 2-4 | 执政联盟≥N个阶层 |
| coalition_size_below | 2-3 | 执政联盟≤N个阶层 |
| coalition_includes | 随机阶层 | 联盟包含指定阶层 |

### 状态条件

| 类型 | 生成范围 | 判定逻辑 |
|-----|---------|---------|
| stability_above | 50-90% | 稳定度≥阈值 |
| stability_below | 20-60% | 稳定度<阈值 |
| legitimacy_above | 40-80 | 合法性≥阈值 |
| at_war | - | 处于战争状态 |
| at_peace | - | 处于和平状态 |
| population_above | 500-2500 | 人口≥阈值 |
| population_below | 200-700 | 人口<阈值 |
| epoch_at_least | 0-4 | 时代≥指定时代 |

### 物价条件

| 类型 | 生成逻辑 | 判定逻辑 |
|-----|---------|---------|
| resource_price_above | 当前价格×(1.1-1.5) | 资源价格≥阈值 |
| resource_price_below | 当前价格×(0.7-0.95) | 资源价格<阈值 |
| price_stability | 波动0.3-0.7 | 价格波动≤阈值 |
| food_affordable | 当前粮价×(0.75-0.95) | 粮价≤阈值 |
| food_scarce | 当前粮价×(1.1-1.4) | 粮价≥阈值 |
| inflation_above | 当前价×(1.15-1.5) | 物价≥阈值 |
| deflation_below | 当前价×(0.65-0.9) | 物价<阈值 |

---

## 2.4 立场分配机制

官员立场分配逻辑（`politicalStances.js` L961-1186）：

### 立场选择

```javascript
// 1. 过滤可用立场（时代范围）
可用立场 = 立场模板.filter(s => 
    当前时代 >= s.unlockEpoch && 当前时代 <= (s.maxEpoch ?? 999)
)

// 2. 计算加权随机
权重 = stratumWeights[出身阶层] || 0.5
if (出身阶层 === 'knight'): 权重 = 0.3
权重 = max(0.1, 权重)

// 3. 按权重随机选择
```

### 条件生成

每个官员生成2-4个条件：
1. **必有1个执政联盟条件**：coalition_includes/size_above/size_below
2. **1-2个阶层相关条件**：90%使用立场偏好阶层
3. **30%概率添加物价条件**
4. **50%概率从立场定义条件中添加1个**

### 效果随机化

立场效果有±20%浮动（`politicalStances.js` L1151-1173）：

```javascript
实际效果 = 模板效果 × (0.8 + random() × 0.4)
```

---

## 2.5 立场满足判定

立场满足检查（`politicalStances.js` L1191-1198）：

```javascript
isStanceSatisfied(stanceId, gameState, conditionParams) {
    // 必须满足所有条件
    return conditionParams.every(c => 
        CONDITION_TYPES[c.typeId].check(c.params, gameState)
    );
}
```

---

# 第三章：内阁协同

## 3.1 协同度计算

内阁协同度基于派系分布（`cabinetSynergy.js` L311-344）：

```javascript
// 统计各派系人数（left/center/right）
多样性指数 = (最多派系 - 最少派系) / 总官员数
协同度 = 50 + 多样性指数 × 50
```

### 协同度等级

| 等级 | 协同度 | 行政效率 | 稳定度 | 组织度增长 |
|-----|-------|---------|-------|----------|
| split | 0-30% | -15% | -5% | +20%（给反对派） |
| diverse | 30-50% | 0 | 0 | 0 |
| coordinated | 50-70% | +5% | 0 | 0 |
| united | 70-85% | +10% | +2% | 0 |
| extreme | 85-100% | +15% | 0 | 反对派组织+X% |

---

## 3.2 派系主导

派系主导条件（`cabinetSynergy.js` L357-428）：

```javascript
DOMINANCE_MIN_EPOCH = 5  // 至少启蒙时代
DOMINANCE_MIN_OFFICIAL_RATIO = 0.5  // 官员数占编制50%
DOMINANCE_THRESHOLD = 0.6  // 某派系占60%
```

### 派系主导效果

| 派系 | 特殊面板 | 效果 |
|-----|---------|-----|
| left（左派） | 阶层配额规划 | 社会流动+20%，底层满意+5 |
| center（建制派） | 临时法令 | 外交关系+0.5/天，稳定+3% |
| right（右派） | 业主自主扩张 | 贸易加成+10%，上层满意+5 |

---

## 3.3 临时法令

建制派主导时可用（`cabinetSynergy.js` L187-291）：

| 法令 | 持续 | 冷却 | 成本 | 效果 |
|-----|-----|-----|-----|-----|
| 紧急征粮 | 30天 | 180天 | 300 | 采集+30%，稳定下降 |
| 贸易特许 | 60天 | 240天 | 500 | 税收+25% |
| 工业补贴 | 90天 | 300天 | 800 | 工业+20%，税收-10% |
| 移民激励 | 60天 | 200天 | 400 | 人口增长+15% |
| 军事动员 | 30天 | 150天 | 600 | 军事+25%，稳定下降 |
| 税收减免 | 45天 | 200天 | 0 | 税收-30%，稳定+15% |
| 强制劳动 | 60天 | 300天 | 0 | 采集+20%，底层满意大降 |
| 什一税 | 90天 | 360天 | 0 | 收入+10%，教士满意+15 |

---

# 第四章：执政联盟

## 4.1 联盟机制

执政联盟由影响力排名前N的阶层组成：

```javascript
// 联盟成员获得政策话语权
// 联盟外成员可能积累不满（组织度增长）
// 联盟构成决定政体类型
```

## 4.2 联盟效果

联盟阶层享有：
- 更高的政策影响力
- 满意度倾向正面修正
- 减少组织度增长

联盟外阶层：
- 可能积累组织度（叛乱风险）
- 满意度倾向负面修正

---

# 第五章：玩法策略

## 5.1 政体选择

| 目标 | 推荐政体条件 | 说明 |
|-----|------------|-----|
| 高生产 | 工业资本主义、技术官僚 | 含资本家/工程师 |
| 高稳定 | 全民联合、保守主义 | 大联盟或贵族 |
| 高税收 | 商业寡头、资产阶级共和 | 商人/资本家主导 |
| 高科研 | 技术精英、学者治国 | 工程师/文书 |
| 高军事 | 军人专政、民族主义 | 军人主导 |

## 5.2 立场管理

| 策略 | 实现方式 | 效果 |
|-----|---------|-----|
| 满足立场条件 | 调整税率/联盟/稳定度 | 获得立场加成 |
| 派系集中 | 雇佣同派系官员 | 高协同度+行政效率 |
| 派系主导 | 60%同派系+5时代+50%编制 | 解锁特殊面板 |

## 5.3 联盟构建

| 联盟规模 | 政体效果 | 稳定性 |
|---------|---------|-------|
| 1阶层 | 专制加成强 | 其他阶层叛乱风险高 |
| 2-4阶层 | 组合加成 | 中等 |
| 5+阶层 | 大联盟稳定加成 | 高 |
| 8+阶层 | 全民联合 | 非常高 |

---

# 附录A：核心公式速查

| 计算 | 公式 |
|-----|-----|
| 政体判定 | 按priority高低匹配条件 |
| 立场权重 | stratumWeights[出身] × (骑士?0.3:1) |
| 效果浮动 | 模板值 × (0.8~1.2) |
| 协同度 | 50 + (最多派系-最少派系)/总数×50 |
| 派系主导 | 时代≥5 && 官员≥50%编制 && 派系≥60% |

---

# 附录B：代码位置索引

| 功能 | 文件 | 行号 |
|-----|-----|-----|
| 政体定义列表 | polityEffects.js | L33-656 |
| 政体效果格式化 | polityEffects.js | L670-785 |
| 政治议题定义 | politicalStances.js | L10-35 |
| 条件类型定义 | politicalStances.js | L46-361 |
| 立场模板（石器-信息） | politicalStances.js | L365-928 |
| 立场分配函数 | politicalStances.js | L961-1186 |
| 立场满足判定 | politicalStances.js | L1191-1198 |
| 协同度计算 | cabinetSynergy.js | L311-344 |
| 派系主导 | cabinetSynergy.js | L357-428 |
| 临时法令 | cabinetSynergy.js | L187-291 |
