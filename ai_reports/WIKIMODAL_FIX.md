# WikiModal 移动端显示问题修复

## 问题描述
WikiModal在移动端显示时，用户只能看到目录（侧边栏），但看不到内容区域。

## 问题原因
原有布局使用了`flex`布局，侧边栏在移动端设置为`w-full sm:w-72`，占据了整个宽度，导致内容区域被挤到屏幕外看不见。

## 解决方案

### 1. 添加状态管理
```jsx
const [showSidebar, setShowSidebar] = useState(true); // 控制移动端侧边栏显示
```

### 2. 修改侧边栏布局
```jsx
// 移动端使用绝对定位，可以完全隐藏
// 桌面端使用相对定位，始终显示
<aside className={`
  ${showSidebar ? 'flex' : 'hidden'}  // 移动端条件显示
  lg:flex                              // 桌面端始终显示
  w-full lg:w-72                       // 移动端全宽，桌面端固定宽度
  absolute lg:relative                 // 移动端绝对定位，桌面端相对定位
  inset-0 lg:inset-auto                // 移动端全屏覆盖
  z-10                                 // 确保在内容之上
`}>
```

### 3. 修改内容区域布局
```jsx
// 移动端条件显示，与侧边栏互斥
<section className={`
  ${showSidebar ? 'hidden' : 'flex'}  // 移动端条件显示
  lg:flex                              // 桌面端始终显示
  flex-1 flex-col
`}>
```

### 4. 添加返回按钮
在内容区域头部添加返回按钮，仅在移动端显示：
```jsx
<button
  onClick={() => setShowSidebar(true)}
  className="lg:hidden mb-2 flex items-center gap-1 text-indigo-400"
>
  <Icon name="ChevronLeft" size={14} />
  <span>返回目录</span>
</button>
```

### 5. 选择条目时自动切换视图
```jsx
const handleSelectEntry = (entryId) => {
  setSelectedEntryId(entryId);
  setShowSidebar(false);  // 移动端自动切换到内容视图
};
```

## 用户体验改进

### 移动端
1. **初始状态**：显示目录（侧边栏），可以浏览分类和条目列表
2. **选择条目**：点击条目后自动切换到内容视图，显示详细信息
3. **返回目录**：点击"返回目录"按钮回到侧边栏，选择其他条目
4. **全屏显示**：侧边栏和内容区域都是全屏显示，互不干扰

### 桌面端
1. **并排显示**：侧边栏和内容区域同时显示，无需切换
2. **固定宽度**：侧边栏固定宽度（18rem），内容区域自适应
3. **无返回按钮**：桌面端不显示返回按钮，因为不需要

## 技术细节

### 响应式断点
- 使用 `lg:` 前缀（1024px）作为移动端和桌面端的分界点
- 小于1024px：移动端布局（单视图切换）
- 大于等于1024px：桌面端布局（双栏并排）

### 布局策略
- **移动端**：使用绝对定位 + 条件渲染实现视图切换
- **桌面端**：使用相对定位 + flex布局实现并排显示

### 状态管理
- `showSidebar`：控制移动端显示哪个视图
  - `true`：显示侧边栏（目录）
  - `false`：显示内容区域（详情）

## 测试建议

### 移动端测试（< 1024px）
1. ✅ 打开WikiModal，应该看到目录列表
2. ✅ 点击任意条目，应该切换到内容视图
3. ✅ 内容应该完整显示，可以滚动查看
4. ✅ 点击"返回目录"按钮，应该回到目录列表
5. ✅ 可以选择不同分类，查看不同条目

### 桌面端测试（>= 1024px）
1. ✅ 打开WikiModal，应该同时看到目录和内容
2. ✅ 点击条目，内容区域更新，目录保持显示
3. ✅ 不应该看到"返回目录"按钮
4. ✅ 侧边栏和内容区域都可以独立滚动

### 响应式测试
1. ✅ 从桌面端缩小到移动端，布局正确切换
2. ✅ 从移动端放大到桌面端，布局正确切换
3. ✅ 在不同尺寸下切换分类和条目，功能正常

## 修改文件
- `/Users/hkingauditore/Dev/civ-game/src/components/modals/WikiModal.jsx`

## 修改内容
1. 添加 `showSidebar` 状态
2. 修改侧边栏className，添加条件显示和定位
3. 修改内容区域className，添加条件显示
4. 添加 `handleSelectEntry` 函数
5. 更新条目按钮点击事件
6. 添加移动端返回按钮

---

**修复完成日期**: 2025-11-27
**问题**: WikiModal在移动端只能看到目录，看不到内容
**解决方案**: 使用视图切换模式，移动端在目录和内容之间切换，桌面端并排显示
**用户体验**: 移动端友好，桌面端保持原有体验
