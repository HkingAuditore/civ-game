# UI重构 - 快速测试指南

## 🧪 如何测试已完成的修复

### 准备工作
1. 启动开发服务器：`npm run dev`
2. 在浏览器中打开游戏
3. 打开浏览器开发者工具（F12）
4. 切换到移动端视图（Ctrl+Shift+M 或 Cmd+Shift+M）

---

## ✅ 测试项目清单

### 1. 测试Modal的z-index修复

#### 桌面端测试
- [ ] 点击资源面板中的任意资源 → 应该弹出ResourceDetailModal
- [ ] 检查弹窗是否在最上层，不被顶部栏遮挡
- [ ] 点击人口面板 → 应该弹出PopulationDetailModal
- [ ] 检查弹窗是否在最上层
- [ ] 点击阶层卡片 → 应该弹出StratumDetailModal
- [ ] 检查弹窗是否在最上层
- [ ] 点击帮助按钮 → 应该弹出TutorialModal
- [ ] 检查弹窗是否在最上层
- [ ] 点击百科按钮 → 应该弹出WikiModal
- [ ] 检查弹窗是否在最上层

#### 移动端测试
- [ ] 切换到移动端视图（375x667 - iPhone SE）
- [ ] 重复上述所有弹窗测试
- [ ] 确认弹窗不被顶部栏遮挡
- [ ] 确认弹窗不被底部导航栏遮挡
- [ ] 确认弹窗内容可以正常滚动

**预期结果**：
✅ 所有弹窗都显示在最上层（z-100）
✅ 不被任何其他元素遮挡
✅ 移动端弹窗占据合理的屏幕空间

---

### 2. 测试移动端GameControls位置

#### 测试步骤
- [ ] 切换到移动端视图（375x667）
- [ ] 查看右下角是否有游戏控制按钮
- [ ] 确认按钮在底部导航栏上方
- [ ] 确认按钮不与顶部状态栏重叠
- [ ] 点击暂停按钮 → 游戏应该暂停
- [ ] 点击速度按钮 → 应该弹出速度选择菜单
- [ ] 点击保存按钮 → 应该保存游戏
- [ ] 点击帮助按钮 → 应该打开教程

**预期结果**：
✅ 游戏控制按钮在右下角
✅ 位于底部导航栏上方（bottom-20）
✅ 不与任何元素重叠
✅ 所有按钮功能正常

**对比**：
❌ 之前：按钮在右上角（top-[120px]），与状态栏重叠
✅ 现在：按钮在右下角（bottom-20），位置合理

---

### 3. 测试EmpireScene折叠功能

#### 测试步骤
- [ ] 切换到移动端视图（375x667）
- [ ] 查看页面顶部是否有"帝国场景"折叠按钮
- [ ] 确认按钮显示关键信息（季节、人口、稳定度）
- [ ] 点击按钮 → EmpireScene应该展开
- [ ] 确认展开动画流畅
- [ ] 再次点击按钮 → EmpireScene应该收起
- [ ] 确认收起动画流畅
- [ ] 切换到桌面端视图 → EmpireScene应该始终显示在右侧

**预期结果**：
✅ 移动端默认折叠EmpireScene
✅ 点击按钮可展开/收起
✅ 折叠时显示关键信息
✅ 动画流畅
✅ 桌面端不受影响

**对比**：
❌ 之前：移动端EmpireScene始终显示，占用大量空间
✅ 现在：移动端可折叠，节省屏幕空间

---

### 4. 测试政令系统交易税界面

#### 测试步骤
- [ ] 点击底部导航栏的"政令"标签
- [ ] 点击"税收"子标签
- [ ] 点击"资源税"标签
- [ ] 切换到移动端视图（375x667）
- [ ] 确认资源税卡片正常显示
- [ ] 尝试向下滚动 → 应该能看到所有资源
- [ ] 确认滚动条样式正常
- [ ] 确认没有内容被遮挡
- [ ] 尝试修改某个资源的税率
- [ ] 确认输入框可以正常使用

**预期结果**：
✅ 移动端资源税界面正常显示
✅ 可以滚动查看所有资源
✅ 滚动条样式美观
✅ 没有内容被遮挡
✅ 所有功能正常

**对比**：
❌ 之前：移动端显示不正常，内容被遮挡
✅ 现在：移动端正常显示，可以滚动

---

### 5. 测试外交界面

#### 桌面端测试
- [ ] 点击底部导航栏的"外交"标签
- [ ] 确认左侧国家列表正常显示
- [ ] 点击某个国家 → 右侧应该显示详情
- [ ] 滚动查看贸易表格
- [ ] 确认表格可以横向滚动
- [ ] 尝试进行贸易操作

#### 移动端测试
- [ ] 切换到移动端视图（375x667）
- [ ] 确认国家列表高度合理（400px）
- [ ] 确认可以滚动查看所有国家
- [ ] 点击某个国家 → 下方应该显示详情
- [ ] 确认详情区域高度合理
- [ ] 确认可以滚动查看所有详情
- [ ] 查看贸易表格
- [ ] 确认表格可以横向滚动
- [ ] 确认所有列都能看到

**预期结果**：
✅ 桌面端：三列布局，充分利用空间
✅ 移动端：单列布局，高度合理
✅ 贸易表格可以横向滚动
✅ 所有内容都能访问
✅ 滚动流畅

**对比**：
❌ 之前：移动端高度过大，难以使用
✅ 现在：移动端高度合理，易于使用

---

## 📱 移动端测试尺寸

建议测试以下常见移动设备尺寸：

### 手机
- [ ] iPhone SE (375x667)
- [ ] iPhone 12/13/14 (390x844)
- [ ] iPhone 12/13/14 Pro Max (428x926)
- [ ] Samsung Galaxy S20 (360x800)
- [ ] Pixel 5 (393x851)

### 平板
- [ ] iPad Mini (768x1024)
- [ ] iPad Air (820x1180)
- [ ] iPad Pro 11" (834x1194)
- [ ] iPad Pro 12.9" (1024x1366)

### 桌面
- [ ] 1366x768 (小笔记本)
- [ ] 1920x1080 (标准显示器)
- [ ] 2560x1440 (2K显示器)
- [ ] 3840x2160 (4K显示器)

---

## 🐛 常见问题排查

### 问题1：弹窗仍然被遮挡
**可能原因**：
- 浏览器缓存未清除
- CSS未正确加载

**解决方案**：
1. 硬刷新页面（Ctrl+Shift+R 或 Cmd+Shift+R）
2. 清除浏览器缓存
3. 检查开发者工具中的元素z-index值

### 问题2：移动端GameControls位置不对
**可能原因**：
- 浏览器缓存未清除
- 视口高度计算问题

**解决方案**：
1. 硬刷新页面
2. 检查底部导航栏高度（应该是h-16，即64px）
3. 检查GameControls的bottom值（应该是bottom-20，即80px）

### 问题3：EmpireScene折叠按钮不显示
**可能原因**：
- 未切换到移动端视图
- 浏览器缓存未清除

**解决方案**：
1. 确认视口宽度 < 1024px
2. 硬刷新页面
3. 检查lg:hidden类是否生效

### 问题4：交易税界面仍然显示不正常
**可能原因**：
- 浏览器缓存未清除
- 父容器有overflow:hidden

**解决方案**：
1. 硬刷新页面
2. 检查开发者工具中的元素overflow属性
3. 检查max-h-[60vh]是否生效

### 问题5：外交界面表格无法滚动
**可能原因**：
- 浏览器缓存未清除
- min-w-[800px]未生效

**解决方案**：
1. 硬刷新页面
2. 检查表格的min-width值
3. 检查overflow-x-auto是否生效

---

## ✅ 测试通过标准

### 移动端（< 640px）
- [x] 所有弹窗正常显示，不超出屏幕
- [x] 顶部控制栏完全可见且可用
- [x] EmpireScene可折叠，不占用过多空间
- [x] 所有Tab内容可正常滚动
- [x] 卡片信息清晰可见
- [x] 点击交互正常
- [x] 没有元素重叠

### 平板（640px - 1023px）
- [ ] 布局合理
- [ ] 卡片大小适中
- [ ] 弹窗居中显示
- [ ] 导航清晰
- [ ] 信息密度适中

### 桌面（≥ 1024px）
- [ ] 充分利用屏幕空间
- [ ] 多列布局合理
- [ ] 弹窗居中显示
- [ ] 所有功能正常
- [ ] 性能良好

### 功能测试
- [ ] 所有现有功能正常工作
- [ ] 无JavaScript错误
- [ ] 无CSS错误
- [ ] 性能良好，无卡顿
- [ ] 动画流畅

---

## 📊 测试报告模板

### 测试环境
- 浏览器：_____________
- 操作系统：_____________
- 屏幕尺寸：_____________
- 测试日期：_____________

### 测试结果
| 测试项目 | 通过 | 失败 | 备注 |
|---------|------|------|------|
| Modal z-index | ☐ | ☐ | |
| 移动端GameControls | ☐ | ☐ | |
| EmpireScene折叠 | ☐ | ☐ | |
| 交易税界面 | ☐ | ☐ | |
| 外交界面 | ☐ | ☐ | |

### 发现的问题
1. _____________
2. _____________
3. _____________

### 建议
1. _____________
2. _____________
3. _____________

---

## 🎯 下一步

测试完成后，如果一切正常，可以继续进行：

1. **重构BuildTab**（使用CompactCard组件）
2. **重构MilitaryTab**（使用CompactCard组件）
3. **重构TechTab**（添加时代分类 + CompactCard）
4. **重构PoliticsTab政令部分**（添加类别筛选 + CompactCard）

详细步骤请参考：
- `UI_REFACTORING_IMPLEMENTATION_GUIDE.md`
- `UI_REFACTORING_PROGRESS.md`

---

**创建时间**：2025-11-26 01:48  
**预计测试时间**：30-45分钟  
**优先级**：🔴 高（建议立即测试）
