(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const c of document.querySelectorAll('link[rel="modulepreload"]'))o(c);new MutationObserver(c=>{for(const u of c)if(u.type==="childList")for(const p of u.addedNodes)p.tagName==="LINK"&&p.rel==="modulepreload"&&o(p)}).observe(document,{childList:!0,subtree:!0});function r(c){const u={};return c.integrity&&(u.integrity=c.integrity),c.referrerPolicy&&(u.referrerPolicy=c.referrerPolicy),c.crossOrigin==="use-credentials"?u.credentials="include":c.crossOrigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function o(c){if(c.ep)return;c.ep=!0;const u=r(c);fetch(c.href,u)}})();function Hv(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var rp={exports:{}},cc={};var e1;function qv(){if(e1)return cc;e1=1;var t=Symbol.for("react.transitional.element"),s=Symbol.for("react.fragment");function r(o,c,u){var p=null;if(u!==void 0&&(p=""+u),c.key!==void 0&&(p=""+c.key),"key"in c){u={};for(var m in c)m!=="key"&&(u[m]=c[m])}else u=c;return c=u.ref,{$$typeof:t,type:o,key:p,ref:c!==void 0?c:null,props:u}}return cc.Fragment=s,cc.jsx=r,cc.jsxs=r,cc}var t1;function Gv(){return t1||(t1=1,rp.exports=qv()),rp.exports}var a=Gv(),op={exports:{}},dc={},lp={exports:{}},cp={};var a1;function Fv(){return a1||(a1=1,(function(t){function s(P,z){var V=P.length;P.push(z);e:for(;0<V;){var F=V-1>>>1,re=P[F];if(0<c(re,z))P[F]=z,P[V]=re,V=F;else break e}}function r(P){return P.length===0?null:P[0]}function o(P){if(P.length===0)return null;var z=P[0],V=P.pop();if(V!==z){P[0]=V;e:for(var F=0,re=P.length,C=re>>>1;F<C;){var L=2*(F+1)-1,ie=P[L],H=L+1,ve=P[H];if(0>c(ie,V))H<re&&0>c(ve,ie)?(P[F]=ve,P[H]=V,F=H):(P[F]=ie,P[L]=V,F=L);else if(H<re&&0>c(ve,V))P[F]=ve,P[H]=V,F=H;else break e}}return z}function c(P,z){var V=P.sortIndex-z.sortIndex;return V!==0?V:P.id-z.id}if(t.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var u=performance;t.unstable_now=function(){return u.now()}}else{var p=Date,m=p.now();t.unstable_now=function(){return p.now()-m}}var h=[],x=[],g=1,b=null,j=3,_=!1,N=!1,M=!1,R=!1,E=typeof setTimeout=="function"?setTimeout:null,T=typeof clearTimeout=="function"?clearTimeout:null,D=typeof setImmediate<"u"?setImmediate:null;function O(P){for(var z=r(x);z!==null;){if(z.callback===null)o(x);else if(z.startTime<=P)o(x),z.sortIndex=z.expirationTime,s(h,z);else break;z=r(x)}}function q(P){if(M=!1,O(P),!N)if(r(h)!==null)N=!0,I||(I=!0,ne());else{var z=r(x);z!==null&&de(q,z.startTime-P)}}var I=!1,Z=-1,Y=5,U=-1;function S(){return R?!0:!(t.unstable_now()-U<Y)}function Q(){if(R=!1,I){var P=t.unstable_now();U=P;var z=!0;try{e:{N=!1,M&&(M=!1,T(Z),Z=-1),_=!0;var V=j;try{t:{for(O(P),b=r(h);b!==null&&!(b.expirationTime>P&&S());){var F=b.callback;if(typeof F=="function"){b.callback=null,j=b.priorityLevel;var re=F(b.expirationTime<=P);if(P=t.unstable_now(),typeof re=="function"){b.callback=re,O(P),z=!0;break t}b===r(h)&&o(h),O(P)}else o(h);b=r(h)}if(b!==null)z=!0;else{var C=r(x);C!==null&&de(q,C.startTime-P),z=!1}}break e}finally{b=null,j=V,_=!1}z=void 0}}finally{z?ne():I=!1}}}var ne;if(typeof D=="function")ne=function(){D(Q)};else if(typeof MessageChannel<"u"){var Ne=new MessageChannel,$e=Ne.port2;Ne.port1.onmessage=Q,ne=function(){$e.postMessage(null)}}else ne=function(){E(Q,0)};function de(P,z){Z=E(function(){P(t.unstable_now())},z)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(P){P.callback=null},t.unstable_forceFrameRate=function(P){0>P||125<P?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Y=0<P?Math.floor(1e3/P):5},t.unstable_getCurrentPriorityLevel=function(){return j},t.unstable_next=function(P){switch(j){case 1:case 2:case 3:var z=3;break;default:z=j}var V=j;j=z;try{return P()}finally{j=V}},t.unstable_requestPaint=function(){R=!0},t.unstable_runWithPriority=function(P,z){switch(P){case 1:case 2:case 3:case 4:case 5:break;default:P=3}var V=j;j=P;try{return z()}finally{j=V}},t.unstable_scheduleCallback=function(P,z,V){var F=t.unstable_now();switch(typeof V=="object"&&V!==null?(V=V.delay,V=typeof V=="number"&&0<V?F+V:F):V=F,P){case 1:var re=-1;break;case 2:re=250;break;case 5:re=1073741823;break;case 4:re=1e4;break;default:re=5e3}return re=V+re,P={id:g++,callback:z,priorityLevel:P,startTime:V,expirationTime:re,sortIndex:-1},V>F?(P.sortIndex=V,s(x,P),r(h)===null&&P===r(x)&&(M?(T(Z),Z=-1):M=!0,de(q,V-F))):(P.sortIndex=re,s(h,P),N||_||(N=!0,I||(I=!0,ne()))),P},t.unstable_shouldYield=S,t.unstable_wrapCallback=function(P){var z=j;return function(){var V=j;j=z;try{return P.apply(this,arguments)}finally{j=V}}}})(cp)),cp}var n1;function Yv(){return n1||(n1=1,lp.exports=Fv()),lp.exports}var dp={exports:{}},ea={};var s1;function Xv(){if(s1)return ea;s1=1;var t=Symbol.for("react.transitional.element"),s=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),o=Symbol.for("react.strict_mode"),c=Symbol.for("react.profiler"),u=Symbol.for("react.consumer"),p=Symbol.for("react.context"),m=Symbol.for("react.forward_ref"),h=Symbol.for("react.suspense"),x=Symbol.for("react.memo"),g=Symbol.for("react.lazy"),b=Symbol.for("react.activity"),j=Symbol.iterator;function _(C){return C===null||typeof C!="object"?null:(C=j&&C[j]||C["@@iterator"],typeof C=="function"?C:null)}var N={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},M=Object.assign,R={};function E(C,L,ie){this.props=C,this.context=L,this.refs=R,this.updater=ie||N}E.prototype.isReactComponent={},E.prototype.setState=function(C,L){if(typeof C!="object"&&typeof C!="function"&&C!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,C,L,"setState")},E.prototype.forceUpdate=function(C){this.updater.enqueueForceUpdate(this,C,"forceUpdate")};function T(){}T.prototype=E.prototype;function D(C,L,ie){this.props=C,this.context=L,this.refs=R,this.updater=ie||N}var O=D.prototype=new T;O.constructor=D,M(O,E.prototype),O.isPureReactComponent=!0;var q=Array.isArray;function I(){}var Z={H:null,A:null,T:null,S:null},Y=Object.prototype.hasOwnProperty;function U(C,L,ie){var H=ie.ref;return{$$typeof:t,type:C,key:L,ref:H!==void 0?H:null,props:ie}}function S(C,L){return U(C.type,L,C.props)}function Q(C){return typeof C=="object"&&C!==null&&C.$$typeof===t}function ne(C){var L={"=":"=0",":":"=2"};return"$"+C.replace(/[=:]/g,function(ie){return L[ie]})}var Ne=/\/+/g;function $e(C,L){return typeof C=="object"&&C!==null&&C.key!=null?ne(""+C.key):L.toString(36)}function de(C){switch(C.status){case"fulfilled":return C.value;case"rejected":throw C.reason;default:switch(typeof C.status=="string"?C.then(I,I):(C.status="pending",C.then(function(L){C.status==="pending"&&(C.status="fulfilled",C.value=L)},function(L){C.status==="pending"&&(C.status="rejected",C.reason=L)})),C.status){case"fulfilled":return C.value;case"rejected":throw C.reason}}throw C}function P(C,L,ie,H,ve){var me=typeof C;(me==="undefined"||me==="boolean")&&(C=null);var X=!1;if(C===null)X=!0;else switch(me){case"bigint":case"string":case"number":X=!0;break;case"object":switch(C.$$typeof){case t:case s:X=!0;break;case g:return X=C._init,P(X(C._payload),L,ie,H,ve)}}if(X)return ve=ve(C),X=H===""?"."+$e(C,0):H,q(ve)?(ie="",X!=null&&(ie=X.replace(Ne,"$&/")+"/"),P(ve,L,ie,"",function(Je){return Je})):ve!=null&&(Q(ve)&&(ve=S(ve,ie+(ve.key==null||C&&C.key===ve.key?"":(""+ve.key).replace(Ne,"$&/")+"/")+X)),L.push(ve)),1;X=0;var qe=H===""?".":H+":";if(q(C))for(var fe=0;fe<C.length;fe++)H=C[fe],me=qe+$e(H,fe),X+=P(H,L,ie,me,ve);else if(fe=_(C),typeof fe=="function")for(C=fe.call(C),fe=0;!(H=C.next()).done;)H=H.value,me=qe+$e(H,fe++),X+=P(H,L,ie,me,ve);else if(me==="object"){if(typeof C.then=="function")return P(de(C),L,ie,H,ve);throw L=String(C),Error("Objects are not valid as a React child (found: "+(L==="[object Object]"?"object with keys {"+Object.keys(C).join(", ")+"}":L)+"). If you meant to render a collection of children, use an array instead.")}return X}function z(C,L,ie){if(C==null)return C;var H=[],ve=0;return P(C,H,"","",function(me){return L.call(ie,me,ve++)}),H}function V(C){if(C._status===-1){var L=C._result;L=L(),L.then(function(ie){(C._status===0||C._status===-1)&&(C._status=1,C._result=ie)},function(ie){(C._status===0||C._status===-1)&&(C._status=2,C._result=ie)}),C._status===-1&&(C._status=0,C._result=L)}if(C._status===1)return C._result.default;throw C._result}var F=typeof reportError=="function"?reportError:function(C){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var L=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof C=="object"&&C!==null&&typeof C.message=="string"?String(C.message):String(C),error:C});if(!window.dispatchEvent(L))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",C);return}console.error(C)},re={map:z,forEach:function(C,L,ie){z(C,function(){L.apply(this,arguments)},ie)},count:function(C){var L=0;return z(C,function(){L++}),L},toArray:function(C){return z(C,function(L){return L})||[]},only:function(C){if(!Q(C))throw Error("React.Children.only expected to receive a single React element child.");return C}};return ea.Activity=b,ea.Children=re,ea.Component=E,ea.Fragment=r,ea.Profiler=c,ea.PureComponent=D,ea.StrictMode=o,ea.Suspense=h,ea.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=Z,ea.__COMPILER_RUNTIME={__proto__:null,c:function(C){return Z.H.useMemoCache(C)}},ea.cache=function(C){return function(){return C.apply(null,arguments)}},ea.cacheSignal=function(){return null},ea.cloneElement=function(C,L,ie){if(C==null)throw Error("The argument must be a React element, but you passed "+C+".");var H=M({},C.props),ve=C.key;if(L!=null)for(me in L.key!==void 0&&(ve=""+L.key),L)!Y.call(L,me)||me==="key"||me==="__self"||me==="__source"||me==="ref"&&L.ref===void 0||(H[me]=L[me]);var me=arguments.length-2;if(me===1)H.children=ie;else if(1<me){for(var X=Array(me),qe=0;qe<me;qe++)X[qe]=arguments[qe+2];H.children=X}return U(C.type,ve,H)},ea.createContext=function(C){return C={$$typeof:p,_currentValue:C,_currentValue2:C,_threadCount:0,Provider:null,Consumer:null},C.Provider=C,C.Consumer={$$typeof:u,_context:C},C},ea.createElement=function(C,L,ie){var H,ve={},me=null;if(L!=null)for(H in L.key!==void 0&&(me=""+L.key),L)Y.call(L,H)&&H!=="key"&&H!=="__self"&&H!=="__source"&&(ve[H]=L[H]);var X=arguments.length-2;if(X===1)ve.children=ie;else if(1<X){for(var qe=Array(X),fe=0;fe<X;fe++)qe[fe]=arguments[fe+2];ve.children=qe}if(C&&C.defaultProps)for(H in X=C.defaultProps,X)ve[H]===void 0&&(ve[H]=X[H]);return U(C,me,ve)},ea.createRef=function(){return{current:null}},ea.forwardRef=function(C){return{$$typeof:m,render:C}},ea.isValidElement=Q,ea.lazy=function(C){return{$$typeof:g,_payload:{_status:-1,_result:C},_init:V}},ea.memo=function(C,L){return{$$typeof:x,type:C,compare:L===void 0?null:L}},ea.startTransition=function(C){var L=Z.T,ie={};Z.T=ie;try{var H=C(),ve=Z.S;ve!==null&&ve(ie,H),typeof H=="object"&&H!==null&&typeof H.then=="function"&&H.then(I,F)}catch(me){F(me)}finally{L!==null&&ie.types!==null&&(L.types=ie.types),Z.T=L}},ea.unstable_useCacheRefresh=function(){return Z.H.useCacheRefresh()},ea.use=function(C){return Z.H.use(C)},ea.useActionState=function(C,L,ie){return Z.H.useActionState(C,L,ie)},ea.useCallback=function(C,L){return Z.H.useCallback(C,L)},ea.useContext=function(C){return Z.H.useContext(C)},ea.useDebugValue=function(){},ea.useDeferredValue=function(C,L){return Z.H.useDeferredValue(C,L)},ea.useEffect=function(C,L){return Z.H.useEffect(C,L)},ea.useEffectEvent=function(C){return Z.H.useEffectEvent(C)},ea.useId=function(){return Z.H.useId()},ea.useImperativeHandle=function(C,L,ie){return Z.H.useImperativeHandle(C,L,ie)},ea.useInsertionEffect=function(C,L){return Z.H.useInsertionEffect(C,L)},ea.useLayoutEffect=function(C,L){return Z.H.useLayoutEffect(C,L)},ea.useMemo=function(C,L){return Z.H.useMemo(C,L)},ea.useOptimistic=function(C,L){return Z.H.useOptimistic(C,L)},ea.useReducer=function(C,L,ie){return Z.H.useReducer(C,L,ie)},ea.useRef=function(C){return Z.H.useRef(C)},ea.useState=function(C){return Z.H.useState(C)},ea.useSyncExternalStore=function(C,L,ie){return Z.H.useSyncExternalStore(C,L,ie)},ea.useTransition=function(){return Z.H.useTransition()},ea.version="19.2.0",ea}var i1;function gf(){return i1||(i1=1,dp.exports=Xv()),dp.exports}var up={exports:{}},Bs={};var r1;function Zv(){if(r1)return Bs;r1=1;var t=gf();function s(h){var x="https://react.dev/errors/"+h;if(1<arguments.length){x+="?args[]="+encodeURIComponent(arguments[1]);for(var g=2;g<arguments.length;g++)x+="&args[]="+encodeURIComponent(arguments[g])}return"Minified React error #"+h+"; visit "+x+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(){}var o={d:{f:r,r:function(){throw Error(s(522))},D:r,C:r,L:r,m:r,X:r,S:r,M:r},p:0,findDOMNode:null},c=Symbol.for("react.portal");function u(h,x,g){var b=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:c,key:b==null?null:""+b,children:h,containerInfo:x,implementation:g}}var p=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function m(h,x){if(h==="font")return"";if(typeof x=="string")return x==="use-credentials"?x:""}return Bs.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=o,Bs.createPortal=function(h,x){var g=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!x||x.nodeType!==1&&x.nodeType!==9&&x.nodeType!==11)throw Error(s(299));return u(h,x,null,g)},Bs.flushSync=function(h){var x=p.T,g=o.p;try{if(p.T=null,o.p=2,h)return h()}finally{p.T=x,o.p=g,o.d.f()}},Bs.preconnect=function(h,x){typeof h=="string"&&(x?(x=x.crossOrigin,x=typeof x=="string"?x==="use-credentials"?x:"":void 0):x=null,o.d.C(h,x))},Bs.prefetchDNS=function(h){typeof h=="string"&&o.d.D(h)},Bs.preinit=function(h,x){if(typeof h=="string"&&x&&typeof x.as=="string"){var g=x.as,b=m(g,x.crossOrigin),j=typeof x.integrity=="string"?x.integrity:void 0,_=typeof x.fetchPriority=="string"?x.fetchPriority:void 0;g==="style"?o.d.S(h,typeof x.precedence=="string"?x.precedence:void 0,{crossOrigin:b,integrity:j,fetchPriority:_}):g==="script"&&o.d.X(h,{crossOrigin:b,integrity:j,fetchPriority:_,nonce:typeof x.nonce=="string"?x.nonce:void 0})}},Bs.preinitModule=function(h,x){if(typeof h=="string")if(typeof x=="object"&&x!==null){if(x.as==null||x.as==="script"){var g=m(x.as,x.crossOrigin);o.d.M(h,{crossOrigin:g,integrity:typeof x.integrity=="string"?x.integrity:void 0,nonce:typeof x.nonce=="string"?x.nonce:void 0})}}else x==null&&o.d.M(h)},Bs.preload=function(h,x){if(typeof h=="string"&&typeof x=="object"&&x!==null&&typeof x.as=="string"){var g=x.as,b=m(g,x.crossOrigin);o.d.L(h,g,{crossOrigin:b,integrity:typeof x.integrity=="string"?x.integrity:void 0,nonce:typeof x.nonce=="string"?x.nonce:void 0,type:typeof x.type=="string"?x.type:void 0,fetchPriority:typeof x.fetchPriority=="string"?x.fetchPriority:void 0,referrerPolicy:typeof x.referrerPolicy=="string"?x.referrerPolicy:void 0,imageSrcSet:typeof x.imageSrcSet=="string"?x.imageSrcSet:void 0,imageSizes:typeof x.imageSizes=="string"?x.imageSizes:void 0,media:typeof x.media=="string"?x.media:void 0})}},Bs.preloadModule=function(h,x){if(typeof h=="string")if(x){var g=m(x.as,x.crossOrigin);o.d.m(h,{as:typeof x.as=="string"&&x.as!=="script"?x.as:void 0,crossOrigin:g,integrity:typeof x.integrity=="string"?x.integrity:void 0})}else o.d.m(h)},Bs.requestFormReset=function(h){o.d.r(h)},Bs.unstable_batchedUpdates=function(h,x){return h(x)},Bs.useFormState=function(h,x,g){return p.H.useFormState(h,x,g)},Bs.useFormStatus=function(){return p.H.useHostTransitionStatus()},Bs.version="19.2.0",Bs}var o1;function Ey(){if(o1)return up.exports;o1=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(s){console.error(s)}}return t(),up.exports=Zv(),up.exports}var l1;function Qv(){if(l1)return dc;l1=1;var t=Yv(),s=gf(),r=Ey();function o(e){var n="https://react.dev/errors/"+e;if(1<arguments.length){n+="?args[]="+encodeURIComponent(arguments[1]);for(var i=2;i<arguments.length;i++)n+="&args[]="+encodeURIComponent(arguments[i])}return"Minified React error #"+e+"; visit "+n+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function c(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function u(e){var n=e,i=e;if(e.alternate)for(;n.return;)n=n.return;else{e=n;do n=e,(n.flags&4098)!==0&&(i=n.return),e=n.return;while(e)}return n.tag===3?i:null}function p(e){if(e.tag===13){var n=e.memoizedState;if(n===null&&(e=e.alternate,e!==null&&(n=e.memoizedState)),n!==null)return n.dehydrated}return null}function m(e){if(e.tag===31){var n=e.memoizedState;if(n===null&&(e=e.alternate,e!==null&&(n=e.memoizedState)),n!==null)return n.dehydrated}return null}function h(e){if(u(e)!==e)throw Error(o(188))}function x(e){var n=e.alternate;if(!n){if(n=u(e),n===null)throw Error(o(188));return n!==e?null:e}for(var i=e,l=n;;){var d=i.return;if(d===null)break;var f=d.alternate;if(f===null){if(l=d.return,l!==null){i=l;continue}break}if(d.child===f.child){for(f=d.child;f;){if(f===i)return h(d),e;if(f===l)return h(d),n;f=f.sibling}throw Error(o(188))}if(i.return!==l.return)i=d,l=f;else{for(var w=!1,A=d.child;A;){if(A===i){w=!0,i=d,l=f;break}if(A===l){w=!0,l=d,i=f;break}A=A.sibling}if(!w){for(A=f.child;A;){if(A===i){w=!0,i=f,l=d;break}if(A===l){w=!0,l=f,i=d;break}A=A.sibling}if(!w)throw Error(o(189))}}if(i.alternate!==l)throw Error(o(190))}if(i.tag!==3)throw Error(o(188));return i.stateNode.current===i?e:n}function g(e){var n=e.tag;if(n===5||n===26||n===27||n===6)return e;for(e=e.child;e!==null;){if(n=g(e),n!==null)return n;e=e.sibling}return null}var b=Object.assign,j=Symbol.for("react.element"),_=Symbol.for("react.transitional.element"),N=Symbol.for("react.portal"),M=Symbol.for("react.fragment"),R=Symbol.for("react.strict_mode"),E=Symbol.for("react.profiler"),T=Symbol.for("react.consumer"),D=Symbol.for("react.context"),O=Symbol.for("react.forward_ref"),q=Symbol.for("react.suspense"),I=Symbol.for("react.suspense_list"),Z=Symbol.for("react.memo"),Y=Symbol.for("react.lazy"),U=Symbol.for("react.activity"),S=Symbol.for("react.memo_cache_sentinel"),Q=Symbol.iterator;function ne(e){return e===null||typeof e!="object"?null:(e=Q&&e[Q]||e["@@iterator"],typeof e=="function"?e:null)}var Ne=Symbol.for("react.client.reference");function $e(e){if(e==null)return null;if(typeof e=="function")return e.$$typeof===Ne?null:e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case M:return"Fragment";case E:return"Profiler";case R:return"StrictMode";case q:return"Suspense";case I:return"SuspenseList";case U:return"Activity"}if(typeof e=="object")switch(e.$$typeof){case N:return"Portal";case D:return e.displayName||"Context";case T:return(e._context.displayName||"Context")+".Consumer";case O:var n=e.render;return e=e.displayName,e||(e=n.displayName||n.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Z:return n=e.displayName||null,n!==null?n:$e(e.type)||"Memo";case Y:n=e._payload,e=e._init;try{return $e(e(n))}catch{}}return null}var de=Array.isArray,P=s.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,z=r.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,V={pending:!1,data:null,method:null,action:null},F=[],re=-1;function C(e){return{current:e}}function L(e){0>re||(e.current=F[re],F[re]=null,re--)}function ie(e,n){re++,F[re]=e.current,e.current=n}var H=C(null),ve=C(null),me=C(null),X=C(null);function qe(e,n){switch(ie(me,n),ie(ve,e),ie(H,null),n.nodeType){case 9:case 11:e=(e=n.documentElement)&&(e=e.namespaceURI)?Nx(e):0;break;default:if(e=n.tagName,n=n.namespaceURI)n=Nx(n),e=Mx(n,e);else switch(e){case"svg":e=1;break;case"math":e=2;break;default:e=0}}L(H),ie(H,e)}function fe(){L(H),L(ve),L(me)}function Je(e){e.memoizedState!==null&&ie(X,e);var n=H.current,i=Mx(n,e.type);n!==i&&(ie(ve,e),ie(H,i))}function tt(e){ve.current===e&&(L(H),L(ve)),X.current===e&&(L(X),ic._currentValue=V)}var Mt,jt;function ot(e){if(Mt===void 0)try{throw Error()}catch(i){var n=i.stack.trim().match(/\n( *(at )?)/);Mt=n&&n[1]||"",jt=-1<i.stack.indexOf(`
    at`)?" (<anonymous>)":-1<i.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Mt+e+jt}var B=!1;function Ue(e,n){if(!e||B)return"";B=!0;var i=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var l={DetermineComponentFrameRoot:function(){try{if(n){var Fe=function(){throw Error()};if(Object.defineProperty(Fe.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Fe,[])}catch(ke){var we=ke}Reflect.construct(e,[],Fe)}else{try{Fe.call()}catch(ke){we=ke}e.call(Fe.prototype)}}else{try{throw Error()}catch(ke){we=ke}(Fe=e())&&typeof Fe.catch=="function"&&Fe.catch(function(){})}}catch(ke){if(ke&&we&&typeof ke.stack=="string")return[ke.stack,we.stack]}return[null,null]}};l.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var d=Object.getOwnPropertyDescriptor(l.DetermineComponentFrameRoot,"name");d&&d.configurable&&Object.defineProperty(l.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var f=l.DetermineComponentFrameRoot(),w=f[0],A=f[1];if(w&&A){var G=w.split(`
`),ye=A.split(`
`);for(d=l=0;l<G.length&&!G[l].includes("DetermineComponentFrameRoot");)l++;for(;d<ye.length&&!ye[d].includes("DetermineComponentFrameRoot");)d++;if(l===G.length||d===ye.length)for(l=G.length-1,d=ye.length-1;1<=l&&0<=d&&G[l]!==ye[d];)d--;for(;1<=l&&0<=d;l--,d--)if(G[l]!==ye[d]){if(l!==1||d!==1)do if(l--,d--,0>d||G[l]!==ye[d]){var De=`
`+G[l].replace(" at new "," at ");return e.displayName&&De.includes("<anonymous>")&&(De=De.replace("<anonymous>",e.displayName)),De}while(1<=l&&0<=d);break}}}finally{B=!1,Error.prepareStackTrace=i}return(i=e?e.displayName||e.name:"")?ot(i):""}function ht(e,n){switch(e.tag){case 26:case 27:case 5:return ot(e.type);case 16:return ot("Lazy");case 13:return e.child!==n&&n!==null?ot("Suspense Fallback"):ot("Suspense");case 19:return ot("SuspenseList");case 0:case 15:return Ue(e.type,!1);case 11:return Ue(e.type.render,!1);case 1:return Ue(e.type,!0);case 31:return ot("Activity");default:return""}}function ft(e){try{var n="",i=null;do n+=ht(e,i),i=e,e=e.return;while(e);return n}catch(l){return`
Error generating stack: `+l.message+`
`+l.stack}}var $t=Object.prototype.hasOwnProperty,It=t.unstable_scheduleCallback,oe=t.unstable_cancelCallback,Ye=t.unstable_shouldYield,bt=t.unstable_requestPaint,Pe=t.unstable_now,lt=t.unstable_getCurrentPriorityLevel,Vt=t.unstable_ImmediatePriority,oa=t.unstable_UserBlockingPriority,Ka=t.unstable_NormalPriority,gn=t.unstable_LowPriority,Zt=t.unstable_IdlePriority,la=t.log,qt=t.unstable_setDisableYieldValue,Gt=null,kt=null;function ta(e){if(typeof la=="function"&&qt(e),kt&&typeof kt.setStrictMode=="function")try{kt.setStrictMode(Gt,e)}catch{}}var Ht=Math.clz32?Math.clz32:he,se=Math.log,pe=Math.LN2;function he(e){return e>>>=0,e===0?32:31-(se(e)/pe|0)|0}var K=256,je=262144,J=4194304;function le(e){var n=e&42;if(n!==0)return n;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return e&261888;case 262144:case 524288:case 1048576:case 2097152:return e&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return e&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function ue(e,n,i){var l=e.pendingLanes;if(l===0)return 0;var d=0,f=e.suspendedLanes,w=e.pingedLanes;e=e.warmLanes;var A=l&134217727;return A!==0?(l=A&~f,l!==0?d=le(l):(w&=A,w!==0?d=le(w):i||(i=A&~e,i!==0&&(d=le(i))))):(A=l&~f,A!==0?d=le(A):w!==0?d=le(w):i||(i=l&~e,i!==0&&(d=le(i)))),d===0?0:n!==0&&n!==d&&(n&f)===0&&(f=d&-d,i=n&-n,f>=i||f===32&&(i&4194048)!==0)?n:d}function Me(e,n){return(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&n)===0}function Ie(e,n){switch(e){case 1:case 2:case 4:case 8:case 64:return n+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function at(){var e=J;return J<<=1,(J&62914560)===0&&(J=4194304),e}function Ze(e){for(var n=[],i=0;31>i;i++)n.push(e);return n}function Ce(e,n){e.pendingLanes|=n,n!==268435456&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function rt(e,n,i,l,d,f){var w=e.pendingLanes;e.pendingLanes=i,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=i,e.entangledLanes&=i,e.errorRecoveryDisabledLanes&=i,e.shellSuspendCounter=0;var A=e.entanglements,G=e.expirationTimes,ye=e.hiddenUpdates;for(i=w&~i;0<i;){var De=31-Ht(i),Fe=1<<De;A[De]=0,G[De]=-1;var we=ye[De];if(we!==null)for(ye[De]=null,De=0;De<we.length;De++){var ke=we[De];ke!==null&&(ke.lane&=-536870913)}i&=~Fe}l!==0&&zt(e,l,0),f!==0&&d===0&&e.tag!==0&&(e.suspendedLanes|=f&~(w&~n))}function zt(e,n,i){e.pendingLanes|=n,e.suspendedLanes&=~n;var l=31-Ht(n);e.entangledLanes|=n,e.entanglements[l]=e.entanglements[l]|1073741824|i&261930}function Ve(e,n){var i=e.entangledLanes|=n;for(e=e.entanglements;i;){var l=31-Ht(i),d=1<<l;d&n|e[l]&n&&(e[l]|=n),i&=~d}}function ca(e,n){var i=n&-n;return i=(i&42)!==0?1:ha(i),(i&(e.suspendedLanes|n))!==0?0:i}function ha(e){switch(e){case 2:e=1;break;case 8:e=4;break;case 32:e=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:e=128;break;case 268435456:e=134217728;break;default:e=0}return e}function Ra(e){return e&=-e,2<e?8<e?(e&134217727)!==0?32:268435456:8:2}function xe(){var e=z.p;return e!==0?e:(e=window.event,e===void 0?32:Fx(e.type))}function Tt(e,n){var i=z.p;try{return z.p=e,n()}finally{z.p=i}}var et=Math.random().toString(36).slice(2),Ae="__reactFiber$"+et,it="__reactProps$"+et,Xe="__reactContainer$"+et,be="__reactEvents$"+et,Qt="__reactListeners$"+et,gt="__reactHandles$"+et,Rt="__reactResources$"+et,ua="__reactMarker$"+et;function An(e){delete e[Ae],delete e[it],delete e[be],delete e[Qt],delete e[gt]}function wa(e){var n=e[Ae];if(n)return n;for(var i=e.parentNode;i;){if(n=i[Xe]||i[Ae]){if(i=n.alternate,n.child!==null||i!==null&&i.child!==null)for(e=Ax(e);e!==null;){if(i=e[Ae])return i;e=Ax(e)}return n}e=i,i=e.parentNode}return null}function Na(e){if(e=e[Ae]||e[Xe]){var n=e.tag;if(n===5||n===6||n===13||n===31||n===26||n===27||n===3)return e}return null}function ze(e){var n=e.tag;if(n===5||n===26||n===27||n===6)return e.stateNode;throw Error(o(33))}function Pn(e){var n=e[Rt];return n||(n=e[Rt]={hoistableStyles:new Map,hoistableScripts:new Map}),n}function ja(e){e[ua]=!0}var vs=new Set,Vn={};function ns(e,n){us(e,n),us(e+"Capture",n)}function us(e,n){for(Vn[e]=n,e=0;e<n.length;e++)vs.add(n[e])}var ps=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Ti={},Qr={};function js(e){return $t.call(Qr,e)?!0:$t.call(Ti,e)?!1:ps.test(e)?Qr[e]=!0:(Ti[e]=!0,!1)}function Si(e,n,i){if(js(n))if(i===null)e.removeAttribute(n);else{switch(typeof i){case"undefined":case"function":case"symbol":e.removeAttribute(n);return;case"boolean":var l=n.toLowerCase().slice(0,5);if(l!=="data-"&&l!=="aria-"){e.removeAttribute(n);return}}e.setAttribute(n,""+i)}}function Wn(e,n,i){if(i===null)e.removeAttribute(n);else{switch(typeof i){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(n);return}e.setAttribute(n,""+i)}}function fs(e,n,i,l){if(l===null)e.removeAttribute(i);else{switch(typeof l){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(i);return}e.setAttributeNS(n,i,""+l)}}function xa(e){switch(typeof e){case"bigint":case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function qs(e){var n=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(n==="checkbox"||n==="radio")}function hi(e,n,i){var l=Object.getOwnPropertyDescriptor(e.constructor.prototype,n);if(!e.hasOwnProperty(n)&&typeof l<"u"&&typeof l.get=="function"&&typeof l.set=="function"){var d=l.get,f=l.set;return Object.defineProperty(e,n,{configurable:!0,get:function(){return d.call(this)},set:function(w){i=""+w,f.call(this,w)}}),Object.defineProperty(e,n,{enumerable:l.enumerable}),{getValue:function(){return i},setValue:function(w){i=""+w},stopTracking:function(){e._valueTracker=null,delete e[n]}}}}function Un(e){if(!e._valueTracker){var n=qs(e)?"checked":"value";e._valueTracker=hi(e,n,""+e[n])}}function Vi(e){if(!e)return!1;var n=e._valueTracker;if(!n)return!0;var i=n.getValue(),l="";return e&&(l=qs(e)?e.checked?"true":"false":e.value),e=l,e!==i?(n.setValue(e),!0):!1}function Ai(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}var oi=/[\n"\\]/g;function Dn(e){return e.replace(oi,function(n){return"\\"+n.charCodeAt(0).toString(16)+" "})}function xi(e,n,i,l,d,f,w,A){e.name="",w!=null&&typeof w!="function"&&typeof w!="symbol"&&typeof w!="boolean"?e.type=w:e.removeAttribute("type"),n!=null?w==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+xa(n)):e.value!==""+xa(n)&&(e.value=""+xa(n)):w!=="submit"&&w!=="reset"||e.removeAttribute("value"),n!=null?li(e,w,xa(n)):i!=null?li(e,w,xa(i)):l!=null&&e.removeAttribute("value"),d==null&&f!=null&&(e.defaultChecked=!!f),d!=null&&(e.checked=d&&typeof d!="function"&&typeof d!="symbol"),A!=null&&typeof A!="function"&&typeof A!="symbol"&&typeof A!="boolean"?e.name=""+xa(A):e.removeAttribute("name")}function Wi(e,n,i,l,d,f,w,A){if(f!=null&&typeof f!="function"&&typeof f!="symbol"&&typeof f!="boolean"&&(e.type=f),n!=null||i!=null){if(!(f!=="submit"&&f!=="reset"||n!=null)){Un(e);return}i=i!=null?""+xa(i):"",n=n!=null?""+xa(n):i,A||n===e.value||(e.value=n),e.defaultValue=n}l=l??d,l=typeof l!="function"&&typeof l!="symbol"&&!!l,e.checked=A?e.checked:!!l,e.defaultChecked=!!l,w!=null&&typeof w!="function"&&typeof w!="symbol"&&typeof w!="boolean"&&(e.name=w),Un(e)}function li(e,n,i){n==="number"&&Ai(e.ownerDocument)===e||e.defaultValue===""+i||(e.defaultValue=""+i)}function ws(e,n,i,l){if(e=e.options,n){n={};for(var d=0;d<i.length;d++)n["$"+i[d]]=!0;for(i=0;i<e.length;i++)d=n.hasOwnProperty("$"+e[i].value),e[i].selected!==d&&(e[i].selected=d),d&&l&&(e[i].defaultSelected=!0)}else{for(i=""+xa(i),n=null,d=0;d<e.length;d++){if(e[d].value===i){e[d].selected=!0,l&&(e[d].defaultSelected=!0);return}n!==null||e[d].disabled||(n=e[d])}n!==null&&(n.selected=!0)}}function Ui(e,n,i){if(n!=null&&(n=""+xa(n),n!==e.value&&(e.value=n),i==null)){e.defaultValue!==n&&(e.defaultValue=n);return}e.defaultValue=i!=null?""+xa(i):""}function Gs(e,n,i,l){if(n==null){if(l!=null){if(i!=null)throw Error(o(92));if(de(l)){if(1<l.length)throw Error(o(93));l=l[0]}i=l}i==null&&(i=""),n=i}i=xa(n),e.defaultValue=i,l=e.textContent,l===i&&l!==""&&l!==null&&(e.value=l),Un(e)}function Ds(e,n){if(n){var i=e.firstChild;if(i&&i===e.lastChild&&i.nodeType===3){i.nodeValue=n;return}}e.textContent=n}var Jr=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function gi(e,n,i){var l=n.indexOf("--")===0;i==null||typeof i=="boolean"||i===""?l?e.setProperty(n,""):n==="float"?e.cssFloat="":e[n]="":l?e.setProperty(n,i):typeof i!="number"||i===0||Jr.has(n)?n==="float"?e.cssFloat=i:e[n]=(""+i).trim():e[n]=i+"px"}function Fs(e,n,i){if(n!=null&&typeof n!="object")throw Error(o(62));if(e=e.style,i!=null){for(var l in i)!i.hasOwnProperty(l)||n!=null&&n.hasOwnProperty(l)||(l.indexOf("--")===0?e.setProperty(l,""):l==="float"?e.cssFloat="":e[l]="");for(var d in n)l=n[d],n.hasOwnProperty(d)&&i[d]!==l&&gi(e,d,l)}else for(var f in n)n.hasOwnProperty(f)&&gi(e,f,n[f])}function Oe(e){if(e.indexOf("-")===-1)return!1;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ge=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),dt=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Nt(e){return dt.test(""+e)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":e}function st(){}var Ct=null;function He(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var _e=null,Te=null;function ut(e){var n=Na(e);if(n&&(e=n.stateNode)){var i=e[it]||null;e:switch(e=n.stateNode,n.type){case"input":if(xi(e,i.value,i.defaultValue,i.defaultValue,i.checked,i.defaultChecked,i.type,i.name),n=i.name,i.type==="radio"&&n!=null){for(i=e;i.parentNode;)i=i.parentNode;for(i=i.querySelectorAll('input[name="'+Dn(""+n)+'"][type="radio"]'),n=0;n<i.length;n++){var l=i[n];if(l!==e&&l.form===e.form){var d=l[it]||null;if(!d)throw Error(o(90));xi(l,d.value,d.defaultValue,d.defaultValue,d.checked,d.defaultChecked,d.type,d.name)}}for(n=0;n<i.length;n++)l=i[n],l.form===e.form&&Vi(l)}break e;case"textarea":Ui(e,i.value,i.defaultValue);break e;case"select":n=i.value,n!=null&&ws(e,!!i.multiple,n,!1)}}}var vt=!1;function Ee(e,n,i){if(vt)return e(n,i);vt=!0;try{var l=e(n);return l}finally{if(vt=!1,(_e!==null||Te!==null)&&(x0(),_e&&(n=_e,e=Te,Te=_e=null,ut(n),e)))for(n=0;n<e.length;n++)ut(e[n])}}function We(e,n){var i=e.stateNode;if(i===null)return null;var l=i[it]||null;if(l===null)return null;i=l[n];e:switch(n){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(l=!l.disabled)||(e=e.type,l=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!l;break e;default:e=!1}if(e)return null;if(i&&typeof i!="function")throw Error(o(231,n,typeof i));return i}var xt=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Fa=!1;if(xt)try{var nt={};Object.defineProperty(nt,"passive",{get:function(){Fa=!0}}),window.addEventListener("test",nt,nt),window.removeEventListener("test",nt,nt)}catch{Fa=!1}var Jt=null,na=null,St=null;function pa(){if(St)return St;var e,n=na,i=n.length,l,d="value"in Jt?Jt.value:Jt.textContent,f=d.length;for(e=0;e<i&&n[e]===d[e];e++);var w=i-e;for(l=1;l<=w&&n[i-l]===d[f-l];l++);return St=d.slice(e,1<l?1-l:void 0)}function $a(e){var n=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&n===13&&(e=13)):e=n,e===10&&(e=13),32<=e||e===13?e:0}function Mn(){return!0}function Rn(){return!1}function ms(e){function n(i,l,d,f,w){this._reactName=i,this._targetInst=d,this.type=l,this.nativeEvent=f,this.target=w,this.currentTarget=null;for(var A in e)e.hasOwnProperty(A)&&(i=e[A],this[A]=i?i(f):f[A]);return this.isDefaultPrevented=(f.defaultPrevented!=null?f.defaultPrevented:f.returnValue===!1)?Mn:Rn,this.isPropagationStopped=Rn,this}return b(n.prototype,{preventDefault:function(){this.defaultPrevented=!0;var i=this.nativeEvent;i&&(i.preventDefault?i.preventDefault():typeof i.returnValue!="unknown"&&(i.returnValue=!1),this.isDefaultPrevented=Mn)},stopPropagation:function(){var i=this.nativeEvent;i&&(i.stopPropagation?i.stopPropagation():typeof i.cancelBubble!="unknown"&&(i.cancelBubble=!0),this.isPropagationStopped=Mn)},persist:function(){},isPersistent:Mn}),n}var In={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Rs=ms(In),Vs=b({},In,{view:0,detail:0}),Oo=ms(Vs),Kr,Sl,eo,zo=b({},Vs,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:to,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==eo&&(eo&&e.type==="mousemove"?(Kr=e.screenX-eo.screenX,Sl=e.screenY-eo.screenY):Sl=Kr=0,eo=e),Kr)},movementY:function(e){return"movementY"in e?e.movementY:Sl}}),Rc=ms(zo),$c=b({},zo,{dataTransfer:0}),vd=ms($c),jd=b({},Vs,{relatedTarget:0}),Pi=ms(jd),Oc=b({},In,{animationName:0,elapsedTime:0,pseudoElement:0}),wd=ms(Oc),zc=b({},In,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Nd=ms(zc),Md=b({},In,{data:0}),jr=ms(Md),Bo={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},_d={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},ss={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Ys(e){var n=this.nativeEvent;return n.getModifierState?n.getModifierState(e):(e=ss[e])?!!n[e]:!1}function to(){return Ys}var Bc=b({},Vs,{key:function(e){if(e.key){var n=Bo[e.key]||e.key;if(n!=="Unidentified")return n}return e.type==="keypress"?(e=$a(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?_d[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:to,charCode:function(e){return e.type==="keypress"?$a(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?$a(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),nm=ms(Bc),Ed=b({},zo,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),y=ms(Ed),v=b({},Vs,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:to}),W=ms(v),te=b({},In,{propertyName:0,elapsedTime:0,pseudoElement:0}),Se=ms(te),pt=b({},zo,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Qe=ms(pt),ct=b({},In,{newState:0,oldState:0}),_t=ms(ct),Dt=[9,13,27,32],mt=xt&&"CompositionEvent"in window,wt=null;xt&&"documentMode"in document&&(wt=document.documentMode);var Bt=xt&&"TextEvent"in window&&!wt,At=xt&&(!mt||wt&&8<wt&&11>=wt),Ma=" ",ga=!1;function ka(e,n){switch(e){case"keyup":return Dt.indexOf(n.keyCode)!==-1;case"keydown":return n.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function La(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Ca=!1;function Va(e,n){switch(e){case"compositionend":return La(n);case"keypress":return n.which!==32?null:(ga=!0,Ma);case"textInput":return e=n.data,e===Ma&&ga?null:e;default:return null}}function en(e,n){if(Ca)return e==="compositionend"||!mt&&ka(e,n)?(e=pa(),St=na=Jt=null,Ca=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(n.ctrlKey||n.altKey||n.metaKey)||n.ctrlKey&&n.altKey){if(n.char&&1<n.char.length)return n.char;if(n.which)return String.fromCharCode(n.which)}return null;case"compositionend":return At&&n.locale!=="ko"?null:n.data;default:return null}}var Kt={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function yt(e){var n=e&&e.nodeName&&e.nodeName.toLowerCase();return n==="input"?!!Kt[e.type]:n==="textarea"}function Ft(e,n,i,l){_e?Te?Te.push(l):Te=[l]:_e=l,n=N0(n,"onChange"),0<n.length&&(i=new Rs("onChange","change",null,i,l),e.push({event:i,listeners:n}))}var Et=null,Yt=null;function tn(e){gx(e,0)}function _a(e){var n=ze(e);if(Vi(n))return e}function on(e,n){if(e==="change")return n}var Oa=!1;if(xt){var Hn;if(xt){var yn="oninput"in document;if(!yn){var Ta=document.createElement("div");Ta.setAttribute("oninput","return;"),yn=typeof Ta.oninput=="function"}Hn=yn}else Hn=!1;Oa=Hn&&(!document.documentMode||9<document.documentMode)}function qn(){Et&&(Et.detachEvent("onpropertychange",Ji),Yt=Et=null)}function Ji(e){if(e.propertyName==="value"&&_a(Yt)){var n=[];Ft(n,Yt,e,He(e)),Ee(tn,n)}}function wr(e,n,i){e==="focusin"?(qn(),Et=n,Yt=i,Et.attachEvent("onpropertychange",Ji)):e==="focusout"&&qn()}function Di(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return _a(Yt)}function ao(e,n){if(e==="click")return _a(n)}function Gn(e,n){if(e==="input"||e==="change")return _a(n)}function Ki(e,n){return e===n&&(e!==0||1/e===1/n)||e!==e&&n!==n}var Wa=typeof Object.is=="function"?Object.is:Ki;function hs(e,n){if(Wa(e,n))return!0;if(typeof e!="object"||e===null||typeof n!="object"||n===null)return!1;var i=Object.keys(e),l=Object.keys(n);if(i.length!==l.length)return!1;for(l=0;l<i.length;l++){var d=i[l];if(!$t.call(n,d)||!Wa(e[d],n[d]))return!1}return!0}function er(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Lo(e,n){var i=er(e);e=0;for(var l;i;){if(i.nodeType===3){if(l=e+i.textContent.length,e<=n&&l>=n)return{node:i,offset:n-e};e=l}e:{for(;i;){if(i.nextSibling){i=i.nextSibling;break e}i=i.parentNode}i=void 0}i=er(i)}}function no(e,n){return e&&n?e===n?!0:e&&e.nodeType===3?!1:n&&n.nodeType===3?no(e,n.parentNode):"contains"in e?e.contains(n):e.compareDocumentPosition?!!(e.compareDocumentPosition(n)&16):!1:!1}function Be(e){e=e!=null&&e.ownerDocument!=null&&e.ownerDocument.defaultView!=null?e.ownerDocument.defaultView:window;for(var n=Ai(e.document);n instanceof e.HTMLIFrameElement;){try{var i=typeof n.contentWindow.location.href=="string"}catch{i=!1}if(i)e=n.contentWindow;else break;n=Ai(e.document)}return n}function Wt(e){var n=e&&e.nodeName&&e.nodeName.toLowerCase();return n&&(n==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||n==="textarea"||e.contentEditable==="true")}var da=xt&&"documentMode"in document&&11>=document.documentMode,bn=null,Sa=null,Ya=null,an=!1;function nn(e,n,i){var l=i.window===i?i.document:i.nodeType===9?i:i.ownerDocument;an||bn==null||bn!==Ai(l)||(l=bn,"selectionStart"in l&&Wt(l)?l={start:l.selectionStart,end:l.selectionEnd}:(l=(l.ownerDocument&&l.ownerDocument.defaultView||window).getSelection(),l={anchorNode:l.anchorNode,anchorOffset:l.anchorOffset,focusNode:l.focusNode,focusOffset:l.focusOffset}),Ya&&hs(Ya,l)||(Ya=l,l=N0(Sa,"onSelect"),0<l.length&&(n=new Rs("onSelect","select",null,n,i),e.push({event:n,listeners:l}),n.target=bn)))}function sa(e,n){var i={};return i[e.toLowerCase()]=n.toLowerCase(),i["Webkit"+e]="webkit"+n,i["Moz"+e]="moz"+n,i}var Xa={animationend:sa("Animation","AnimationEnd"),animationiteration:sa("Animation","AnimationIteration"),animationstart:sa("Animation","AnimationStart"),transitionrun:sa("Transition","TransitionRun"),transitionstart:sa("Transition","TransitionStart"),transitioncancel:sa("Transition","TransitionCancel"),transitionend:sa("Transition","TransitionEnd")},Fn={},Ri={};xt&&(Ri=document.createElement("div").style,"AnimationEvent"in window||(delete Xa.animationend.animation,delete Xa.animationiteration.animation,delete Xa.animationstart.animation),"TransitionEvent"in window||delete Xa.transitionend.transition);function Yn(e){if(Fn[e])return Fn[e];if(!Xa[e])return e;var n=Xa[e],i;for(i in n)if(n.hasOwnProperty(i)&&i in Ri)return Fn[e]=n[i];return e}var Xs=Yn("animationend"),yi=Yn("animationiteration"),Ii=Yn("animationstart"),ia=Yn("transitionrun"),ln=Yn("transitionstart"),fn=Yn("transitioncancel"),En=Yn("transitionend"),Aa=new Map,sn="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");sn.push("scrollEnd");function za(e,n){Aa.set(e,n),ns(n,[e])}var is=typeof reportError=="function"?reportError:function(e){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var n=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof e=="object"&&e!==null&&typeof e.message=="string"?String(e.message):String(e),error:e});if(!window.dispatchEvent(n))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",e);return}console.error(e)},mn=[],Ns=0,rs=0;function os(){for(var e=Ns,n=rs=Ns=0;n<e;){var i=mn[n];mn[n++]=null;var l=mn[n];mn[n++]=null;var d=mn[n];mn[n++]=null;var f=mn[n];if(mn[n++]=null,l!==null&&d!==null){var w=l.pending;w===null?d.next=d:(d.next=w.next,w.next=d),l.pending=d}f!==0&&Xn(i,d,f)}}function cn(e,n,i,l){mn[Ns++]=e,mn[Ns++]=n,mn[Ns++]=i,mn[Ns++]=l,rs|=l,e.lanes|=l,e=e.alternate,e!==null&&(e.lanes|=l)}function Ms(e,n,i,l){return cn(e,n,i,l),$s(e)}function Zs(e,n){return cn(e,null,null,n),$s(e)}function Xn(e,n,i){e.lanes|=i;var l=e.alternate;l!==null&&(l.lanes|=i);for(var d=!1,f=e.return;f!==null;)f.childLanes|=i,l=f.alternate,l!==null&&(l.childLanes|=i),f.tag===22&&(e=f.stateNode,e===null||e._visibility&1||(d=!0)),e=f,f=f.return;return e.tag===3?(f=e.stateNode,d&&n!==null&&(d=31-Ht(i),e=f.hiddenUpdates,l=e[d],l===null?e[d]=[n]:l.push(n),n.lane=i|536870912),f):null}function $s(e){if(50<Jl)throw Jl=0,Su=null,Error(o(185));for(var n=e.return;n!==null;)e=n,n=e.return;return e.tag===3?e.stateNode:null}var kn={};function Os(e,n,i,l){this.tag=e,this.key=i,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=n,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=l,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ua(e,n,i,l){return new Os(e,n,i,l)}function xs(e){return e=e.prototype,!(!e||!e.isReactComponent)}function vn(e,n){var i=e.alternate;return i===null?(i=Ua(e.tag,n,e.key,e.mode),i.elementType=e.elementType,i.type=e.type,i.stateNode=e.stateNode,i.alternate=e,e.alternate=i):(i.pendingProps=n,i.type=e.type,i.flags=0,i.subtreeFlags=0,i.deletions=null),i.flags=e.flags&65011712,i.childLanes=e.childLanes,i.lanes=e.lanes,i.child=e.child,i.memoizedProps=e.memoizedProps,i.memoizedState=e.memoizedState,i.updateQueue=e.updateQueue,n=e.dependencies,i.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext},i.sibling=e.sibling,i.index=e.index,i.ref=e.ref,i.refCleanup=e.refCleanup,i}function Ws(e,n){e.flags&=65011714;var i=e.alternate;return i===null?(e.childLanes=0,e.lanes=n,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=i.childLanes,e.lanes=i.lanes,e.child=i.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=i.memoizedProps,e.memoizedState=i.memoizedState,e.updateQueue=i.updateQueue,e.type=i.type,n=i.dependencies,e.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext}),e}function $i(e,n,i,l,d,f){var w=0;if(l=e,typeof e=="function")xs(e)&&(w=1);else if(typeof e=="string")w=Pv(e,i,H.current)?26:e==="html"||e==="head"||e==="body"?27:5;else e:switch(e){case U:return e=Ua(31,i,n,d),e.elementType=U,e.lanes=f,e;case M:return ls(i.children,d,f,n);case R:w=8,d|=24;break;case E:return e=Ua(12,i,n,d|2),e.elementType=E,e.lanes=f,e;case q:return e=Ua(13,i,n,d),e.elementType=q,e.lanes=f,e;case I:return e=Ua(19,i,n,d),e.elementType=I,e.lanes=f,e;default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case D:w=10;break e;case T:w=9;break e;case O:w=11;break e;case Z:w=14;break e;case Y:w=16,l=null;break e}w=29,i=Error(o(130,e===null?"null":typeof e,"")),l=null}return n=Ua(w,i,n,d),n.elementType=e,n.type=l,n.lanes=f,n}function ls(e,n,i,l){return e=Ua(7,e,l,n),e.lanes=i,e}function bi(e,n,i){return e=Ua(6,e,null,n),e.lanes=i,e}function Lc(e){var n=Ua(18,null,null,0);return n.stateNode=e,n}function so(e,n,i){return n=Ua(4,e.children!==null?e.children:[],e.key,n),n.lanes=i,n.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},n}var Vc=new WeakMap;function $n(e,n){if(typeof e=="object"&&e!==null){var i=Vc.get(e);return i!==void 0?i:(n={value:e,source:n,stack:ft(n)},Vc.set(e,n),n)}return{value:e,source:n,stack:ft(n)}}var Hi=[],Zn=0,_s=null,zs=0,dn=[],Qn=0,Es=null,gs=1,Qs="";function vi(e,n){Hi[Zn++]=zs,Hi[Zn++]=_s,_s=e,zs=n}function Wc(e,n,i){dn[Qn++]=gs,dn[Qn++]=Qs,dn[Qn++]=Es,Es=e;var l=gs;e=Qs;var d=32-Ht(l)-1;l&=~(1<<d),i+=1;var f=32-Ht(n)+d;if(30<f){var w=d-d%5;f=(l&(1<<w)-1).toString(32),l>>=w,d-=w,gs=1<<32-Ht(n)+d|i<<d|l,Qs=f+e}else gs=1<<f|i<<d|l,Qs=e}function Al(e){e.return!==null&&(vi(e,1),Wc(e,1,0))}function Vo(e){for(;e===_s;)_s=Hi[--Zn],Hi[Zn]=null,zs=Hi[--Zn],Hi[Zn]=null;for(;e===Es;)Es=dn[--Qn],dn[Qn]=null,Qs=dn[--Qn],dn[Qn]=null,gs=dn[--Qn],dn[Qn]=null}function qi(e,n){dn[Qn++]=gs,dn[Qn++]=Qs,dn[Qn++]=Es,gs=n.id,Qs=n.overflow,Es=e}var On=null,hn=null,va=!1,Nr=null,ji=!1,kd=Error(o(519));function Mr(e){var n=Error(o(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Pl($n(n,e)),kd}function sm(e){var n=e.stateNode,i=e.type,l=e.memoizedProps;switch(n[Ae]=e,n[it]=l,i){case"dialog":ma("cancel",n),ma("close",n);break;case"iframe":case"object":case"embed":ma("load",n);break;case"video":case"audio":for(i=0;i<ec.length;i++)ma(ec[i],n);break;case"source":ma("error",n);break;case"img":case"image":case"link":ma("error",n),ma("load",n);break;case"details":ma("toggle",n);break;case"input":ma("invalid",n),Wi(n,l.value,l.defaultValue,l.checked,l.defaultChecked,l.type,l.name,!0);break;case"select":ma("invalid",n);break;case"textarea":ma("invalid",n),Gs(n,l.value,l.defaultValue,l.children)}i=l.children,typeof i!="string"&&typeof i!="number"&&typeof i!="bigint"||n.textContent===""+i||l.suppressHydrationWarning===!0||jx(n.textContent,i)?(l.popover!=null&&(ma("beforetoggle",n),ma("toggle",n)),l.onScroll!=null&&ma("scroll",n),l.onScrollEnd!=null&&ma("scrollend",n),l.onClick!=null&&(n.onclick=st),n=!0):n=!1,n||Mr(e,!0)}function im(e){for(On=e.return;On;)switch(On.tag){case 5:case 31:case 13:ji=!1;return;case 27:case 3:ji=!0;return;default:On=On.return}}function Wo(e){if(e!==On)return!1;if(!va)return im(e),va=!0,!1;var n=e.tag,i;if((i=n!==3&&n!==27)&&((i=n===5)&&(i=e.type,i=!(i!=="form"&&i!=="button")||qu(e.type,e.memoizedProps)),i=!i),i&&hn&&Mr(e),im(e),n===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(o(317));hn=Sx(e)}else if(n===31){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(o(317));hn=Sx(e)}else n===27?(n=hn,Br(e.type)?(e=Zu,Zu=null,hn=e):hn=n):hn=On?Ni(e.stateNode.nextSibling):null;return!0}function io(){hn=On=null,va=!1}function Cd(){var e=Nr;return e!==null&&(ti===null?ti=e:ti.push.apply(ti,e),Nr=null),e}function Pl(e){Nr===null?Nr=[e]:Nr.push(e)}var Td=C(null),ro=null,tr=null;function _r(e,n,i){ie(Td,n._currentValue),n._currentValue=i}function ar(e){e._currentValue=Td.current,L(Td)}function Sd(e,n,i){for(;e!==null;){var l=e.alternate;if((e.childLanes&n)!==n?(e.childLanes|=n,l!==null&&(l.childLanes|=n)):l!==null&&(l.childLanes&n)!==n&&(l.childLanes|=n),e===i)break;e=e.return}}function Ad(e,n,i,l){var d=e.child;for(d!==null&&(d.return=e);d!==null;){var f=d.dependencies;if(f!==null){var w=d.child;f=f.firstContext;e:for(;f!==null;){var A=f;f=d;for(var G=0;G<n.length;G++)if(A.context===n[G]){f.lanes|=i,A=f.alternate,A!==null&&(A.lanes|=i),Sd(f.return,i,e),l||(w=null);break e}f=A.next}}else if(d.tag===18){if(w=d.return,w===null)throw Error(o(341));w.lanes|=i,f=w.alternate,f!==null&&(f.lanes|=i),Sd(w,i,e),w=null}else w=d.child;if(w!==null)w.return=d;else for(w=d;w!==null;){if(w===e){w=null;break}if(d=w.sibling,d!==null){d.return=w.return,w=d;break}w=w.return}d=w}}function Uo(e,n,i,l){e=null;for(var d=n,f=!1;d!==null;){if(!f){if((d.flags&524288)!==0)f=!0;else if((d.flags&262144)!==0)break}if(d.tag===10){var w=d.alternate;if(w===null)throw Error(o(387));if(w=w.memoizedProps,w!==null){var A=d.type;Wa(d.pendingProps.value,w.value)||(e!==null?e.push(A):e=[A])}}else if(d===X.current){if(w=d.alternate,w===null)throw Error(o(387));w.memoizedState.memoizedState!==d.memoizedState.memoizedState&&(e!==null?e.push(ic):e=[ic])}d=d.return}e!==null&&Ad(n,e,i,l),n.flags|=262144}function Uc(e){for(e=e.firstContext;e!==null;){if(!Wa(e.context._currentValue,e.memoizedValue))return!0;e=e.next}return!1}function oo(e){ro=e,tr=null,e=e.dependencies,e!==null&&(e.firstContext=null)}function ks(e){return rm(ro,e)}function Ic(e,n){return ro===null&&oo(e),rm(e,n)}function rm(e,n){var i=n._currentValue;if(n={context:n,memoizedValue:i,next:null},tr===null){if(e===null)throw Error(o(308));tr=n,e.dependencies={lanes:0,firstContext:n},e.flags|=524288}else tr=tr.next=n;return i}var C2=typeof AbortController<"u"?AbortController:function(){var e=[],n=this.signal={aborted:!1,addEventListener:function(i,l){e.push(l)}};this.abort=function(){n.aborted=!0,e.forEach(function(i){return i()})}},T2=t.unstable_scheduleCallback,S2=t.unstable_NormalPriority,Jn={$$typeof:D,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Pd(){return{controller:new C2,data:new Map,refCount:0}}function Dl(e){e.refCount--,e.refCount===0&&T2(S2,function(){e.controller.abort()})}var Rl=null,Dd=0,Io=0,Ho=null;function A2(e,n){if(Rl===null){var i=Rl=[];Dd=0,Io=Ou(),Ho={status:"pending",value:void 0,then:function(l){i.push(l)}}}return Dd++,n.then(om,om),n}function om(){if(--Dd===0&&Rl!==null){Ho!==null&&(Ho.status="fulfilled");var e=Rl;Rl=null,Io=0,Ho=null;for(var n=0;n<e.length;n++)(0,e[n])()}}function P2(e,n){var i=[],l={status:"pending",value:null,reason:null,then:function(d){i.push(d)}};return e.then(function(){l.status="fulfilled",l.value=n;for(var d=0;d<i.length;d++)(0,i[d])(n)},function(d){for(l.status="rejected",l.reason=d,d=0;d<i.length;d++)(0,i[d])(void 0)}),l}var lm=P.S;P.S=function(e,n){qh=Pe(),typeof n=="object"&&n!==null&&typeof n.then=="function"&&A2(e,n),lm!==null&&lm(e,n)};var lo=C(null);function Rd(){var e=lo.current;return e!==null?e:rn.pooledCache}function Hc(e,n){n===null?ie(lo,lo.current):ie(lo,n.pool)}function cm(){var e=Rd();return e===null?null:{parent:Jn._currentValue,pool:e}}var qo=Error(o(460)),$d=Error(o(474)),qc=Error(o(542)),Gc={then:function(){}};function dm(e){return e=e.status,e==="fulfilled"||e==="rejected"}function um(e,n,i){switch(i=e[i],i===void 0?e.push(n):i!==n&&(n.then(st,st),n=i),n.status){case"fulfilled":return n.value;case"rejected":throw e=n.reason,fm(e),e;default:if(typeof n.status=="string")n.then(st,st);else{if(e=rn,e!==null&&100<e.shellSuspendCounter)throw Error(o(482));e=n,e.status="pending",e.then(function(l){if(n.status==="pending"){var d=n;d.status="fulfilled",d.value=l}},function(l){if(n.status==="pending"){var d=n;d.status="rejected",d.reason=l}})}switch(n.status){case"fulfilled":return n.value;case"rejected":throw e=n.reason,fm(e),e}throw uo=n,qo}}function co(e){try{var n=e._init;return n(e._payload)}catch(i){throw i!==null&&typeof i=="object"&&typeof i.then=="function"?(uo=i,qo):i}}var uo=null;function pm(){if(uo===null)throw Error(o(459));var e=uo;return uo=null,e}function fm(e){if(e===qo||e===qc)throw Error(o(483))}var Go=null,$l=0;function Fc(e){var n=$l;return $l+=1,Go===null&&(Go=[]),um(Go,e,n)}function Ol(e,n){n=n.props.ref,e.ref=n!==void 0?n:null}function Yc(e,n){throw n.$$typeof===j?Error(o(525)):(e=Object.prototype.toString.call(n),Error(o(31,e==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":e)))}function mm(e){function n(ce,ee){if(e){var ge=ce.deletions;ge===null?(ce.deletions=[ee],ce.flags|=16):ge.push(ee)}}function i(ce,ee){if(!e)return null;for(;ee!==null;)n(ce,ee),ee=ee.sibling;return null}function l(ce){for(var ee=new Map;ce!==null;)ce.key!==null?ee.set(ce.key,ce):ee.set(ce.index,ce),ce=ce.sibling;return ee}function d(ce,ee){return ce=vn(ce,ee),ce.index=0,ce.sibling=null,ce}function f(ce,ee,ge){return ce.index=ge,e?(ge=ce.alternate,ge!==null?(ge=ge.index,ge<ee?(ce.flags|=67108866,ee):ge):(ce.flags|=67108866,ee)):(ce.flags|=1048576,ee)}function w(ce){return e&&ce.alternate===null&&(ce.flags|=67108866),ce}function A(ce,ee,ge,Le){return ee===null||ee.tag!==6?(ee=bi(ge,ce.mode,Le),ee.return=ce,ee):(ee=d(ee,ge),ee.return=ce,ee)}function G(ce,ee,ge,Le){var Lt=ge.type;return Lt===M?De(ce,ee,ge.props.children,Le,ge.key):ee!==null&&(ee.elementType===Lt||typeof Lt=="object"&&Lt!==null&&Lt.$$typeof===Y&&co(Lt)===ee.type)?(ee=d(ee,ge.props),Ol(ee,ge),ee.return=ce,ee):(ee=$i(ge.type,ge.key,ge.props,null,ce.mode,Le),Ol(ee,ge),ee.return=ce,ee)}function ye(ce,ee,ge,Le){return ee===null||ee.tag!==4||ee.stateNode.containerInfo!==ge.containerInfo||ee.stateNode.implementation!==ge.implementation?(ee=so(ge,ce.mode,Le),ee.return=ce,ee):(ee=d(ee,ge.children||[]),ee.return=ce,ee)}function De(ce,ee,ge,Le,Lt){return ee===null||ee.tag!==7?(ee=ls(ge,ce.mode,Le,Lt),ee.return=ce,ee):(ee=d(ee,ge),ee.return=ce,ee)}function Fe(ce,ee,ge){if(typeof ee=="string"&&ee!==""||typeof ee=="number"||typeof ee=="bigint")return ee=bi(""+ee,ce.mode,ge),ee.return=ce,ee;if(typeof ee=="object"&&ee!==null){switch(ee.$$typeof){case _:return ge=$i(ee.type,ee.key,ee.props,null,ce.mode,ge),Ol(ge,ee),ge.return=ce,ge;case N:return ee=so(ee,ce.mode,ge),ee.return=ce,ee;case Y:return ee=co(ee),Fe(ce,ee,ge)}if(de(ee)||ne(ee))return ee=ls(ee,ce.mode,ge,null),ee.return=ce,ee;if(typeof ee.then=="function")return Fe(ce,Fc(ee),ge);if(ee.$$typeof===D)return Fe(ce,Ic(ce,ee),ge);Yc(ce,ee)}return null}function we(ce,ee,ge,Le){var Lt=ee!==null?ee.key:null;if(typeof ge=="string"&&ge!==""||typeof ge=="number"||typeof ge=="bigint")return Lt!==null?null:A(ce,ee,""+ge,Le);if(typeof ge=="object"&&ge!==null){switch(ge.$$typeof){case _:return ge.key===Lt?G(ce,ee,ge,Le):null;case N:return ge.key===Lt?ye(ce,ee,ge,Le):null;case Y:return ge=co(ge),we(ce,ee,ge,Le)}if(de(ge)||ne(ge))return Lt!==null?null:De(ce,ee,ge,Le,null);if(typeof ge.then=="function")return we(ce,ee,Fc(ge),Le);if(ge.$$typeof===D)return we(ce,ee,Ic(ce,ge),Le);Yc(ce,ge)}return null}function ke(ce,ee,ge,Le,Lt){if(typeof Le=="string"&&Le!==""||typeof Le=="number"||typeof Le=="bigint")return ce=ce.get(ge)||null,A(ee,ce,""+Le,Lt);if(typeof Le=="object"&&Le!==null){switch(Le.$$typeof){case _:return ce=ce.get(Le.key===null?ge:Le.key)||null,G(ee,ce,Le,Lt);case N:return ce=ce.get(Le.key===null?ge:Le.key)||null,ye(ee,ce,Le,Lt);case Y:return Le=co(Le),ke(ce,ee,ge,Le,Lt)}if(de(Le)||ne(Le))return ce=ce.get(ge)||null,De(ee,ce,Le,Lt,null);if(typeof Le.then=="function")return ke(ce,ee,ge,Fc(Le),Lt);if(Le.$$typeof===D)return ke(ce,ee,ge,Ic(ee,Le),Lt);Yc(ee,Le)}return null}function Pt(ce,ee,ge,Le){for(var Lt=null,Pa=null,Ot=ee,ra=ee=0,ba=null;Ot!==null&&ra<ge.length;ra++){Ot.index>ra?(ba=Ot,Ot=null):ba=Ot.sibling;var Da=we(ce,Ot,ge[ra],Le);if(Da===null){Ot===null&&(Ot=ba);break}e&&Ot&&Da.alternate===null&&n(ce,Ot),ee=f(Da,ee,ra),Pa===null?Lt=Da:Pa.sibling=Da,Pa=Da,Ot=ba}if(ra===ge.length)return i(ce,Ot),va&&vi(ce,ra),Lt;if(Ot===null){for(;ra<ge.length;ra++)Ot=Fe(ce,ge[ra],Le),Ot!==null&&(ee=f(Ot,ee,ra),Pa===null?Lt=Ot:Pa.sibling=Ot,Pa=Ot);return va&&vi(ce,ra),Lt}for(Ot=l(Ot);ra<ge.length;ra++)ba=ke(Ot,ce,ra,ge[ra],Le),ba!==null&&(e&&ba.alternate!==null&&Ot.delete(ba.key===null?ra:ba.key),ee=f(ba,ee,ra),Pa===null?Lt=ba:Pa.sibling=ba,Pa=ba);return e&&Ot.forEach(function(Ir){return n(ce,Ir)}),va&&vi(ce,ra),Lt}function Ut(ce,ee,ge,Le){if(ge==null)throw Error(o(151));for(var Lt=null,Pa=null,Ot=ee,ra=ee=0,ba=null,Da=ge.next();Ot!==null&&!Da.done;ra++,Da=ge.next()){Ot.index>ra?(ba=Ot,Ot=null):ba=Ot.sibling;var Ir=we(ce,Ot,Da.value,Le);if(Ir===null){Ot===null&&(Ot=ba);break}e&&Ot&&Ir.alternate===null&&n(ce,Ot),ee=f(Ir,ee,ra),Pa===null?Lt=Ir:Pa.sibling=Ir,Pa=Ir,Ot=ba}if(Da.done)return i(ce,Ot),va&&vi(ce,ra),Lt;if(Ot===null){for(;!Da.done;ra++,Da=ge.next())Da=Fe(ce,Da.value,Le),Da!==null&&(ee=f(Da,ee,ra),Pa===null?Lt=Da:Pa.sibling=Da,Pa=Da);return va&&vi(ce,ra),Lt}for(Ot=l(Ot);!Da.done;ra++,Da=ge.next())Da=ke(Ot,ce,ra,Da.value,Le),Da!==null&&(e&&Da.alternate!==null&&Ot.delete(Da.key===null?ra:Da.key),ee=f(Da,ee,ra),Pa===null?Lt=Da:Pa.sibling=Da,Pa=Da);return e&&Ot.forEach(function(Iv){return n(ce,Iv)}),va&&vi(ce,ra),Lt}function Ja(ce,ee,ge,Le){if(typeof ge=="object"&&ge!==null&&ge.type===M&&ge.key===null&&(ge=ge.props.children),typeof ge=="object"&&ge!==null){switch(ge.$$typeof){case _:e:{for(var Lt=ge.key;ee!==null;){if(ee.key===Lt){if(Lt=ge.type,Lt===M){if(ee.tag===7){i(ce,ee.sibling),Le=d(ee,ge.props.children),Le.return=ce,ce=Le;break e}}else if(ee.elementType===Lt||typeof Lt=="object"&&Lt!==null&&Lt.$$typeof===Y&&co(Lt)===ee.type){i(ce,ee.sibling),Le=d(ee,ge.props),Ol(Le,ge),Le.return=ce,ce=Le;break e}i(ce,ee);break}else n(ce,ee);ee=ee.sibling}ge.type===M?(Le=ls(ge.props.children,ce.mode,Le,ge.key),Le.return=ce,ce=Le):(Le=$i(ge.type,ge.key,ge.props,null,ce.mode,Le),Ol(Le,ge),Le.return=ce,ce=Le)}return w(ce);case N:e:{for(Lt=ge.key;ee!==null;){if(ee.key===Lt)if(ee.tag===4&&ee.stateNode.containerInfo===ge.containerInfo&&ee.stateNode.implementation===ge.implementation){i(ce,ee.sibling),Le=d(ee,ge.children||[]),Le.return=ce,ce=Le;break e}else{i(ce,ee);break}else n(ce,ee);ee=ee.sibling}Le=so(ge,ce.mode,Le),Le.return=ce,ce=Le}return w(ce);case Y:return ge=co(ge),Ja(ce,ee,ge,Le)}if(de(ge))return Pt(ce,ee,ge,Le);if(ne(ge)){if(Lt=ne(ge),typeof Lt!="function")throw Error(o(150));return ge=Lt.call(ge),Ut(ce,ee,ge,Le)}if(typeof ge.then=="function")return Ja(ce,ee,Fc(ge),Le);if(ge.$$typeof===D)return Ja(ce,ee,Ic(ce,ge),Le);Yc(ce,ge)}return typeof ge=="string"&&ge!==""||typeof ge=="number"||typeof ge=="bigint"?(ge=""+ge,ee!==null&&ee.tag===6?(i(ce,ee.sibling),Le=d(ee,ge),Le.return=ce,ce=Le):(i(ce,ee),Le=bi(ge,ce.mode,Le),Le.return=ce,ce=Le),w(ce)):i(ce,ee)}return function(ce,ee,ge,Le){try{$l=0;var Lt=Ja(ce,ee,ge,Le);return Go=null,Lt}catch(Ot){if(Ot===qo||Ot===qc)throw Ot;var Pa=Ua(29,Ot,null,ce.mode);return Pa.lanes=Le,Pa.return=ce,Pa}finally{}}}var po=mm(!0),hm=mm(!1),Er=!1;function Od(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function zd(e,n){e=e.updateQueue,n.updateQueue===e&&(n.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function kr(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function Cr(e,n,i){var l=e.updateQueue;if(l===null)return null;if(l=l.shared,(Ba&2)!==0){var d=l.pending;return d===null?n.next=n:(n.next=d.next,d.next=n),l.pending=n,n=$s(e),Xn(e,null,i),n}return cn(e,l,n,i),$s(e)}function zl(e,n,i){if(n=n.updateQueue,n!==null&&(n=n.shared,(i&4194048)!==0)){var l=n.lanes;l&=e.pendingLanes,i|=l,n.lanes=i,Ve(e,i)}}function Bd(e,n){var i=e.updateQueue,l=e.alternate;if(l!==null&&(l=l.updateQueue,i===l)){var d=null,f=null;if(i=i.firstBaseUpdate,i!==null){do{var w={lane:i.lane,tag:i.tag,payload:i.payload,callback:null,next:null};f===null?d=f=w:f=f.next=w,i=i.next}while(i!==null);f===null?d=f=n:f=f.next=n}else d=f=n;i={baseState:l.baseState,firstBaseUpdate:d,lastBaseUpdate:f,shared:l.shared,callbacks:l.callbacks},e.updateQueue=i;return}e=i.lastBaseUpdate,e===null?i.firstBaseUpdate=n:e.next=n,i.lastBaseUpdate=n}var Ld=!1;function Bl(){if(Ld){var e=Ho;if(e!==null)throw e}}function Ll(e,n,i,l){Ld=!1;var d=e.updateQueue;Er=!1;var f=d.firstBaseUpdate,w=d.lastBaseUpdate,A=d.shared.pending;if(A!==null){d.shared.pending=null;var G=A,ye=G.next;G.next=null,w===null?f=ye:w.next=ye,w=G;var De=e.alternate;De!==null&&(De=De.updateQueue,A=De.lastBaseUpdate,A!==w&&(A===null?De.firstBaseUpdate=ye:A.next=ye,De.lastBaseUpdate=G))}if(f!==null){var Fe=d.baseState;w=0,De=ye=G=null,A=f;do{var we=A.lane&-536870913,ke=we!==A.lane;if(ke?(ya&we)===we:(l&we)===we){we!==0&&we===Io&&(Ld=!0),De!==null&&(De=De.next={lane:0,tag:A.tag,payload:A.payload,callback:null,next:null});e:{var Pt=e,Ut=A;we=n;var Ja=i;switch(Ut.tag){case 1:if(Pt=Ut.payload,typeof Pt=="function"){Fe=Pt.call(Ja,Fe,we);break e}Fe=Pt;break e;case 3:Pt.flags=Pt.flags&-65537|128;case 0:if(Pt=Ut.payload,we=typeof Pt=="function"?Pt.call(Ja,Fe,we):Pt,we==null)break e;Fe=b({},Fe,we);break e;case 2:Er=!0}}we=A.callback,we!==null&&(e.flags|=64,ke&&(e.flags|=8192),ke=d.callbacks,ke===null?d.callbacks=[we]:ke.push(we))}else ke={lane:we,tag:A.tag,payload:A.payload,callback:A.callback,next:null},De===null?(ye=De=ke,G=Fe):De=De.next=ke,w|=we;if(A=A.next,A===null){if(A=d.shared.pending,A===null)break;ke=A,A=ke.next,ke.next=null,d.lastBaseUpdate=ke,d.shared.pending=null}}while(!0);De===null&&(G=Fe),d.baseState=G,d.firstBaseUpdate=ye,d.lastBaseUpdate=De,f===null&&(d.shared.lanes=0),Dr|=w,e.lanes=w,e.memoizedState=Fe}}function xm(e,n){if(typeof e!="function")throw Error(o(191,e));e.call(n)}function gm(e,n){var i=e.callbacks;if(i!==null)for(e.callbacks=null,e=0;e<i.length;e++)xm(i[e],n)}var Fo=C(null),Xc=C(0);function ym(e,n){e=ur,ie(Xc,e),ie(Fo,n),ur=e|n.baseLanes}function Vd(){ie(Xc,ur),ie(Fo,Fo.current)}function Wd(){ur=Xc.current,L(Fo),L(Xc)}var ci=C(null),wi=null;function Tr(e){var n=e.alternate;ie(zn,zn.current&1),ie(ci,e),wi===null&&(n===null||Fo.current!==null||n.memoizedState!==null)&&(wi=e)}function Ud(e){ie(zn,zn.current),ie(ci,e),wi===null&&(wi=e)}function bm(e){e.tag===22?(ie(zn,zn.current),ie(ci,e),wi===null&&(wi=e)):Sr()}function Sr(){ie(zn,zn.current),ie(ci,ci.current)}function di(e){L(ci),wi===e&&(wi=null),L(zn)}var zn=C(0);function Zc(e){for(var n=e;n!==null;){if(n.tag===13){var i=n.memoizedState;if(i!==null&&(i=i.dehydrated,i===null||Yu(i)||Xu(i)))return n}else if(n.tag===19&&(n.memoizedProps.revealOrder==="forwards"||n.memoizedProps.revealOrder==="backwards"||n.memoizedProps.revealOrder==="unstable_legacy-backwards"||n.memoizedProps.revealOrder==="together")){if((n.flags&128)!==0)return n}else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return null;n=n.return}n.sibling.return=n.return,n=n.sibling}return null}var nr=0,aa=null,Za=null,Kn=null,Qc=!1,Yo=!1,fo=!1,Jc=0,Vl=0,Xo=null,D2=0;function Cn(){throw Error(o(321))}function Id(e,n){if(n===null)return!1;for(var i=0;i<n.length&&i<e.length;i++)if(!Wa(e[i],n[i]))return!1;return!0}function Hd(e,n,i,l,d,f){return nr=f,aa=n,n.memoizedState=null,n.updateQueue=null,n.lanes=0,P.H=e===null||e.memoizedState===null?ah:iu,fo=!1,f=i(l,d),fo=!1,Yo&&(f=jm(n,i,l,d)),vm(e),f}function vm(e){P.H=Il;var n=Za!==null&&Za.next!==null;if(nr=0,Kn=Za=aa=null,Qc=!1,Vl=0,Xo=null,n)throw Error(o(300));e===null||es||(e=e.dependencies,e!==null&&Uc(e)&&(es=!0))}function jm(e,n,i,l){aa=e;var d=0;do{if(Yo&&(Xo=null),Vl=0,Yo=!1,25<=d)throw Error(o(301));if(d+=1,Kn=Za=null,e.updateQueue!=null){var f=e.updateQueue;f.lastEffect=null,f.events=null,f.stores=null,f.memoCache!=null&&(f.memoCache.index=0)}P.H=nh,f=n(i,l)}while(Yo);return f}function R2(){var e=P.H,n=e.useState()[0];return n=typeof n.then=="function"?Wl(n):n,e=e.useState()[0],(Za!==null?Za.memoizedState:null)!==e&&(aa.flags|=1024),n}function qd(){var e=Jc!==0;return Jc=0,e}function Gd(e,n,i){n.updateQueue=e.updateQueue,n.flags&=-2053,e.lanes&=~i}function Fd(e){if(Qc){for(e=e.memoizedState;e!==null;){var n=e.queue;n!==null&&(n.pending=null),e=e.next}Qc=!1}nr=0,Kn=Za=aa=null,Yo=!1,Vl=Jc=0,Xo=null}function Us(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Kn===null?aa.memoizedState=Kn=e:Kn=Kn.next=e,Kn}function Bn(){if(Za===null){var e=aa.alternate;e=e!==null?e.memoizedState:null}else e=Za.next;var n=Kn===null?aa.memoizedState:Kn.next;if(n!==null)Kn=n,Za=e;else{if(e===null)throw aa.alternate===null?Error(o(467)):Error(o(310));Za=e,e={memoizedState:Za.memoizedState,baseState:Za.baseState,baseQueue:Za.baseQueue,queue:Za.queue,next:null},Kn===null?aa.memoizedState=Kn=e:Kn=Kn.next=e}return Kn}function Kc(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Wl(e){var n=Vl;return Vl+=1,Xo===null&&(Xo=[]),e=um(Xo,e,n),n=aa,(Kn===null?n.memoizedState:Kn.next)===null&&(n=n.alternate,P.H=n===null||n.memoizedState===null?ah:iu),e}function e0(e){if(e!==null&&typeof e=="object"){if(typeof e.then=="function")return Wl(e);if(e.$$typeof===D)return ks(e)}throw Error(o(438,String(e)))}function Yd(e){var n=null,i=aa.updateQueue;if(i!==null&&(n=i.memoCache),n==null){var l=aa.alternate;l!==null&&(l=l.updateQueue,l!==null&&(l=l.memoCache,l!=null&&(n={data:l.data.map(function(d){return d.slice()}),index:0})))}if(n==null&&(n={data:[],index:0}),i===null&&(i=Kc(),aa.updateQueue=i),i.memoCache=n,i=n.data[n.index],i===void 0)for(i=n.data[n.index]=Array(e),l=0;l<e;l++)i[l]=S;return n.index++,i}function sr(e,n){return typeof n=="function"?n(e):n}function t0(e){var n=Bn();return Xd(n,Za,e)}function Xd(e,n,i){var l=e.queue;if(l===null)throw Error(o(311));l.lastRenderedReducer=i;var d=e.baseQueue,f=l.pending;if(f!==null){if(d!==null){var w=d.next;d.next=f.next,f.next=w}n.baseQueue=d=f,l.pending=null}if(f=e.baseState,d===null)e.memoizedState=f;else{n=d.next;var A=w=null,G=null,ye=n,De=!1;do{var Fe=ye.lane&-536870913;if(Fe!==ye.lane?(ya&Fe)===Fe:(nr&Fe)===Fe){var we=ye.revertLane;if(we===0)G!==null&&(G=G.next={lane:0,revertLane:0,gesture:null,action:ye.action,hasEagerState:ye.hasEagerState,eagerState:ye.eagerState,next:null}),Fe===Io&&(De=!0);else if((nr&we)===we){ye=ye.next,we===Io&&(De=!0);continue}else Fe={lane:0,revertLane:ye.revertLane,gesture:null,action:ye.action,hasEagerState:ye.hasEagerState,eagerState:ye.eagerState,next:null},G===null?(A=G=Fe,w=f):G=G.next=Fe,aa.lanes|=we,Dr|=we;Fe=ye.action,fo&&i(f,Fe),f=ye.hasEagerState?ye.eagerState:i(f,Fe)}else we={lane:Fe,revertLane:ye.revertLane,gesture:ye.gesture,action:ye.action,hasEagerState:ye.hasEagerState,eagerState:ye.eagerState,next:null},G===null?(A=G=we,w=f):G=G.next=we,aa.lanes|=Fe,Dr|=Fe;ye=ye.next}while(ye!==null&&ye!==n);if(G===null?w=f:G.next=A,!Wa(f,e.memoizedState)&&(es=!0,De&&(i=Ho,i!==null)))throw i;e.memoizedState=f,e.baseState=w,e.baseQueue=G,l.lastRenderedState=f}return d===null&&(l.lanes=0),[e.memoizedState,l.dispatch]}function Zd(e){var n=Bn(),i=n.queue;if(i===null)throw Error(o(311));i.lastRenderedReducer=e;var l=i.dispatch,d=i.pending,f=n.memoizedState;if(d!==null){i.pending=null;var w=d=d.next;do f=e(f,w.action),w=w.next;while(w!==d);Wa(f,n.memoizedState)||(es=!0),n.memoizedState=f,n.baseQueue===null&&(n.baseState=f),i.lastRenderedState=f}return[f,l]}function wm(e,n,i){var l=aa,d=Bn(),f=va;if(f){if(i===void 0)throw Error(o(407));i=i()}else i=n();var w=!Wa((Za||d).memoizedState,i);if(w&&(d.memoizedState=i,es=!0),d=d.queue,Kd(_m.bind(null,l,d,e),[e]),d.getSnapshot!==n||w||Kn!==null&&Kn.memoizedState.tag&1){if(l.flags|=2048,Zo(9,{destroy:void 0},Mm.bind(null,l,d,i,n),null),rn===null)throw Error(o(349));f||(nr&127)!==0||Nm(l,n,i)}return i}function Nm(e,n,i){e.flags|=16384,e={getSnapshot:n,value:i},n=aa.updateQueue,n===null?(n=Kc(),aa.updateQueue=n,n.stores=[e]):(i=n.stores,i===null?n.stores=[e]:i.push(e))}function Mm(e,n,i,l){n.value=i,n.getSnapshot=l,Em(n)&&km(e)}function _m(e,n,i){return i(function(){Em(n)&&km(e)})}function Em(e){var n=e.getSnapshot;e=e.value;try{var i=n();return!Wa(e,i)}catch{return!0}}function km(e){var n=Zs(e,2);n!==null&&ai(n,e,2)}function Qd(e){var n=Us();if(typeof e=="function"){var i=e;if(e=i(),fo){ta(!0);try{i()}finally{ta(!1)}}}return n.memoizedState=n.baseState=e,n.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:sr,lastRenderedState:e},n}function Cm(e,n,i,l){return e.baseState=i,Xd(e,Za,typeof l=="function"?l:sr)}function $2(e,n,i,l,d){if(s0(e))throw Error(o(485));if(e=n.action,e!==null){var f={payload:d,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(w){f.listeners.push(w)}};P.T!==null?i(!0):f.isTransition=!1,l(f),i=n.pending,i===null?(f.next=n.pending=f,Tm(n,f)):(f.next=i.next,n.pending=i.next=f)}}function Tm(e,n){var i=n.action,l=n.payload,d=e.state;if(n.isTransition){var f=P.T,w={};P.T=w;try{var A=i(d,l),G=P.S;G!==null&&G(w,A),Sm(e,n,A)}catch(ye){Jd(e,n,ye)}finally{f!==null&&w.types!==null&&(f.types=w.types),P.T=f}}else try{f=i(d,l),Sm(e,n,f)}catch(ye){Jd(e,n,ye)}}function Sm(e,n,i){i!==null&&typeof i=="object"&&typeof i.then=="function"?i.then(function(l){Am(e,n,l)},function(l){return Jd(e,n,l)}):Am(e,n,i)}function Am(e,n,i){n.status="fulfilled",n.value=i,Pm(n),e.state=i,n=e.pending,n!==null&&(i=n.next,i===n?e.pending=null:(i=i.next,n.next=i,Tm(e,i)))}function Jd(e,n,i){var l=e.pending;if(e.pending=null,l!==null){l=l.next;do n.status="rejected",n.reason=i,Pm(n),n=n.next;while(n!==l)}e.action=null}function Pm(e){e=e.listeners;for(var n=0;n<e.length;n++)(0,e[n])()}function Dm(e,n){return n}function Rm(e,n){if(va){var i=rn.formState;if(i!==null){e:{var l=aa;if(va){if(hn){t:{for(var d=hn,f=ji;d.nodeType!==8;){if(!f){d=null;break t}if(d=Ni(d.nextSibling),d===null){d=null;break t}}f=d.data,d=f==="F!"||f==="F"?d:null}if(d){hn=Ni(d.nextSibling),l=d.data==="F!";break e}}Mr(l)}l=!1}l&&(n=i[0])}}return i=Us(),i.memoizedState=i.baseState=n,l={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Dm,lastRenderedState:n},i.queue=l,i=Km.bind(null,aa,l),l.dispatch=i,l=Qd(!1),f=su.bind(null,aa,!1,l.queue),l=Us(),d={state:n,dispatch:null,action:e,pending:null},l.queue=d,i=$2.bind(null,aa,d,f,i),d.dispatch=i,l.memoizedState=e,[n,i,!1]}function $m(e){var n=Bn();return Om(n,Za,e)}function Om(e,n,i){if(n=Xd(e,n,Dm)[0],e=t0(sr)[0],typeof n=="object"&&n!==null&&typeof n.then=="function")try{var l=Wl(n)}catch(w){throw w===qo?qc:w}else l=n;n=Bn();var d=n.queue,f=d.dispatch;return i!==n.memoizedState&&(aa.flags|=2048,Zo(9,{destroy:void 0},O2.bind(null,d,i),null)),[l,f,e]}function O2(e,n){e.action=n}function zm(e){var n=Bn(),i=Za;if(i!==null)return Om(n,i,e);Bn(),n=n.memoizedState,i=Bn();var l=i.queue.dispatch;return i.memoizedState=e,[n,l,!1]}function Zo(e,n,i,l){return e={tag:e,create:i,deps:l,inst:n,next:null},n=aa.updateQueue,n===null&&(n=Kc(),aa.updateQueue=n),i=n.lastEffect,i===null?n.lastEffect=e.next=e:(l=i.next,i.next=e,e.next=l,n.lastEffect=e),e}function Bm(){return Bn().memoizedState}function a0(e,n,i,l){var d=Us();aa.flags|=e,d.memoizedState=Zo(1|n,{destroy:void 0},i,l===void 0?null:l)}function n0(e,n,i,l){var d=Bn();l=l===void 0?null:l;var f=d.memoizedState.inst;Za!==null&&l!==null&&Id(l,Za.memoizedState.deps)?d.memoizedState=Zo(n,f,i,l):(aa.flags|=e,d.memoizedState=Zo(1|n,f,i,l))}function Lm(e,n){a0(8390656,8,e,n)}function Kd(e,n){n0(2048,8,e,n)}function z2(e){aa.flags|=4;var n=aa.updateQueue;if(n===null)n=Kc(),aa.updateQueue=n,n.events=[e];else{var i=n.events;i===null?n.events=[e]:i.push(e)}}function Vm(e){var n=Bn().memoizedState;return z2({ref:n,nextImpl:e}),function(){if((Ba&2)!==0)throw Error(o(440));return n.impl.apply(void 0,arguments)}}function Wm(e,n){return n0(4,2,e,n)}function Um(e,n){return n0(4,4,e,n)}function Im(e,n){if(typeof n=="function"){e=e();var i=n(e);return function(){typeof i=="function"?i():n(null)}}if(n!=null)return e=e(),n.current=e,function(){n.current=null}}function Hm(e,n,i){i=i!=null?i.concat([e]):null,n0(4,4,Im.bind(null,n,e),i)}function eu(){}function qm(e,n){var i=Bn();n=n===void 0?null:n;var l=i.memoizedState;return n!==null&&Id(n,l[1])?l[0]:(i.memoizedState=[e,n],e)}function Gm(e,n){var i=Bn();n=n===void 0?null:n;var l=i.memoizedState;if(n!==null&&Id(n,l[1]))return l[0];if(l=e(),fo){ta(!0);try{e()}finally{ta(!1)}}return i.memoizedState=[l,n],l}function tu(e,n,i){return i===void 0||(nr&1073741824)!==0&&(ya&261930)===0?e.memoizedState=n:(e.memoizedState=i,e=Fh(),aa.lanes|=e,Dr|=e,i)}function Fm(e,n,i,l){return Wa(i,n)?i:Fo.current!==null?(e=tu(e,i,l),Wa(e,n)||(es=!0),e):(nr&42)===0||(nr&1073741824)!==0&&(ya&261930)===0?(es=!0,e.memoizedState=i):(e=Fh(),aa.lanes|=e,Dr|=e,n)}function Ym(e,n,i,l,d){var f=z.p;z.p=f!==0&&8>f?f:8;var w=P.T,A={};P.T=A,su(e,!1,n,i);try{var G=d(),ye=P.S;if(ye!==null&&ye(A,G),G!==null&&typeof G=="object"&&typeof G.then=="function"){var De=P2(G,l);Ul(e,n,De,fi(e))}else Ul(e,n,l,fi(e))}catch(Fe){Ul(e,n,{then:function(){},status:"rejected",reason:Fe},fi())}finally{z.p=f,w!==null&&A.types!==null&&(w.types=A.types),P.T=w}}function B2(){}function au(e,n,i,l){if(e.tag!==5)throw Error(o(476));var d=Xm(e).queue;Ym(e,d,n,V,i===null?B2:function(){return Zm(e),i(l)})}function Xm(e){var n=e.memoizedState;if(n!==null)return n;n={memoizedState:V,baseState:V,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:sr,lastRenderedState:V},next:null};var i={};return n.next={memoizedState:i,baseState:i,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:sr,lastRenderedState:i},next:null},e.memoizedState=n,e=e.alternate,e!==null&&(e.memoizedState=n),n}function Zm(e){var n=Xm(e);n.next===null&&(n=e.alternate.memoizedState),Ul(e,n.next.queue,{},fi())}function nu(){return ks(ic)}function Qm(){return Bn().memoizedState}function Jm(){return Bn().memoizedState}function L2(e){for(var n=e.return;n!==null;){switch(n.tag){case 24:case 3:var i=fi();e=kr(i);var l=Cr(n,e,i);l!==null&&(ai(l,n,i),zl(l,n,i)),n={cache:Pd()},e.payload=n;return}n=n.return}}function V2(e,n,i){var l=fi();i={lane:l,revertLane:0,gesture:null,action:i,hasEagerState:!1,eagerState:null,next:null},s0(e)?eh(n,i):(i=Ms(e,n,i,l),i!==null&&(ai(i,e,l),th(i,n,l)))}function Km(e,n,i){var l=fi();Ul(e,n,i,l)}function Ul(e,n,i,l){var d={lane:l,revertLane:0,gesture:null,action:i,hasEagerState:!1,eagerState:null,next:null};if(s0(e))eh(n,d);else{var f=e.alternate;if(e.lanes===0&&(f===null||f.lanes===0)&&(f=n.lastRenderedReducer,f!==null))try{var w=n.lastRenderedState,A=f(w,i);if(d.hasEagerState=!0,d.eagerState=A,Wa(A,w))return cn(e,n,d,0),rn===null&&os(),!1}catch{}finally{}if(i=Ms(e,n,d,l),i!==null)return ai(i,e,l),th(i,n,l),!0}return!1}function su(e,n,i,l){if(l={lane:2,revertLane:Ou(),gesture:null,action:l,hasEagerState:!1,eagerState:null,next:null},s0(e)){if(n)throw Error(o(479))}else n=Ms(e,i,l,2),n!==null&&ai(n,e,2)}function s0(e){var n=e.alternate;return e===aa||n!==null&&n===aa}function eh(e,n){Yo=Qc=!0;var i=e.pending;i===null?n.next=n:(n.next=i.next,i.next=n),e.pending=n}function th(e,n,i){if((i&4194048)!==0){var l=n.lanes;l&=e.pendingLanes,i|=l,n.lanes=i,Ve(e,i)}}var Il={readContext:ks,use:e0,useCallback:Cn,useContext:Cn,useEffect:Cn,useImperativeHandle:Cn,useLayoutEffect:Cn,useInsertionEffect:Cn,useMemo:Cn,useReducer:Cn,useRef:Cn,useState:Cn,useDebugValue:Cn,useDeferredValue:Cn,useTransition:Cn,useSyncExternalStore:Cn,useId:Cn,useHostTransitionStatus:Cn,useFormState:Cn,useActionState:Cn,useOptimistic:Cn,useMemoCache:Cn,useCacheRefresh:Cn};Il.useEffectEvent=Cn;var ah={readContext:ks,use:e0,useCallback:function(e,n){return Us().memoizedState=[e,n===void 0?null:n],e},useContext:ks,useEffect:Lm,useImperativeHandle:function(e,n,i){i=i!=null?i.concat([e]):null,a0(4194308,4,Im.bind(null,n,e),i)},useLayoutEffect:function(e,n){return a0(4194308,4,e,n)},useInsertionEffect:function(e,n){a0(4,2,e,n)},useMemo:function(e,n){var i=Us();n=n===void 0?null:n;var l=e();if(fo){ta(!0);try{e()}finally{ta(!1)}}return i.memoizedState=[l,n],l},useReducer:function(e,n,i){var l=Us();if(i!==void 0){var d=i(n);if(fo){ta(!0);try{i(n)}finally{ta(!1)}}}else d=n;return l.memoizedState=l.baseState=d,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:d},l.queue=e,e=e.dispatch=V2.bind(null,aa,e),[l.memoizedState,e]},useRef:function(e){var n=Us();return e={current:e},n.memoizedState=e},useState:function(e){e=Qd(e);var n=e.queue,i=Km.bind(null,aa,n);return n.dispatch=i,[e.memoizedState,i]},useDebugValue:eu,useDeferredValue:function(e,n){var i=Us();return tu(i,e,n)},useTransition:function(){var e=Qd(!1);return e=Ym.bind(null,aa,e.queue,!0,!1),Us().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,n,i){var l=aa,d=Us();if(va){if(i===void 0)throw Error(o(407));i=i()}else{if(i=n(),rn===null)throw Error(o(349));(ya&127)!==0||Nm(l,n,i)}d.memoizedState=i;var f={value:i,getSnapshot:n};return d.queue=f,Lm(_m.bind(null,l,f,e),[e]),l.flags|=2048,Zo(9,{destroy:void 0},Mm.bind(null,l,f,i,n),null),i},useId:function(){var e=Us(),n=rn.identifierPrefix;if(va){var i=Qs,l=gs;i=(l&~(1<<32-Ht(l)-1)).toString(32)+i,n="_"+n+"R_"+i,i=Jc++,0<i&&(n+="H"+i.toString(32)),n+="_"}else i=D2++,n="_"+n+"r_"+i.toString(32)+"_";return e.memoizedState=n},useHostTransitionStatus:nu,useFormState:Rm,useActionState:Rm,useOptimistic:function(e){var n=Us();n.memoizedState=n.baseState=e;var i={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return n.queue=i,n=su.bind(null,aa,!0,i),i.dispatch=n,[e,n]},useMemoCache:Yd,useCacheRefresh:function(){return Us().memoizedState=L2.bind(null,aa)},useEffectEvent:function(e){var n=Us(),i={impl:e};return n.memoizedState=i,function(){if((Ba&2)!==0)throw Error(o(440));return i.impl.apply(void 0,arguments)}}},iu={readContext:ks,use:e0,useCallback:qm,useContext:ks,useEffect:Kd,useImperativeHandle:Hm,useInsertionEffect:Wm,useLayoutEffect:Um,useMemo:Gm,useReducer:t0,useRef:Bm,useState:function(){return t0(sr)},useDebugValue:eu,useDeferredValue:function(e,n){var i=Bn();return Fm(i,Za.memoizedState,e,n)},useTransition:function(){var e=t0(sr)[0],n=Bn().memoizedState;return[typeof e=="boolean"?e:Wl(e),n]},useSyncExternalStore:wm,useId:Qm,useHostTransitionStatus:nu,useFormState:$m,useActionState:$m,useOptimistic:function(e,n){var i=Bn();return Cm(i,Za,e,n)},useMemoCache:Yd,useCacheRefresh:Jm};iu.useEffectEvent=Vm;var nh={readContext:ks,use:e0,useCallback:qm,useContext:ks,useEffect:Kd,useImperativeHandle:Hm,useInsertionEffect:Wm,useLayoutEffect:Um,useMemo:Gm,useReducer:Zd,useRef:Bm,useState:function(){return Zd(sr)},useDebugValue:eu,useDeferredValue:function(e,n){var i=Bn();return Za===null?tu(i,e,n):Fm(i,Za.memoizedState,e,n)},useTransition:function(){var e=Zd(sr)[0],n=Bn().memoizedState;return[typeof e=="boolean"?e:Wl(e),n]},useSyncExternalStore:wm,useId:Qm,useHostTransitionStatus:nu,useFormState:zm,useActionState:zm,useOptimistic:function(e,n){var i=Bn();return Za!==null?Cm(i,Za,e,n):(i.baseState=e,[e,i.queue.dispatch])},useMemoCache:Yd,useCacheRefresh:Jm};nh.useEffectEvent=Vm;function ru(e,n,i,l){n=e.memoizedState,i=i(l,n),i=i==null?n:b({},n,i),e.memoizedState=i,e.lanes===0&&(e.updateQueue.baseState=i)}var ou={enqueueSetState:function(e,n,i){e=e._reactInternals;var l=fi(),d=kr(l);d.payload=n,i!=null&&(d.callback=i),n=Cr(e,d,l),n!==null&&(ai(n,e,l),zl(n,e,l))},enqueueReplaceState:function(e,n,i){e=e._reactInternals;var l=fi(),d=kr(l);d.tag=1,d.payload=n,i!=null&&(d.callback=i),n=Cr(e,d,l),n!==null&&(ai(n,e,l),zl(n,e,l))},enqueueForceUpdate:function(e,n){e=e._reactInternals;var i=fi(),l=kr(i);l.tag=2,n!=null&&(l.callback=n),n=Cr(e,l,i),n!==null&&(ai(n,e,i),zl(n,e,i))}};function sh(e,n,i,l,d,f,w){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(l,f,w):n.prototype&&n.prototype.isPureReactComponent?!hs(i,l)||!hs(d,f):!0}function ih(e,n,i,l){e=n.state,typeof n.componentWillReceiveProps=="function"&&n.componentWillReceiveProps(i,l),typeof n.UNSAFE_componentWillReceiveProps=="function"&&n.UNSAFE_componentWillReceiveProps(i,l),n.state!==e&&ou.enqueueReplaceState(n,n.state,null)}function mo(e,n){var i=n;if("ref"in n){i={};for(var l in n)l!=="ref"&&(i[l]=n[l])}if(e=e.defaultProps){i===n&&(i=b({},i));for(var d in e)i[d]===void 0&&(i[d]=e[d])}return i}function rh(e){is(e)}function oh(e){console.error(e)}function lh(e){is(e)}function i0(e,n){try{var i=e.onUncaughtError;i(n.value,{componentStack:n.stack})}catch(l){setTimeout(function(){throw l})}}function ch(e,n,i){try{var l=e.onCaughtError;l(i.value,{componentStack:i.stack,errorBoundary:n.tag===1?n.stateNode:null})}catch(d){setTimeout(function(){throw d})}}function lu(e,n,i){return i=kr(i),i.tag=3,i.payload={element:null},i.callback=function(){i0(e,n)},i}function dh(e){return e=kr(e),e.tag=3,e}function uh(e,n,i,l){var d=i.type.getDerivedStateFromError;if(typeof d=="function"){var f=l.value;e.payload=function(){return d(f)},e.callback=function(){ch(n,i,l)}}var w=i.stateNode;w!==null&&typeof w.componentDidCatch=="function"&&(e.callback=function(){ch(n,i,l),typeof d!="function"&&(Rr===null?Rr=new Set([this]):Rr.add(this));var A=l.stack;this.componentDidCatch(l.value,{componentStack:A!==null?A:""})})}function W2(e,n,i,l,d){if(i.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){if(n=i.alternate,n!==null&&Uo(n,i,d,!0),i=ci.current,i!==null){switch(i.tag){case 31:case 13:return wi===null?g0():i.alternate===null&&Tn===0&&(Tn=3),i.flags&=-257,i.flags|=65536,i.lanes=d,l===Gc?i.flags|=16384:(n=i.updateQueue,n===null?i.updateQueue=new Set([l]):n.add(l),Du(e,l,d)),!1;case 22:return i.flags|=65536,l===Gc?i.flags|=16384:(n=i.updateQueue,n===null?(n={transitions:null,markerInstances:null,retryQueue:new Set([l])},i.updateQueue=n):(i=n.retryQueue,i===null?n.retryQueue=new Set([l]):i.add(l)),Du(e,l,d)),!1}throw Error(o(435,i.tag))}return Du(e,l,d),g0(),!1}if(va)return n=ci.current,n!==null?((n.flags&65536)===0&&(n.flags|=256),n.flags|=65536,n.lanes=d,l!==kd&&(e=Error(o(422),{cause:l}),Pl($n(e,i)))):(l!==kd&&(n=Error(o(423),{cause:l}),Pl($n(n,i))),e=e.current.alternate,e.flags|=65536,d&=-d,e.lanes|=d,l=$n(l,i),d=lu(e.stateNode,l,d),Bd(e,d),Tn!==4&&(Tn=2)),!1;var f=Error(o(520),{cause:l});if(f=$n(f,i),Ql===null?Ql=[f]:Ql.push(f),Tn!==4&&(Tn=2),n===null)return!0;l=$n(l,i),i=n;do{switch(i.tag){case 3:return i.flags|=65536,e=d&-d,i.lanes|=e,e=lu(i.stateNode,l,e),Bd(i,e),!1;case 1:if(n=i.type,f=i.stateNode,(i.flags&128)===0&&(typeof n.getDerivedStateFromError=="function"||f!==null&&typeof f.componentDidCatch=="function"&&(Rr===null||!Rr.has(f))))return i.flags|=65536,d&=-d,i.lanes|=d,d=dh(d),uh(d,e,i,l),Bd(i,d),!1}i=i.return}while(i!==null);return!1}var cu=Error(o(461)),es=!1;function Cs(e,n,i,l){n.child=e===null?hm(n,null,i,l):po(n,e.child,i,l)}function ph(e,n,i,l,d){i=i.render;var f=n.ref;if("ref"in l){var w={};for(var A in l)A!=="ref"&&(w[A]=l[A])}else w=l;return oo(n),l=Hd(e,n,i,w,f,d),A=qd(),e!==null&&!es?(Gd(e,n,d),ir(e,n,d)):(va&&A&&Al(n),n.flags|=1,Cs(e,n,l,d),n.child)}function fh(e,n,i,l,d){if(e===null){var f=i.type;return typeof f=="function"&&!xs(f)&&f.defaultProps===void 0&&i.compare===null?(n.tag=15,n.type=f,mh(e,n,f,l,d)):(e=$i(i.type,null,l,n,n.mode,d),e.ref=n.ref,e.return=n,n.child=e)}if(f=e.child,!gu(e,d)){var w=f.memoizedProps;if(i=i.compare,i=i!==null?i:hs,i(w,l)&&e.ref===n.ref)return ir(e,n,d)}return n.flags|=1,e=vn(f,l),e.ref=n.ref,e.return=n,n.child=e}function mh(e,n,i,l,d){if(e!==null){var f=e.memoizedProps;if(hs(f,l)&&e.ref===n.ref)if(es=!1,n.pendingProps=l=f,gu(e,d))(e.flags&131072)!==0&&(es=!0);else return n.lanes=e.lanes,ir(e,n,d)}return du(e,n,i,l,d)}function hh(e,n,i,l){var d=l.children,f=e!==null?e.memoizedState:null;if(e===null&&n.stateNode===null&&(n.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),l.mode==="hidden"){if((n.flags&128)!==0){if(f=f!==null?f.baseLanes|i:i,e!==null){for(l=n.child=e.child,d=0;l!==null;)d=d|l.lanes|l.childLanes,l=l.sibling;l=d&~f}else l=0,n.child=null;return xh(e,n,f,i,l)}if((i&536870912)!==0)n.memoizedState={baseLanes:0,cachePool:null},e!==null&&Hc(n,f!==null?f.cachePool:null),f!==null?ym(n,f):Vd(),bm(n);else return l=n.lanes=536870912,xh(e,n,f!==null?f.baseLanes|i:i,i,l)}else f!==null?(Hc(n,f.cachePool),ym(n,f),Sr(),n.memoizedState=null):(e!==null&&Hc(n,null),Vd(),Sr());return Cs(e,n,d,i),n.child}function Hl(e,n){return e!==null&&e.tag===22||n.stateNode!==null||(n.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),n.sibling}function xh(e,n,i,l,d){var f=Rd();return f=f===null?null:{parent:Jn._currentValue,pool:f},n.memoizedState={baseLanes:i,cachePool:f},e!==null&&Hc(n,null),Vd(),bm(n),e!==null&&Uo(e,n,l,!0),n.childLanes=d,null}function r0(e,n){return n=l0({mode:n.mode,children:n.children},e.mode),n.ref=e.ref,e.child=n,n.return=e,n}function gh(e,n,i){return po(n,e.child,null,i),e=r0(n,n.pendingProps),e.flags|=2,di(n),n.memoizedState=null,e}function U2(e,n,i){var l=n.pendingProps,d=(n.flags&128)!==0;if(n.flags&=-129,e===null){if(va){if(l.mode==="hidden")return e=r0(n,l),n.lanes=536870912,Hl(null,e);if(Ud(n),(e=hn)?(e=Tx(e,ji),e=e!==null&&e.data==="&"?e:null,e!==null&&(n.memoizedState={dehydrated:e,treeContext:Es!==null?{id:gs,overflow:Qs}:null,retryLane:536870912,hydrationErrors:null},i=Lc(e),i.return=n,n.child=i,On=n,hn=null)):e=null,e===null)throw Mr(n);return n.lanes=536870912,null}return r0(n,l)}var f=e.memoizedState;if(f!==null){var w=f.dehydrated;if(Ud(n),d)if(n.flags&256)n.flags&=-257,n=gh(e,n,i);else if(n.memoizedState!==null)n.child=e.child,n.flags|=128,n=null;else throw Error(o(558));else if(es||Uo(e,n,i,!1),d=(i&e.childLanes)!==0,es||d){if(l=rn,l!==null&&(w=ca(l,i),w!==0&&w!==f.retryLane))throw f.retryLane=w,Zs(e,w),ai(l,e,w),cu;g0(),n=gh(e,n,i)}else e=f.treeContext,hn=Ni(w.nextSibling),On=n,va=!0,Nr=null,ji=!1,e!==null&&qi(n,e),n=r0(n,l),n.flags|=4096;return n}return e=vn(e.child,{mode:l.mode,children:l.children}),e.ref=n.ref,n.child=e,e.return=n,e}function o0(e,n){var i=n.ref;if(i===null)e!==null&&e.ref!==null&&(n.flags|=4194816);else{if(typeof i!="function"&&typeof i!="object")throw Error(o(284));(e===null||e.ref!==i)&&(n.flags|=4194816)}}function du(e,n,i,l,d){return oo(n),i=Hd(e,n,i,l,void 0,d),l=qd(),e!==null&&!es?(Gd(e,n,d),ir(e,n,d)):(va&&l&&Al(n),n.flags|=1,Cs(e,n,i,d),n.child)}function yh(e,n,i,l,d,f){return oo(n),n.updateQueue=null,i=jm(n,l,i,d),vm(e),l=qd(),e!==null&&!es?(Gd(e,n,f),ir(e,n,f)):(va&&l&&Al(n),n.flags|=1,Cs(e,n,i,f),n.child)}function bh(e,n,i,l,d){if(oo(n),n.stateNode===null){var f=kn,w=i.contextType;typeof w=="object"&&w!==null&&(f=ks(w)),f=new i(l,f),n.memoizedState=f.state!==null&&f.state!==void 0?f.state:null,f.updater=ou,n.stateNode=f,f._reactInternals=n,f=n.stateNode,f.props=l,f.state=n.memoizedState,f.refs={},Od(n),w=i.contextType,f.context=typeof w=="object"&&w!==null?ks(w):kn,f.state=n.memoizedState,w=i.getDerivedStateFromProps,typeof w=="function"&&(ru(n,i,w,l),f.state=n.memoizedState),typeof i.getDerivedStateFromProps=="function"||typeof f.getSnapshotBeforeUpdate=="function"||typeof f.UNSAFE_componentWillMount!="function"&&typeof f.componentWillMount!="function"||(w=f.state,typeof f.componentWillMount=="function"&&f.componentWillMount(),typeof f.UNSAFE_componentWillMount=="function"&&f.UNSAFE_componentWillMount(),w!==f.state&&ou.enqueueReplaceState(f,f.state,null),Ll(n,l,f,d),Bl(),f.state=n.memoizedState),typeof f.componentDidMount=="function"&&(n.flags|=4194308),l=!0}else if(e===null){f=n.stateNode;var A=n.memoizedProps,G=mo(i,A);f.props=G;var ye=f.context,De=i.contextType;w=kn,typeof De=="object"&&De!==null&&(w=ks(De));var Fe=i.getDerivedStateFromProps;De=typeof Fe=="function"||typeof f.getSnapshotBeforeUpdate=="function",A=n.pendingProps!==A,De||typeof f.UNSAFE_componentWillReceiveProps!="function"&&typeof f.componentWillReceiveProps!="function"||(A||ye!==w)&&ih(n,f,l,w),Er=!1;var we=n.memoizedState;f.state=we,Ll(n,l,f,d),Bl(),ye=n.memoizedState,A||we!==ye||Er?(typeof Fe=="function"&&(ru(n,i,Fe,l),ye=n.memoizedState),(G=Er||sh(n,i,G,l,we,ye,w))?(De||typeof f.UNSAFE_componentWillMount!="function"&&typeof f.componentWillMount!="function"||(typeof f.componentWillMount=="function"&&f.componentWillMount(),typeof f.UNSAFE_componentWillMount=="function"&&f.UNSAFE_componentWillMount()),typeof f.componentDidMount=="function"&&(n.flags|=4194308)):(typeof f.componentDidMount=="function"&&(n.flags|=4194308),n.memoizedProps=l,n.memoizedState=ye),f.props=l,f.state=ye,f.context=w,l=G):(typeof f.componentDidMount=="function"&&(n.flags|=4194308),l=!1)}else{f=n.stateNode,zd(e,n),w=n.memoizedProps,De=mo(i,w),f.props=De,Fe=n.pendingProps,we=f.context,ye=i.contextType,G=kn,typeof ye=="object"&&ye!==null&&(G=ks(ye)),A=i.getDerivedStateFromProps,(ye=typeof A=="function"||typeof f.getSnapshotBeforeUpdate=="function")||typeof f.UNSAFE_componentWillReceiveProps!="function"&&typeof f.componentWillReceiveProps!="function"||(w!==Fe||we!==G)&&ih(n,f,l,G),Er=!1,we=n.memoizedState,f.state=we,Ll(n,l,f,d),Bl();var ke=n.memoizedState;w!==Fe||we!==ke||Er||e!==null&&e.dependencies!==null&&Uc(e.dependencies)?(typeof A=="function"&&(ru(n,i,A,l),ke=n.memoizedState),(De=Er||sh(n,i,De,l,we,ke,G)||e!==null&&e.dependencies!==null&&Uc(e.dependencies))?(ye||typeof f.UNSAFE_componentWillUpdate!="function"&&typeof f.componentWillUpdate!="function"||(typeof f.componentWillUpdate=="function"&&f.componentWillUpdate(l,ke,G),typeof f.UNSAFE_componentWillUpdate=="function"&&f.UNSAFE_componentWillUpdate(l,ke,G)),typeof f.componentDidUpdate=="function"&&(n.flags|=4),typeof f.getSnapshotBeforeUpdate=="function"&&(n.flags|=1024)):(typeof f.componentDidUpdate!="function"||w===e.memoizedProps&&we===e.memoizedState||(n.flags|=4),typeof f.getSnapshotBeforeUpdate!="function"||w===e.memoizedProps&&we===e.memoizedState||(n.flags|=1024),n.memoizedProps=l,n.memoizedState=ke),f.props=l,f.state=ke,f.context=G,l=De):(typeof f.componentDidUpdate!="function"||w===e.memoizedProps&&we===e.memoizedState||(n.flags|=4),typeof f.getSnapshotBeforeUpdate!="function"||w===e.memoizedProps&&we===e.memoizedState||(n.flags|=1024),l=!1)}return f=l,o0(e,n),l=(n.flags&128)!==0,f||l?(f=n.stateNode,i=l&&typeof i.getDerivedStateFromError!="function"?null:f.render(),n.flags|=1,e!==null&&l?(n.child=po(n,e.child,null,d),n.child=po(n,null,i,d)):Cs(e,n,i,d),n.memoizedState=f.state,e=n.child):e=ir(e,n,d),e}function vh(e,n,i,l){return io(),n.flags|=256,Cs(e,n,i,l),n.child}var uu={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function pu(e){return{baseLanes:e,cachePool:cm()}}function fu(e,n,i){return e=e!==null?e.childLanes&~i:0,n&&(e|=pi),e}function jh(e,n,i){var l=n.pendingProps,d=!1,f=(n.flags&128)!==0,w;if((w=f)||(w=e!==null&&e.memoizedState===null?!1:(zn.current&2)!==0),w&&(d=!0,n.flags&=-129),w=(n.flags&32)!==0,n.flags&=-33,e===null){if(va){if(d?Tr(n):Sr(),(e=hn)?(e=Tx(e,ji),e=e!==null&&e.data!=="&"?e:null,e!==null&&(n.memoizedState={dehydrated:e,treeContext:Es!==null?{id:gs,overflow:Qs}:null,retryLane:536870912,hydrationErrors:null},i=Lc(e),i.return=n,n.child=i,On=n,hn=null)):e=null,e===null)throw Mr(n);return Xu(e)?n.lanes=32:n.lanes=536870912,null}var A=l.children;return l=l.fallback,d?(Sr(),d=n.mode,A=l0({mode:"hidden",children:A},d),l=ls(l,d,i,null),A.return=n,l.return=n,A.sibling=l,n.child=A,l=n.child,l.memoizedState=pu(i),l.childLanes=fu(e,w,i),n.memoizedState=uu,Hl(null,l)):(Tr(n),mu(n,A))}var G=e.memoizedState;if(G!==null&&(A=G.dehydrated,A!==null)){if(f)n.flags&256?(Tr(n),n.flags&=-257,n=hu(e,n,i)):n.memoizedState!==null?(Sr(),n.child=e.child,n.flags|=128,n=null):(Sr(),A=l.fallback,d=n.mode,l=l0({mode:"visible",children:l.children},d),A=ls(A,d,i,null),A.flags|=2,l.return=n,A.return=n,l.sibling=A,n.child=l,po(n,e.child,null,i),l=n.child,l.memoizedState=pu(i),l.childLanes=fu(e,w,i),n.memoizedState=uu,n=Hl(null,l));else if(Tr(n),Xu(A)){if(w=A.nextSibling&&A.nextSibling.dataset,w)var ye=w.dgst;w=ye,l=Error(o(419)),l.stack="",l.digest=w,Pl({value:l,source:null,stack:null}),n=hu(e,n,i)}else if(es||Uo(e,n,i,!1),w=(i&e.childLanes)!==0,es||w){if(w=rn,w!==null&&(l=ca(w,i),l!==0&&l!==G.retryLane))throw G.retryLane=l,Zs(e,l),ai(w,e,l),cu;Yu(A)||g0(),n=hu(e,n,i)}else Yu(A)?(n.flags|=192,n.child=e.child,n=null):(e=G.treeContext,hn=Ni(A.nextSibling),On=n,va=!0,Nr=null,ji=!1,e!==null&&qi(n,e),n=mu(n,l.children),n.flags|=4096);return n}return d?(Sr(),A=l.fallback,d=n.mode,G=e.child,ye=G.sibling,l=vn(G,{mode:"hidden",children:l.children}),l.subtreeFlags=G.subtreeFlags&65011712,ye!==null?A=vn(ye,A):(A=ls(A,d,i,null),A.flags|=2),A.return=n,l.return=n,l.sibling=A,n.child=l,Hl(null,l),l=n.child,A=e.child.memoizedState,A===null?A=pu(i):(d=A.cachePool,d!==null?(G=Jn._currentValue,d=d.parent!==G?{parent:G,pool:G}:d):d=cm(),A={baseLanes:A.baseLanes|i,cachePool:d}),l.memoizedState=A,l.childLanes=fu(e,w,i),n.memoizedState=uu,Hl(e.child,l)):(Tr(n),i=e.child,e=i.sibling,i=vn(i,{mode:"visible",children:l.children}),i.return=n,i.sibling=null,e!==null&&(w=n.deletions,w===null?(n.deletions=[e],n.flags|=16):w.push(e)),n.child=i,n.memoizedState=null,i)}function mu(e,n){return n=l0({mode:"visible",children:n},e.mode),n.return=e,e.child=n}function l0(e,n){return e=Ua(22,e,null,n),e.lanes=0,e}function hu(e,n,i){return po(n,e.child,null,i),e=mu(n,n.pendingProps.children),e.flags|=2,n.memoizedState=null,e}function wh(e,n,i){e.lanes|=n;var l=e.alternate;l!==null&&(l.lanes|=n),Sd(e.return,n,i)}function xu(e,n,i,l,d,f){var w=e.memoizedState;w===null?e.memoizedState={isBackwards:n,rendering:null,renderingStartTime:0,last:l,tail:i,tailMode:d,treeForkCount:f}:(w.isBackwards=n,w.rendering=null,w.renderingStartTime=0,w.last=l,w.tail=i,w.tailMode=d,w.treeForkCount=f)}function Nh(e,n,i){var l=n.pendingProps,d=l.revealOrder,f=l.tail;l=l.children;var w=zn.current,A=(w&2)!==0;if(A?(w=w&1|2,n.flags|=128):w&=1,ie(zn,w),Cs(e,n,l,i),l=va?zs:0,!A&&e!==null&&(e.flags&128)!==0)e:for(e=n.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&wh(e,i,n);else if(e.tag===19)wh(e,i,n);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===n)break e;for(;e.sibling===null;){if(e.return===null||e.return===n)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}switch(d){case"forwards":for(i=n.child,d=null;i!==null;)e=i.alternate,e!==null&&Zc(e)===null&&(d=i),i=i.sibling;i=d,i===null?(d=n.child,n.child=null):(d=i.sibling,i.sibling=null),xu(n,!1,d,i,f,l);break;case"backwards":case"unstable_legacy-backwards":for(i=null,d=n.child,n.child=null;d!==null;){if(e=d.alternate,e!==null&&Zc(e)===null){n.child=d;break}e=d.sibling,d.sibling=i,i=d,d=e}xu(n,!0,i,null,f,l);break;case"together":xu(n,!1,null,null,void 0,l);break;default:n.memoizedState=null}return n.child}function ir(e,n,i){if(e!==null&&(n.dependencies=e.dependencies),Dr|=n.lanes,(i&n.childLanes)===0)if(e!==null){if(Uo(e,n,i,!1),(i&n.childLanes)===0)return null}else return null;if(e!==null&&n.child!==e.child)throw Error(o(153));if(n.child!==null){for(e=n.child,i=vn(e,e.pendingProps),n.child=i,i.return=n;e.sibling!==null;)e=e.sibling,i=i.sibling=vn(e,e.pendingProps),i.return=n;i.sibling=null}return n.child}function gu(e,n){return(e.lanes&n)!==0?!0:(e=e.dependencies,!!(e!==null&&Uc(e)))}function I2(e,n,i){switch(n.tag){case 3:qe(n,n.stateNode.containerInfo),_r(n,Jn,e.memoizedState.cache),io();break;case 27:case 5:Je(n);break;case 4:qe(n,n.stateNode.containerInfo);break;case 10:_r(n,n.type,n.memoizedProps.value);break;case 31:if(n.memoizedState!==null)return n.flags|=128,Ud(n),null;break;case 13:var l=n.memoizedState;if(l!==null)return l.dehydrated!==null?(Tr(n),n.flags|=128,null):(i&n.child.childLanes)!==0?jh(e,n,i):(Tr(n),e=ir(e,n,i),e!==null?e.sibling:null);Tr(n);break;case 19:var d=(e.flags&128)!==0;if(l=(i&n.childLanes)!==0,l||(Uo(e,n,i,!1),l=(i&n.childLanes)!==0),d){if(l)return Nh(e,n,i);n.flags|=128}if(d=n.memoizedState,d!==null&&(d.rendering=null,d.tail=null,d.lastEffect=null),ie(zn,zn.current),l)break;return null;case 22:return n.lanes=0,hh(e,n,i,n.pendingProps);case 24:_r(n,Jn,e.memoizedState.cache)}return ir(e,n,i)}function Mh(e,n,i){if(e!==null)if(e.memoizedProps!==n.pendingProps)es=!0;else{if(!gu(e,i)&&(n.flags&128)===0)return es=!1,I2(e,n,i);es=(e.flags&131072)!==0}else es=!1,va&&(n.flags&1048576)!==0&&Wc(n,zs,n.index);switch(n.lanes=0,n.tag){case 16:e:{var l=n.pendingProps;if(e=co(n.elementType),n.type=e,typeof e=="function")xs(e)?(l=mo(e,l),n.tag=1,n=bh(null,n,e,l,i)):(n.tag=0,n=du(null,n,e,l,i));else{if(e!=null){var d=e.$$typeof;if(d===O){n.tag=11,n=ph(null,n,e,l,i);break e}else if(d===Z){n.tag=14,n=fh(null,n,e,l,i);break e}}throw n=$e(e)||e,Error(o(306,n,""))}}return n;case 0:return du(e,n,n.type,n.pendingProps,i);case 1:return l=n.type,d=mo(l,n.pendingProps),bh(e,n,l,d,i);case 3:e:{if(qe(n,n.stateNode.containerInfo),e===null)throw Error(o(387));l=n.pendingProps;var f=n.memoizedState;d=f.element,zd(e,n),Ll(n,l,null,i);var w=n.memoizedState;if(l=w.cache,_r(n,Jn,l),l!==f.cache&&Ad(n,[Jn],i,!0),Bl(),l=w.element,f.isDehydrated)if(f={element:l,isDehydrated:!1,cache:w.cache},n.updateQueue.baseState=f,n.memoizedState=f,n.flags&256){n=vh(e,n,l,i);break e}else if(l!==d){d=$n(Error(o(424)),n),Pl(d),n=vh(e,n,l,i);break e}else{switch(e=n.stateNode.containerInfo,e.nodeType){case 9:e=e.body;break;default:e=e.nodeName==="HTML"?e.ownerDocument.body:e}for(hn=Ni(e.firstChild),On=n,va=!0,Nr=null,ji=!0,i=hm(n,null,l,i),n.child=i;i;)i.flags=i.flags&-3|4096,i=i.sibling}else{if(io(),l===d){n=ir(e,n,i);break e}Cs(e,n,l,i)}n=n.child}return n;case 26:return o0(e,n),e===null?(i=$x(n.type,null,n.pendingProps,null))?n.memoizedState=i:va||(i=n.type,e=n.pendingProps,l=M0(me.current).createElement(i),l[Ae]=n,l[it]=e,Ts(l,i,e),ja(l),n.stateNode=l):n.memoizedState=$x(n.type,e.memoizedProps,n.pendingProps,e.memoizedState),null;case 27:return Je(n),e===null&&va&&(l=n.stateNode=Px(n.type,n.pendingProps,me.current),On=n,ji=!0,d=hn,Br(n.type)?(Zu=d,hn=Ni(l.firstChild)):hn=d),Cs(e,n,n.pendingProps.children,i),o0(e,n),e===null&&(n.flags|=4194304),n.child;case 5:return e===null&&va&&((d=l=hn)&&(l=bv(l,n.type,n.pendingProps,ji),l!==null?(n.stateNode=l,On=n,hn=Ni(l.firstChild),ji=!1,d=!0):d=!1),d||Mr(n)),Je(n),d=n.type,f=n.pendingProps,w=e!==null?e.memoizedProps:null,l=f.children,qu(d,f)?l=null:w!==null&&qu(d,w)&&(n.flags|=32),n.memoizedState!==null&&(d=Hd(e,n,R2,null,null,i),ic._currentValue=d),o0(e,n),Cs(e,n,l,i),n.child;case 6:return e===null&&va&&((e=i=hn)&&(i=vv(i,n.pendingProps,ji),i!==null?(n.stateNode=i,On=n,hn=null,e=!0):e=!1),e||Mr(n)),null;case 13:return jh(e,n,i);case 4:return qe(n,n.stateNode.containerInfo),l=n.pendingProps,e===null?n.child=po(n,null,l,i):Cs(e,n,l,i),n.child;case 11:return ph(e,n,n.type,n.pendingProps,i);case 7:return Cs(e,n,n.pendingProps,i),n.child;case 8:return Cs(e,n,n.pendingProps.children,i),n.child;case 12:return Cs(e,n,n.pendingProps.children,i),n.child;case 10:return l=n.pendingProps,_r(n,n.type,l.value),Cs(e,n,l.children,i),n.child;case 9:return d=n.type._context,l=n.pendingProps.children,oo(n),d=ks(d),l=l(d),n.flags|=1,Cs(e,n,l,i),n.child;case 14:return fh(e,n,n.type,n.pendingProps,i);case 15:return mh(e,n,n.type,n.pendingProps,i);case 19:return Nh(e,n,i);case 31:return U2(e,n,i);case 22:return hh(e,n,i,n.pendingProps);case 24:return oo(n),l=ks(Jn),e===null?(d=Rd(),d===null&&(d=rn,f=Pd(),d.pooledCache=f,f.refCount++,f!==null&&(d.pooledCacheLanes|=i),d=f),n.memoizedState={parent:l,cache:d},Od(n),_r(n,Jn,d)):((e.lanes&i)!==0&&(zd(e,n),Ll(n,null,null,i),Bl()),d=e.memoizedState,f=n.memoizedState,d.parent!==l?(d={parent:l,cache:l},n.memoizedState=d,n.lanes===0&&(n.memoizedState=n.updateQueue.baseState=d),_r(n,Jn,l)):(l=f.cache,_r(n,Jn,l),l!==d.cache&&Ad(n,[Jn],i,!0))),Cs(e,n,n.pendingProps.children,i),n.child;case 29:throw n.pendingProps}throw Error(o(156,n.tag))}function rr(e){e.flags|=4}function yu(e,n,i,l,d){if((n=(e.mode&32)!==0)&&(n=!1),n){if(e.flags|=16777216,(d&335544128)===d)if(e.stateNode.complete)e.flags|=8192;else if(Qh())e.flags|=8192;else throw uo=Gc,$d}else e.flags&=-16777217}function _h(e,n){if(n.type!=="stylesheet"||(n.state.loading&4)!==0)e.flags&=-16777217;else if(e.flags|=16777216,!Vx(n))if(Qh())e.flags|=8192;else throw uo=Gc,$d}function c0(e,n){n!==null&&(e.flags|=4),e.flags&16384&&(n=e.tag!==22?at():536870912,e.lanes|=n,el|=n)}function ql(e,n){if(!va)switch(e.tailMode){case"hidden":n=e.tail;for(var i=null;n!==null;)n.alternate!==null&&(i=n),n=n.sibling;i===null?e.tail=null:i.sibling=null;break;case"collapsed":i=e.tail;for(var l=null;i!==null;)i.alternate!==null&&(l=i),i=i.sibling;l===null?n||e.tail===null?e.tail=null:e.tail.sibling=null:l.sibling=null}}function xn(e){var n=e.alternate!==null&&e.alternate.child===e.child,i=0,l=0;if(n)for(var d=e.child;d!==null;)i|=d.lanes|d.childLanes,l|=d.subtreeFlags&65011712,l|=d.flags&65011712,d.return=e,d=d.sibling;else for(d=e.child;d!==null;)i|=d.lanes|d.childLanes,l|=d.subtreeFlags,l|=d.flags,d.return=e,d=d.sibling;return e.subtreeFlags|=l,e.childLanes=i,n}function H2(e,n,i){var l=n.pendingProps;switch(Vo(n),n.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return xn(n),null;case 1:return xn(n),null;case 3:return i=n.stateNode,l=null,e!==null&&(l=e.memoizedState.cache),n.memoizedState.cache!==l&&(n.flags|=2048),ar(Jn),fe(),i.pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),(e===null||e.child===null)&&(Wo(n)?rr(n):e===null||e.memoizedState.isDehydrated&&(n.flags&256)===0||(n.flags|=1024,Cd())),xn(n),null;case 26:var d=n.type,f=n.memoizedState;return e===null?(rr(n),f!==null?(xn(n),_h(n,f)):(xn(n),yu(n,d,null,l,i))):f?f!==e.memoizedState?(rr(n),xn(n),_h(n,f)):(xn(n),n.flags&=-16777217):(e=e.memoizedProps,e!==l&&rr(n),xn(n),yu(n,d,e,l,i)),null;case 27:if(tt(n),i=me.current,d=n.type,e!==null&&n.stateNode!=null)e.memoizedProps!==l&&rr(n);else{if(!l){if(n.stateNode===null)throw Error(o(166));return xn(n),null}e=H.current,Wo(n)?sm(n):(e=Px(d,l,i),n.stateNode=e,rr(n))}return xn(n),null;case 5:if(tt(n),d=n.type,e!==null&&n.stateNode!=null)e.memoizedProps!==l&&rr(n);else{if(!l){if(n.stateNode===null)throw Error(o(166));return xn(n),null}if(f=H.current,Wo(n))sm(n);else{var w=M0(me.current);switch(f){case 1:f=w.createElementNS("http://www.w3.org/2000/svg",d);break;case 2:f=w.createElementNS("http://www.w3.org/1998/Math/MathML",d);break;default:switch(d){case"svg":f=w.createElementNS("http://www.w3.org/2000/svg",d);break;case"math":f=w.createElementNS("http://www.w3.org/1998/Math/MathML",d);break;case"script":f=w.createElement("div"),f.innerHTML="<script><\/script>",f=f.removeChild(f.firstChild);break;case"select":f=typeof l.is=="string"?w.createElement("select",{is:l.is}):w.createElement("select"),l.multiple?f.multiple=!0:l.size&&(f.size=l.size);break;default:f=typeof l.is=="string"?w.createElement(d,{is:l.is}):w.createElement(d)}}f[Ae]=n,f[it]=l;e:for(w=n.child;w!==null;){if(w.tag===5||w.tag===6)f.appendChild(w.stateNode);else if(w.tag!==4&&w.tag!==27&&w.child!==null){w.child.return=w,w=w.child;continue}if(w===n)break e;for(;w.sibling===null;){if(w.return===null||w.return===n)break e;w=w.return}w.sibling.return=w.return,w=w.sibling}n.stateNode=f;e:switch(Ts(f,d,l),d){case"button":case"input":case"select":case"textarea":l=!!l.autoFocus;break e;case"img":l=!0;break e;default:l=!1}l&&rr(n)}}return xn(n),yu(n,n.type,e===null?null:e.memoizedProps,n.pendingProps,i),null;case 6:if(e&&n.stateNode!=null)e.memoizedProps!==l&&rr(n);else{if(typeof l!="string"&&n.stateNode===null)throw Error(o(166));if(e=me.current,Wo(n)){if(e=n.stateNode,i=n.memoizedProps,l=null,d=On,d!==null)switch(d.tag){case 27:case 5:l=d.memoizedProps}e[Ae]=n,e=!!(e.nodeValue===i||l!==null&&l.suppressHydrationWarning===!0||jx(e.nodeValue,i)),e||Mr(n,!0)}else e=M0(e).createTextNode(l),e[Ae]=n,n.stateNode=e}return xn(n),null;case 31:if(i=n.memoizedState,e===null||e.memoizedState!==null){if(l=Wo(n),i!==null){if(e===null){if(!l)throw Error(o(318));if(e=n.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(o(557));e[Ae]=n}else io(),(n.flags&128)===0&&(n.memoizedState=null),n.flags|=4;xn(n),e=!1}else i=Cd(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=i),e=!0;if(!e)return n.flags&256?(di(n),n):(di(n),null);if((n.flags&128)!==0)throw Error(o(558))}return xn(n),null;case 13:if(l=n.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(d=Wo(n),l!==null&&l.dehydrated!==null){if(e===null){if(!d)throw Error(o(318));if(d=n.memoizedState,d=d!==null?d.dehydrated:null,!d)throw Error(o(317));d[Ae]=n}else io(),(n.flags&128)===0&&(n.memoizedState=null),n.flags|=4;xn(n),d=!1}else d=Cd(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=d),d=!0;if(!d)return n.flags&256?(di(n),n):(di(n),null)}return di(n),(n.flags&128)!==0?(n.lanes=i,n):(i=l!==null,e=e!==null&&e.memoizedState!==null,i&&(l=n.child,d=null,l.alternate!==null&&l.alternate.memoizedState!==null&&l.alternate.memoizedState.cachePool!==null&&(d=l.alternate.memoizedState.cachePool.pool),f=null,l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(f=l.memoizedState.cachePool.pool),f!==d&&(l.flags|=2048)),i!==e&&i&&(n.child.flags|=8192),c0(n,n.updateQueue),xn(n),null);case 4:return fe(),e===null&&Vu(n.stateNode.containerInfo),xn(n),null;case 10:return ar(n.type),xn(n),null;case 19:if(L(zn),l=n.memoizedState,l===null)return xn(n),null;if(d=(n.flags&128)!==0,f=l.rendering,f===null)if(d)ql(l,!1);else{if(Tn!==0||e!==null&&(e.flags&128)!==0)for(e=n.child;e!==null;){if(f=Zc(e),f!==null){for(n.flags|=128,ql(l,!1),e=f.updateQueue,n.updateQueue=e,c0(n,e),n.subtreeFlags=0,e=i,i=n.child;i!==null;)Ws(i,e),i=i.sibling;return ie(zn,zn.current&1|2),va&&vi(n,l.treeForkCount),n.child}e=e.sibling}l.tail!==null&&Pe()>m0&&(n.flags|=128,d=!0,ql(l,!1),n.lanes=4194304)}else{if(!d)if(e=Zc(f),e!==null){if(n.flags|=128,d=!0,e=e.updateQueue,n.updateQueue=e,c0(n,e),ql(l,!0),l.tail===null&&l.tailMode==="hidden"&&!f.alternate&&!va)return xn(n),null}else 2*Pe()-l.renderingStartTime>m0&&i!==536870912&&(n.flags|=128,d=!0,ql(l,!1),n.lanes=4194304);l.isBackwards?(f.sibling=n.child,n.child=f):(e=l.last,e!==null?e.sibling=f:n.child=f,l.last=f)}return l.tail!==null?(e=l.tail,l.rendering=e,l.tail=e.sibling,l.renderingStartTime=Pe(),e.sibling=null,i=zn.current,ie(zn,d?i&1|2:i&1),va&&vi(n,l.treeForkCount),e):(xn(n),null);case 22:case 23:return di(n),Wd(),l=n.memoizedState!==null,e!==null?e.memoizedState!==null!==l&&(n.flags|=8192):l&&(n.flags|=8192),l?(i&536870912)!==0&&(n.flags&128)===0&&(xn(n),n.subtreeFlags&6&&(n.flags|=8192)):xn(n),i=n.updateQueue,i!==null&&c0(n,i.retryQueue),i=null,e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(i=e.memoizedState.cachePool.pool),l=null,n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(l=n.memoizedState.cachePool.pool),l!==i&&(n.flags|=2048),e!==null&&L(lo),null;case 24:return i=null,e!==null&&(i=e.memoizedState.cache),n.memoizedState.cache!==i&&(n.flags|=2048),ar(Jn),xn(n),null;case 25:return null;case 30:return null}throw Error(o(156,n.tag))}function q2(e,n){switch(Vo(n),n.tag){case 1:return e=n.flags,e&65536?(n.flags=e&-65537|128,n):null;case 3:return ar(Jn),fe(),e=n.flags,(e&65536)!==0&&(e&128)===0?(n.flags=e&-65537|128,n):null;case 26:case 27:case 5:return tt(n),null;case 31:if(n.memoizedState!==null){if(di(n),n.alternate===null)throw Error(o(340));io()}return e=n.flags,e&65536?(n.flags=e&-65537|128,n):null;case 13:if(di(n),e=n.memoizedState,e!==null&&e.dehydrated!==null){if(n.alternate===null)throw Error(o(340));io()}return e=n.flags,e&65536?(n.flags=e&-65537|128,n):null;case 19:return L(zn),null;case 4:return fe(),null;case 10:return ar(n.type),null;case 22:case 23:return di(n),Wd(),e!==null&&L(lo),e=n.flags,e&65536?(n.flags=e&-65537|128,n):null;case 24:return ar(Jn),null;case 25:return null;default:return null}}function Eh(e,n){switch(Vo(n),n.tag){case 3:ar(Jn),fe();break;case 26:case 27:case 5:tt(n);break;case 4:fe();break;case 31:n.memoizedState!==null&&di(n);break;case 13:di(n);break;case 19:L(zn);break;case 10:ar(n.type);break;case 22:case 23:di(n),Wd(),e!==null&&L(lo);break;case 24:ar(Jn)}}function Gl(e,n){try{var i=n.updateQueue,l=i!==null?i.lastEffect:null;if(l!==null){var d=l.next;i=d;do{if((i.tag&e)===e){l=void 0;var f=i.create,w=i.inst;l=f(),w.destroy=l}i=i.next}while(i!==d)}}catch(A){Ha(n,n.return,A)}}function Ar(e,n,i){try{var l=n.updateQueue,d=l!==null?l.lastEffect:null;if(d!==null){var f=d.next;l=f;do{if((l.tag&e)===e){var w=l.inst,A=w.destroy;if(A!==void 0){w.destroy=void 0,d=n;var G=i,ye=A;try{ye()}catch(De){Ha(d,G,De)}}}l=l.next}while(l!==f)}}catch(De){Ha(n,n.return,De)}}function kh(e){var n=e.updateQueue;if(n!==null){var i=e.stateNode;try{gm(n,i)}catch(l){Ha(e,e.return,l)}}}function Ch(e,n,i){i.props=mo(e.type,e.memoizedProps),i.state=e.memoizedState;try{i.componentWillUnmount()}catch(l){Ha(e,n,l)}}function Fl(e,n){try{var i=e.ref;if(i!==null){switch(e.tag){case 26:case 27:case 5:var l=e.stateNode;break;case 30:l=e.stateNode;break;default:l=e.stateNode}typeof i=="function"?e.refCleanup=i(l):i.current=l}}catch(d){Ha(e,n,d)}}function Gi(e,n){var i=e.ref,l=e.refCleanup;if(i!==null)if(typeof l=="function")try{l()}catch(d){Ha(e,n,d)}finally{e.refCleanup=null,e=e.alternate,e!=null&&(e.refCleanup=null)}else if(typeof i=="function")try{i(null)}catch(d){Ha(e,n,d)}else i.current=null}function Th(e){var n=e.type,i=e.memoizedProps,l=e.stateNode;try{e:switch(n){case"button":case"input":case"select":case"textarea":i.autoFocus&&l.focus();break e;case"img":i.src?l.src=i.src:i.srcSet&&(l.srcset=i.srcSet)}}catch(d){Ha(e,e.return,d)}}function bu(e,n,i){try{var l=e.stateNode;fv(l,e.type,i,n),l[it]=n}catch(d){Ha(e,e.return,d)}}function Sh(e){return e.tag===5||e.tag===3||e.tag===26||e.tag===27&&Br(e.type)||e.tag===4}function vu(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Sh(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.tag===27&&Br(e.type)||e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function ju(e,n,i){var l=e.tag;if(l===5||l===6)e=e.stateNode,n?(i.nodeType===9?i.body:i.nodeName==="HTML"?i.ownerDocument.body:i).insertBefore(e,n):(n=i.nodeType===9?i.body:i.nodeName==="HTML"?i.ownerDocument.body:i,n.appendChild(e),i=i._reactRootContainer,i!=null||n.onclick!==null||(n.onclick=st));else if(l!==4&&(l===27&&Br(e.type)&&(i=e.stateNode,n=null),e=e.child,e!==null))for(ju(e,n,i),e=e.sibling;e!==null;)ju(e,n,i),e=e.sibling}function d0(e,n,i){var l=e.tag;if(l===5||l===6)e=e.stateNode,n?i.insertBefore(e,n):i.appendChild(e);else if(l!==4&&(l===27&&Br(e.type)&&(i=e.stateNode),e=e.child,e!==null))for(d0(e,n,i),e=e.sibling;e!==null;)d0(e,n,i),e=e.sibling}function Ah(e){var n=e.stateNode,i=e.memoizedProps;try{for(var l=e.type,d=n.attributes;d.length;)n.removeAttributeNode(d[0]);Ts(n,l,i),n[Ae]=e,n[it]=i}catch(f){Ha(e,e.return,f)}}var or=!1,ts=!1,wu=!1,Ph=typeof WeakSet=="function"?WeakSet:Set,ys=null;function G2(e,n){if(e=e.containerInfo,Iu=A0,e=Be(e),Wt(e)){if("selectionStart"in e)var i={start:e.selectionStart,end:e.selectionEnd};else e:{i=(i=e.ownerDocument)&&i.defaultView||window;var l=i.getSelection&&i.getSelection();if(l&&l.rangeCount!==0){i=l.anchorNode;var d=l.anchorOffset,f=l.focusNode;l=l.focusOffset;try{i.nodeType,f.nodeType}catch{i=null;break e}var w=0,A=-1,G=-1,ye=0,De=0,Fe=e,we=null;t:for(;;){for(var ke;Fe!==i||d!==0&&Fe.nodeType!==3||(A=w+d),Fe!==f||l!==0&&Fe.nodeType!==3||(G=w+l),Fe.nodeType===3&&(w+=Fe.nodeValue.length),(ke=Fe.firstChild)!==null;)we=Fe,Fe=ke;for(;;){if(Fe===e)break t;if(we===i&&++ye===d&&(A=w),we===f&&++De===l&&(G=w),(ke=Fe.nextSibling)!==null)break;Fe=we,we=Fe.parentNode}Fe=ke}i=A===-1||G===-1?null:{start:A,end:G}}else i=null}i=i||{start:0,end:0}}else i=null;for(Hu={focusedElem:e,selectionRange:i},A0=!1,ys=n;ys!==null;)if(n=ys,e=n.child,(n.subtreeFlags&1028)!==0&&e!==null)e.return=n,ys=e;else for(;ys!==null;){switch(n=ys,f=n.alternate,e=n.flags,n.tag){case 0:if((e&4)!==0&&(e=n.updateQueue,e=e!==null?e.events:null,e!==null))for(i=0;i<e.length;i++)d=e[i],d.ref.impl=d.nextImpl;break;case 11:case 15:break;case 1:if((e&1024)!==0&&f!==null){e=void 0,i=n,d=f.memoizedProps,f=f.memoizedState,l=i.stateNode;try{var Pt=mo(i.type,d);e=l.getSnapshotBeforeUpdate(Pt,f),l.__reactInternalSnapshotBeforeUpdate=e}catch(Ut){Ha(i,i.return,Ut)}}break;case 3:if((e&1024)!==0){if(e=n.stateNode.containerInfo,i=e.nodeType,i===9)Fu(e);else if(i===1)switch(e.nodeName){case"HEAD":case"HTML":case"BODY":Fu(e);break;default:e.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((e&1024)!==0)throw Error(o(163))}if(e=n.sibling,e!==null){e.return=n.return,ys=e;break}ys=n.return}}function Dh(e,n,i){var l=i.flags;switch(i.tag){case 0:case 11:case 15:cr(e,i),l&4&&Gl(5,i);break;case 1:if(cr(e,i),l&4)if(e=i.stateNode,n===null)try{e.componentDidMount()}catch(w){Ha(i,i.return,w)}else{var d=mo(i.type,n.memoizedProps);n=n.memoizedState;try{e.componentDidUpdate(d,n,e.__reactInternalSnapshotBeforeUpdate)}catch(w){Ha(i,i.return,w)}}l&64&&kh(i),l&512&&Fl(i,i.return);break;case 3:if(cr(e,i),l&64&&(e=i.updateQueue,e!==null)){if(n=null,i.child!==null)switch(i.child.tag){case 27:case 5:n=i.child.stateNode;break;case 1:n=i.child.stateNode}try{gm(e,n)}catch(w){Ha(i,i.return,w)}}break;case 27:n===null&&l&4&&Ah(i);case 26:case 5:cr(e,i),n===null&&l&4&&Th(i),l&512&&Fl(i,i.return);break;case 12:cr(e,i);break;case 31:cr(e,i),l&4&&Oh(e,i);break;case 13:cr(e,i),l&4&&zh(e,i),l&64&&(e=i.memoizedState,e!==null&&(e=e.dehydrated,e!==null&&(i=tv.bind(null,i),jv(e,i))));break;case 22:if(l=i.memoizedState!==null||or,!l){n=n!==null&&n.memoizedState!==null||ts,d=or;var f=ts;or=l,(ts=n)&&!f?dr(e,i,(i.subtreeFlags&8772)!==0):cr(e,i),or=d,ts=f}break;case 30:break;default:cr(e,i)}}function Rh(e){var n=e.alternate;n!==null&&(e.alternate=null,Rh(n)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(n=e.stateNode,n!==null&&An(n)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}var jn=null,Js=!1;function lr(e,n,i){for(i=i.child;i!==null;)$h(e,n,i),i=i.sibling}function $h(e,n,i){if(kt&&typeof kt.onCommitFiberUnmount=="function")try{kt.onCommitFiberUnmount(Gt,i)}catch{}switch(i.tag){case 26:ts||Gi(i,n),lr(e,n,i),i.memoizedState?i.memoizedState.count--:i.stateNode&&(i=i.stateNode,i.parentNode.removeChild(i));break;case 27:ts||Gi(i,n);var l=jn,d=Js;Br(i.type)&&(jn=i.stateNode,Js=!1),lr(e,n,i),ac(i.stateNode),jn=l,Js=d;break;case 5:ts||Gi(i,n);case 6:if(l=jn,d=Js,jn=null,lr(e,n,i),jn=l,Js=d,jn!==null)if(Js)try{(jn.nodeType===9?jn.body:jn.nodeName==="HTML"?jn.ownerDocument.body:jn).removeChild(i.stateNode)}catch(f){Ha(i,n,f)}else try{jn.removeChild(i.stateNode)}catch(f){Ha(i,n,f)}break;case 18:jn!==null&&(Js?(e=jn,kx(e.nodeType===9?e.body:e.nodeName==="HTML"?e.ownerDocument.body:e,i.stateNode),ll(e)):kx(jn,i.stateNode));break;case 4:l=jn,d=Js,jn=i.stateNode.containerInfo,Js=!0,lr(e,n,i),jn=l,Js=d;break;case 0:case 11:case 14:case 15:Ar(2,i,n),ts||Ar(4,i,n),lr(e,n,i);break;case 1:ts||(Gi(i,n),l=i.stateNode,typeof l.componentWillUnmount=="function"&&Ch(i,n,l)),lr(e,n,i);break;case 21:lr(e,n,i);break;case 22:ts=(l=ts)||i.memoizedState!==null,lr(e,n,i),ts=l;break;default:lr(e,n,i)}}function Oh(e,n){if(n.memoizedState===null&&(e=n.alternate,e!==null&&(e=e.memoizedState,e!==null))){e=e.dehydrated;try{ll(e)}catch(i){Ha(n,n.return,i)}}}function zh(e,n){if(n.memoizedState===null&&(e=n.alternate,e!==null&&(e=e.memoizedState,e!==null&&(e=e.dehydrated,e!==null))))try{ll(e)}catch(i){Ha(n,n.return,i)}}function F2(e){switch(e.tag){case 31:case 13:case 19:var n=e.stateNode;return n===null&&(n=e.stateNode=new Ph),n;case 22:return e=e.stateNode,n=e._retryCache,n===null&&(n=e._retryCache=new Ph),n;default:throw Error(o(435,e.tag))}}function u0(e,n){var i=F2(e);n.forEach(function(l){if(!i.has(l)){i.add(l);var d=av.bind(null,e,l);l.then(d,d)}})}function Ks(e,n){var i=n.deletions;if(i!==null)for(var l=0;l<i.length;l++){var d=i[l],f=e,w=n,A=w;e:for(;A!==null;){switch(A.tag){case 27:if(Br(A.type)){jn=A.stateNode,Js=!1;break e}break;case 5:jn=A.stateNode,Js=!1;break e;case 3:case 4:jn=A.stateNode.containerInfo,Js=!0;break e}A=A.return}if(jn===null)throw Error(o(160));$h(f,w,d),jn=null,Js=!1,f=d.alternate,f!==null&&(f.return=null),d.return=null}if(n.subtreeFlags&13886)for(n=n.child;n!==null;)Bh(n,e),n=n.sibling}var Oi=null;function Bh(e,n){var i=e.alternate,l=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:Ks(n,e),ei(e),l&4&&(Ar(3,e,e.return),Gl(3,e),Ar(5,e,e.return));break;case 1:Ks(n,e),ei(e),l&512&&(ts||i===null||Gi(i,i.return)),l&64&&or&&(e=e.updateQueue,e!==null&&(l=e.callbacks,l!==null&&(i=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=i===null?l:i.concat(l))));break;case 26:var d=Oi;if(Ks(n,e),ei(e),l&512&&(ts||i===null||Gi(i,i.return)),l&4){var f=i!==null?i.memoizedState:null;if(l=e.memoizedState,i===null)if(l===null)if(e.stateNode===null){e:{l=e.type,i=e.memoizedProps,d=d.ownerDocument||d;t:switch(l){case"title":f=d.getElementsByTagName("title")[0],(!f||f[ua]||f[Ae]||f.namespaceURI==="http://www.w3.org/2000/svg"||f.hasAttribute("itemprop"))&&(f=d.createElement(l),d.head.insertBefore(f,d.querySelector("head > title"))),Ts(f,l,i),f[Ae]=e,ja(f),l=f;break e;case"link":var w=Bx("link","href",d).get(l+(i.href||""));if(w){for(var A=0;A<w.length;A++)if(f=w[A],f.getAttribute("href")===(i.href==null||i.href===""?null:i.href)&&f.getAttribute("rel")===(i.rel==null?null:i.rel)&&f.getAttribute("title")===(i.title==null?null:i.title)&&f.getAttribute("crossorigin")===(i.crossOrigin==null?null:i.crossOrigin)){w.splice(A,1);break t}}f=d.createElement(l),Ts(f,l,i),d.head.appendChild(f);break;case"meta":if(w=Bx("meta","content",d).get(l+(i.content||""))){for(A=0;A<w.length;A++)if(f=w[A],f.getAttribute("content")===(i.content==null?null:""+i.content)&&f.getAttribute("name")===(i.name==null?null:i.name)&&f.getAttribute("property")===(i.property==null?null:i.property)&&f.getAttribute("http-equiv")===(i.httpEquiv==null?null:i.httpEquiv)&&f.getAttribute("charset")===(i.charSet==null?null:i.charSet)){w.splice(A,1);break t}}f=d.createElement(l),Ts(f,l,i),d.head.appendChild(f);break;default:throw Error(o(468,l))}f[Ae]=e,ja(f),l=f}e.stateNode=l}else Lx(d,e.type,e.stateNode);else e.stateNode=zx(d,l,e.memoizedProps);else f!==l?(f===null?i.stateNode!==null&&(i=i.stateNode,i.parentNode.removeChild(i)):f.count--,l===null?Lx(d,e.type,e.stateNode):zx(d,l,e.memoizedProps)):l===null&&e.stateNode!==null&&bu(e,e.memoizedProps,i.memoizedProps)}break;case 27:Ks(n,e),ei(e),l&512&&(ts||i===null||Gi(i,i.return)),i!==null&&l&4&&bu(e,e.memoizedProps,i.memoizedProps);break;case 5:if(Ks(n,e),ei(e),l&512&&(ts||i===null||Gi(i,i.return)),e.flags&32){d=e.stateNode;try{Ds(d,"")}catch(Pt){Ha(e,e.return,Pt)}}l&4&&e.stateNode!=null&&(d=e.memoizedProps,bu(e,d,i!==null?i.memoizedProps:d)),l&1024&&(wu=!0);break;case 6:if(Ks(n,e),ei(e),l&4){if(e.stateNode===null)throw Error(o(162));l=e.memoizedProps,i=e.stateNode;try{i.nodeValue=l}catch(Pt){Ha(e,e.return,Pt)}}break;case 3:if(k0=null,d=Oi,Oi=_0(n.containerInfo),Ks(n,e),Oi=d,ei(e),l&4&&i!==null&&i.memoizedState.isDehydrated)try{ll(n.containerInfo)}catch(Pt){Ha(e,e.return,Pt)}wu&&(wu=!1,Lh(e));break;case 4:l=Oi,Oi=_0(e.stateNode.containerInfo),Ks(n,e),ei(e),Oi=l;break;case 12:Ks(n,e),ei(e);break;case 31:Ks(n,e),ei(e),l&4&&(l=e.updateQueue,l!==null&&(e.updateQueue=null,u0(e,l)));break;case 13:Ks(n,e),ei(e),e.child.flags&8192&&e.memoizedState!==null!=(i!==null&&i.memoizedState!==null)&&(f0=Pe()),l&4&&(l=e.updateQueue,l!==null&&(e.updateQueue=null,u0(e,l)));break;case 22:d=e.memoizedState!==null;var G=i!==null&&i.memoizedState!==null,ye=or,De=ts;if(or=ye||d,ts=De||G,Ks(n,e),ts=De,or=ye,ei(e),l&8192)e:for(n=e.stateNode,n._visibility=d?n._visibility&-2:n._visibility|1,d&&(i===null||G||or||ts||ho(e)),i=null,n=e;;){if(n.tag===5||n.tag===26){if(i===null){G=i=n;try{if(f=G.stateNode,d)w=f.style,typeof w.setProperty=="function"?w.setProperty("display","none","important"):w.display="none";else{A=G.stateNode;var Fe=G.memoizedProps.style,we=Fe!=null&&Fe.hasOwnProperty("display")?Fe.display:null;A.style.display=we==null||typeof we=="boolean"?"":(""+we).trim()}}catch(Pt){Ha(G,G.return,Pt)}}}else if(n.tag===6){if(i===null){G=n;try{G.stateNode.nodeValue=d?"":G.memoizedProps}catch(Pt){Ha(G,G.return,Pt)}}}else if(n.tag===18){if(i===null){G=n;try{var ke=G.stateNode;d?Cx(ke,!0):Cx(G.stateNode,!1)}catch(Pt){Ha(G,G.return,Pt)}}}else if((n.tag!==22&&n.tag!==23||n.memoizedState===null||n===e)&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break e;for(;n.sibling===null;){if(n.return===null||n.return===e)break e;i===n&&(i=null),n=n.return}i===n&&(i=null),n.sibling.return=n.return,n=n.sibling}l&4&&(l=e.updateQueue,l!==null&&(i=l.retryQueue,i!==null&&(l.retryQueue=null,u0(e,i))));break;case 19:Ks(n,e),ei(e),l&4&&(l=e.updateQueue,l!==null&&(e.updateQueue=null,u0(e,l)));break;case 30:break;case 21:break;default:Ks(n,e),ei(e)}}function ei(e){var n=e.flags;if(n&2){try{for(var i,l=e.return;l!==null;){if(Sh(l)){i=l;break}l=l.return}if(i==null)throw Error(o(160));switch(i.tag){case 27:var d=i.stateNode,f=vu(e);d0(e,f,d);break;case 5:var w=i.stateNode;i.flags&32&&(Ds(w,""),i.flags&=-33);var A=vu(e);d0(e,A,w);break;case 3:case 4:var G=i.stateNode.containerInfo,ye=vu(e);ju(e,ye,G);break;default:throw Error(o(161))}}catch(De){Ha(e,e.return,De)}e.flags&=-3}n&4096&&(e.flags&=-4097)}function Lh(e){if(e.subtreeFlags&1024)for(e=e.child;e!==null;){var n=e;Lh(n),n.tag===5&&n.flags&1024&&n.stateNode.reset(),e=e.sibling}}function cr(e,n){if(n.subtreeFlags&8772)for(n=n.child;n!==null;)Dh(e,n.alternate,n),n=n.sibling}function ho(e){for(e=e.child;e!==null;){var n=e;switch(n.tag){case 0:case 11:case 14:case 15:Ar(4,n,n.return),ho(n);break;case 1:Gi(n,n.return);var i=n.stateNode;typeof i.componentWillUnmount=="function"&&Ch(n,n.return,i),ho(n);break;case 27:ac(n.stateNode);case 26:case 5:Gi(n,n.return),ho(n);break;case 22:n.memoizedState===null&&ho(n);break;case 30:ho(n);break;default:ho(n)}e=e.sibling}}function dr(e,n,i){for(i=i&&(n.subtreeFlags&8772)!==0,n=n.child;n!==null;){var l=n.alternate,d=e,f=n,w=f.flags;switch(f.tag){case 0:case 11:case 15:dr(d,f,i),Gl(4,f);break;case 1:if(dr(d,f,i),l=f,d=l.stateNode,typeof d.componentDidMount=="function")try{d.componentDidMount()}catch(ye){Ha(l,l.return,ye)}if(l=f,d=l.updateQueue,d!==null){var A=l.stateNode;try{var G=d.shared.hiddenCallbacks;if(G!==null)for(d.shared.hiddenCallbacks=null,d=0;d<G.length;d++)xm(G[d],A)}catch(ye){Ha(l,l.return,ye)}}i&&w&64&&kh(f),Fl(f,f.return);break;case 27:Ah(f);case 26:case 5:dr(d,f,i),i&&l===null&&w&4&&Th(f),Fl(f,f.return);break;case 12:dr(d,f,i);break;case 31:dr(d,f,i),i&&w&4&&Oh(d,f);break;case 13:dr(d,f,i),i&&w&4&&zh(d,f);break;case 22:f.memoizedState===null&&dr(d,f,i),Fl(f,f.return);break;case 30:break;default:dr(d,f,i)}n=n.sibling}}function Nu(e,n){var i=null;e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(i=e.memoizedState.cachePool.pool),e=null,n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(e=n.memoizedState.cachePool.pool),e!==i&&(e!=null&&e.refCount++,i!=null&&Dl(i))}function Mu(e,n){e=null,n.alternate!==null&&(e=n.alternate.memoizedState.cache),n=n.memoizedState.cache,n!==e&&(n.refCount++,e!=null&&Dl(e))}function zi(e,n,i,l){if(n.subtreeFlags&10256)for(n=n.child;n!==null;)Vh(e,n,i,l),n=n.sibling}function Vh(e,n,i,l){var d=n.flags;switch(n.tag){case 0:case 11:case 15:zi(e,n,i,l),d&2048&&Gl(9,n);break;case 1:zi(e,n,i,l);break;case 3:zi(e,n,i,l),d&2048&&(e=null,n.alternate!==null&&(e=n.alternate.memoizedState.cache),n=n.memoizedState.cache,n!==e&&(n.refCount++,e!=null&&Dl(e)));break;case 12:if(d&2048){zi(e,n,i,l),e=n.stateNode;try{var f=n.memoizedProps,w=f.id,A=f.onPostCommit;typeof A=="function"&&A(w,n.alternate===null?"mount":"update",e.passiveEffectDuration,-0)}catch(G){Ha(n,n.return,G)}}else zi(e,n,i,l);break;case 31:zi(e,n,i,l);break;case 13:zi(e,n,i,l);break;case 23:break;case 22:f=n.stateNode,w=n.alternate,n.memoizedState!==null?f._visibility&2?zi(e,n,i,l):Yl(e,n):f._visibility&2?zi(e,n,i,l):(f._visibility|=2,Qo(e,n,i,l,(n.subtreeFlags&10256)!==0||!1)),d&2048&&Nu(w,n);break;case 24:zi(e,n,i,l),d&2048&&Mu(n.alternate,n);break;default:zi(e,n,i,l)}}function Qo(e,n,i,l,d){for(d=d&&((n.subtreeFlags&10256)!==0||!1),n=n.child;n!==null;){var f=e,w=n,A=i,G=l,ye=w.flags;switch(w.tag){case 0:case 11:case 15:Qo(f,w,A,G,d),Gl(8,w);break;case 23:break;case 22:var De=w.stateNode;w.memoizedState!==null?De._visibility&2?Qo(f,w,A,G,d):Yl(f,w):(De._visibility|=2,Qo(f,w,A,G,d)),d&&ye&2048&&Nu(w.alternate,w);break;case 24:Qo(f,w,A,G,d),d&&ye&2048&&Mu(w.alternate,w);break;default:Qo(f,w,A,G,d)}n=n.sibling}}function Yl(e,n){if(n.subtreeFlags&10256)for(n=n.child;n!==null;){var i=e,l=n,d=l.flags;switch(l.tag){case 22:Yl(i,l),d&2048&&Nu(l.alternate,l);break;case 24:Yl(i,l),d&2048&&Mu(l.alternate,l);break;default:Yl(i,l)}n=n.sibling}}var Xl=8192;function Jo(e,n,i){if(e.subtreeFlags&Xl)for(e=e.child;e!==null;)Wh(e,n,i),e=e.sibling}function Wh(e,n,i){switch(e.tag){case 26:Jo(e,n,i),e.flags&Xl&&e.memoizedState!==null&&Dv(i,Oi,e.memoizedState,e.memoizedProps);break;case 5:Jo(e,n,i);break;case 3:case 4:var l=Oi;Oi=_0(e.stateNode.containerInfo),Jo(e,n,i),Oi=l;break;case 22:e.memoizedState===null&&(l=e.alternate,l!==null&&l.memoizedState!==null?(l=Xl,Xl=16777216,Jo(e,n,i),Xl=l):Jo(e,n,i));break;default:Jo(e,n,i)}}function Uh(e){var n=e.alternate;if(n!==null&&(e=n.child,e!==null)){n.child=null;do n=e.sibling,e.sibling=null,e=n;while(e!==null)}}function Zl(e){var n=e.deletions;if((e.flags&16)!==0){if(n!==null)for(var i=0;i<n.length;i++){var l=n[i];ys=l,Hh(l,e)}Uh(e)}if(e.subtreeFlags&10256)for(e=e.child;e!==null;)Ih(e),e=e.sibling}function Ih(e){switch(e.tag){case 0:case 11:case 15:Zl(e),e.flags&2048&&Ar(9,e,e.return);break;case 3:Zl(e);break;case 12:Zl(e);break;case 22:var n=e.stateNode;e.memoizedState!==null&&n._visibility&2&&(e.return===null||e.return.tag!==13)?(n._visibility&=-3,p0(e)):Zl(e);break;default:Zl(e)}}function p0(e){var n=e.deletions;if((e.flags&16)!==0){if(n!==null)for(var i=0;i<n.length;i++){var l=n[i];ys=l,Hh(l,e)}Uh(e)}for(e=e.child;e!==null;){switch(n=e,n.tag){case 0:case 11:case 15:Ar(8,n,n.return),p0(n);break;case 22:i=n.stateNode,i._visibility&2&&(i._visibility&=-3,p0(n));break;default:p0(n)}e=e.sibling}}function Hh(e,n){for(;ys!==null;){var i=ys;switch(i.tag){case 0:case 11:case 15:Ar(8,i,n);break;case 23:case 22:if(i.memoizedState!==null&&i.memoizedState.cachePool!==null){var l=i.memoizedState.cachePool.pool;l!=null&&l.refCount++}break;case 24:Dl(i.memoizedState.cache)}if(l=i.child,l!==null)l.return=i,ys=l;else e:for(i=e;ys!==null;){l=ys;var d=l.sibling,f=l.return;if(Rh(l),l===i){ys=null;break e}if(d!==null){d.return=f,ys=d;break e}ys=f}}}var Y2={getCacheForType:function(e){var n=ks(Jn),i=n.data.get(e);return i===void 0&&(i=e(),n.data.set(e,i)),i},cacheSignal:function(){return ks(Jn).controller.signal}},X2=typeof WeakMap=="function"?WeakMap:Map,Ba=0,rn=null,fa=null,ya=0,Ia=0,ui=null,Pr=!1,Ko=!1,_u=!1,ur=0,Tn=0,Dr=0,xo=0,Eu=0,pi=0,el=0,Ql=null,ti=null,ku=!1,f0=0,qh=0,m0=1/0,h0=null,Rr=null,cs=0,$r=null,tl=null,pr=0,Cu=0,Tu=null,Gh=null,Jl=0,Su=null;function fi(){return(Ba&2)!==0&&ya!==0?ya&-ya:P.T!==null?Ou():xe()}function Fh(){if(pi===0)if((ya&536870912)===0||va){var e=je;je<<=1,(je&3932160)===0&&(je=262144),pi=e}else pi=536870912;return e=ci.current,e!==null&&(e.flags|=32),pi}function ai(e,n,i){(e===rn&&(Ia===2||Ia===9)||e.cancelPendingCommit!==null)&&(al(e,0),Or(e,ya,pi,!1)),Ce(e,i),((Ba&2)===0||e!==rn)&&(e===rn&&((Ba&2)===0&&(xo|=i),Tn===4&&Or(e,ya,pi,!1)),Fi(e))}function Yh(e,n,i){if((Ba&6)!==0)throw Error(o(327));var l=!i&&(n&127)===0&&(n&e.expiredLanes)===0||Me(e,n),d=l?J2(e,n):Pu(e,n,!0),f=l;do{if(d===0){Ko&&!l&&Or(e,n,0,!1);break}else{if(i=e.current.alternate,f&&!Z2(i)){d=Pu(e,n,!1),f=!1;continue}if(d===2){if(f=n,e.errorRecoveryDisabledLanes&f)var w=0;else w=e.pendingLanes&-536870913,w=w!==0?w:w&536870912?536870912:0;if(w!==0){n=w;e:{var A=e;d=Ql;var G=A.current.memoizedState.isDehydrated;if(G&&(al(A,w).flags|=256),w=Pu(A,w,!1),w!==2){if(_u&&!G){A.errorRecoveryDisabledLanes|=f,xo|=f,d=4;break e}f=ti,ti=d,f!==null&&(ti===null?ti=f:ti.push.apply(ti,f))}d=w}if(f=!1,d!==2)continue}}if(d===1){al(e,0),Or(e,n,0,!0);break}e:{switch(l=e,f=d,f){case 0:case 1:throw Error(o(345));case 4:if((n&4194048)!==n)break;case 6:Or(l,n,pi,!Pr);break e;case 2:ti=null;break;case 3:case 5:break;default:throw Error(o(329))}if((n&62914560)===n&&(d=f0+300-Pe(),10<d)){if(Or(l,n,pi,!Pr),ue(l,0,!0)!==0)break e;pr=n,l.timeoutHandle=_x(Xh.bind(null,l,i,ti,h0,ku,n,pi,xo,el,Pr,f,"Throttled",-0,0),d);break e}Xh(l,i,ti,h0,ku,n,pi,xo,el,Pr,f,null,-0,0)}}break}while(!0);Fi(e)}function Xh(e,n,i,l,d,f,w,A,G,ye,De,Fe,we,ke){if(e.timeoutHandle=-1,Fe=n.subtreeFlags,Fe&8192||(Fe&16785408)===16785408){Fe={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:st},Wh(n,f,Fe);var Pt=(f&62914560)===f?f0-Pe():(f&4194048)===f?qh-Pe():0;if(Pt=Rv(Fe,Pt),Pt!==null){pr=f,e.cancelPendingCommit=Pt(nx.bind(null,e,n,f,i,l,d,w,A,G,De,Fe,null,we,ke)),Or(e,f,w,!ye);return}}nx(e,n,f,i,l,d,w,A,G)}function Z2(e){for(var n=e;;){var i=n.tag;if((i===0||i===11||i===15)&&n.flags&16384&&(i=n.updateQueue,i!==null&&(i=i.stores,i!==null)))for(var l=0;l<i.length;l++){var d=i[l],f=d.getSnapshot;d=d.value;try{if(!Wa(f(),d))return!1}catch{return!1}}if(i=n.child,n.subtreeFlags&16384&&i!==null)i.return=n,n=i;else{if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return!0;n=n.return}n.sibling.return=n.return,n=n.sibling}}return!0}function Or(e,n,i,l){n&=~Eu,n&=~xo,e.suspendedLanes|=n,e.pingedLanes&=~n,l&&(e.warmLanes|=n),l=e.expirationTimes;for(var d=n;0<d;){var f=31-Ht(d),w=1<<f;l[f]=-1,d&=~w}i!==0&&zt(e,i,n)}function x0(){return(Ba&6)===0?(Kl(0),!1):!0}function Au(){if(fa!==null){if(Ia===0)var e=fa.return;else e=fa,tr=ro=null,Fd(e),Go=null,$l=0,e=fa;for(;e!==null;)Eh(e.alternate,e),e=e.return;fa=null}}function al(e,n){var i=e.timeoutHandle;i!==-1&&(e.timeoutHandle=-1,xv(i)),i=e.cancelPendingCommit,i!==null&&(e.cancelPendingCommit=null,i()),pr=0,Au(),rn=e,fa=i=vn(e.current,null),ya=n,Ia=0,ui=null,Pr=!1,Ko=Me(e,n),_u=!1,el=pi=Eu=xo=Dr=Tn=0,ti=Ql=null,ku=!1,(n&8)!==0&&(n|=n&32);var l=e.entangledLanes;if(l!==0)for(e=e.entanglements,l&=n;0<l;){var d=31-Ht(l),f=1<<d;n|=e[d],l&=~f}return ur=n,os(),i}function Zh(e,n){aa=null,P.H=Il,n===qo||n===qc?(n=pm(),Ia=3):n===$d?(n=pm(),Ia=4):Ia=n===cu?8:n!==null&&typeof n=="object"&&typeof n.then=="function"?6:1,ui=n,fa===null&&(Tn=1,i0(e,$n(n,e.current)))}function Qh(){var e=ci.current;return e===null?!0:(ya&4194048)===ya?wi===null:(ya&62914560)===ya||(ya&536870912)!==0?e===wi:!1}function Jh(){var e=P.H;return P.H=Il,e===null?Il:e}function Kh(){var e=P.A;return P.A=Y2,e}function g0(){Tn=4,Pr||(ya&4194048)!==ya&&ci.current!==null||(Ko=!0),(Dr&134217727)===0&&(xo&134217727)===0||rn===null||Or(rn,ya,pi,!1)}function Pu(e,n,i){var l=Ba;Ba|=2;var d=Jh(),f=Kh();(rn!==e||ya!==n)&&(h0=null,al(e,n)),n=!1;var w=Tn;e:do try{if(Ia!==0&&fa!==null){var A=fa,G=ui;switch(Ia){case 8:Au(),w=6;break e;case 3:case 2:case 9:case 6:ci.current===null&&(n=!0);var ye=Ia;if(Ia=0,ui=null,nl(e,A,G,ye),i&&Ko){w=0;break e}break;default:ye=Ia,Ia=0,ui=null,nl(e,A,G,ye)}}Q2(),w=Tn;break}catch(De){Zh(e,De)}while(!0);return n&&e.shellSuspendCounter++,tr=ro=null,Ba=l,P.H=d,P.A=f,fa===null&&(rn=null,ya=0,os()),w}function Q2(){for(;fa!==null;)ex(fa)}function J2(e,n){var i=Ba;Ba|=2;var l=Jh(),d=Kh();rn!==e||ya!==n?(h0=null,m0=Pe()+500,al(e,n)):Ko=Me(e,n);e:do try{if(Ia!==0&&fa!==null){n=fa;var f=ui;t:switch(Ia){case 1:Ia=0,ui=null,nl(e,n,f,1);break;case 2:case 9:if(dm(f)){Ia=0,ui=null,tx(n);break}n=function(){Ia!==2&&Ia!==9||rn!==e||(Ia=7),Fi(e)},f.then(n,n);break e;case 3:Ia=7;break e;case 4:Ia=5;break e;case 7:dm(f)?(Ia=0,ui=null,tx(n)):(Ia=0,ui=null,nl(e,n,f,7));break;case 5:var w=null;switch(fa.tag){case 26:w=fa.memoizedState;case 5:case 27:var A=fa;if(w?Vx(w):A.stateNode.complete){Ia=0,ui=null;var G=A.sibling;if(G!==null)fa=G;else{var ye=A.return;ye!==null?(fa=ye,y0(ye)):fa=null}break t}}Ia=0,ui=null,nl(e,n,f,5);break;case 6:Ia=0,ui=null,nl(e,n,f,6);break;case 8:Au(),Tn=6;break e;default:throw Error(o(462))}}K2();break}catch(De){Zh(e,De)}while(!0);return tr=ro=null,P.H=l,P.A=d,Ba=i,fa!==null?0:(rn=null,ya=0,os(),Tn)}function K2(){for(;fa!==null&&!Ye();)ex(fa)}function ex(e){var n=Mh(e.alternate,e,ur);e.memoizedProps=e.pendingProps,n===null?y0(e):fa=n}function tx(e){var n=e,i=n.alternate;switch(n.tag){case 15:case 0:n=yh(i,n,n.pendingProps,n.type,void 0,ya);break;case 11:n=yh(i,n,n.pendingProps,n.type.render,n.ref,ya);break;case 5:Fd(n);default:Eh(i,n),n=fa=Ws(n,ur),n=Mh(i,n,ur)}e.memoizedProps=e.pendingProps,n===null?y0(e):fa=n}function nl(e,n,i,l){tr=ro=null,Fd(n),Go=null,$l=0;var d=n.return;try{if(W2(e,d,n,i,ya)){Tn=1,i0(e,$n(i,e.current)),fa=null;return}}catch(f){if(d!==null)throw fa=d,f;Tn=1,i0(e,$n(i,e.current)),fa=null;return}n.flags&32768?(va||l===1?e=!0:Ko||(ya&536870912)!==0?e=!1:(Pr=e=!0,(l===2||l===9||l===3||l===6)&&(l=ci.current,l!==null&&l.tag===13&&(l.flags|=16384))),ax(n,e)):y0(n)}function y0(e){var n=e;do{if((n.flags&32768)!==0){ax(n,Pr);return}e=n.return;var i=H2(n.alternate,n,ur);if(i!==null){fa=i;return}if(n=n.sibling,n!==null){fa=n;return}fa=n=e}while(n!==null);Tn===0&&(Tn=5)}function ax(e,n){do{var i=q2(e.alternate,e);if(i!==null){i.flags&=32767,fa=i;return}if(i=e.return,i!==null&&(i.flags|=32768,i.subtreeFlags=0,i.deletions=null),!n&&(e=e.sibling,e!==null)){fa=e;return}fa=e=i}while(e!==null);Tn=6,fa=null}function nx(e,n,i,l,d,f,w,A,G){e.cancelPendingCommit=null;do b0();while(cs!==0);if((Ba&6)!==0)throw Error(o(327));if(n!==null){if(n===e.current)throw Error(o(177));if(f=n.lanes|n.childLanes,f|=rs,rt(e,i,f,w,A,G),e===rn&&(fa=rn=null,ya=0),tl=n,$r=e,pr=i,Cu=f,Tu=d,Gh=l,(n.subtreeFlags&10256)!==0||(n.flags&10256)!==0?(e.callbackNode=null,e.callbackPriority=0,nv(Ka,function(){return lx(),null})):(e.callbackNode=null,e.callbackPriority=0),l=(n.flags&13878)!==0,(n.subtreeFlags&13878)!==0||l){l=P.T,P.T=null,d=z.p,z.p=2,w=Ba,Ba|=4;try{G2(e,n,i)}finally{Ba=w,z.p=d,P.T=l}}cs=1,sx(),ix(),rx()}}function sx(){if(cs===1){cs=0;var e=$r,n=tl,i=(n.flags&13878)!==0;if((n.subtreeFlags&13878)!==0||i){i=P.T,P.T=null;var l=z.p;z.p=2;var d=Ba;Ba|=4;try{Bh(n,e);var f=Hu,w=Be(e.containerInfo),A=f.focusedElem,G=f.selectionRange;if(w!==A&&A&&A.ownerDocument&&no(A.ownerDocument.documentElement,A)){if(G!==null&&Wt(A)){var ye=G.start,De=G.end;if(De===void 0&&(De=ye),"selectionStart"in A)A.selectionStart=ye,A.selectionEnd=Math.min(De,A.value.length);else{var Fe=A.ownerDocument||document,we=Fe&&Fe.defaultView||window;if(we.getSelection){var ke=we.getSelection(),Pt=A.textContent.length,Ut=Math.min(G.start,Pt),Ja=G.end===void 0?Ut:Math.min(G.end,Pt);!ke.extend&&Ut>Ja&&(w=Ja,Ja=Ut,Ut=w);var ce=Lo(A,Ut),ee=Lo(A,Ja);if(ce&&ee&&(ke.rangeCount!==1||ke.anchorNode!==ce.node||ke.anchorOffset!==ce.offset||ke.focusNode!==ee.node||ke.focusOffset!==ee.offset)){var ge=Fe.createRange();ge.setStart(ce.node,ce.offset),ke.removeAllRanges(),Ut>Ja?(ke.addRange(ge),ke.extend(ee.node,ee.offset)):(ge.setEnd(ee.node,ee.offset),ke.addRange(ge))}}}}for(Fe=[],ke=A;ke=ke.parentNode;)ke.nodeType===1&&Fe.push({element:ke,left:ke.scrollLeft,top:ke.scrollTop});for(typeof A.focus=="function"&&A.focus(),A=0;A<Fe.length;A++){var Le=Fe[A];Le.element.scrollLeft=Le.left,Le.element.scrollTop=Le.top}}A0=!!Iu,Hu=Iu=null}finally{Ba=d,z.p=l,P.T=i}}e.current=n,cs=2}}function ix(){if(cs===2){cs=0;var e=$r,n=tl,i=(n.flags&8772)!==0;if((n.subtreeFlags&8772)!==0||i){i=P.T,P.T=null;var l=z.p;z.p=2;var d=Ba;Ba|=4;try{Dh(e,n.alternate,n)}finally{Ba=d,z.p=l,P.T=i}}cs=3}}function rx(){if(cs===4||cs===3){cs=0,bt();var e=$r,n=tl,i=pr,l=Gh;(n.subtreeFlags&10256)!==0||(n.flags&10256)!==0?cs=5:(cs=0,tl=$r=null,ox(e,e.pendingLanes));var d=e.pendingLanes;if(d===0&&(Rr=null),Ra(i),n=n.stateNode,kt&&typeof kt.onCommitFiberRoot=="function")try{kt.onCommitFiberRoot(Gt,n,void 0,(n.current.flags&128)===128)}catch{}if(l!==null){n=P.T,d=z.p,z.p=2,P.T=null;try{for(var f=e.onRecoverableError,w=0;w<l.length;w++){var A=l[w];f(A.value,{componentStack:A.stack})}}finally{P.T=n,z.p=d}}(pr&3)!==0&&b0(),Fi(e),d=e.pendingLanes,(i&261930)!==0&&(d&42)!==0?e===Su?Jl++:(Jl=0,Su=e):Jl=0,Kl(0)}}function ox(e,n){(e.pooledCacheLanes&=n)===0&&(n=e.pooledCache,n!=null&&(e.pooledCache=null,Dl(n)))}function b0(){return sx(),ix(),rx(),lx()}function lx(){if(cs!==5)return!1;var e=$r,n=Cu;Cu=0;var i=Ra(pr),l=P.T,d=z.p;try{z.p=32>i?32:i,P.T=null,i=Tu,Tu=null;var f=$r,w=pr;if(cs=0,tl=$r=null,pr=0,(Ba&6)!==0)throw Error(o(331));var A=Ba;if(Ba|=4,Ih(f.current),Vh(f,f.current,w,i),Ba=A,Kl(0,!1),kt&&typeof kt.onPostCommitFiberRoot=="function")try{kt.onPostCommitFiberRoot(Gt,f)}catch{}return!0}finally{z.p=d,P.T=l,ox(e,n)}}function cx(e,n,i){n=$n(i,n),n=lu(e.stateNode,n,2),e=Cr(e,n,2),e!==null&&(Ce(e,2),Fi(e))}function Ha(e,n,i){if(e.tag===3)cx(e,e,i);else for(;n!==null;){if(n.tag===3){cx(n,e,i);break}else if(n.tag===1){var l=n.stateNode;if(typeof n.type.getDerivedStateFromError=="function"||typeof l.componentDidCatch=="function"&&(Rr===null||!Rr.has(l))){e=$n(i,e),i=dh(2),l=Cr(n,i,2),l!==null&&(uh(i,l,n,e),Ce(l,2),Fi(l));break}}n=n.return}}function Du(e,n,i){var l=e.pingCache;if(l===null){l=e.pingCache=new X2;var d=new Set;l.set(n,d)}else d=l.get(n),d===void 0&&(d=new Set,l.set(n,d));d.has(i)||(_u=!0,d.add(i),e=ev.bind(null,e,n,i),n.then(e,e))}function ev(e,n,i){var l=e.pingCache;l!==null&&l.delete(n),e.pingedLanes|=e.suspendedLanes&i,e.warmLanes&=~i,rn===e&&(ya&i)===i&&(Tn===4||Tn===3&&(ya&62914560)===ya&&300>Pe()-f0?(Ba&2)===0&&al(e,0):Eu|=i,el===ya&&(el=0)),Fi(e)}function dx(e,n){n===0&&(n=at()),e=Zs(e,n),e!==null&&(Ce(e,n),Fi(e))}function tv(e){var n=e.memoizedState,i=0;n!==null&&(i=n.retryLane),dx(e,i)}function av(e,n){var i=0;switch(e.tag){case 31:case 13:var l=e.stateNode,d=e.memoizedState;d!==null&&(i=d.retryLane);break;case 19:l=e.stateNode;break;case 22:l=e.stateNode._retryCache;break;default:throw Error(o(314))}l!==null&&l.delete(n),dx(e,i)}function nv(e,n){return It(e,n)}var v0=null,sl=null,Ru=!1,j0=!1,$u=!1,zr=0;function Fi(e){e!==sl&&e.next===null&&(sl===null?v0=sl=e:sl=sl.next=e),j0=!0,Ru||(Ru=!0,iv())}function Kl(e,n){if(!$u&&j0){$u=!0;do for(var i=!1,l=v0;l!==null;){if(e!==0){var d=l.pendingLanes;if(d===0)var f=0;else{var w=l.suspendedLanes,A=l.pingedLanes;f=(1<<31-Ht(42|e)+1)-1,f&=d&~(w&~A),f=f&201326741?f&201326741|1:f?f|2:0}f!==0&&(i=!0,mx(l,f))}else f=ya,f=ue(l,l===rn?f:0,l.cancelPendingCommit!==null||l.timeoutHandle!==-1),(f&3)===0||Me(l,f)||(i=!0,mx(l,f));l=l.next}while(i);$u=!1}}function sv(){ux()}function ux(){j0=Ru=!1;var e=0;zr!==0&&hv()&&(e=zr);for(var n=Pe(),i=null,l=v0;l!==null;){var d=l.next,f=px(l,n);f===0?(l.next=null,i===null?v0=d:i.next=d,d===null&&(sl=i)):(i=l,(e!==0||(f&3)!==0)&&(j0=!0)),l=d}cs!==0&&cs!==5||Kl(e),zr!==0&&(zr=0)}function px(e,n){for(var i=e.suspendedLanes,l=e.pingedLanes,d=e.expirationTimes,f=e.pendingLanes&-62914561;0<f;){var w=31-Ht(f),A=1<<w,G=d[w];G===-1?((A&i)===0||(A&l)!==0)&&(d[w]=Ie(A,n)):G<=n&&(e.expiredLanes|=A),f&=~A}if(n=rn,i=ya,i=ue(e,e===n?i:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),l=e.callbackNode,i===0||e===n&&(Ia===2||Ia===9)||e.cancelPendingCommit!==null)return l!==null&&l!==null&&oe(l),e.callbackNode=null,e.callbackPriority=0;if((i&3)===0||Me(e,i)){if(n=i&-i,n===e.callbackPriority)return n;switch(l!==null&&oe(l),Ra(i)){case 2:case 8:i=oa;break;case 32:i=Ka;break;case 268435456:i=Zt;break;default:i=Ka}return l=fx.bind(null,e),i=It(i,l),e.callbackPriority=n,e.callbackNode=i,n}return l!==null&&l!==null&&oe(l),e.callbackPriority=2,e.callbackNode=null,2}function fx(e,n){if(cs!==0&&cs!==5)return e.callbackNode=null,e.callbackPriority=0,null;var i=e.callbackNode;if(b0()&&e.callbackNode!==i)return null;var l=ya;return l=ue(e,e===rn?l:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),l===0?null:(Yh(e,l,n),px(e,Pe()),e.callbackNode!=null&&e.callbackNode===i?fx.bind(null,e):null)}function mx(e,n){if(b0())return null;Yh(e,n,!0)}function iv(){gv(function(){(Ba&6)!==0?It(Vt,sv):ux()})}function Ou(){if(zr===0){var e=Io;e===0&&(e=K,K<<=1,(K&261888)===0&&(K=256)),zr=e}return zr}function hx(e){return e==null||typeof e=="symbol"||typeof e=="boolean"?null:typeof e=="function"?e:Nt(""+e)}function xx(e,n){var i=n.ownerDocument.createElement("input");return i.name=n.name,i.value=n.value,e.id&&i.setAttribute("form",e.id),n.parentNode.insertBefore(i,n),e=new FormData(e),i.parentNode.removeChild(i),e}function rv(e,n,i,l,d){if(n==="submit"&&i&&i.stateNode===d){var f=hx((d[it]||null).action),w=l.submitter;w&&(n=(n=w[it]||null)?hx(n.formAction):w.getAttribute("formAction"),n!==null&&(f=n,w=null));var A=new Rs("action","action",null,l,d);e.push({event:A,listeners:[{instance:null,listener:function(){if(l.defaultPrevented){if(zr!==0){var G=w?xx(d,w):new FormData(d);au(i,{pending:!0,data:G,method:d.method,action:f},null,G)}}else typeof f=="function"&&(A.preventDefault(),G=w?xx(d,w):new FormData(d),au(i,{pending:!0,data:G,method:d.method,action:f},f,G))},currentTarget:d}]})}}for(var zu=0;zu<sn.length;zu++){var Bu=sn[zu],ov=Bu.toLowerCase(),lv=Bu[0].toUpperCase()+Bu.slice(1);za(ov,"on"+lv)}za(Xs,"onAnimationEnd"),za(yi,"onAnimationIteration"),za(Ii,"onAnimationStart"),za("dblclick","onDoubleClick"),za("focusin","onFocus"),za("focusout","onBlur"),za(ia,"onTransitionRun"),za(ln,"onTransitionStart"),za(fn,"onTransitionCancel"),za(En,"onTransitionEnd"),us("onMouseEnter",["mouseout","mouseover"]),us("onMouseLeave",["mouseout","mouseover"]),us("onPointerEnter",["pointerout","pointerover"]),us("onPointerLeave",["pointerout","pointerover"]),ns("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),ns("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),ns("onBeforeInput",["compositionend","keypress","textInput","paste"]),ns("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),ns("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),ns("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ec="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),cv=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(ec));function gx(e,n){n=(n&4)!==0;for(var i=0;i<e.length;i++){var l=e[i],d=l.event;l=l.listeners;e:{var f=void 0;if(n)for(var w=l.length-1;0<=w;w--){var A=l[w],G=A.instance,ye=A.currentTarget;if(A=A.listener,G!==f&&d.isPropagationStopped())break e;f=A,d.currentTarget=ye;try{f(d)}catch(De){is(De)}d.currentTarget=null,f=G}else for(w=0;w<l.length;w++){if(A=l[w],G=A.instance,ye=A.currentTarget,A=A.listener,G!==f&&d.isPropagationStopped())break e;f=A,d.currentTarget=ye;try{f(d)}catch(De){is(De)}d.currentTarget=null,f=G}}}}function ma(e,n){var i=n[be];i===void 0&&(i=n[be]=new Set);var l=e+"__bubble";i.has(l)||(yx(n,e,2,!1),i.add(l))}function Lu(e,n,i){var l=0;n&&(l|=4),yx(i,e,l,n)}var w0="_reactListening"+Math.random().toString(36).slice(2);function Vu(e){if(!e[w0]){e[w0]=!0,vs.forEach(function(i){i!=="selectionchange"&&(cv.has(i)||Lu(i,!1,e),Lu(i,!0,e))});var n=e.nodeType===9?e:e.ownerDocument;n===null||n[w0]||(n[w0]=!0,Lu("selectionchange",!1,n))}}function yx(e,n,i,l){switch(Fx(n)){case 2:var d=zv;break;case 8:d=Bv;break;default:d=tp}i=d.bind(null,n,i,e),d=void 0,!Fa||n!=="touchstart"&&n!=="touchmove"&&n!=="wheel"||(d=!0),l?d!==void 0?e.addEventListener(n,i,{capture:!0,passive:d}):e.addEventListener(n,i,!0):d!==void 0?e.addEventListener(n,i,{passive:d}):e.addEventListener(n,i,!1)}function Wu(e,n,i,l,d){var f=l;if((n&1)===0&&(n&2)===0&&l!==null)e:for(;;){if(l===null)return;var w=l.tag;if(w===3||w===4){var A=l.stateNode.containerInfo;if(A===d)break;if(w===4)for(w=l.return;w!==null;){var G=w.tag;if((G===3||G===4)&&w.stateNode.containerInfo===d)return;w=w.return}for(;A!==null;){if(w=wa(A),w===null)return;if(G=w.tag,G===5||G===6||G===26||G===27){l=f=w;continue e}A=A.parentNode}}l=l.return}Ee(function(){var ye=f,De=He(i),Fe=[];e:{var we=Aa.get(e);if(we!==void 0){var ke=Rs,Pt=e;switch(e){case"keypress":if($a(i)===0)break e;case"keydown":case"keyup":ke=nm;break;case"focusin":Pt="focus",ke=Pi;break;case"focusout":Pt="blur",ke=Pi;break;case"beforeblur":case"afterblur":ke=Pi;break;case"click":if(i.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ke=Rc;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ke=vd;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ke=W;break;case Xs:case yi:case Ii:ke=wd;break;case En:ke=Se;break;case"scroll":case"scrollend":ke=Oo;break;case"wheel":ke=Qe;break;case"copy":case"cut":case"paste":ke=Nd;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ke=y;break;case"toggle":case"beforetoggle":ke=_t}var Ut=(n&4)!==0,Ja=!Ut&&(e==="scroll"||e==="scrollend"),ce=Ut?we!==null?we+"Capture":null:we;Ut=[];for(var ee=ye,ge;ee!==null;){var Le=ee;if(ge=Le.stateNode,Le=Le.tag,Le!==5&&Le!==26&&Le!==27||ge===null||ce===null||(Le=We(ee,ce),Le!=null&&Ut.push(tc(ee,Le,ge))),Ja)break;ee=ee.return}0<Ut.length&&(we=new ke(we,Pt,null,i,De),Fe.push({event:we,listeners:Ut}))}}if((n&7)===0){e:{if(we=e==="mouseover"||e==="pointerover",ke=e==="mouseout"||e==="pointerout",we&&i!==Ct&&(Pt=i.relatedTarget||i.fromElement)&&(wa(Pt)||Pt[Xe]))break e;if((ke||we)&&(we=De.window===De?De:(we=De.ownerDocument)?we.defaultView||we.parentWindow:window,ke?(Pt=i.relatedTarget||i.toElement,ke=ye,Pt=Pt?wa(Pt):null,Pt!==null&&(Ja=u(Pt),Ut=Pt.tag,Pt!==Ja||Ut!==5&&Ut!==27&&Ut!==6)&&(Pt=null)):(ke=null,Pt=ye),ke!==Pt)){if(Ut=Rc,Le="onMouseLeave",ce="onMouseEnter",ee="mouse",(e==="pointerout"||e==="pointerover")&&(Ut=y,Le="onPointerLeave",ce="onPointerEnter",ee="pointer"),Ja=ke==null?we:ze(ke),ge=Pt==null?we:ze(Pt),we=new Ut(Le,ee+"leave",ke,i,De),we.target=Ja,we.relatedTarget=ge,Le=null,wa(De)===ye&&(Ut=new Ut(ce,ee+"enter",Pt,i,De),Ut.target=ge,Ut.relatedTarget=Ja,Le=Ut),Ja=Le,ke&&Pt)t:{for(Ut=dv,ce=ke,ee=Pt,ge=0,Le=ce;Le;Le=Ut(Le))ge++;Le=0;for(var Lt=ee;Lt;Lt=Ut(Lt))Le++;for(;0<ge-Le;)ce=Ut(ce),ge--;for(;0<Le-ge;)ee=Ut(ee),Le--;for(;ge--;){if(ce===ee||ee!==null&&ce===ee.alternate){Ut=ce;break t}ce=Ut(ce),ee=Ut(ee)}Ut=null}else Ut=null;ke!==null&&bx(Fe,we,ke,Ut,!1),Pt!==null&&Ja!==null&&bx(Fe,Ja,Pt,Ut,!0)}}e:{if(we=ye?ze(ye):window,ke=we.nodeName&&we.nodeName.toLowerCase(),ke==="select"||ke==="input"&&we.type==="file")var Pa=on;else if(yt(we))if(Oa)Pa=Gn;else{Pa=Di;var Ot=wr}else ke=we.nodeName,!ke||ke.toLowerCase()!=="input"||we.type!=="checkbox"&&we.type!=="radio"?ye&&Oe(ye.elementType)&&(Pa=on):Pa=ao;if(Pa&&(Pa=Pa(e,ye))){Ft(Fe,Pa,i,De);break e}Ot&&Ot(e,we,ye),e==="focusout"&&ye&&we.type==="number"&&ye.memoizedProps.value!=null&&li(we,"number",we.value)}switch(Ot=ye?ze(ye):window,e){case"focusin":(yt(Ot)||Ot.contentEditable==="true")&&(bn=Ot,Sa=ye,Ya=null);break;case"focusout":Ya=Sa=bn=null;break;case"mousedown":an=!0;break;case"contextmenu":case"mouseup":case"dragend":an=!1,nn(Fe,i,De);break;case"selectionchange":if(da)break;case"keydown":case"keyup":nn(Fe,i,De)}var ra;if(mt)e:{switch(e){case"compositionstart":var ba="onCompositionStart";break e;case"compositionend":ba="onCompositionEnd";break e;case"compositionupdate":ba="onCompositionUpdate";break e}ba=void 0}else Ca?ka(e,i)&&(ba="onCompositionEnd"):e==="keydown"&&i.keyCode===229&&(ba="onCompositionStart");ba&&(At&&i.locale!=="ko"&&(Ca||ba!=="onCompositionStart"?ba==="onCompositionEnd"&&Ca&&(ra=pa()):(Jt=De,na="value"in Jt?Jt.value:Jt.textContent,Ca=!0)),Ot=N0(ye,ba),0<Ot.length&&(ba=new jr(ba,e,null,i,De),Fe.push({event:ba,listeners:Ot}),ra?ba.data=ra:(ra=La(i),ra!==null&&(ba.data=ra)))),(ra=Bt?Va(e,i):en(e,i))&&(ba=N0(ye,"onBeforeInput"),0<ba.length&&(Ot=new jr("onBeforeInput","beforeinput",null,i,De),Fe.push({event:Ot,listeners:ba}),Ot.data=ra)),rv(Fe,e,ye,i,De)}gx(Fe,n)})}function tc(e,n,i){return{instance:e,listener:n,currentTarget:i}}function N0(e,n){for(var i=n+"Capture",l=[];e!==null;){var d=e,f=d.stateNode;if(d=d.tag,d!==5&&d!==26&&d!==27||f===null||(d=We(e,i),d!=null&&l.unshift(tc(e,d,f)),d=We(e,n),d!=null&&l.push(tc(e,d,f))),e.tag===3)return l;e=e.return}return[]}function dv(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5&&e.tag!==27);return e||null}function bx(e,n,i,l,d){for(var f=n._reactName,w=[];i!==null&&i!==l;){var A=i,G=A.alternate,ye=A.stateNode;if(A=A.tag,G!==null&&G===l)break;A!==5&&A!==26&&A!==27||ye===null||(G=ye,d?(ye=We(i,f),ye!=null&&w.unshift(tc(i,ye,G))):d||(ye=We(i,f),ye!=null&&w.push(tc(i,ye,G)))),i=i.return}w.length!==0&&e.push({event:n,listeners:w})}var uv=/\r\n?/g,pv=/\u0000|\uFFFD/g;function vx(e){return(typeof e=="string"?e:""+e).replace(uv,`
`).replace(pv,"")}function jx(e,n){return n=vx(n),vx(e)===n}function Qa(e,n,i,l,d,f){switch(i){case"children":typeof l=="string"?n==="body"||n==="textarea"&&l===""||Ds(e,l):(typeof l=="number"||typeof l=="bigint")&&n!=="body"&&Ds(e,""+l);break;case"className":Wn(e,"class",l);break;case"tabIndex":Wn(e,"tabindex",l);break;case"dir":case"role":case"viewBox":case"width":case"height":Wn(e,i,l);break;case"style":Fs(e,l,f);break;case"data":if(n!=="object"){Wn(e,"data",l);break}case"src":case"href":if(l===""&&(n!=="a"||i!=="href")){e.removeAttribute(i);break}if(l==null||typeof l=="function"||typeof l=="symbol"||typeof l=="boolean"){e.removeAttribute(i);break}l=Nt(""+l),e.setAttribute(i,l);break;case"action":case"formAction":if(typeof l=="function"){e.setAttribute(i,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof f=="function"&&(i==="formAction"?(n!=="input"&&Qa(e,n,"name",d.name,d,null),Qa(e,n,"formEncType",d.formEncType,d,null),Qa(e,n,"formMethod",d.formMethod,d,null),Qa(e,n,"formTarget",d.formTarget,d,null)):(Qa(e,n,"encType",d.encType,d,null),Qa(e,n,"method",d.method,d,null),Qa(e,n,"target",d.target,d,null)));if(l==null||typeof l=="symbol"||typeof l=="boolean"){e.removeAttribute(i);break}l=Nt(""+l),e.setAttribute(i,l);break;case"onClick":l!=null&&(e.onclick=st);break;case"onScroll":l!=null&&ma("scroll",e);break;case"onScrollEnd":l!=null&&ma("scrollend",e);break;case"dangerouslySetInnerHTML":if(l!=null){if(typeof l!="object"||!("__html"in l))throw Error(o(61));if(i=l.__html,i!=null){if(d.children!=null)throw Error(o(60));e.innerHTML=i}}break;case"multiple":e.multiple=l&&typeof l!="function"&&typeof l!="symbol";break;case"muted":e.muted=l&&typeof l!="function"&&typeof l!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(l==null||typeof l=="function"||typeof l=="boolean"||typeof l=="symbol"){e.removeAttribute("xlink:href");break}i=Nt(""+l),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",i);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":l!=null&&typeof l!="function"&&typeof l!="symbol"?e.setAttribute(i,""+l):e.removeAttribute(i);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":l&&typeof l!="function"&&typeof l!="symbol"?e.setAttribute(i,""):e.removeAttribute(i);break;case"capture":case"download":l===!0?e.setAttribute(i,""):l!==!1&&l!=null&&typeof l!="function"&&typeof l!="symbol"?e.setAttribute(i,l):e.removeAttribute(i);break;case"cols":case"rows":case"size":case"span":l!=null&&typeof l!="function"&&typeof l!="symbol"&&!isNaN(l)&&1<=l?e.setAttribute(i,l):e.removeAttribute(i);break;case"rowSpan":case"start":l==null||typeof l=="function"||typeof l=="symbol"||isNaN(l)?e.removeAttribute(i):e.setAttribute(i,l);break;case"popover":ma("beforetoggle",e),ma("toggle",e),Si(e,"popover",l);break;case"xlinkActuate":fs(e,"http://www.w3.org/1999/xlink","xlink:actuate",l);break;case"xlinkArcrole":fs(e,"http://www.w3.org/1999/xlink","xlink:arcrole",l);break;case"xlinkRole":fs(e,"http://www.w3.org/1999/xlink","xlink:role",l);break;case"xlinkShow":fs(e,"http://www.w3.org/1999/xlink","xlink:show",l);break;case"xlinkTitle":fs(e,"http://www.w3.org/1999/xlink","xlink:title",l);break;case"xlinkType":fs(e,"http://www.w3.org/1999/xlink","xlink:type",l);break;case"xmlBase":fs(e,"http://www.w3.org/XML/1998/namespace","xml:base",l);break;case"xmlLang":fs(e,"http://www.w3.org/XML/1998/namespace","xml:lang",l);break;case"xmlSpace":fs(e,"http://www.w3.org/XML/1998/namespace","xml:space",l);break;case"is":Si(e,"is",l);break;case"innerText":case"textContent":break;default:(!(2<i.length)||i[0]!=="o"&&i[0]!=="O"||i[1]!=="n"&&i[1]!=="N")&&(i=Ge.get(i)||i,Si(e,i,l))}}function Uu(e,n,i,l,d,f){switch(i){case"style":Fs(e,l,f);break;case"dangerouslySetInnerHTML":if(l!=null){if(typeof l!="object"||!("__html"in l))throw Error(o(61));if(i=l.__html,i!=null){if(d.children!=null)throw Error(o(60));e.innerHTML=i}}break;case"children":typeof l=="string"?Ds(e,l):(typeof l=="number"||typeof l=="bigint")&&Ds(e,""+l);break;case"onScroll":l!=null&&ma("scroll",e);break;case"onScrollEnd":l!=null&&ma("scrollend",e);break;case"onClick":l!=null&&(e.onclick=st);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Vn.hasOwnProperty(i))e:{if(i[0]==="o"&&i[1]==="n"&&(d=i.endsWith("Capture"),n=i.slice(2,d?i.length-7:void 0),f=e[it]||null,f=f!=null?f[i]:null,typeof f=="function"&&e.removeEventListener(n,f,d),typeof l=="function")){typeof f!="function"&&f!==null&&(i in e?e[i]=null:e.hasAttribute(i)&&e.removeAttribute(i)),e.addEventListener(n,l,d);break e}i in e?e[i]=l:l===!0?e.setAttribute(i,""):Si(e,i,l)}}}function Ts(e,n,i){switch(n){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":ma("error",e),ma("load",e);var l=!1,d=!1,f;for(f in i)if(i.hasOwnProperty(f)){var w=i[f];if(w!=null)switch(f){case"src":l=!0;break;case"srcSet":d=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(o(137,n));default:Qa(e,n,f,w,i,null)}}d&&Qa(e,n,"srcSet",i.srcSet,i,null),l&&Qa(e,n,"src",i.src,i,null);return;case"input":ma("invalid",e);var A=f=w=d=null,G=null,ye=null;for(l in i)if(i.hasOwnProperty(l)){var De=i[l];if(De!=null)switch(l){case"name":d=De;break;case"type":w=De;break;case"checked":G=De;break;case"defaultChecked":ye=De;break;case"value":f=De;break;case"defaultValue":A=De;break;case"children":case"dangerouslySetInnerHTML":if(De!=null)throw Error(o(137,n));break;default:Qa(e,n,l,De,i,null)}}Wi(e,f,A,G,ye,w,d,!1);return;case"select":ma("invalid",e),l=w=f=null;for(d in i)if(i.hasOwnProperty(d)&&(A=i[d],A!=null))switch(d){case"value":f=A;break;case"defaultValue":w=A;break;case"multiple":l=A;default:Qa(e,n,d,A,i,null)}n=f,i=w,e.multiple=!!l,n!=null?ws(e,!!l,n,!1):i!=null&&ws(e,!!l,i,!0);return;case"textarea":ma("invalid",e),f=d=l=null;for(w in i)if(i.hasOwnProperty(w)&&(A=i[w],A!=null))switch(w){case"value":l=A;break;case"defaultValue":d=A;break;case"children":f=A;break;case"dangerouslySetInnerHTML":if(A!=null)throw Error(o(91));break;default:Qa(e,n,w,A,i,null)}Gs(e,l,d,f);return;case"option":for(G in i)if(i.hasOwnProperty(G)&&(l=i[G],l!=null))switch(G){case"selected":e.selected=l&&typeof l!="function"&&typeof l!="symbol";break;default:Qa(e,n,G,l,i,null)}return;case"dialog":ma("beforetoggle",e),ma("toggle",e),ma("cancel",e),ma("close",e);break;case"iframe":case"object":ma("load",e);break;case"video":case"audio":for(l=0;l<ec.length;l++)ma(ec[l],e);break;case"image":ma("error",e),ma("load",e);break;case"details":ma("toggle",e);break;case"embed":case"source":case"link":ma("error",e),ma("load",e);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(ye in i)if(i.hasOwnProperty(ye)&&(l=i[ye],l!=null))switch(ye){case"children":case"dangerouslySetInnerHTML":throw Error(o(137,n));default:Qa(e,n,ye,l,i,null)}return;default:if(Oe(n)){for(De in i)i.hasOwnProperty(De)&&(l=i[De],l!==void 0&&Uu(e,n,De,l,i,void 0));return}}for(A in i)i.hasOwnProperty(A)&&(l=i[A],l!=null&&Qa(e,n,A,l,i,null))}function fv(e,n,i,l){switch(n){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var d=null,f=null,w=null,A=null,G=null,ye=null,De=null;for(ke in i){var Fe=i[ke];if(i.hasOwnProperty(ke)&&Fe!=null)switch(ke){case"checked":break;case"value":break;case"defaultValue":G=Fe;default:l.hasOwnProperty(ke)||Qa(e,n,ke,null,l,Fe)}}for(var we in l){var ke=l[we];if(Fe=i[we],l.hasOwnProperty(we)&&(ke!=null||Fe!=null))switch(we){case"type":f=ke;break;case"name":d=ke;break;case"checked":ye=ke;break;case"defaultChecked":De=ke;break;case"value":w=ke;break;case"defaultValue":A=ke;break;case"children":case"dangerouslySetInnerHTML":if(ke!=null)throw Error(o(137,n));break;default:ke!==Fe&&Qa(e,n,we,ke,l,Fe)}}xi(e,w,A,G,ye,De,f,d);return;case"select":ke=w=A=we=null;for(f in i)if(G=i[f],i.hasOwnProperty(f)&&G!=null)switch(f){case"value":break;case"multiple":ke=G;default:l.hasOwnProperty(f)||Qa(e,n,f,null,l,G)}for(d in l)if(f=l[d],G=i[d],l.hasOwnProperty(d)&&(f!=null||G!=null))switch(d){case"value":we=f;break;case"defaultValue":A=f;break;case"multiple":w=f;default:f!==G&&Qa(e,n,d,f,l,G)}n=A,i=w,l=ke,we!=null?ws(e,!!i,we,!1):!!l!=!!i&&(n!=null?ws(e,!!i,n,!0):ws(e,!!i,i?[]:"",!1));return;case"textarea":ke=we=null;for(A in i)if(d=i[A],i.hasOwnProperty(A)&&d!=null&&!l.hasOwnProperty(A))switch(A){case"value":break;case"children":break;default:Qa(e,n,A,null,l,d)}for(w in l)if(d=l[w],f=i[w],l.hasOwnProperty(w)&&(d!=null||f!=null))switch(w){case"value":we=d;break;case"defaultValue":ke=d;break;case"children":break;case"dangerouslySetInnerHTML":if(d!=null)throw Error(o(91));break;default:d!==f&&Qa(e,n,w,d,l,f)}Ui(e,we,ke);return;case"option":for(var Pt in i)if(we=i[Pt],i.hasOwnProperty(Pt)&&we!=null&&!l.hasOwnProperty(Pt))switch(Pt){case"selected":e.selected=!1;break;default:Qa(e,n,Pt,null,l,we)}for(G in l)if(we=l[G],ke=i[G],l.hasOwnProperty(G)&&we!==ke&&(we!=null||ke!=null))switch(G){case"selected":e.selected=we&&typeof we!="function"&&typeof we!="symbol";break;default:Qa(e,n,G,we,l,ke)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Ut in i)we=i[Ut],i.hasOwnProperty(Ut)&&we!=null&&!l.hasOwnProperty(Ut)&&Qa(e,n,Ut,null,l,we);for(ye in l)if(we=l[ye],ke=i[ye],l.hasOwnProperty(ye)&&we!==ke&&(we!=null||ke!=null))switch(ye){case"children":case"dangerouslySetInnerHTML":if(we!=null)throw Error(o(137,n));break;default:Qa(e,n,ye,we,l,ke)}return;default:if(Oe(n)){for(var Ja in i)we=i[Ja],i.hasOwnProperty(Ja)&&we!==void 0&&!l.hasOwnProperty(Ja)&&Uu(e,n,Ja,void 0,l,we);for(De in l)we=l[De],ke=i[De],!l.hasOwnProperty(De)||we===ke||we===void 0&&ke===void 0||Uu(e,n,De,we,l,ke);return}}for(var ce in i)we=i[ce],i.hasOwnProperty(ce)&&we!=null&&!l.hasOwnProperty(ce)&&Qa(e,n,ce,null,l,we);for(Fe in l)we=l[Fe],ke=i[Fe],!l.hasOwnProperty(Fe)||we===ke||we==null&&ke==null||Qa(e,n,Fe,we,l,ke)}function wx(e){switch(e){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function mv(){if(typeof performance.getEntriesByType=="function"){for(var e=0,n=0,i=performance.getEntriesByType("resource"),l=0;l<i.length;l++){var d=i[l],f=d.transferSize,w=d.initiatorType,A=d.duration;if(f&&A&&wx(w)){for(w=0,A=d.responseEnd,l+=1;l<i.length;l++){var G=i[l],ye=G.startTime;if(ye>A)break;var De=G.transferSize,Fe=G.initiatorType;De&&wx(Fe)&&(G=G.responseEnd,w+=De*(G<A?1:(A-ye)/(G-ye)))}if(--l,n+=8*(f+w)/(d.duration/1e3),e++,10<e)break}}if(0<e)return n/e/1e6}return navigator.connection&&(e=navigator.connection.downlink,typeof e=="number")?e:5}var Iu=null,Hu=null;function M0(e){return e.nodeType===9?e:e.ownerDocument}function Nx(e){switch(e){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Mx(e,n){if(e===0)switch(n){case"svg":return 1;case"math":return 2;default:return 0}return e===1&&n==="foreignObject"?0:e}function qu(e,n){return e==="textarea"||e==="noscript"||typeof n.children=="string"||typeof n.children=="number"||typeof n.children=="bigint"||typeof n.dangerouslySetInnerHTML=="object"&&n.dangerouslySetInnerHTML!==null&&n.dangerouslySetInnerHTML.__html!=null}var Gu=null;function hv(){var e=window.event;return e&&e.type==="popstate"?e===Gu?!1:(Gu=e,!0):(Gu=null,!1)}var _x=typeof setTimeout=="function"?setTimeout:void 0,xv=typeof clearTimeout=="function"?clearTimeout:void 0,Ex=typeof Promise=="function"?Promise:void 0,gv=typeof queueMicrotask=="function"?queueMicrotask:typeof Ex<"u"?function(e){return Ex.resolve(null).then(e).catch(yv)}:_x;function yv(e){setTimeout(function(){throw e})}function Br(e){return e==="head"}function kx(e,n){var i=n,l=0;do{var d=i.nextSibling;if(e.removeChild(i),d&&d.nodeType===8)if(i=d.data,i==="/$"||i==="/&"){if(l===0){e.removeChild(d),ll(n);return}l--}else if(i==="$"||i==="$?"||i==="$~"||i==="$!"||i==="&")l++;else if(i==="html")ac(e.ownerDocument.documentElement);else if(i==="head"){i=e.ownerDocument.head,ac(i);for(var f=i.firstChild;f;){var w=f.nextSibling,A=f.nodeName;f[ua]||A==="SCRIPT"||A==="STYLE"||A==="LINK"&&f.rel.toLowerCase()==="stylesheet"||i.removeChild(f),f=w}}else i==="body"&&ac(e.ownerDocument.body);i=d}while(i);ll(n)}function Cx(e,n){var i=e;e=0;do{var l=i.nextSibling;if(i.nodeType===1?n?(i._stashedDisplay=i.style.display,i.style.display="none"):(i.style.display=i._stashedDisplay||"",i.getAttribute("style")===""&&i.removeAttribute("style")):i.nodeType===3&&(n?(i._stashedText=i.nodeValue,i.nodeValue=""):i.nodeValue=i._stashedText||""),l&&l.nodeType===8)if(i=l.data,i==="/$"){if(e===0)break;e--}else i!=="$"&&i!=="$?"&&i!=="$~"&&i!=="$!"||e++;i=l}while(i)}function Fu(e){var n=e.firstChild;for(n&&n.nodeType===10&&(n=n.nextSibling);n;){var i=n;switch(n=n.nextSibling,i.nodeName){case"HTML":case"HEAD":case"BODY":Fu(i),An(i);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(i.rel.toLowerCase()==="stylesheet")continue}e.removeChild(i)}}function bv(e,n,i,l){for(;e.nodeType===1;){var d=i;if(e.nodeName.toLowerCase()!==n.toLowerCase()){if(!l&&(e.nodeName!=="INPUT"||e.type!=="hidden"))break}else if(l){if(!e[ua])switch(n){case"meta":if(!e.hasAttribute("itemprop"))break;return e;case"link":if(f=e.getAttribute("rel"),f==="stylesheet"&&e.hasAttribute("data-precedence"))break;if(f!==d.rel||e.getAttribute("href")!==(d.href==null||d.href===""?null:d.href)||e.getAttribute("crossorigin")!==(d.crossOrigin==null?null:d.crossOrigin)||e.getAttribute("title")!==(d.title==null?null:d.title))break;return e;case"style":if(e.hasAttribute("data-precedence"))break;return e;case"script":if(f=e.getAttribute("src"),(f!==(d.src==null?null:d.src)||e.getAttribute("type")!==(d.type==null?null:d.type)||e.getAttribute("crossorigin")!==(d.crossOrigin==null?null:d.crossOrigin))&&f&&e.hasAttribute("async")&&!e.hasAttribute("itemprop"))break;return e;default:return e}}else if(n==="input"&&e.type==="hidden"){var f=d.name==null?null:""+d.name;if(d.type==="hidden"&&e.getAttribute("name")===f)return e}else return e;if(e=Ni(e.nextSibling),e===null)break}return null}function vv(e,n,i){if(n==="")return null;for(;e.nodeType!==3;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!i||(e=Ni(e.nextSibling),e===null))return null;return e}function Tx(e,n){for(;e.nodeType!==8;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!n||(e=Ni(e.nextSibling),e===null))return null;return e}function Yu(e){return e.data==="$?"||e.data==="$~"}function Xu(e){return e.data==="$!"||e.data==="$?"&&e.ownerDocument.readyState!=="loading"}function jv(e,n){var i=e.ownerDocument;if(e.data==="$~")e._reactRetry=n;else if(e.data!=="$?"||i.readyState!=="loading")n();else{var l=function(){n(),i.removeEventListener("DOMContentLoaded",l)};i.addEventListener("DOMContentLoaded",l),e._reactRetry=l}}function Ni(e){for(;e!=null;e=e.nextSibling){var n=e.nodeType;if(n===1||n===3)break;if(n===8){if(n=e.data,n==="$"||n==="$!"||n==="$?"||n==="$~"||n==="&"||n==="F!"||n==="F")break;if(n==="/$"||n==="/&")return null}}return e}var Zu=null;function Sx(e){e=e.nextSibling;for(var n=0;e;){if(e.nodeType===8){var i=e.data;if(i==="/$"||i==="/&"){if(n===0)return Ni(e.nextSibling);n--}else i!=="$"&&i!=="$!"&&i!=="$?"&&i!=="$~"&&i!=="&"||n++}e=e.nextSibling}return null}function Ax(e){e=e.previousSibling;for(var n=0;e;){if(e.nodeType===8){var i=e.data;if(i==="$"||i==="$!"||i==="$?"||i==="$~"||i==="&"){if(n===0)return e;n--}else i!=="/$"&&i!=="/&"||n++}e=e.previousSibling}return null}function Px(e,n,i){switch(n=M0(i),e){case"html":if(e=n.documentElement,!e)throw Error(o(452));return e;case"head":if(e=n.head,!e)throw Error(o(453));return e;case"body":if(e=n.body,!e)throw Error(o(454));return e;default:throw Error(o(451))}}function ac(e){for(var n=e.attributes;n.length;)e.removeAttributeNode(n[0]);An(e)}var Mi=new Map,Dx=new Set;function _0(e){return typeof e.getRootNode=="function"?e.getRootNode():e.nodeType===9?e:e.ownerDocument}var fr=z.d;z.d={f:wv,r:Nv,D:Mv,C:_v,L:Ev,m:kv,X:Tv,S:Cv,M:Sv};function wv(){var e=fr.f(),n=x0();return e||n}function Nv(e){var n=Na(e);n!==null&&n.tag===5&&n.type==="form"?Zm(n):fr.r(e)}var il=typeof document>"u"?null:document;function Rx(e,n,i){var l=il;if(l&&typeof n=="string"&&n){var d=Dn(n);d='link[rel="'+e+'"][href="'+d+'"]',typeof i=="string"&&(d+='[crossorigin="'+i+'"]'),Dx.has(d)||(Dx.add(d),e={rel:e,crossOrigin:i,href:n},l.querySelector(d)===null&&(n=l.createElement("link"),Ts(n,"link",e),ja(n),l.head.appendChild(n)))}}function Mv(e){fr.D(e),Rx("dns-prefetch",e,null)}function _v(e,n){fr.C(e,n),Rx("preconnect",e,n)}function Ev(e,n,i){fr.L(e,n,i);var l=il;if(l&&e&&n){var d='link[rel="preload"][as="'+Dn(n)+'"]';n==="image"&&i&&i.imageSrcSet?(d+='[imagesrcset="'+Dn(i.imageSrcSet)+'"]',typeof i.imageSizes=="string"&&(d+='[imagesizes="'+Dn(i.imageSizes)+'"]')):d+='[href="'+Dn(e)+'"]';var f=d;switch(n){case"style":f=rl(e);break;case"script":f=ol(e)}Mi.has(f)||(e=b({rel:"preload",href:n==="image"&&i&&i.imageSrcSet?void 0:e,as:n},i),Mi.set(f,e),l.querySelector(d)!==null||n==="style"&&l.querySelector(nc(f))||n==="script"&&l.querySelector(sc(f))||(n=l.createElement("link"),Ts(n,"link",e),ja(n),l.head.appendChild(n)))}}function kv(e,n){fr.m(e,n);var i=il;if(i&&e){var l=n&&typeof n.as=="string"?n.as:"script",d='link[rel="modulepreload"][as="'+Dn(l)+'"][href="'+Dn(e)+'"]',f=d;switch(l){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":f=ol(e)}if(!Mi.has(f)&&(e=b({rel:"modulepreload",href:e},n),Mi.set(f,e),i.querySelector(d)===null)){switch(l){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(i.querySelector(sc(f)))return}l=i.createElement("link"),Ts(l,"link",e),ja(l),i.head.appendChild(l)}}}function Cv(e,n,i){fr.S(e,n,i);var l=il;if(l&&e){var d=Pn(l).hoistableStyles,f=rl(e);n=n||"default";var w=d.get(f);if(!w){var A={loading:0,preload:null};if(w=l.querySelector(nc(f)))A.loading=5;else{e=b({rel:"stylesheet",href:e,"data-precedence":n},i),(i=Mi.get(f))&&Qu(e,i);var G=w=l.createElement("link");ja(G),Ts(G,"link",e),G._p=new Promise(function(ye,De){G.onload=ye,G.onerror=De}),G.addEventListener("load",function(){A.loading|=1}),G.addEventListener("error",function(){A.loading|=2}),A.loading|=4,E0(w,n,l)}w={type:"stylesheet",instance:w,count:1,state:A},d.set(f,w)}}}function Tv(e,n){fr.X(e,n);var i=il;if(i&&e){var l=Pn(i).hoistableScripts,d=ol(e),f=l.get(d);f||(f=i.querySelector(sc(d)),f||(e=b({src:e,async:!0},n),(n=Mi.get(d))&&Ju(e,n),f=i.createElement("script"),ja(f),Ts(f,"link",e),i.head.appendChild(f)),f={type:"script",instance:f,count:1,state:null},l.set(d,f))}}function Sv(e,n){fr.M(e,n);var i=il;if(i&&e){var l=Pn(i).hoistableScripts,d=ol(e),f=l.get(d);f||(f=i.querySelector(sc(d)),f||(e=b({src:e,async:!0,type:"module"},n),(n=Mi.get(d))&&Ju(e,n),f=i.createElement("script"),ja(f),Ts(f,"link",e),i.head.appendChild(f)),f={type:"script",instance:f,count:1,state:null},l.set(d,f))}}function $x(e,n,i,l){var d=(d=me.current)?_0(d):null;if(!d)throw Error(o(446));switch(e){case"meta":case"title":return null;case"style":return typeof i.precedence=="string"&&typeof i.href=="string"?(n=rl(i.href),i=Pn(d).hoistableStyles,l=i.get(n),l||(l={type:"style",instance:null,count:0,state:null},i.set(n,l)),l):{type:"void",instance:null,count:0,state:null};case"link":if(i.rel==="stylesheet"&&typeof i.href=="string"&&typeof i.precedence=="string"){e=rl(i.href);var f=Pn(d).hoistableStyles,w=f.get(e);if(w||(d=d.ownerDocument||d,w={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},f.set(e,w),(f=d.querySelector(nc(e)))&&!f._p&&(w.instance=f,w.state.loading=5),Mi.has(e)||(i={rel:"preload",as:"style",href:i.href,crossOrigin:i.crossOrigin,integrity:i.integrity,media:i.media,hrefLang:i.hrefLang,referrerPolicy:i.referrerPolicy},Mi.set(e,i),f||Av(d,e,i,w.state))),n&&l===null)throw Error(o(528,""));return w}if(n&&l!==null)throw Error(o(529,""));return null;case"script":return n=i.async,i=i.src,typeof i=="string"&&n&&typeof n!="function"&&typeof n!="symbol"?(n=ol(i),i=Pn(d).hoistableScripts,l=i.get(n),l||(l={type:"script",instance:null,count:0,state:null},i.set(n,l)),l):{type:"void",instance:null,count:0,state:null};default:throw Error(o(444,e))}}function rl(e){return'href="'+Dn(e)+'"'}function nc(e){return'link[rel="stylesheet"]['+e+"]"}function Ox(e){return b({},e,{"data-precedence":e.precedence,precedence:null})}function Av(e,n,i,l){e.querySelector('link[rel="preload"][as="style"]['+n+"]")?l.loading=1:(n=e.createElement("link"),l.preload=n,n.addEventListener("load",function(){return l.loading|=1}),n.addEventListener("error",function(){return l.loading|=2}),Ts(n,"link",i),ja(n),e.head.appendChild(n))}function ol(e){return'[src="'+Dn(e)+'"]'}function sc(e){return"script[async]"+e}function zx(e,n,i){if(n.count++,n.instance===null)switch(n.type){case"style":var l=e.querySelector('style[data-href~="'+Dn(i.href)+'"]');if(l)return n.instance=l,ja(l),l;var d=b({},i,{"data-href":i.href,"data-precedence":i.precedence,href:null,precedence:null});return l=(e.ownerDocument||e).createElement("style"),ja(l),Ts(l,"style",d),E0(l,i.precedence,e),n.instance=l;case"stylesheet":d=rl(i.href);var f=e.querySelector(nc(d));if(f)return n.state.loading|=4,n.instance=f,ja(f),f;l=Ox(i),(d=Mi.get(d))&&Qu(l,d),f=(e.ownerDocument||e).createElement("link"),ja(f);var w=f;return w._p=new Promise(function(A,G){w.onload=A,w.onerror=G}),Ts(f,"link",l),n.state.loading|=4,E0(f,i.precedence,e),n.instance=f;case"script":return f=ol(i.src),(d=e.querySelector(sc(f)))?(n.instance=d,ja(d),d):(l=i,(d=Mi.get(f))&&(l=b({},i),Ju(l,d)),e=e.ownerDocument||e,d=e.createElement("script"),ja(d),Ts(d,"link",l),e.head.appendChild(d),n.instance=d);case"void":return null;default:throw Error(o(443,n.type))}else n.type==="stylesheet"&&(n.state.loading&4)===0&&(l=n.instance,n.state.loading|=4,E0(l,i.precedence,e));return n.instance}function E0(e,n,i){for(var l=i.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),d=l.length?l[l.length-1]:null,f=d,w=0;w<l.length;w++){var A=l[w];if(A.dataset.precedence===n)f=A;else if(f!==d)break}f?f.parentNode.insertBefore(e,f.nextSibling):(n=i.nodeType===9?i.head:i,n.insertBefore(e,n.firstChild))}function Qu(e,n){e.crossOrigin==null&&(e.crossOrigin=n.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=n.referrerPolicy),e.title==null&&(e.title=n.title)}function Ju(e,n){e.crossOrigin==null&&(e.crossOrigin=n.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=n.referrerPolicy),e.integrity==null&&(e.integrity=n.integrity)}var k0=null;function Bx(e,n,i){if(k0===null){var l=new Map,d=k0=new Map;d.set(i,l)}else d=k0,l=d.get(i),l||(l=new Map,d.set(i,l));if(l.has(e))return l;for(l.set(e,null),i=i.getElementsByTagName(e),d=0;d<i.length;d++){var f=i[d];if(!(f[ua]||f[Ae]||e==="link"&&f.getAttribute("rel")==="stylesheet")&&f.namespaceURI!=="http://www.w3.org/2000/svg"){var w=f.getAttribute(n)||"";w=e+w;var A=l.get(w);A?A.push(f):l.set(w,[f])}}return l}function Lx(e,n,i){e=e.ownerDocument||e,e.head.insertBefore(i,n==="title"?e.querySelector("head > title"):null)}function Pv(e,n,i){if(i===1||n.itemProp!=null)return!1;switch(e){case"meta":case"title":return!0;case"style":if(typeof n.precedence!="string"||typeof n.href!="string"||n.href==="")break;return!0;case"link":if(typeof n.rel!="string"||typeof n.href!="string"||n.href===""||n.onLoad||n.onError)break;switch(n.rel){case"stylesheet":return e=n.disabled,typeof n.precedence=="string"&&e==null;default:return!0}case"script":if(n.async&&typeof n.async!="function"&&typeof n.async!="symbol"&&!n.onLoad&&!n.onError&&n.src&&typeof n.src=="string")return!0}return!1}function Vx(e){return!(e.type==="stylesheet"&&(e.state.loading&3)===0)}function Dv(e,n,i,l){if(i.type==="stylesheet"&&(typeof l.media!="string"||matchMedia(l.media).matches!==!1)&&(i.state.loading&4)===0){if(i.instance===null){var d=rl(l.href),f=n.querySelector(nc(d));if(f){n=f._p,n!==null&&typeof n=="object"&&typeof n.then=="function"&&(e.count++,e=C0.bind(e),n.then(e,e)),i.state.loading|=4,i.instance=f,ja(f);return}f=n.ownerDocument||n,l=Ox(l),(d=Mi.get(d))&&Qu(l,d),f=f.createElement("link"),ja(f);var w=f;w._p=new Promise(function(A,G){w.onload=A,w.onerror=G}),Ts(f,"link",l),i.instance=f}e.stylesheets===null&&(e.stylesheets=new Map),e.stylesheets.set(i,n),(n=i.state.preload)&&(i.state.loading&3)===0&&(e.count++,i=C0.bind(e),n.addEventListener("load",i),n.addEventListener("error",i))}}var Ku=0;function Rv(e,n){return e.stylesheets&&e.count===0&&S0(e,e.stylesheets),0<e.count||0<e.imgCount?function(i){var l=setTimeout(function(){if(e.stylesheets&&S0(e,e.stylesheets),e.unsuspend){var f=e.unsuspend;e.unsuspend=null,f()}},6e4+n);0<e.imgBytes&&Ku===0&&(Ku=62500*mv());var d=setTimeout(function(){if(e.waitingForImages=!1,e.count===0&&(e.stylesheets&&S0(e,e.stylesheets),e.unsuspend)){var f=e.unsuspend;e.unsuspend=null,f()}},(e.imgBytes>Ku?50:800)+n);return e.unsuspend=i,function(){e.unsuspend=null,clearTimeout(l),clearTimeout(d)}}:null}function C0(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)S0(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}}var T0=null;function S0(e,n){e.stylesheets=null,e.unsuspend!==null&&(e.count++,T0=new Map,n.forEach($v,e),T0=null,C0.call(e))}function $v(e,n){if(!(n.state.loading&4)){var i=T0.get(e);if(i)var l=i.get(null);else{i=new Map,T0.set(e,i);for(var d=e.querySelectorAll("link[data-precedence],style[data-precedence]"),f=0;f<d.length;f++){var w=d[f];(w.nodeName==="LINK"||w.getAttribute("media")!=="not all")&&(i.set(w.dataset.precedence,w),l=w)}l&&i.set(null,l)}d=n.instance,w=d.getAttribute("data-precedence"),f=i.get(w)||l,f===l&&i.set(null,d),i.set(w,d),this.count++,l=C0.bind(this),d.addEventListener("load",l),d.addEventListener("error",l),f?f.parentNode.insertBefore(d,f.nextSibling):(e=e.nodeType===9?e.head:e,e.insertBefore(d,e.firstChild)),n.state.loading|=4}}var ic={$$typeof:D,Provider:null,Consumer:null,_currentValue:V,_currentValue2:V,_threadCount:0};function Ov(e,n,i,l,d,f,w,A,G){this.tag=1,this.containerInfo=e,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Ze(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ze(0),this.hiddenUpdates=Ze(null),this.identifierPrefix=l,this.onUncaughtError=d,this.onCaughtError=f,this.onRecoverableError=w,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=G,this.incompleteTransitions=new Map}function Wx(e,n,i,l,d,f,w,A,G,ye,De,Fe){return e=new Ov(e,n,i,w,G,ye,De,Fe,A),n=1,f===!0&&(n|=24),f=Ua(3,null,null,n),e.current=f,f.stateNode=e,n=Pd(),n.refCount++,e.pooledCache=n,n.refCount++,f.memoizedState={element:l,isDehydrated:i,cache:n},Od(f),e}function Ux(e){return e?(e=kn,e):kn}function Ix(e,n,i,l,d,f){d=Ux(d),l.context===null?l.context=d:l.pendingContext=d,l=kr(n),l.payload={element:i},f=f===void 0?null:f,f!==null&&(l.callback=f),i=Cr(e,l,n),i!==null&&(ai(i,e,n),zl(i,e,n))}function Hx(e,n){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var i=e.retryLane;e.retryLane=i!==0&&i<n?i:n}}function ep(e,n){Hx(e,n),(e=e.alternate)&&Hx(e,n)}function qx(e){if(e.tag===13||e.tag===31){var n=Zs(e,67108864);n!==null&&ai(n,e,67108864),ep(e,67108864)}}function Gx(e){if(e.tag===13||e.tag===31){var n=fi();n=ha(n);var i=Zs(e,n);i!==null&&ai(i,e,n),ep(e,n)}}var A0=!0;function zv(e,n,i,l){var d=P.T;P.T=null;var f=z.p;try{z.p=2,tp(e,n,i,l)}finally{z.p=f,P.T=d}}function Bv(e,n,i,l){var d=P.T;P.T=null;var f=z.p;try{z.p=8,tp(e,n,i,l)}finally{z.p=f,P.T=d}}function tp(e,n,i,l){if(A0){var d=ap(l);if(d===null)Wu(e,n,l,P0,i),Yx(e,l);else if(Vv(d,e,n,i,l))l.stopPropagation();else if(Yx(e,l),n&4&&-1<Lv.indexOf(e)){for(;d!==null;){var f=Na(d);if(f!==null)switch(f.tag){case 3:if(f=f.stateNode,f.current.memoizedState.isDehydrated){var w=le(f.pendingLanes);if(w!==0){var A=f;for(A.pendingLanes|=2,A.entangledLanes|=2;w;){var G=1<<31-Ht(w);A.entanglements[1]|=G,w&=~G}Fi(f),(Ba&6)===0&&(m0=Pe()+500,Kl(0))}}break;case 31:case 13:A=Zs(f,2),A!==null&&ai(A,f,2),x0(),ep(f,2)}if(f=ap(l),f===null&&Wu(e,n,l,P0,i),f===d)break;d=f}d!==null&&l.stopPropagation()}else Wu(e,n,l,null,i)}}function ap(e){return e=He(e),np(e)}var P0=null;function np(e){if(P0=null,e=wa(e),e!==null){var n=u(e);if(n===null)e=null;else{var i=n.tag;if(i===13){if(e=p(n),e!==null)return e;e=null}else if(i===31){if(e=m(n),e!==null)return e;e=null}else if(i===3){if(n.stateNode.current.memoizedState.isDehydrated)return n.tag===3?n.stateNode.containerInfo:null;e=null}else n!==e&&(e=null)}}return P0=e,null}function Fx(e){switch(e){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(lt()){case Vt:return 2;case oa:return 8;case Ka:case gn:return 32;case Zt:return 268435456;default:return 32}default:return 32}}var sp=!1,Lr=null,Vr=null,Wr=null,rc=new Map,oc=new Map,Ur=[],Lv="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Yx(e,n){switch(e){case"focusin":case"focusout":Lr=null;break;case"dragenter":case"dragleave":Vr=null;break;case"mouseover":case"mouseout":Wr=null;break;case"pointerover":case"pointerout":rc.delete(n.pointerId);break;case"gotpointercapture":case"lostpointercapture":oc.delete(n.pointerId)}}function lc(e,n,i,l,d,f){return e===null||e.nativeEvent!==f?(e={blockedOn:n,domEventName:i,eventSystemFlags:l,nativeEvent:f,targetContainers:[d]},n!==null&&(n=Na(n),n!==null&&qx(n)),e):(e.eventSystemFlags|=l,n=e.targetContainers,d!==null&&n.indexOf(d)===-1&&n.push(d),e)}function Vv(e,n,i,l,d){switch(n){case"focusin":return Lr=lc(Lr,e,n,i,l,d),!0;case"dragenter":return Vr=lc(Vr,e,n,i,l,d),!0;case"mouseover":return Wr=lc(Wr,e,n,i,l,d),!0;case"pointerover":var f=d.pointerId;return rc.set(f,lc(rc.get(f)||null,e,n,i,l,d)),!0;case"gotpointercapture":return f=d.pointerId,oc.set(f,lc(oc.get(f)||null,e,n,i,l,d)),!0}return!1}function Xx(e){var n=wa(e.target);if(n!==null){var i=u(n);if(i!==null){if(n=i.tag,n===13){if(n=p(i),n!==null){e.blockedOn=n,Tt(e.priority,function(){Gx(i)});return}}else if(n===31){if(n=m(i),n!==null){e.blockedOn=n,Tt(e.priority,function(){Gx(i)});return}}else if(n===3&&i.stateNode.current.memoizedState.isDehydrated){e.blockedOn=i.tag===3?i.stateNode.containerInfo:null;return}}}e.blockedOn=null}function D0(e){if(e.blockedOn!==null)return!1;for(var n=e.targetContainers;0<n.length;){var i=ap(e.nativeEvent);if(i===null){i=e.nativeEvent;var l=new i.constructor(i.type,i);Ct=l,i.target.dispatchEvent(l),Ct=null}else return n=Na(i),n!==null&&qx(n),e.blockedOn=i,!1;n.shift()}return!0}function Zx(e,n,i){D0(e)&&i.delete(n)}function Wv(){sp=!1,Lr!==null&&D0(Lr)&&(Lr=null),Vr!==null&&D0(Vr)&&(Vr=null),Wr!==null&&D0(Wr)&&(Wr=null),rc.forEach(Zx),oc.forEach(Zx)}function R0(e,n){e.blockedOn===n&&(e.blockedOn=null,sp||(sp=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,Wv)))}var $0=null;function Qx(e){$0!==e&&($0=e,t.unstable_scheduleCallback(t.unstable_NormalPriority,function(){$0===e&&($0=null);for(var n=0;n<e.length;n+=3){var i=e[n],l=e[n+1],d=e[n+2];if(typeof l!="function"){if(np(l||i)===null)continue;break}var f=Na(i);f!==null&&(e.splice(n,3),n-=3,au(f,{pending:!0,data:d,method:i.method,action:l},l,d))}}))}function ll(e){function n(G){return R0(G,e)}Lr!==null&&R0(Lr,e),Vr!==null&&R0(Vr,e),Wr!==null&&R0(Wr,e),rc.forEach(n),oc.forEach(n);for(var i=0;i<Ur.length;i++){var l=Ur[i];l.blockedOn===e&&(l.blockedOn=null)}for(;0<Ur.length&&(i=Ur[0],i.blockedOn===null);)Xx(i),i.blockedOn===null&&Ur.shift();if(i=(e.ownerDocument||e).$$reactFormReplay,i!=null)for(l=0;l<i.length;l+=3){var d=i[l],f=i[l+1],w=d[it]||null;if(typeof f=="function")w||Qx(i);else if(w){var A=null;if(f&&f.hasAttribute("formAction")){if(d=f,w=f[it]||null)A=w.formAction;else if(np(d)!==null)continue}else A=w.action;typeof A=="function"?i[l+1]=A:(i.splice(l,3),l-=3),Qx(i)}}}function Jx(){function e(f){f.canIntercept&&f.info==="react-transition"&&f.intercept({handler:function(){return new Promise(function(w){return d=w})},focusReset:"manual",scroll:"manual"})}function n(){d!==null&&(d(),d=null),l||setTimeout(i,20)}function i(){if(!l&&!navigation.transition){var f=navigation.currentEntry;f&&f.url!=null&&navigation.navigate(f.url,{state:f.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var l=!1,d=null;return navigation.addEventListener("navigate",e),navigation.addEventListener("navigatesuccess",n),navigation.addEventListener("navigateerror",n),setTimeout(i,100),function(){l=!0,navigation.removeEventListener("navigate",e),navigation.removeEventListener("navigatesuccess",n),navigation.removeEventListener("navigateerror",n),d!==null&&(d(),d=null)}}}function ip(e){this._internalRoot=e}O0.prototype.render=ip.prototype.render=function(e){var n=this._internalRoot;if(n===null)throw Error(o(409));var i=n.current,l=fi();Ix(i,l,e,n,null,null)},O0.prototype.unmount=ip.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var n=e.containerInfo;Ix(e.current,2,null,e,null,null),x0(),n[Xe]=null}};function O0(e){this._internalRoot=e}O0.prototype.unstable_scheduleHydration=function(e){if(e){var n=xe();e={blockedOn:null,target:e,priority:n};for(var i=0;i<Ur.length&&n!==0&&n<Ur[i].priority;i++);Ur.splice(i,0,e),i===0&&Xx(e)}};var Kx=s.version;if(Kx!=="19.2.0")throw Error(o(527,Kx,"19.2.0"));z.findDOMNode=function(e){var n=e._reactInternals;if(n===void 0)throw typeof e.render=="function"?Error(o(188)):(e=Object.keys(e).join(","),Error(o(268,e)));return e=x(n),e=e!==null?g(e):null,e=e===null?null:e.stateNode,e};var Uv={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:P,reconcilerVersion:"19.2.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var z0=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!z0.isDisabled&&z0.supportsFiber)try{Gt=z0.inject(Uv),kt=z0}catch{}}return dc.createRoot=function(e,n){if(!c(e))throw Error(o(299));var i=!1,l="",d=rh,f=oh,w=lh;return n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(l=n.identifierPrefix),n.onUncaughtError!==void 0&&(d=n.onUncaughtError),n.onCaughtError!==void 0&&(f=n.onCaughtError),n.onRecoverableError!==void 0&&(w=n.onRecoverableError)),n=Wx(e,1,!1,null,null,i,l,null,d,f,w,Jx),e[Xe]=n.current,Vu(e),new ip(n)},dc.hydrateRoot=function(e,n,i){if(!c(e))throw Error(o(299));var l=!1,d="",f=rh,w=oh,A=lh,G=null;return i!=null&&(i.unstable_strictMode===!0&&(l=!0),i.identifierPrefix!==void 0&&(d=i.identifierPrefix),i.onUncaughtError!==void 0&&(f=i.onUncaughtError),i.onCaughtError!==void 0&&(w=i.onCaughtError),i.onRecoverableError!==void 0&&(A=i.onRecoverableError),i.formState!==void 0&&(G=i.formState)),n=Wx(e,1,!0,n,i??null,l,d,G,f,w,A,Jx),n.context=Ux(null),i=n.current,l=fi(),l=ha(l),d=kr(l),d.callback=null,Cr(i,d,l),i=l,n.current.lanes=i,Ce(n,i),Fi(n),e[Xe]=n.current,Vu(e),new O0(n)},dc.version="19.2.0",dc}var c1;function Jv(){if(c1)return op.exports;c1=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(s){console.error(s)}}return t(),op.exports=Qv(),op.exports}var Kv=Jv(),$=gf();const Ls=Hv($),e5=[1,2,5],go={price:{livingCostWeight:.15,taxCostWeight:.1},wage:{livingCostWeight:.1,taxCostWeight:.1},market:{virtualDemandPerPop:.01,supplyDemandWeight:1,inventoryTargetDays:200,inventoryPriceImpact:.25,demandElasticity:.5,outputVariation:.2}},Re={food:{name:"",icon:"Wheat",color:"text-yellow-400",basePrice:1.6,minPrice:.16,maxPrice:16,defaultOwner:"peasant",unlockEpoch:0,tags:["essential","raw_material"],marketConfig:{supplyDemandWeight:.6,inventoryTargetDays:300,inventoryPriceImpact:.15,demandElasticity:.2,outputVariation:.2}},wood:{name:"",icon:"Trees",color:"text-emerald-400",basePrice:3.2,minPrice:.32,maxPrice:32,defaultOwner:"lumberjack",unlockEpoch:0,tags:["raw_material"],marketConfig:{supplyDemandWeight:.7,inventoryTargetDays:250,inventoryPriceImpact:.2,demandElasticity:.3,outputVariation:.2}},stone:{name:"",icon:"Pickaxe",color:"text-stone-400",basePrice:4.5,minPrice:.45,maxPrice:45,defaultOwner:"miner",unlockEpoch:0,tags:["raw_material"],marketConfig:{supplyDemandWeight:.7,inventoryTargetDays:250,inventoryPriceImpact:.2,demandElasticity:.3,outputVariation:.2}},cloth:{name:"",icon:"Shirt",color:"text-indigo-300",basePrice:2.5,minPrice:.25,maxPrice:25,defaultOwner:"artisan",unlockEpoch:0,tags:["essential","raw_material","manufactured"],marketConfig:{supplyDemandWeight:.8,inventoryTargetDays:200,inventoryPriceImpact:.25,demandElasticity:.4,outputVariation:.2}},brick:{name:"",icon:"Home",color:"text-red-400",basePrice:9.5,minPrice:.95,maxPrice:95,defaultOwner:"artisan",unlockEpoch:0,unlockTech:"pottery",tags:["industrial"],marketConfig:{supplyDemandWeight:1,inventoryTargetDays:150,inventoryPriceImpact:.3,demandElasticity:.5,outputVariation:.2}},tools:{name:"",icon:"Anvil",color:"text-blue-300",basePrice:12.5,minPrice:1.25,maxPrice:125,defaultOwner:"artisan",unlockEpoch:0,unlockTech:"tool_making",tags:["industrial"],marketConfig:{supplyDemandWeight:1.2,inventoryTargetDays:300,inventoryPriceImpact:.35,demandElasticity:.6,outputVariation:.2}},plank:{name:"",icon:"TreeDeciduous",color:"text-amber-600",basePrice:7.5,minPrice:.75,maxPrice:75,defaultOwner:"worker",unlockEpoch:1,unlockTech:"tools",tags:["industrial"],marketConfig:{supplyDemandWeight:1,inventoryTargetDays:150,inventoryPriceImpact:.3,demandElasticity:.5,outputVariation:.2}},copper:{name:"",icon:"Pickaxe",color:"text-orange-400",basePrice:8.5,minPrice:.85,maxPrice:85,defaultOwner:"miner",unlockEpoch:1,unlockTech:"copper_mining",tags:["raw_material"],marketConfig:{supplyDemandWeight:.9,inventoryTargetDays:200,inventoryPriceImpact:.25,demandElasticity:.4,outputVariation:.2}},dye:{name:"",icon:"Droplets",color:"text-pink-500",basePrice:7.5,minPrice:.75,maxPrice:75,defaultOwner:"artisan",unlockEpoch:1,tags:["industrial","raw_material"],marketConfig:{supplyDemandWeight:1.1,inventoryTargetDays:120,inventoryPriceImpact:.35,demandElasticity:.6,outputVariation:.2}},papyrus:{name:"",icon:"ScrollText",color:"text-lime-300",basePrice:10,minPrice:1,maxPrice:100,defaultOwner:"scribe",unlockEpoch:2,unlockTech:"papyrus_cultivation",tags:["raw_material","manufactured"],marketConfig:{supplyDemandWeight:1.1,inventoryTargetDays:150,inventoryPriceImpact:.3,demandElasticity:.5,outputVariation:.2}},delicacies:{name:"",icon:"UtensilsCrossed",color:"text-rose-400",basePrice:18,minPrice:1.8,maxPrice:180,defaultOwner:"artisan",unlockEpoch:2,unlockTech:"culinary_arts",tags:["luxury","manufactured"],marketConfig:{supplyDemandWeight:1.5,inventoryTargetDays:80,inventoryPriceImpact:.45,demandElasticity:1.3,outputVariation:.2}},furniture:{name:"",icon:"Armchair",color:"text-amber-500",basePrice:20,minPrice:2,maxPrice:200,defaultOwner:"artisan",unlockEpoch:2,unlockTech:"carpentry",tags:["luxury","manufactured"],marketConfig:{supplyDemandWeight:1.5,inventoryTargetDays:100,inventoryPriceImpact:.4,demandElasticity:1.2,outputVariation:.2}},ale:{name:"",icon:"Wine",color:"text-purple-400",basePrice:13,minPrice:1.3,maxPrice:130,defaultOwner:"artisan",unlockEpoch:2,unlockTech:"brewing",tags:["luxury","manufactured"],marketConfig:{supplyDemandWeight:1.6,inventoryTargetDays:8,inventoryPriceImpact:.5,demandElasticity:1.5,outputVariation:.2}},fine_clothes:{name:"",icon:"Shirt",color:"text-purple-400",basePrice:24,minPrice:2.4,maxPrice:240,defaultOwner:"artisan",unlockEpoch:2,tags:["luxury","manufactured"],marketConfig:{supplyDemandWeight:1.6,inventoryTargetDays:100,inventoryPriceImpact:.5,demandElasticity:1.5,outputVariation:.2}},iron:{name:"",icon:"Pickaxe",color:"text-zinc-400",basePrice:11.5,minPrice:1.15,maxPrice:115,defaultOwner:"miner",unlockEpoch:2,unlockTech:"ironworking",tags:["raw_material"],marketConfig:{supplyDemandWeight:.8,inventoryTargetDays:250,inventoryPriceImpact:.2,demandElasticity:.3,outputVariation:.2}},spice:{name:"",icon:"Leaf",color:"text-amber-400",basePrice:20,minPrice:2,maxPrice:200,defaultOwner:"merchant",unlockEpoch:4,unlockTech:"cartography",tags:["essential","manufactured"],marketConfig:{supplyDemandWeight:1.4,inventoryTargetDays:120,inventoryPriceImpact:.4,demandElasticity:.9,outputVariation:.2}},coffee:{name:"",icon:"Coffee",color:"text-amber-700",basePrice:18,minPrice:1.8,maxPrice:180,defaultOwner:"merchant",unlockEpoch:5,unlockTech:"coffee_agronomy",tags:["essential","manufactured"],marketConfig:{supplyDemandWeight:1.2,inventoryTargetDays:150,inventoryPriceImpact:.35,demandElasticity:.8,outputVariation:.2}},coal:{name:"",icon:"Flame",color:"text-slate-300",basePrice:11,minPrice:1.1,maxPrice:110,defaultOwner:"miner",unlockEpoch:6,unlockTech:"coal_gasification",tags:["raw_material"],marketConfig:{supplyDemandWeight:.9,inventoryTargetDays:200,inventoryPriceImpact:.25,demandElasticity:.4,outputVariation:.2}},steel:{name:"",icon:"Cog",color:"text-gray-300",basePrice:30,minPrice:3,maxPrice:300,defaultOwner:"engineer",unlockEpoch:6,unlockTech:"steel_alloys",tags:["industrial"],marketConfig:{supplyDemandWeight:1,inventoryTargetDays:180,inventoryPriceImpact:.3,demandElasticity:.5,outputVariation:.2}},silver:{name:"",icon:"Coins",color:"text-slate-200",type:"currency",basePrice:1,minPrice:1,maxPrice:1,unlockEpoch:0,tags:["currency"]},science:{name:"",icon:"Cpu",color:"text-cyan-400",basePrice:5,minPrice:.5,maxPrice:50,defaultOwner:"official",unlockEpoch:0,tags:["special","manufactured"],marketConfig:{supplyDemandWeight:.5,inventoryTargetDays:400,inventoryPriceImpact:.15,demandElasticity:.2,outputVariation:.1}},culture:{name:"",icon:"ScrollText",color:"text-pink-400",basePrice:2,minPrice:.25,maxPrice:10,defaultOwner:"cleric",unlockEpoch:1,unlockTech:"amphitheater_design",tags:["special","manufactured"],marketConfig:{supplyDemandWeight:.6,inventoryTargetDays:350,inventoryPriceImpact:.2,demandElasticity:.3,outputVariation:.15}},maxPop:{name:"",icon:"Users",color:"text-blue-400",type:"virtual",tags:["special"]},militaryCapacity:{name:"",icon:"Shield",color:"text-red-400",type:"virtual",tags:["special"]}},wn=[{id:0,name:"",color:"text-stone-400",bg:"bg-stone-900",tileColor:"bg-stone-700",req:{science:0},cost:{},bonuses:{desc:""}},{id:1,name:"",color:"text-orange-400",bg:"bg-orange-950",tileColor:"bg-orange-800",req:{science:600,population:25},cost:{food:6e3,wood:3500,stone:1200,silver:600,science:600},bonuses:{desc:"",gatherBonus:.15,militaryBonus:.1}},{id:2,name:"",color:"text-amber-300",bg:"bg-amber-900",tileColor:"bg-amber-700",req:{science:1800,population:90,culture:250},cost:{food:2e4,wood:1e4,brick:3600,silver:5e3,tools:1200,science:1800},bonuses:{desc:"",gatherBonus:.2,cultureBonus:.15,scienceBonus:.1}},{id:3,name:"",color:"text-blue-400",bg:"bg-blue-950",tileColor:"bg-blue-800",req:{science:4500,population:170,culture:600},cost:{food:1e5,wood:5e4,brick:25e3,iron:12500,papyrus:5e3,silver:15e3,science:4500},bonuses:{desc:"",gatherBonus:.25,cultureBonus:.2}},{id:4,name:"",color:"text-cyan-300",bg:"bg-cyan-900",tileColor:"bg-cyan-700",req:{science:8e3,population:320,culture:1400},cost:{food:26e4,plank:7e4,brick:6e4,iron:35e3,silver:4e4,science:8e3},bonuses:{desc:"",gatherBonus:.3,scienceBonus:.2,militaryBonus:.1}},{id:5,name:"",color:"text-purple-400",bg:"bg-purple-950",tileColor:"bg-purple-800",req:{science:12e3,population:450,culture:2500},cost:{food:35e4,plank:8e4,papyrus:3e4,spice:2e4,silver:5e4,science:12e3},bonuses:{desc:"",cultureBonus:.3,scienceBonus:.3}},{id:6,name:"",color:"text-gray-200",bg:"bg-gray-800",tileColor:"bg-gray-600",req:{science:2e4,population:650,culture:4e3},cost:{food:75e4,brick:18e4,iron:12e4,tools:75e3,spice:3e4,silver:12e4,science:2e4},bonuses:{desc:"",gatherBonus:.4,industryBonus:.5,scienceBonus:.3}},{id:7,name:"",color:"text-green-400",bg:"bg-green-950",tileColor:"bg-green-800",req:{science:35e3,population:1e3,culture:8e3},cost:{food:2e6,tools:3e5,silver:25e4,spice:8e4,papyrus:1e5,science:35e3},bonuses:{desc:"",scienceBonus:.6,cultureBonus:.5,knowledgeBonus:.4}}],Ke={peasant:{name:"",icon:"Wheat",weight:1,tax:1,headTaxBase:.01,desc:"",wealthWeight:1,influenceBase:.5,startingWealth:80,defaultResource:"food",needs:{food:.55,cloth:.05,ale:.02},luxuryNeeds:{1.5:{tools:.02},2:{plank:.03,wood:.02},2.5:{furniture:.02,stone:.01},3:{spice:.04,brick:.02},3.5:{culture:.01},4.5:{copper:.004},5.5:{delicacies:.02,fine_clothes:.01},7:{coffee:.02},8:{}},buffs:{satisfied:{desc:"",taxIncome:.1,production:.05},dissatisfied:{desc:"",taxIncome:-.2,production:-.1}}},lumberjack:{name:"",icon:"Trees",weight:.8,tax:1.2,headTaxBase:.02,desc:"",wealthWeight:1,influenceBase:.4,startingWealth:90,defaultResource:"wood",needs:{food:.75,cloth:.07,ale:.02},luxuryNeeds:{1.5:{tools:.03},2:{plank:.04,wood:.03},2.5:{furniture:.025},3:{spice:.03,brick:.025},3.5:{stone:.015,culture:.01},4.5:{copper:.006},5.5:{delicacies:.025,fine_clothes:.015},7:{coffee:.03},8:{}},buffs:{satisfied:{desc:"",production:.06},dissatisfied:{desc:"",production:-.1}}},serf:{name:"",icon:"Users",weight:.5,tax:2,headTaxBase:.015,desc:"",wealthWeight:.5,influenceBase:.3,startingWealth:50,defaultResource:"food",needs:{food:.6,cloth:.05,ale:.02},luxuryNeeds:{2:{},2.5:{food:.06},3:{furniture:.01,plank:.02,tools:.006},4:{spice:.02,stone:.006,culture:.006},5:{},6:{delicacies:.01,brick:.015},7.5:{fine_clothes:.008,copper:.004},9:{coffee:.01},10:{}},buffs:{satisfied:{desc:"",production:.08},dissatisfied:{desc:"",production:-.15}}},worker:{name:"",icon:"Hammer",weight:2,tax:3,headTaxBase:.03,desc:"",wealthWeight:2,influenceBase:1,startingWealth:150,defaultResource:"plank",needs:{food:.7,cloth:.08,tools:.03,ale:.05},luxuryNeeds:{1.8:{plank:.02},2.5:{furniture:.03,spice:.02},3:{coffee:.025,brick:.03,culture:.015},4:{fine_clothes:.03,delicacies:.04,stone:.015},5:{steel:.01,copper:.008},6.5:{},8:{papyrus:.02},10:{},12:{}},buffs:{satisfied:{desc:"",industryBonus:.15},dissatisfied:{desc:"",industryBonus:-.25}}},artisan:{name:"",icon:"Anvil",weight:1.5,tax:3.5,headTaxBase:.035,desc:"",wealthWeight:2.5,influenceBase:1.2,startingWealth:200,defaultResource:"tools",needs:{food:.65,cloth:.1,tools:.04,ale:.05,furniture:.02},luxuryNeeds:{1.8:{copper:.015,spice:.04},2.5:{coffee:.03,fine_clothes:.025,brick:.03,culture:.02},3.5:{delicacies:.06,stone:.025},4.5:{steel:.008},6:{},8:{papyrus:.03},10:{},12:{}},buffs:{satisfied:{desc:"",production:.1},dissatisfied:{desc:"",production:-.15}}},miner:{name:"",icon:"Pickaxe",weight:1.2,tax:2.5,headTaxBase:.025,desc:"",wealthWeight:1.5,influenceBase:.8,startingWealth:120,defaultResource:"stone",needs:{food:.85,cloth:.08,ale:.02},luxuryNeeds:{1.8:{tools:.03},2.5:{furniture:.02,spice:.015,food:.15},3:{plank:.03,brick:.02,coffee:.015,culture:.01},4:{delicacies:.03},5.5:{copper:.01},7:{fine_clothes:.02},9:{},11:{}},buffs:{satisfied:{desc:"",gatherBonus:.1},dissatisfied:{desc:"",stability:-.1}}},merchant:{name:"",icon:"Coins",weight:6,tax:5,headTaxBase:.09,desc:"",wealthWeight:8,influenceBase:3.5,startingWealth:500,defaultResource:"spice",needs:{food:.8,delicacies:.45,cloth:.12,spice:.15,furniture:.08,plank:.05,ale:.1,fine_clothes:.05,culture:.08},luxuryNeeds:{1.5:{coffee:.14},2:{delicacies:.35,plank:.12,brick:.05},3:{steel:.05,culture:.15},5:{papyrus:.08,copper:.06,stone:.05},8:{},12:{},18:{}},buffs:{satisfied:{desc:"",taxIncome:.15,gatherBonus:.05},dissatisfied:{desc:"",taxIncome:-.2,stability:-.1}},tradeConfig:{minProfitMargin:.1,maxPurchaseAmount:10,exportProbability:.5,maxInventoryRatio:.1,minWealthForTrade:10,tradeDuration:3,tradeCooldown:0,enableDebugLog:!0}},navigator:{name:"",icon:"Compass",weight:4,tax:3,headTaxBase:.06,desc:"",wealthWeight:3,influenceBase:2.5,startingWealth:300,defaultResource:"spice",needs:{food:.7,cloth:.1,spice:.1,ale:.1},luxuryNeeds:{1.8:{tools:.05},2.5:{coffee:.07,furniture:.07,culture:.06},3.5:{fine_clothes:.08,delicacies:.12,plank:.07},5:{copper:.05,steel:.03},7:{papyrus:.05},10:{brick:.08},14:{}},buffs:{satisfied:{desc:"",gatherBonus:.1},dissatisfied:{desc:"",gatherBonus:-.1,stability:-.1}}},scribe:{name:"",icon:"Feather",weight:2.5,tax:2,headTaxBase:.04,desc:"",wealthWeight:2.5,influenceBase:1.5,startingWealth:250,defaultResource:"papyrus",needs:{food:.6,cloth:.1,papyrus:.06,furniture:.02},luxuryNeeds:{1.5:{coffee:.07,culture:.06},2:{fine_clothes:.05,plank:.025},3:{delicacies:.09,spice:.05},5:{copper:.035,brick:.025},7:{},10:{stone:.04},14:{cloth:.07},18:{steel:.015}},buffs:{satisfied:{desc:"",scienceBonus:.15},dissatisfied:{desc:"",scienceBonus:-.2}}},soldier:{name:"",icon:"Swords",weight:3,tax:1,headTaxBase:.04,desc:"",wealthWeight:2,influenceBase:2,startingWealth:180,defaultResource:"tools",needs:{food:.95,cloth:.08,ale:.05},luxuryNeeds:{2:{tools:.07,copper:.025},2.5:{furniture:.05,spice:.05,culture:.04},3.5:{fine_clothes:.07,delicacies:.07,steel:.025},5:{food:.5,brick:.05},7:{coffee:.09,stone:.05},10:{},14:{}},buffs:{satisfied:{desc:"",militaryPower:.2},dissatisfied:{desc:"",militaryPower:-.3,stability:-.2}}},cleric:{name:"",icon:"Cross",weight:4,tax:.5,headTaxBase:.05,desc:"",wealthWeight:3,influenceBase:3,startingWealth:220,defaultResource:"culture",needs:{food:.6,cloth:.09,papyrus:.035,ale:.035,culture:.06},luxuryNeeds:{1.5:{plank:.02},2:{fine_clothes:.06,furniture:.06,stone:.04},3:{delicacies:.08,spice:.04},4.5:{copper:.04,brick:.04},6:{coffee:.05,steel:.01},8:{papyrus:.09},10:{}},buffs:{satisfied:{desc:"",cultureBonus:.2,stability:.1},dissatisfied:{desc:"",cultureBonus:-.15,stability:-.1}}},official:{name:"",icon:"ScrollText",weight:5,tax:2,headTaxBase:.08,desc:"",wealthWeight:5,influenceBase:4,startingWealth:400,defaultResource:"science",needs:{food:.5,delicacies:.385,cloth:.12,papyrus:.08,coffee:.04,furniture:.06,stone:.02,fine_clothes:.06,culture:.09},luxuryNeeds:{1.3:{},1.8:{delicacies:.3,spice:.12,plank:.08,brick:.06},2.5:{steel:.04,culture:.15},4:{papyrus:.08,copper:.04,stone:.04},6:{fine_clothes:.15},9:{},14:{},20:{}},buffs:{satisfied:{desc:"",taxIncome:.1},dissatisfied:{desc:"",taxIncome:-.2}}},landowner:{name:"",icon:"Castle",weight:10,tax:5,headTaxBase:.07,desc:"",wealthWeight:10,influenceBase:5,startingWealth:800,defaultResource:"food",needs:{food:.6,delicacies:.5,cloth:.15,spice:.12,furniture:.1,brick:.05,plank:.05,fine_clothes:.08,culture:.1},luxuryNeeds:{1.3:{delicacies:.4,fine_clothes:.12,culture:.12},1.8:{spice:.2,coffee:.1,stone:.08},2.5:{plank:.12,steel:.04,brick:.08},4:{copper:.06,papyrus:.04},6:{},9:{},14:{},20:{}},buffs:{satisfied:{desc:"",taxIncome:.15,stability:.15},dissatisfied:{desc:"",taxIncome:-.3,stability:-.25}}},capitalist:{name:"",icon:"Briefcase",weight:15,tax:8,headTaxBase:.08,desc:"",wealthWeight:20,influenceBase:6,startingWealth:1200,defaultResource:"steel",needs:{food:.55,delicacies:.3,cloth:.14,coffee:.072,furniture:.072,steel:.02,culture:.11},luxuryNeeds:{1.3:{fine_clothes:.12,culture:.12},1.8:{delicacies:.3,spice:.15,brick:.08},2.5:{stone:.06,plank:.1},4:{copper:.08,papyrus:.06},6:{},10:{},15:{},22:{}},buffs:{satisfied:{desc:"",industryBonus:.25,scienceBonus:.15},dissatisfied:{desc:"",industryBonus:-.3,taxIncome:-.25}}},knight:{name:"",icon:"Shield",weight:8,tax:2,headTaxBase:.09,desc:"",wealthWeight:8,influenceBase:4,startingWealth:600,defaultResource:"tools",needs:{food:.7,delicacies:.75,cloth:.15,coffee:.05,furniture:.08,ale:.1,culture:.08},luxuryNeeds:{1.3:{delicacies:.4,fine_clothes:.1,culture:.08},1.8:{spice:.12,steel:.04},2.5:{coffee:.08,brick:.06,stone:.04},4:{tools:.06,copper:.04,plank:.06},6:{},10:{},15:{},22:{}},buffs:{satisfied:{desc:"",militaryPower:.25,stability:.1},dissatisfied:{desc:"",militaryPower:-.2,stability:-.15}}},engineer:{name:"",icon:"Cog",weight:7,tax:6,headTaxBase:.1,desc:"",wealthWeight:6,influenceBase:3.5,startingWealth:700,defaultResource:"steel",needs:{food:.8,cloth:.12,coffee:.08,ale:.05,furniture:.05,culture:.07},luxuryNeeds:{1.3:{fine_clothes:.08,culture:.08},1.8:{delicacies:.15,spice:.08,tools:.06},2.5:{plank:.08,copper:.04,stone:.04},4:{papyrus:.06,brick:.06,steel:.04},6:{},10:{},15:{},22:{}},buffs:{satisfied:{desc:"",industryBonus:.2,scienceBonus:.1},dissatisfied:{desc:"",industryBonus:-.25}}},unemployed:{name:"",icon:"AlertTriangle",weight:.2,tax:1,headTaxBase:.01,desc:"",wealthWeight:.2,influenceBase:.3,startingWealth:30,needs:{food:.45,cloth:.05},luxuryNeeds:{2.5:{ale:.04,food:.1},3.5:{furniture:.01},4.5:{plank:.01,culture:.004},5.5:{tools:.004},7:{spice:.008},9:{brick:.006}},buffs:{satisfied:{desc:"",stability:.02},dissatisfied:{desc:"",stability:-.1}}}},Ln=[{id:"farm",name:"",desc:"",baseCost:{wood:12},output:{food:2.8},jobs:{peasant:2},owner:"peasant",epoch:0,cat:"gather",visual:{icon:"Wheat",color:"bg-yellow-700",text:"text-yellow-200"},marketConfig:{price:{livingCostWeight:.15,taxCostWeight:.2},wage:{livingCostWeight:.08,taxCostWeight:.05}}},{id:"trading_post",name:"",desc:"",baseCost:{wood:50,stone:10},output:{food:2,silver:.8},jobs:{merchant:1},owner:"merchant",epoch:0,cat:"civic",requiresTech:"barter",visual:{icon:"Handshake",color:"bg-amber-800",text:"text-amber-200"}},{id:"large_estate",name:"",desc:"",baseCost:{wood:100,plank:25},output:{food:12},jobs:{serf:6,landowner:1},owner:"landowner",epoch:3,cat:"gather",requiresTech:"feudalism",visual:{icon:"Castle",color:"bg-amber-800",text:"text-amber-200"}},{id:"lumber_camp",name:"",desc:"",baseCost:{food:18},input:{},output:{wood:2.2},jobs:{lumberjack:2},owner:"lumberjack",epoch:0,cat:"gather",visual:{icon:"Trees",color:"bg-emerald-800",text:"text-emerald-200"},marketConfig:{price:{livingCostWeight:.1,taxCostWeight:.15},wage:{livingCostWeight:.05,taxCostWeight:.05}}},{id:"quarry",name:"",desc:"",baseCost:{wood:55},input:{},output:{stone:1.7},jobs:{miner:2},owner:"miner",epoch:0,cat:"gather",visual:{icon:"Pickaxe",color:"bg-stone-600",text:"text-stone-200"},marketConfig:{price:{livingCostWeight:.1,taxCostWeight:.15},wage:{livingCostWeight:.05,taxCostWeight:.05}}},{id:"copper_mine",name:"",desc:"",baseCost:{food:120,wood:120},input:{tools:.02},output:{copper:.35},jobs:{miner:3},owner:"miner",epoch:1,cat:"gather",requiresTech:"copper_mining",visual:{icon:"Gem",color:"bg-orange-700",text:"text-orange-200"},marketConfig:{price:{livingCostWeight:.2,taxCostWeight:.25},wage:{livingCostWeight:.1,taxCostWeight:.1}}},{id:"reed_works",name:"",desc:"",baseCost:{food:140,wood:80},output:{papyrus:.4},jobs:{peasant:2},owner:"peasant",epoch:2,cat:"gather",requiresTech:"papyrus_cultivation",visual:{icon:"ScrollText",color:"bg-lime-800",text:"text-lime-200"},marketConfig:{price:{livingCostWeight:.1,taxCostWeight:.15},wage:{livingCostWeight:.05,taxCostWeight:.05}}},{id:"culinary_kitchen",name:"",desc:"",baseCost:{wood:100,stone:60,brick:30},input:{tools:.1,food:1.5},output:{delicacies:1.5},jobs:{artisan:2,peasant:1},owner:"artisan",epoch:2,cat:"industry",requiresTech:"culinary_arts",visual:{icon:"UtensilsCrossed",color:"bg-rose-800",text:"text-rose-200"}},{id:"brewery",name:"",desc:"",baseCost:{wood:90,stone:50,brick:25},input:{food:1.2,wood:.2},output:{ale:1.2},jobs:{worker:2},owner:"worker",epoch:2,cat:"industry",requiresTech:"brewing",visual:{icon:"Wine",color:"bg-purple-800",text:"text-purple-200"},marketConfig:{price:{livingCostWeight:.4,taxCostWeight:.5},wage:{livingCostWeight:.25,taxCostWeight:.25}}},{id:"furniture_workshop",name:"",desc:"",baseCost:{plank:120,stone:80},input:{tools:.1,plank:1,cloth:.3},output:{furniture:1.2},jobs:{artisan:3},owner:"artisan",epoch:2,cat:"industry",requiresTech:"carpentry",visual:{icon:"Armchair",color:"bg-amber-800",text:"text-amber-200"},marketConfig:{price:{livingCostWeight:.3,taxCostWeight:.4},wage:{livingCostWeight:.15,taxCostWeight:.15}}},{id:"loom_house",name:"",desc:"",baseCost:{wood:35,food:20},output:{cloth:1.6},jobs:{peasant:2},owner:"peasant",epoch:0,cat:"industry",visual:{icon:"Shirt",color:"bg-indigo-800",text:"text-indigo-200"}},{id:"dye_works",name:"",desc:"",baseCost:{wood:60,stone:20},input:{food:.5},output:{dye:.4},jobs:{peasant:2},owner:"artisan",epoch:1,cat:"industry",visual:{icon:"Paintbrush",color:"bg-pink-800",text:"text-pink-200"}},{id:"tailor_workshop",name:"",desc:"",baseCost:{wood:100,stone:40},input:{tools:.04,cloth:1,dye:.2},output:{fine_clothes:.8,culture:.1},jobs:{artisan:2},owner:"artisan",epoch:2,cat:"industry",requiresTech:"tools",visual:{icon:"Package",color:"bg-indigo-900",text:"text-indigo-100"}},{id:"mine",name:"",desc:"",baseCost:{plank:120,food:220},input:{tools:.04},output:{iron:.35},jobs:{miner:5,capitalist:1},owner:"capitalist",epoch:2,cat:"gather",requiresTech:"ironworking",visual:{icon:"Mountain",color:"bg-zinc-700",text:"text-zinc-200"},marketConfig:{price:{livingCostWeight:.2,taxCostWeight:.25},wage:{livingCostWeight:.1,taxCostWeight:.1}}},{id:"coffee_plantation",name:"",desc:"",baseCost:{wood:200,spice:30},output:{coffee:.4},jobs:{serf:4,merchant:1},owner:"merchant",epoch:5,cat:"gather",requiresTech:"coffee_agronomy",visual:{icon:"Coffee",color:"bg-amber-900",text:"text-amber-200"}},{id:"coal_mine",name:"",desc:"",baseCost:{plank:200,tools:60},input:{tools:.1},output:{coal:.45},jobs:{miner:6,capitalist:1},owner:"capitalist",epoch:6,cat:"gather",requiresTech:"coal_gasification",visual:{icon:"Flame",color:"bg-slate-700",text:"text-slate-100"},marketConfig:{price:{livingCostWeight:.2,taxCostWeight:.25},wage:{livingCostWeight:.1,taxCostWeight:.1}}},{id:"hut",name:"",desc:"",baseCost:{wood:20,food:20},output:{maxPop:4},epoch:0,cat:"civic",visual:{icon:"Tent",color:"bg-orange-800",text:"text-orange-200"}},{id:"house",name:"",desc:"",baseCost:{plank:60,brick:40},output:{maxPop:11},epoch:2,cat:"civic",requiresTech:"urban_planning",visual:{icon:"Home",color:"bg-amber-700",text:"text-amber-100"}},{id:"granary",name:"",desc:"",baseCost:{wood:120,brick:40},output:{maxPop:8},epoch:1,cat:"civic",requiresTech:"granary_architecture",visual:{icon:"Boxes",color:"bg-yellow-900",text:"text-yellow-200"}},{id:"town_hall",name:"",desc:"",baseCost:{brick:200,plank:200},input:{brick:.2,papyrus:.02,delicacies:.1,fine_clothes:.05},output:{},jobs:{official:5},epoch:3,cat:"civic",requiresTech:"bureaucracy",visual:{icon:"Scale",color:"bg-slate-800",text:"text-slate-200"}},{id:"church",name:"",desc:"",baseCost:{stone:150,plank:50},input:{furniture:.1,fine_clothes:.1},output:{culture:.8,silver:.5},jobs:{cleric:3},owner:"cleric",epoch:3,cat:"civic",requiresTech:"theology",visual:{icon:"Cross",color:"bg-purple-900",text:"text-purple-200"}},{id:"amphitheater",name:"",desc:"",baseCost:{stone:200,brick:80},input:{fine_clothes:.15},output:{culture:1.2},jobs:{cleric:2},owner:"cleric",epoch:1,cat:"civic",requiresTech:"amphitheater_design",visual:{icon:"Music2",color:"bg-rose-900",text:"text-rose-200"}},{id:"navigator_school",name:"",desc:"",baseCost:{wood:160,papyrus:80},output:{science:.6,culture:.2},jobs:{navigator:2,scribe:1,official:1},owner:"official",epoch:4,cat:"civic",requiresTech:"navigator_schooling",visual:{icon:"Navigation",color:"bg-cyan-900",text:"text-cyan-200"}},{id:"coffee_house",name:"",desc:"",baseCost:{plank:140,coffee:40},input:{coffee:.4,delicacies:.2},output:{culture:1,science:1},jobs:{merchant:1,scribe:2},owner:"merchant",epoch:5,cat:"civic",requiresTech:"coffeehouse_philosophy",visual:{icon:"Coffee",color:"bg-brown-900",text:"text-amber-200"}},{id:"rail_depot",name:"",desc:"",baseCost:{steel:180,coal:120},input:{coal:.4,ale:.2,delicacies:.1},output:{silver:1.5,maxPop:14},jobs:{engineer:2,merchant:2,capitalist:1},owner:"capitalist",epoch:6,cat:"civic",requiresTech:"rail_network",visual:{icon:"Train",color:"bg-gray-900",text:"text-gray-100"}},{id:"sawmill",name:"",desc:"",baseCost:{wood:75,stone:35},input:{wood:1.2},output:{plank:1.8},jobs:{worker:3},owner:"worker",epoch:1,requiresTech:"tools",cat:"industry",visual:{icon:"Hammer",color:"bg-amber-900",text:"text-amber-300"},marketConfig:{price:{livingCostWeight:.2,taxCostWeight:.25},wage:{livingCostWeight:.1,taxCostWeight:.1}}},{id:"brickworks",name:"",desc:"",baseCost:{wood:140,stone:90},input:{stone:1,wood:.3},output:{brick:1.6},jobs:{worker:2},owner:"worker",epoch:0,cat:"industry",requiresTech:"pottery",visual:{icon:"Factory",color:"bg-red-900",text:"text-red-300"}},{id:"stone_tool_workshop",name:"",desc:"",baseCost:{wood:40,stone:25},input:{wood:1,stone:.8},output:{tools:.5},jobs:{artisan:2},owner:"artisan",epoch:0,cat:"industry",requiresTech:"tool_making",visual:{icon:"Hammer",color:"bg-stone-700",text:"text-stone-200"},marketConfig:{price:{livingCostWeight:.2,taxCostWeight:.25},wage:{livingCostWeight:.1,taxCostWeight:.1}}},{id:"bronze_foundry",name:"",desc:"",baseCost:{wood:140,stone:75,copper:35},input:{copper:.6,wood:.4},output:{tools:1},jobs:{worker:2,artisan:1},owner:"artisan",epoch:1,cat:"industry",requiresTech:"bronze_working",visual:{icon:"Anvil",color:"bg-orange-800",text:"text-amber-200"},marketConfig:{price:{livingCostWeight:.3,taxCostWeight:.35},wage:{livingCostWeight:.2,taxCostWeight:.2}}},{id:"iron_tool_workshop",name:"",desc:"",baseCost:{plank:150,brick:80},input:{wood:.5,iron:.8},output:{tools:1.5},jobs:{worker:2,artisan:1},owner:"artisan",epoch:2,cat:"industry",requiresTech:"ironworking",visual:{icon:"Cog",color:"bg-zinc-800",text:"text-zinc-200"},marketConfig:{price:{livingCostWeight:.3,taxCostWeight:.35},wage:{livingCostWeight:.2,taxCostWeight:.2}}},{id:"factory",name:"",desc:"",baseCost:{brick:400,steel:200},input:{steel:.2,coal:.2},output:{tools:1.2},jobs:{worker:10,engineer:2,capitalist:1},owner:"capitalist",epoch:6,requiresTech:"industrialization",cat:"industry",visual:{icon:"Factory",color:"bg-blue-900",text:"text-blue-200"}},{id:"printing_house",name:"",desc:"",baseCost:{brick:200,papyrus:80},input:{papyrus:.4,coffee:.1},output:{science:1.2},jobs:{artisan:2,scribe:2,capitalist:1},owner:"capitalist",epoch:5,cat:"industry",requiresTech:"printing_press",visual:{icon:"BookOpen",color:"bg-indigo-900",text:"text-indigo-200"}},{id:"steel_foundry",name:"",desc:"",baseCost:{brick:300,iron:200},input:{iron:.4,coal:.4},output:{steel:.4},jobs:{engineer:3,worker:4,capitalist:1},owner:"capitalist",epoch:6,cat:"industry",requiresTech:"steel_alloys",visual:{icon:"Cog",color:"bg-gray-900",text:"text-gray-200"}},{id:"library",name:"",desc:"",baseCost:{wood:200,stone:60},output:{science:.8},jobs:{scribe:3},owner:"scribe",epoch:0,cat:"civic",visual:{icon:"Landmark",color:"bg-cyan-800",text:"text-cyan-200"}},{id:"market",name:"",desc:"",baseCost:{plank:100},input:{brick:.05},output:{food:2},jobs:{merchant:2},owner:"merchant",epoch:1,requiresTech:"caravan_trade",cat:"civic",visual:{icon:"Handshake",color:"bg-yellow-800",text:"text-yellow-200"}},{id:"dockyard",name:"",desc:"",baseCost:{plank:200,tools:40},input:{wood:.5},output:{spice:.35},jobs:{navigator:2,worker:2,merchant:1},owner:"merchant",epoch:4,cat:"industry",requiresTech:"cartography",visual:{icon:"Anchor",color:"bg-sky-900",text:"text-sky-200"}},{id:"trade_port",name:"",desc:"",baseCost:{plank:220,spice:60},input:{spice:.3},output:{food:2},jobs:{merchant:3},owner:"merchant",epoch:4,cat:"civic",requiresTech:"charter_companies",visual:{icon:"Ship",color:"bg-indigo-900",text:"text-indigo-200"}},{id:"barracks",name:"",desc:"",baseCost:{wood:80,stone:40},output:{militaryCapacity:10},epoch:0,cat:"military",visual:{icon:"Shield",color:"bg-red-900",text:"text-red-200"}},{id:"training_ground",name:"",desc:"",baseCost:{plank:150,brick:80,iron:30},output:{militaryCapacity:20},epoch:2,cat:"military",requiresTech:"military_training",visual:{icon:"Swords",color:"bg-red-800",text:"text-red-100"}},{id:"fortress",name:"",desc:"",baseCost:{brick:300,iron:150,steel:50},output:{militaryCapacity:40},epoch:4,cat:"military",requiresTech:"fortification",visual:{icon:"Castle",color:"bg-red-950",text:"text-red-100"}},{id:"textile_mill",name:"",desc:"",baseCost:{brick:180,plank:120,tools:60},input:{food:.8,dye:.3},output:{cloth:3.5,fine_clothes:.6},jobs:{worker:6,artisan:2,capitalist:1},owner:"capitalist",epoch:5,cat:"industry",requiresTech:"mechanized_weaving",visual:{icon:"Shirt",color:"bg-indigo-700",text:"text-indigo-100"},marketConfig:{price:{livingCostWeight:.25,taxCostWeight:.3},wage:{livingCostWeight:.15,taxCostWeight:.15}}},{id:"garment_factory",name:"",desc:"",baseCost:{brick:350,steel:150,tools:100},input:{cloth:2.5,dye:.5,coal:.3},output:{fine_clothes:2.8,culture:.3},jobs:{worker:12,artisan:3,engineer:1,capitalist:1},owner:"capitalist",epoch:6,cat:"industry",requiresTech:"assembly_line",visual:{icon:"Factory",color:"bg-indigo-900",text:"text-indigo-100"},marketConfig:{price:{livingCostWeight:.3,taxCostWeight:.35},wage:{livingCostWeight:.2,taxCostWeight:.2}}},{id:"lumber_mill",name:"",desc:"",baseCost:{brick:160,plank:100,tools:50},input:{wood:3},output:{plank:5.5},jobs:{worker:5,artisan:1,capitalist:1},owner:"capitalist",epoch:5,cat:"industry",requiresTech:"hydraulic_sawing",visual:{icon:"Axe",color:"bg-amber-700",text:"text-amber-100"},marketConfig:{price:{livingCostWeight:.2,taxCostWeight:.25},wage:{livingCostWeight:.12,taxCostWeight:.12}}},{id:"furniture_factory",name:"",desc:"",baseCost:{brick:280,steel:120,tools:80},input:{plank:2.5,cloth:.8,coal:.25},output:{furniture:3.5,culture:.2},jobs:{worker:8,artisan:2,engineer:1,capitalist:1},owner:"capitalist",epoch:6,cat:"industry",requiresTech:"mass_production",visual:{icon:"Armchair",color:"bg-amber-900",text:"text-amber-100"},marketConfig:{price:{livingCostWeight:.28,taxCostWeight:.32},wage:{livingCostWeight:.18,taxCostWeight:.18}}},{id:"metallurgy_workshop",name:"",desc:"",baseCost:{brick:200,iron:100,tools:60},input:{iron:1.5,copper:.3,wood:.8},output:{tools:3},jobs:{worker:4,artisan:2,engineer:1},owner:"artisan",epoch:4,cat:"industry",requiresTech:"advanced_metallurgy",visual:{icon:"Anvil",color:"bg-zinc-700",text:"text-zinc-100"},marketConfig:{price:{livingCostWeight:.25,taxCostWeight:.3},wage:{livingCostWeight:.15,taxCostWeight:.15}}},{id:"steel_works",name:"",desc:"",baseCost:{brick:500,steel:250,tools:150},input:{iron:1.2,coal:1},output:{steel:1.2,tools:.8},jobs:{worker:15,engineer:4,capitalist:2},owner:"capitalist",epoch:6,cat:"industry",requiresTech:"bessemer_process",visual:{icon:"Factory",color:"bg-gray-800",text:"text-gray-100"},marketConfig:{price:{livingCostWeight:.3,taxCostWeight:.35},wage:{livingCostWeight:.2,taxCostWeight:.2}}},{id:"building_materials_plant",name:"",desc:"",baseCost:{brick:200,plank:100,tools:50},input:{stone:2,wood:.6,coal:.2},output:{brick:4},jobs:{worker:6,engineer:1,capitalist:1},owner:"capitalist",epoch:5,cat:"industry",requiresTech:"industrial_ceramics",visual:{icon:"Building2",color:"bg-red-800",text:"text-red-100"},marketConfig:{price:{livingCostWeight:.2,taxCostWeight:.25},wage:{livingCostWeight:.12,taxCostWeight:.12}}},{id:"prefab_factory",name:"",desc:"",baseCost:{brick:400,steel:200,tools:100},input:{brick:1.5,steel:.2,stone:1,coal:.4},output:{brick:8},jobs:{worker:10,engineer:2,capitalist:1},owner:"capitalist",epoch:6,cat:"industry",requiresTech:"standardized_construction",visual:{icon:"Building",color:"bg-slate-700",text:"text-slate-100"},marketConfig:{price:{livingCostWeight:.28,taxCostWeight:.32},wage:{livingCostWeight:.18,taxCostWeight:.18}}},{id:"cannery",name:"",desc:"",baseCost:{brick:250,steel:100,tools:60},input:{food:2.5,iron:.3,coal:.25},output:{delicacies:3.5},jobs:{worker:8,artisan:2,engineer:1,capitalist:1},owner:"capitalist",epoch:6,cat:"industry",requiresTech:"food_preservation",visual:{icon:"Package",color:"bg-orange-800",text:"text-orange-100"},marketConfig:{price:{livingCostWeight:.22,taxCostWeight:.28},wage:{livingCostWeight:.14,taxCostWeight:.14}}},{id:"distillery",name:"",desc:"",baseCost:{brick:220,copper:80,tools:50},input:{food:2,coal:.2},output:{ale:3.5,silver:.8},jobs:{worker:5,artisan:2,capitalist:1},owner:"capitalist",epoch:5,cat:"industry",requiresTech:"distillation",visual:{icon:"Wine",color:"bg-purple-700",text:"text-purple-100"},marketConfig:{price:{livingCostWeight:.35,taxCostWeight:.4},wage:{livingCostWeight:.22,taxCostWeight:.22}}},{id:"paper_mill",name:"",desc:"",baseCost:{brick:180,plank:100,tools:50},input:{wood:1.5,coal:.15},output:{papyrus:1.8},jobs:{worker:5,engineer:1,capitalist:1},owner:"capitalist",epoch:5,cat:"industry",requiresTech:"wood_pulp_process",visual:{icon:"ScrollText",color:"bg-lime-700",text:"text-lime-100"},marketConfig:{price:{livingCostWeight:.18,taxCostWeight:.22},wage:{livingCostWeight:.1,taxCostWeight:.1}}},{id:"publishing_house",name:"",desc:"",baseCost:{brick:300,steel:80,papyrus:100},input:{papyrus:1,coffee:.2,coal:.15},output:{science:2.5,culture:1},jobs:{scribe:4,artisan:2,engineer:1,capitalist:1},owner:"capitalist",epoch:6,cat:"industry",requiresTech:"mass_media",visual:{icon:"Newspaper",color:"bg-cyan-800",text:"text-cyan-100"},marketConfig:{price:{livingCostWeight:.25,taxCostWeight:.3},wage:{livingCostWeight:.18,taxCostWeight:.18}}},{id:"industrial_mine",name:"",desc:"",baseCost:{brick:350,steel:200,tools:100},input:{tools:.15,coal:.3},output:{iron:1.2,copper:.4},jobs:{miner:10,engineer:2,capitalist:1},owner:"capitalist",epoch:6,cat:"gather",requiresTech:"deep_shaft_mining",visual:{icon:"Mountain",color:"bg-zinc-800",text:"text-zinc-100"},marketConfig:{price:{livingCostWeight:.25,taxCostWeight:.3},wage:{livingCostWeight:.15,taxCostWeight:.15}}},{id:"mechanized_farm",name:"",desc:"",baseCost:{brick:200,steel:150,tools:80},input:{tools:.1,coal:.2},output:{food:15},jobs:{peasant:4,worker:4,engineer:1,capitalist:1},owner:"capitalist",epoch:6,cat:"gather",requiresTech:"agricultural_machinery",visual:{icon:"Tractor",color:"bg-green-800",text:"text-green-100"},marketConfig:{price:{livingCostWeight:.18,taxCostWeight:.22},wage:{livingCostWeight:.1,taxCostWeight:.1}}},{id:"logging_company",name:"",desc:"",baseCost:{brick:180,steel:100,tools:60},input:{tools:.08,coal:.15},output:{wood:8},jobs:{lumberjack:6,worker:4,engineer:1,capitalist:1},owner:"capitalist",epoch:6,cat:"gather",requiresTech:"steam_logging",visual:{icon:"TreeDeciduous",color:"bg-emerald-700",text:"text-emerald-100"},marketConfig:{price:{livingCostWeight:.15,taxCostWeight:.2},wage:{livingCostWeight:.08,taxCostWeight:.08}}},{id:"apartment_block",name:"",desc:"",baseCost:{brick:400,steel:100,plank:150},output:{maxPop:15},epoch:6,cat:"civic",requiresTech:"urban_architecture",visual:{icon:"Building2",color:"bg-slate-600",text:"text-slate-100"}},{id:"university",name:"",desc:"",baseCost:{brick:400,plank:200,papyrus:100},input:{papyrus:.3,coffee:.2,delicacies:.15},output:{science:3,culture:.8},jobs:{scribe:4,engineer:2,official:2},owner:"official",epoch:5,cat:"civic",requiresTech:"higher_education",visual:{icon:"GraduationCap",color:"bg-blue-900",text:"text-blue-100"}},{id:"opera_house",name:"",desc:"",baseCost:{brick:350,plank:150,furniture:80},input:{fine_clothes:.25,delicacies:.2},output:{culture:3.5,silver:1},jobs:{cleric:4,artisan:2,merchant:1},owner:"cleric",epoch:5,cat:"civic",requiresTech:"grand_arts",visual:{icon:"Music",color:"bg-rose-800",text:"text-rose-100"}},{id:"stock_exchange",name:"",desc:"",baseCost:{brick:500,steel:150,papyrus:100},input:{papyrus:.2,coffee:.15},output:{silver:5,culture:.5},jobs:{merchant:6,scribe:2,capitalist:2},owner:"capitalist",epoch:6,cat:"civic",requiresTech:"financial_capitalism",visual:{icon:"TrendingUp",color:"bg-emerald-900",text:"text-emerald-100"}}],_l=[{id:"barter",name:"",desc:" 0.3 ",cost:{science:150},epoch:0,effects:{passive:{silver:.3}}},{id:"stone_axes",name:"",desc:" 25%",cost:{science:150},epoch:0,effects:{buildings:{lumber_camp:.25}}},{id:"flint_knapping",name:"",desc:" 25%",cost:{science:210},epoch:0,effects:{buildings:{quarry:.25}}},{id:"animal_husbandry",name:"",desc:" 20 ",cost:{science:240},epoch:0,effects:{passive:{food:20}}},{id:"pottery",name:"",desc:" +10%",cost:{science:300},epoch:0,effects:{buildings:{farm:.1}}},{id:"tool_making",name:"",desc:" +10%",cost:{science:270},epoch:0,effects:{categories:{gather:.1}}},{id:"basic_irrigation",name:"",desc:" 15%",cost:{science:360},epoch:0,effects:{buildings:{farm:.15}}},{id:"oral_tradition",name:"",desc:" 15%",cost:{science:330},epoch:0,effects:{buildings:{library:.15}}},{id:"communal_granary",name:"",desc:" +10",cost:{science:390},epoch:0,effects:{maxPop:10}},{id:"river_fishing",name:"",desc:" 10  0.2 ",cost:{science:450},epoch:0,effects:{passive:{food:10,silver:.2}}},{id:"wheel",name:"",desc:" +20%",cost:{science:480},epoch:0,effects:{categories:{gather:.2}}},{id:"sailing",name:"",desc:" 0.5  5 ",cost:{science:1050},epoch:1,effects:{passive:{silver:.5,food:5}}},{id:"tools",name:"",desc:" +5%",cost:{science:750},epoch:1,effects:{categories:{industry:.05}}},{id:"copper_mining",name:"",desc:" +25%",cost:{science:840},epoch:1,effects:{buildings:{copper_mine:.25}}},{id:"bronze_working",name:"",desc:" +30% +15%",cost:{science:960},epoch:1,effects:{buildings:{bronze_foundry:.3,mine:.15}}},{id:"horse_collar",name:"",desc:" 10%",cost:{science:780},epoch:1,effects:{buildings:{farm:.1,large_estate:.1}}},{id:"caravan_trade",name:"",desc:" +35%",cost:{science:900},epoch:1,effects:{buildings:{market:.35}}},{id:"granary_architecture",name:"",desc:" +25% +5 ",cost:{science:960},epoch:1,effects:{buildings:{granary:.25},maxPop:5}},{id:"primitive_weaving",name:"",desc:" +10%",cost:{science:820},epoch:1,effects:{buildings:{loom_house:.1}}},{id:"papyrus_cultivation",name:"",desc:" +20%",cost:{science:1575},epoch:2,effects:{buildings:{reed_works:.2}}},{id:"culinary_arts",name:"",desc:"",cost:{science:1680},epoch:2,effects:{buildings:{culinary_kitchen:.2}}},{id:"brewing",name:"",desc:"",cost:{science:1610},epoch:2,effects:{buildings:{brewery:.2}}},{id:"carpentry",name:"",desc:"",cost:{science:1750},epoch:2,effects:{buildings:{furniture_workshop:.2}}},{id:"library_catalogs",name:"",desc:" +25%",cost:{science:1645},epoch:2,effects:{buildings:{library:.25}}},{id:"amphitheater_design",name:"",desc:" +30%",cost:{science:1470},epoch:1,effects:{buildings:{amphitheater:.3}}},{id:"urban_planning",name:"",desc:" +20% +10",cost:{science:1820},epoch:2,effects:{buildings:{house:.2},maxPop:10}},{id:"republican_code",name:"",desc:" +15% +5",cost:{science:1960},epoch:2,effects:{categories:{civic:.15},maxPop:5}},{id:"road_system",name:"",desc:" +10%",cost:{science:2100},epoch:2,effects:{categories:{gather:.1}}},{id:"advanced_weaving",name:"",desc:" +20%",cost:{science:1950},epoch:2,effects:{buildings:{loom_house:.2}}},{id:"feudalism",name:"",desc:" +15%",cost:{science:3500},epoch:3,effects:{buildings:{large_estate:.15}}},{id:"basic_weaving",name:"",desc:" +25%",cost:{science:3150},epoch:3,effects:{buildings:{loom_house:.25}}},{id:"theology",name:"",desc:" +30%",cost:{science:3850},epoch:3,effects:{buildings:{church:.3}}},{id:"bureaucracy",name:"",desc:" +5% 0.3 ",cost:{science:4200},epoch:3,effects:{categories:{gather:.05,industry:.05,civic:.05},passive:{culture:.3}}},{id:"three_field_system",name:"",desc:" +15% ",cost:{science:3850},epoch:3,effects:{buildings:{farm:.15,large_estate:.15}}},{id:"stone_keep_engineering",name:"",desc:" 10%",cost:{science:4025},epoch:3,effects:{buildings:{hut:.1,house:.1}}},{id:"ritual_priesthood",name:"",desc:" 15%",cost:{science:1190},epoch:3,effects:{buildings:{church:.15}}},{id:"ironworking",name:"",desc:" +30%",cost:{science:1500},epoch:2,effects:{buildings:{mine:.3}}},{id:"cartography",name:"",desc:" +25%",cost:{science:6300},epoch:4,effects:{buildings:{dockyard:.25}}},{id:"charter_companies",name:"",desc:" +30% +1 ",cost:{science:6650},epoch:4,effects:{buildings:{trade_port:.3},passive:{silver:1}}},{id:"navigator_schooling",name:"",desc:" 30%",cost:{science:7e3},epoch:4,effects:{buildings:{navigator_school:.3}}},{id:"naval_artillery",name:"",desc:" 15% ",cost:{science:7350},epoch:4,effects:{buildings:{dockyard:.15}}},{id:"colonial_ledgers",name:"",desc:" +20% 1.5 ",cost:{science:7700},epoch:4,effects:{buildings:{dockyard:.2,trade_port:.2},passive:{silver:1.5}}},{id:"spice_monopolies",name:"",desc:" 15% ",cost:{science:8050},epoch:4,effects:{buildings:{trade_port:.15}}},{id:"coffee_agronomy",name:"",desc:" +30%",cost:{science:14400},epoch:5,effects:{buildings:{coffee_plantation:.3}}},{id:"coffeehouse_philosophy",name:"",desc:" +35% +0.4 ",cost:{science:15300},epoch:5,effects:{buildings:{coffee_house:.35},passive:{culture:.4}}},{id:"printing_press",name:"",desc:" 35% ",cost:{science:16200},epoch:5,effects:{buildings:{printing_house:.35}}},{id:"public_schooling",name:"",desc:" +25%  +0.2 ",cost:{science:17100},epoch:5,effects:{buildings:{library:.25},passive:{culture:.2}}},{id:"social_contract",name:"",desc:" +20% +15 0.5 ",cost:{science:18e3},epoch:5,effects:{categories:{civic:.2},maxPop:15,passive:{culture:.5}}},{id:"salon_debates",name:"",desc:" 15%",cost:{science:18900},epoch:5,effects:{buildings:{amphitheater:.15}}},{id:"coal_gasification",name:"",desc:" +30%",cost:{science:23400},epoch:6,effects:{buildings:{coal_mine:.3}}},{id:"steel_alloys",name:"",desc:" +30%",cost:{science:24300},epoch:6,effects:{buildings:{steel_foundry:.3}}},{id:"industrialization",name:"",desc:" +10%",cost:{science:27e3},epoch:6,effects:{categories:{industry:.1}}},{id:"steam_power",name:"",desc:" +20% ",cost:{science:28800},epoch:6,effects:{categories:{industry:.2}}},{id:"chemical_fertilizer",name:"",desc:" +20% ",cost:{science:27e3},epoch:6,effects:{buildings:{farm:.2,large_estate:.2}}},{id:"rail_network",name:"",desc:" +30% +10%",cost:{science:27900},epoch:6,effects:{buildings:{rail_depot:.3},categories:{gather:.1}}},{id:"precision_tools",name:"",desc:" +25%",cost:{science:28800},epoch:6,effects:{buildings:{factory:.25}}},{id:"military_training",name:"",desc:" +15%",cost:{science:2800},epoch:2,effects:{categories:{military:.15}}},{id:"fortification",name:"",desc:" +25% +10",cost:{science:8400},epoch:4,effects:{categories:{military:.25},maxPop:10}},{id:"mechanized_weaving",name:"",desc:" +20% +15%",cost:{science:13500},epoch:5,effects:{buildings:{loom_house:.2,tailor_workshop:.15}}},{id:"assembly_line",name:"",desc:" +25% +20%",cost:{science:26100},epoch:6,effects:{buildings:{textile_mill:.25,garment_factory:.2}}},{id:"hydraulic_sawing",name:"",desc:" +25% +15%",cost:{science:12600},epoch:5,effects:{buildings:{sawmill:.25,lumber_camp:.15}}},{id:"mass_production",name:"",desc:" +20% +25%",cost:{science:25200},epoch:6,effects:{buildings:{lumber_mill:.2,furniture_workshop:.25}}},{id:"advanced_metallurgy",name:"",desc:" +20% +15%",cost:{science:7700},epoch:4,effects:{buildings:{iron_tool_workshop:.2,bronze_foundry:.15}}},{id:"bessemer_process",name:"",desc:" +30% +25%",cost:{science:27900},epoch:6,effects:{buildings:{steel_foundry:.3,metallurgy_workshop:.25}}},{id:"industrial_ceramics",name:"",desc:" +25%",cost:{science:11700},epoch:5,effects:{buildings:{brickworks:.25}}},{id:"standardized_construction",name:"",desc:" +25% +15",cost:{science:24300},epoch:6,effects:{buildings:{building_materials_plant:.25},maxPop:15}},{id:"food_preservation",name:"",desc:"",cost:{science:22500},epoch:6,effects:{buildings:{culinary_kitchen:.25}}},{id:"distillation",name:"",desc:"",cost:{science:14400},epoch:5,effects:{buildings:{brewery:.3}}},{id:"wood_pulp_process",name:"",desc:"",cost:{science:13050},epoch:5,effects:{buildings:{reed_works:.3}}},{id:"mass_media",name:"",desc:" +30% +20%",cost:{science:24750},epoch:6,effects:{buildings:{printing_house:.3,publishing_house:.2}}},{id:"deep_shaft_mining",name:"",desc:"",cost:{science:23400},epoch:6,effects:{buildings:{mine:.25,coal_mine:.2}}},{id:"agricultural_machinery",name:"",desc:"",cost:{science:25200},epoch:6,effects:{buildings:{farm:.25,large_estate:.3}}},{id:"steam_logging",name:"",desc:"",cost:{science:22500},epoch:6,effects:{buildings:{lumber_camp:.3}}},{id:"higher_education",name:"",desc:"",cost:{science:15750},epoch:5,effects:{buildings:{library:.2,navigator_school:.2}}},{id:"grand_arts",name:"",desc:"",cost:{science:17100},epoch:5,effects:{buildings:{amphitheater:.25,church:.15}}},{id:"urban_architecture",name:"",desc:"",cost:{science:26100},epoch:6,effects:{buildings:{house:.2},maxPop:20}},{id:"financial_capitalism",name:"",desc:" +20% +15% 2 ",cost:{science:29250},epoch:6,effects:{buildings:{trade_port:.2,rail_depot:.15},passive:{silver:2}}}],nd=[{id:"communal_granary",name:"",desc:"",category:"social",unlockEpoch:0,cost:{},effects:[" -15%"," +8%"," -10%"],drawbacks:[" -5%"],modifiers:{needsReduction:.15,maxPop:.08,categories:{gather:-.05},resourceDemandMod:{food:-.1}},active:!1},{id:"shaman_council",name:"",desc:"",category:"culture",unlockEpoch:0,cost:{},effects:[" +10%"," +5%"," +15%"],drawbacks:[" -2 "],modifiers:{categories:{civic:.1},buildings:{library:.05},passive:{silver:-2,culture:.5},resourceDemandMod:{culture:.15}},active:!1},{id:"hunting_party",name:"",desc:"",category:"economy",unlockEpoch:0,cost:{},effects:[" +12%"," +5%"," +15%"],drawbacks:[" -2 "],modifiers:{categories:{gather:.12,military:.05},passive:{food:-2},resourceSupplyMod:{food:.15}},active:!1},{id:"blood_oath",name:"",desc:"",category:"military",unlockEpoch:0,cost:{},effects:[" +15%"," -5%"," -10%"],drawbacks:[" -8%"],modifiers:{categories:{military:.15,industry:-.08},needsReduction:.05,stratumDemandMod:{soldier:-.1}},active:!1},{id:"corvee_labor",name:"",desc:"",category:"economy",unlockEpoch:1,cost:{},effects:[" +18%"," -10%"," +12%"],drawbacks:[" -8%"," +5%"],modifiers:{categories:{gather:.18},buildCostReduction:.1,maxPop:-.08,needsReduction:-.05,resourceSupplyMod:{stone:.12}},active:!1},{id:"divine_kingship",name:"",desc:"",category:"culture",unlockEpoch:1,cost:{},effects:[" +15%"," +8%"," +20%"],drawbacks:[" -10%"],modifiers:{categories:{civic:.15,military:.08},buildings:{library:-.1,university:-.1},stratumDemandMod:{landowner:.2}},active:!1},{id:"bronze_standardization",name:"",desc:"",category:"economy",unlockEpoch:1,cost:{},effects:[" +12%"," +10%"," +20%"],drawbacks:[" -3 "],modifiers:{categories:{industry:.12,military:.1},passive:{silver:-3},resourceDemandMod:{copper:.2}},active:!1},{id:"temple_economy",name:"",desc:"",category:"economy",unlockEpoch:1,cost:{},effects:[" +5 "," +8%"," +15%"],drawbacks:[" -5%"],modifiers:{passive:{silver:5,culture:1},categories:{civic:.08,industry:-.05},stratumDemandMod:{cleric:.15}},active:!1},{id:"warrior_caste",name:"",desc:"",category:"military",unlockEpoch:1,cost:{},effects:[" +20%"," +15%"," +18%"],drawbacks:[" -8%"," -4 "],modifiers:{categories:{military:.2,gather:-.08},buildings:{barracks:.15,training_ground:.15},passive:{silver:-4},resourceDemandMod:{tools:.18}},active:!1},{id:"bread_and_circus",name:"",desc:"",category:"social",unlockEpoch:2,cost:{},effects:[" -18%"," +10%"," +15%"," +20%"],drawbacks:[" -6 "," -4 "],modifiers:{needsReduction:.18,categories:{civic:.1},passive:{food:-6,silver:-4},resourceDemandMod:{food:.15,culture:.2}},active:!1},{id:"twelve_tables",name:"",desc:"",category:"social",unlockEpoch:2,cost:{},effects:[" +12%"," +6%"," +10%"],drawbacks:[" -5%"],modifiers:{categories:{civic:.12,military:-.05},maxPop:.06,passive:{culture:.8},resourceDemandMod:{copper:.1}},active:!1},{id:"agora_assembly",name:"",desc:"",category:"culture",unlockEpoch:2,cost:{},effects:[" +15%"," +8%"," +15%"," +12%"],drawbacks:[" -6%"],modifiers:{buildings:{library:.15,university:.1},categories:{civic:.08,gather:-.06},passive:{science:1.5},stratumDemandMod:{scribe:.15},resourceDemandMod:{papyrus:.12}},active:!1},{id:"salt_monopoly",name:"",desc:"",category:"economy",unlockEpoch:2,cost:{},effects:[" +8 "," +6%"," +10%"," -8%"],drawbacks:[" +8%"," -5%"],modifiers:{passive:{silver:8},categories:{industry:.06},needsReduction:-.08,maxPop:-.05,resourceSupplyMod:{iron:.1},resourceDemandMod:{tools:-.08}},active:!1},{id:"phalanx_drill",name:"",desc:"",category:"military",unlockEpoch:2,cost:{},effects:[" +18%"," +20%"," +12%"," +15%"],drawbacks:[" -5 "," -3 "],modifiers:{categories:{military:.18},buildings:{barracks:.2,training_ground:.15},passive:{silver:-5,food:-3},stratumDemandMod:{soldier:.12},resourceDemandMod:{tools:.15}},active:!1},{id:"guild_charter",name:"",desc:"",category:"economy",unlockEpoch:2,cost:{},effects:[" +15%"," +8%"," +10%"," +12%"],drawbacks:[" -4 "],modifiers:{buildings:{loom_house:.15,furniture_workshop:.15,dye_works:.15,tailor_workshop:.12},categories:{industry:.08},passive:{silver:-4},stratumDemandMod:{artisan:.1},resourceSupplyMod:{cloth:.12}},active:!1},{id:"road_network",name:"",desc:"",category:"economy",unlockEpoch:2,cost:{},effects:[" +10%"," +8%"," +5%"," +15%"," +10%"],drawbacks:[" -6 "],modifiers:{categories:{gather:.1,industry:.08,military:.05},passive:{silver:-6},stratumDemandMod:{merchant:.15},resourceDemandMod:{stone:.1}},active:!1},{id:"feudal_levy",name:"",desc:"",category:"military",unlockEpoch:3,cost:{},effects:[" +22%"," +15%"," +20%"," +10%"],drawbacks:[" -10%"," -3 "],modifiers:{categories:{military:.22,gather:-.1},buildings:{barracks:.15,fortress:.15},passive:{food:-3},stratumDemandMod:{knight:.2},resourceDemandMod:{food:.1}},active:!1},{id:"magna_carta",name:"",desc:"",category:"social",unlockEpoch:3,cost:{},effects:[" +15%"," +8%"," +5%"," +12%"," -10%"],drawbacks:[" -8%"],modifiers:{categories:{civic:.15,military:-.08},maxPop:.08,stratumDemandMod:{official:.12,landowner:-.1},buildings:{library:.05},passive:{culture:1}},active:!1},{id:"tithe",name:"",desc:"",category:"culture",unlockEpoch:3,cost:{},effects:[" +7 "," +5%"," +18%"," +10%"],drawbacks:[" +8%"," -4%"],modifiers:{passive:{silver:7,culture:.5},categories:{civic:.05,industry:-.04},needsReduction:-.08,stratumDemandMod:{cleric:.18},resourceSupplyMod:{culture:.1}},active:!1},{id:"hanseatic_law",name:"",desc:"",category:"economy",unlockEpoch:3,cost:{},effects:["/ +18%"," +6 "," +20%"," +15%"],drawbacks:[" -5%"],modifiers:{buildings:{market:.18,trade_port:.18,trading_post:.12},passive:{silver:6},categories:{gather:-.05},stratumDemandMod:{merchant:.2},resourceDemandMod:{spice:.15}},active:!1},{id:"inquisition",name:"",desc:"",category:"culture",unlockEpoch:3,cost:{},effects:[" -12%"," +8%"," -20%"," -15%"],drawbacks:[" -15%"," -5%"],modifiers:{needsReduction:.12,categories:{civic:.08},buildings:{library:-.15,university:-.15},maxPop:-.05,stratumDemandMod:{scribe:-.2},resourceDemandMod:{papyrus:-.15}},active:!1},{id:"guild_monopoly",name:"",desc:"",category:"economy",unlockEpoch:3,cost:{},effects:[" +15%"," +12%"," +15%"," +12%"],drawbacks:[" +6%"," -3 "],modifiers:{categories:{industry:.15},buildings:{loom_house:.12,furniture_workshop:.12,tailor_workshop:.12,stone_tool_workshop:.12},needsReduction:-.06,passive:{silver:-3},stratumDemandMod:{artisan:.15},resourceSupplyMod:{furniture:.12}},active:!1},{id:"knight_tournament",name:"",desc:"",category:"military",unlockEpoch:3,cost:{},effects:[" +15%"," +10%"," +18%"," +12%"," +20%"],drawbacks:[" -5 "," -2 "],modifiers:{categories:{military:.15},passive:{silver:-5,food:-2,culture:2},stratumDemandMod:{knight:.18,landowner:.12},resourceDemandMod:{ale:.2}},active:!1},{id:"serfdom",name:"",desc:"",category:"social",unlockEpoch:3,cost:{},effects:[" +20%"," +15%"," -15%"," +12%"," +20%"],drawbacks:[" -10%"," +10%"," -8%"],modifiers:{categories:{gather:.2,industry:-.08},buildings:{farm:.15,large_estate:.15},maxPop:-.1,needsReduction:-.1,stratumDemandMod:{serf:-.15,landowner:.2},resourceSupplyMod:{food:.12}},active:!1},{id:"navigation_act",name:"",desc:"",category:"economy",unlockEpoch:4,cost:{},effects:["/ +25%"," +8 "," +15%"," +10%"],drawbacks:[" -6%"," +5%"],modifiers:{buildings:{dockyard:.25,trade_port:.2},passive:{silver:8},categories:{gather:-.06},needsReduction:-.05,stratumDemandMod:{navigator:.15},resourceSupplyMod:{spice:.1}},active:!1},{id:"encomienda",name:"",desc:"",category:"economy",unlockEpoch:4,cost:{},effects:[" +22%"," +6 "," -20%"," +15%"],drawbacks:[" -10%"," -8%"],modifiers:{categories:{gather:.22,civic:-.1},passive:{silver:6},maxPop:-.08,stratumDemandMod:{serf:-.2},resourceSupplyMod:{food:.15}},active:!1},{id:"joint_stock",name:"",desc:"",category:"economy",unlockEpoch:4,cost:{},effects:[" +20%"," +10 "," +25%"," +18%"," +20%"],drawbacks:[" -4 "],modifiers:{buildings:{market:.2,trade_port:.15},passive:{silver:10,food:-4},stratumDemandMod:{capitalist:.25,merchant:.18},resourceDemandMod:{spice:.2}},active:!1},{id:"press_gang",name:"",desc:"",category:"military",unlockEpoch:4,cost:{},effects:[" +18%"," +20%"," -15%"," +10%"],drawbacks:[" -8%"," -6%"],modifiers:{categories:{military:.18,civic:-.08},buildings:{dockyard:.2},maxPop:-.06,stratumDemandMod:{navigator:-.15},resourceDemandMod:{ale:.1}},active:!1},{id:"bullionism",name:"",desc:"",category:"economy",unlockEpoch:4,cost:{},effects:[" +12 "," -12%"," -20%"," +8%"],drawbacks:[" -15%"," -5%"],modifiers:{passive:{silver:12},categories:{industry:-.05},buildings:{trade_port:-.15},stratumDemandMod:{merchant:-.12},resourceDemandMod:{spice:-.2},resourceSupplyMod:{cloth:.08}},active:!1},{id:"printing_privilege",name:"",desc:"",category:"culture",unlockEpoch:4,cost:{},effects:[" +25%"," +4 "," -10%"," +15%"],drawbacks:[" -8%"],modifiers:{buildings:{printing_house:.25,publishing_house:.2},passive:{silver:4},buildings_negative:{library:-.08},stratumDemandMod:{scribe:-.1},resourceSupplyMod:{papyrus:.15}},active:!1},{id:"plantation_system",name:"",desc:"",category:"economy",unlockEpoch:4,cost:{},effects:["/ +20%"," +0.5 /"," +15%"," +20%"," +18%"],drawbacks:[" +10%"," -6%"],modifiers:{buildings:{farm:.2,large_estate:.25},passive:{spice:.5,coffee:.5},needsReduction:-.1,categories:{civic:-.06},stratumDemandMod:{landowner:.15},resourceSupplyMod:{coffee:.2,spice:.18}},active:!1},{id:"enlightened_despotism",name:"",desc:"",category:"social",unlockEpoch:5,cost:{},effects:[" +18%"," +12%"," +8%"," +15%"," +12%"],drawbacks:[" -8 "],modifiers:{categories:{civic:.18,industry:.08},buildings:{library:.12,university:.12},passive:{silver:-8,science:2},stratumDemandMod:{official:.15,engineer:.12}},active:!1},{id:"habeas_corpus",name:"",desc:"",category:"social",unlockEpoch:5,cost:{},effects:[" +15%"," +10%"," +10%"," +8%"],drawbacks:[" -8%"],modifiers:{categories:{civic:.15,military:-.08},maxPop:.1,passive:{culture:1.5},stratumDemandMod:{worker:.1,merchant:.08}},active:!1},{id:"royal_academy",name:"",desc:"",category:"culture",unlockEpoch:5,cost:{},effects:[" +30%"," +20%"," +25%"," +20%"],drawbacks:[" -8 "],modifiers:{buildings:{university:.3,library:.15,navigator_school:.15},passive:{silver:-8,science:3},stratumDemandMod:{scribe:.25},resourceDemandMod:{papyrus:.2}},active:!1},{id:"physiocracy",name:"",desc:"",category:"economy",unlockEpoch:5,cost:{},effects:[" +18%"," +20%"," +10%"," +15%"," -15%"],drawbacks:[" -8%"," -10%"],modifiers:{categories:{gather:.18,industry:-.08},buildings:{farm:.2,large_estate:.15,market:-.1},stratumDemandMod:{peasant:.1,merchant:-.15},resourceSupplyMod:{food:.15}},active:!1},{id:"patent_system",name:"",desc:"",category:"economy",unlockEpoch:5,cost:{},effects:[" +15%"," +18%"," +20%"," +10%"],drawbacks:[" -5 "],modifiers:{categories:{industry:.15},buildings:{factory:.18,steel_works:.15,printing_house:.12},passive:{silver:-5,science:1},stratumDemandMod:{engineer:.2},resourceSupplyMod:{steel:.1}},active:!1},{id:"freedom_of_press",name:"",desc:"",category:"culture",unlockEpoch:5,cost:{},effects:["/ +25%"," +10%"," +15%"," +15%"," +18%"],drawbacks:[" -5%"],modifiers:{buildings:{printing_house:.25,publishing_house:.25},categories:{civic:-.05},stratumDemandMod:{scribe:.15},resourceDemandMod:{papyrus:.18},passive:{science:2,culture:3}},active:!1},{id:"standing_army",name:"",desc:"",category:"military",unlockEpoch:5,cost:{},effects:[" +25%"," +20%"," +20%"," +15%"," +12%"],drawbacks:[" -10 "," -5 "],modifiers:{categories:{military:.25},buildings:{fortress:.2,barracks:.15},passive:{silver:-10,food:-5},stratumDemandMod:{soldier:.2},resourceDemandMod:{tools:.15,food:.12}},active:!1},{id:"social_contract",name:"",desc:"",category:"social",unlockEpoch:5,cost:{},effects:[" -15%"," +12%"," +8%"," -12%"," +8%"],drawbacks:[" -10%"],modifiers:{needsReduction:.15,categories:{civic:.12,military:-.1},maxPop:.08,passive:{culture:2},stratumDemandMod:{landowner:-.12,peasant:.08}},active:!1},{id:"factory_act",name:"",desc:"",category:"social",unlockEpoch:6,cost:{},effects:[" -12%"," +10%"," +10%"," -8%"],drawbacks:[" -8%"," -4 "],modifiers:{needsReduction:.12,maxPop:.1,categories:{industry:-.08},passive:{silver:-4},stratumDemandMod:{worker:.1},resourceDemandMod:{tools:-.08}},active:!1},{id:"corn_laws_repeal",name:"",desc:"",category:"economy",unlockEpoch:6,cost:{},effects:[" -10%"," +10%"," +12%"," -10%"," -15%"],drawbacks:[" -12%"," -10%"],modifiers:{needsReduction:.1,categories:{industry:.1,gather:-.12},buildings:{farm:-.1},stratumDemandMod:{worker:.12,landowner:-.15},resourceDemandMod:{food:-.1}},active:!1},{id:"laissez_faire",name:"",desc:"",category:"economy",unlockEpoch:6,cost:{},effects:[" +18%"," +20%"," +25%"," +20%"," +12%"],drawbacks:[" -12%"," +8%"],modifiers:{categories:{industry:.18,civic:-.12},buildings:{market:.2,factory:.15},needsReduction:-.08,stratumDemandMod:{capitalist:.25,merchant:.2},resourceSupplyMod:{steel:.12}},active:!1},{id:"trade_union_act",name:"",desc:"",category:"social",unlockEpoch:6,cost:{},effects:[" -15%"," +10%"," +18%"," -15%"],drawbacks:[" -10%"," -5 "],modifiers:{needsReduction:.15,categories:{civic:.1,industry:-.1},passive:{silver:-5},stratumDemandMod:{worker:.18,capitalist:-.15}},active:!1},{id:"railway_boom",name:"",desc:"",category:"economy",unlockEpoch:6,cost:{},effects:[" +15%"," +15%"," +10%"," +20%"," +25%"," +15%"],drawbacks:[" -12 "],modifiers:{categories:{gather:.15,industry:.15,military:.1},passive:{silver:-12},stratumDemandMod:{engineer:.2,worker:.15},resourceDemandMod:{steel:.25}},active:!1},{id:"mass_conscription",name:"",desc:"",category:"military",unlockEpoch:6,cost:{},effects:[" +30%"," +25%"," +25%"," +18%"," +20%"],drawbacks:[" -15%"," -8%"," -6 "],modifiers:{categories:{military:.3,gather:-.15,industry:-.08},buildings:{barracks:.25,training_ground:.25,fortress:.2},passive:{food:-6},stratumDemandMod:{soldier:.25},resourceDemandMod:{food:.18,tools:.2}},active:!1},{id:"public_education_act",name:"",desc:"",category:"culture",unlockEpoch:6,cost:{},effects:[" +20%"," +15%"," +10%"," +15%"," +15%"],drawbacks:[" -10 "],modifiers:{buildings:{library:.2,university:.15},categories:{civic:.15},maxPop:.1,passive:{silver:-10,science:2},stratumDemandMod:{scribe:.15},resourceDemandMod:{papyrus:.15}},active:!1},{id:"gold_standard",name:"",desc:"",category:"economy",unlockEpoch:6,cost:{},effects:["/ +20%"," +15 "," +15%"," +12%"," +10%"],drawbacks:[" -5%"],modifiers:{buildings:{market:.2,trade_port:.2},passive:{silver:15},categories:{industry:-.05},stratumDemandMod:{merchant:.15},resourceDemandMod:{spice:.12,coffee:.1}},active:!1},{id:"tax_farming",name:"",desc:"",category:"economy",unlockEpoch:1,cost:{},effects:[" +8 "," +12%"," -10%"],drawbacks:[" +10%"," -8%"],modifiers:{passive:{silver:8},needsReduction:-.1,categories:{civic:-.08},stratumDemandMod:{merchant:.12,peasant:-.1}},active:!1},{id:"war_economy",name:"",desc:"",category:"military",unlockEpoch:2,cost:{},effects:[" +35%"," +12%"," +30%"," +25%"," +15%"],drawbacks:[" -15%"," +12%"," -8 "],modifiers:{categories:{military:.35,industry:.12,civic:-.15},needsReduction:-.12,passive:{food:-8},stratumDemandMod:{soldier:.3},resourceDemandMod:{tools:.25},resourceSupplyMod:{tools:.15}},active:!1},{id:"state_granary",name:"",desc:"",category:"social",unlockEpoch:1,cost:{},effects:[" -10%"," +3 "," -8%"," +8%"],drawbacks:[" -5 "],modifiers:{needsReduction:.1,passive:{food:3,silver:-5},resourceDemandMod:{food:-.08},resourceSupplyMod:{food:.08}},active:!1},{id:"sumptuary_laws",name:"",desc:"",category:"social",unlockEpoch:1,cost:{},effects:[" -15%"," +4 "," -20%"," -18%"," -12%"],drawbacks:[" -10%"," -8%"],modifiers:{needsReduction:.15,passive:{silver:4},categories:{industry:-.1},passive_negative:{culture:-1.5},stratumDemandMod:{landowner:-.18},resourceDemandMod:{delicacies:-.2,fine_clothes:-.2,cloth:-.12}},active:!1},{id:"mercenary_contract",name:"",desc:"",category:"military",unlockEpoch:2,cost:{},effects:[" +20%"," +15%"," +12%"],drawbacks:[" -12 "],modifiers:{categories:{military:.2},passive:{silver:-12},stratumDemandMod:{soldier:.15},resourceDemandMod:{tools:.12}},active:!1},{id:"colonial_exploitation",name:"",desc:"",category:"economy",unlockEpoch:4,cost:{},effects:[" +0.6 /"," +10 "," +20%"," +25%"," +25%"],drawbacks:[" -12%"," +8%"],modifiers:{passive:{spice:.6,coffee:.6,silver:10},categories:{civic:-.12},needsReduction:-.08,stratumDemandMod:{merchant:.2},resourceSupplyMod:{spice:.25,coffee:.25}},active:!1}],t5=[{id:"stone_clan",name:"",type:"",color:"text-amber-400",desc:"",appearEpoch:0,expireEpoch:1,marketVolatility:.45,aggression:.65,wealth:350,economyTraits:{resourceBias:{food:1.3,wood:1.1,stone:.8}}},{id:"dawn_tribe",name:"",type:"",color:"text-emerald-400",desc:"",appearEpoch:0,expireEpoch:2,marketVolatility:.25,aggression:.2,wealth:420,economyTraits:{resourceBias:{food:1.4,wood:.9,plank:.7,culture:.5}}},{id:"saffron_city",name:"",type:"",color:"text-orange-300",desc:"",appearEpoch:1,expireEpoch:3,marketVolatility:.33,aggression:.45,wealth:900,economyTraits:{resourceBias:{copper:1.5,brick:1.2,spice:1.2,wood:.8}}},{id:"marble_league",name:"",type:"",color:"text-blue-300",desc:"",appearEpoch:2,expireEpoch:4,marketVolatility:.28,aggression:.35,wealth:1400,economyTraits:{resourceBias:{papyrus:1.5,culture:1.6,stone:1.1,silver:.9}}},{id:"high_kingdom",name:"",type:"",color:"text-red-400",desc:"",appearEpoch:3,expireEpoch:4,marketVolatility:.34,aggression:.6,wealth:1600,economyTraits:{resourceBias:{food:1.3,iron:1.4,tools:1.1,culture:.8}}},{id:"sunset_armada",name:"",type:"",color:"text-amber-500",desc:"",appearEpoch:4,expireEpoch:5,marketVolatility:.37,aggression:.55,wealth:1900,economyTraits:{resourceBias:{spice:1.7,plank:1.3,tools:1.2,silver:1.1}}},{id:"lumiere_republic",name:"",type:"",color:"text-purple-300",desc:"",appearEpoch:5,expireEpoch:6,marketVolatility:.26,aggression:.3,wealth:2100,economyTraits:{resourceBias:{coffee:1.5,culture:1.7,papyrus:1.3,science:1.4}}},{id:"industrial_consortium",name:"",type:"",color:"text-orange-400",desc:"",appearEpoch:6,expireEpoch:7,marketVolatility:.24,aggression:.45,wealth:2600,economyTraits:{resourceBias:{coal:1.6,steel:1.5,tools:1.4,silver:1.2}}},{id:"steppe_horde",name:"",type:"",color:"text-yellow-300",desc:"",appearEpoch:2,expireEpoch:4,marketVolatility:.42,aggression:.75,wealth:1200,culturalTraits:{militaryFocus:!0,tradingStyle:"aggressive",diplomaticModifier:-.1},economyTraits:{resourceBias:{food:1.5,iron:1.2,tools:.9,culture:.6}},specialAbilities:[{type:"raid_bonus",value:.3,desc:" +30%"},{type:"cavalry_discount",value:.2,desc:" -20%"}]},{id:"desert_caravan",name:"",type:"",color:"text-amber-200",desc:"",appearEpoch:2,expireEpoch:5,marketVolatility:.22,aggression:.25,wealth:1800,culturalTraits:{tradingStyle:"merchant",diplomaticModifier:.15,marketExpertise:!0},economyTraits:{resourceBias:{spice:2,silver:1.4,culture:1.2,food:.7}},specialAbilities:[{type:"trade_bonus",value:.25,desc:" +25%"},{type:"market_stability",value:.15,desc:" -15%"}]},{id:"jungle_empire",name:"",type:"",color:"text-green-400",desc:"",appearEpoch:1,expireEpoch:4,marketVolatility:.35,aggression:.4,wealth:1100,culturalTraits:{religiousFocus:!0,scientificAdvancement:.2,isolationist:!0},economyTraits:{resourceBias:{culture:1.8,science:1.5,papyrus:1.3,stone:1.2}},specialAbilities:[{type:"culture_bonus",value:.2,desc:" +20%"},{type:"science_bonus",value:.15,desc:" +15%"}]},{id:"mountain_clans",name:"",type:"",color:"text-slate-300",desc:"",appearEpoch:1,expireEpoch:3,marketVolatility:.38,aggression:.5,wealth:800,culturalTraits:{defensiveFocus:!0,miningExpertise:!0,isolationist:!0},economyTraits:{resourceBias:{stone:1.8,iron:1.6,copper:1.4,food:.8}},specialAbilities:[{type:"mining_bonus",value:.25,desc:" +25%"},{type:"defense_bonus",value:.3,desc:" +30%"}]},{id:"river_confederation",name:"",type:"",color:"text-cyan-400",desc:"",appearEpoch:1,expireEpoch:3,marketVolatility:.28,aggression:.3,wealth:1e3,culturalTraits:{agriculturalFocus:!0,engineeringAdvanced:!0,peacefulTrade:!0},economyTraits:{resourceBias:{food:2,papyrus:1.4,brick:1.2,culture:1.1}},specialAbilities:[{type:"food_production",value:.3,desc:" +30%"},{type:"population_growth",value:.15,desc:" +15%"}]},{id:"island_thalassocracy",name:"",type:"",color:"text-teal-300",desc:"",appearEpoch:3,expireEpoch:5,marketVolatility:.32,aggression:.4,wealth:1700,culturalTraits:{navalSupremacy:!0,tradingStyle:"maritime",explorationBonus:.25},economyTraits:{resourceBias:{plank:1.6,spice:1.5,tools:1.3,silver:1.2}},specialAbilities:[{type:"naval_bonus",value:.35,desc:" +35%"},{type:"trade_route",value:.2,desc:" +20%"}]},{id:"northern_principality",name:"",type:"",color:"text-blue-200",desc:"",appearEpoch:3,expireEpoch:5,marketVolatility:.36,aggression:.55,wealth:1400,culturalTraits:{militaryTradition:!0,resourcefulSurvival:!0,honorCode:!0},economyTraits:{resourceBias:{wood:1.7,plank:1.5,iron:1.3,food:.9}},specialAbilities:[{type:"winter_warfare",value:.25,desc:" +25%"},{type:"lumber_efficiency",value:.2,desc:" +20%"}]},{id:"silk_empire",name:"",type:"",color:"text-rose-300",desc:"",appearEpoch:2,expireEpoch:6,marketVolatility:.25,aggression:.35,wealth:2200,culturalTraits:{culturalHegemony:!0,bureaucraticEfficiency:.2,tradingStyle:"monopolistic"},economyTraits:{resourceBias:{culture:2,papyrus:1.6,silver:1.4,science:1.3}},specialAbilities:[{type:"culture_influence",value:.3,desc:" +30%"}]},{id:"nomad_confederation",name:"",type:"",color:"text-orange-200",desc:"",appearEpoch:1,expireEpoch:3,marketVolatility:.48,aggression:.7,wealth:700,culturalTraits:{mobilityFocus:!0,raidingCulture:!0,adaptability:.25},economyTraits:{resourceBias:{food:1.4,wood:1.1,tools:.9,culture:.7}},specialAbilities:[{type:"mobility_bonus",value:.4,desc:" +40%"},{type:"raid_frequency",value:.3,desc:" +30%"}]},{id:"theocratic_order",name:"",type:"",color:"text-yellow-100",desc:"",appearEpoch:3,expireEpoch:5,marketVolatility:.31,aggression:.65,wealth:1500,culturalTraits:{religiousFervor:!0,militaryDiscipline:.25,missionaryZeal:!0},economyTraits:{resourceBias:{culture:1.6,iron:1.4,tools:1.3,silver:1.2}},specialAbilities:[{type:"holy_war",value:.3,desc:" +30%"},{type:"morale_bonus",value:.25,desc:" +25%"}]},{id:"merchant_republic",name:"",type:"",color:"text-emerald-300",desc:"",appearEpoch:4,expireEpoch:6,marketVolatility:.2,aggression:.25,wealth:2400,culturalTraits:{financialExpertise:!0,tradingStyle:"capitalist",diplomaticModifier:.2},economyTraits:{resourceBias:{silver:1.8,culture:1.4,science:1.3,spice:1.2}},specialAbilities:[{type:"banking_system",value:.25,desc:" +25%"},{type:"trade_network",value:.3,desc:" +30%"}]},{id:"revolutionary_state",name:"",type:"",color:"text-red-300",desc:"",appearEpoch:5,expireEpoch:7,marketVolatility:.4,aggression:.6,wealth:1900,culturalTraits:{revolutionaryZeal:!0,massConscription:.3,ideologicalExport:!0},economyTraits:{resourceBias:{culture:1.5,science:1.4,iron:1.3,food:1.2}},specialAbilities:[{type:"conscription",value:.35,desc:" +35%"},{type:"revolutionary_fervor",value:.2,desc:" +20%"}]},{id:"eternal_city",name:"",type:"",color:"text-red-500",desc:"",appearEpoch:2,expireEpoch:4,marketVolatility:.27,aggression:.65,wealth:1600,culturalTraits:{legalTradition:!0,militaryDiscipline:.3,infrastructureFocus:!0},economyTraits:{resourceBias:{stone:1.5,iron:1.4,culture:1.3,silver:1.2}},specialAbilities:[{type:"military_trade",desc:""},{type:"high_aggression",desc:""}]},{id:"golden_crescent",name:"",type:"",color:"text-yellow-400",desc:"",appearEpoch:1,expireEpoch:3,marketVolatility:.3,aggression:.45,wealth:1100,culturalTraits:{cradle:!0,writingInventor:!0,astronomyAdvanced:!0},economyTraits:{resourceBias:{food:1.6,brick:1.5,papyrus:1.4,culture:1.3}},specialAbilities:[{type:"agricultural_trade",desc:""},{type:"cultural_focus",desc:""}]},{id:"pyramid_kingdom",name:"",type:"",color:"text-amber-300",desc:"",appearEpoch:1,expireEpoch:3,marketVolatility:.25,aggression:.35,wealth:1300,culturalTraits:{monumentBuilding:!0,divineKingship:!0,riverCivilization:!0},economyTraits:{resourceBias:{stone:1.8,food:1.5,papyrus:1.4,culture:1.6}},specialAbilities:[{type:"stone_trade",desc:""},{type:"cultural_export",desc:""}]},{id:"agora_polis",name:"",type:"",color:"text-sky-400",desc:"",appearEpoch:2,expireEpoch:4,marketVolatility:.29,aggression:.3,wealth:1200,culturalTraits:{democracyBirthplace:!0,philosophyCenter:!0,navalTradition:!0},economyTraits:{resourceBias:{culture:2,science:1.8,silver:1.3,papyrus:1.2}},specialAbilities:[{type:"knowledge_trade",desc:""},{type:"peaceful_focus",desc:""}]},{id:"sparta_militaris",name:"",type:"",color:"text-red-600",desc:"''",appearEpoch:2,expireEpoch:4,marketVolatility:.35,aggression:.85,wealth:900,culturalTraits:{militarySociety:!0,austereLiving:!0,helotSystem:!0},economyTraits:{resourceBias:{iron:1.6,food:1.3,tools:1.2,culture:.5}},specialAbilities:[{type:"iron_trade",desc:""},{type:"warlike",desc:""}]},{id:"carthago_nova",name:"",type:"",color:"text-purple-400",desc:"",appearEpoch:2,expireEpoch:4,marketVolatility:.26,aggression:.5,wealth:1800,culturalTraits:{mercantileTradition:!0,mercenaryArmy:!0,navalCommerce:!0},economyTraits:{resourceBias:{silver:1.7,spice:1.5,plank:1.4,tools:1.2}},specialAbilities:[{type:"silver_trade",desc:""},{type:"naval_commerce",desc:""}]},{id:"viking_raiders",name:"",type:"",color:"text-blue-400",desc:"",appearEpoch:3,expireEpoch:4,marketVolatility:.45,aggression:.8,wealth:1100,culturalTraits:{seafaringMastery:!0,raidingCulture:!0,explorerSpirit:!0},economyTraits:{resourceBias:{plank:1.6,iron:1.4,food:1.2,silver:1.1}},specialAbilities:[{type:"timber_trade",desc:""},{type:"raider",desc:""}]},{id:"mongol_horde",name:"",type:"",color:"text-amber-500",desc:"",appearEpoch:3,expireEpoch:5,marketVolatility:.5,aggression:.9,wealth:1600,culturalTraits:{horseLordSupremacy:!0,rapidConquest:!0,tradeProtection:!0},economyTraits:{resourceBias:{food:1.4,iron:1.5,silver:1.3,spice:1.2}},specialAbilities:[{type:"conquest_trade",desc:""},{type:"extreme_aggression",desc:""}]},{id:"shogunate",name:"",type:"",color:"text-rose-400",desc:"",appearEpoch:3,expireEpoch:6,marketVolatility:.28,aggression:.55,wealth:1400,culturalTraits:{bushidoCode:!0,isolationism:!0,craftExcellence:!0},economyTraits:{resourceBias:{iron:1.5,culture:1.4,food:1.3,tools:1.2}},specialAbilities:[{type:"craft_trade",desc:""},{type:"cultural_isolation",desc:""}]},{id:"ming_celestial",name:"",type:"",color:"text-yellow-500",desc:"",appearEpoch:3,expireEpoch:6,marketVolatility:.22,aggression:.35,wealth:2500,culturalTraits:{celestialMandate:!0,examSystem:!0,tributeSystem:!0},economyTraits:{resourceBias:{culture:1.8,science:1.5,silver:1.4,papyrus:1.3}},specialAbilities:[{type:"luxury_trade",desc:""},{type:"wealthy_empire",desc:""}]},{id:"ottoman_sublime",name:"",type:"",color:"text-emerald-400",desc:"",appearEpoch:4,expireEpoch:6,marketVolatility:.3,aggression:.6,wealth:2e3,culturalTraits:{gunpowderEmpire:!0,janissarySystem:!0,multiculturalRule:!0},economyTraits:{resourceBias:{spice:1.5,iron:1.4,culture:1.3,silver:1.3}},specialAbilities:[{type:"spice_trade",desc:""},{type:"expansionist",desc:""}]},{id:"spanish_conquistador",name:"",type:"",color:"text-orange-500",desc:"",appearEpoch:4,expireEpoch:6,marketVolatility:.35,aggression:.7,wealth:2200,culturalTraits:{conquistadorSpirit:!0,religiousMission:!0,colonialEmpire:!0},economyTraits:{resourceBias:{silver:2,spice:1.5,culture:1.2,iron:1.2}},specialAbilities:[{type:"silver_monopoly",desc:""},{type:"aggressive_colonial",desc:""}]},{id:"british_empire",name:"",type:"",color:"text-blue-500",desc:"",appearEpoch:5,expireEpoch:7,marketVolatility:.23,aggression:.55,wealth:2800,culturalTraits:{navalSupremacy:!0,parliamentarySystem:!0,industrialPioneer:!0},economyTraits:{resourceBias:{coal:1.6,steel:1.5,silver:1.4,culture:1.3}},specialAbilities:[{type:"industrial_trade",desc:""},{type:"naval_dominance",desc:""}]},{id:"prussian_eagle",name:"",type:"",color:"text-slate-400",desc:"",appearEpoch:5,expireEpoch:7,marketVolatility:.25,aggression:.7,wealth:2100,culturalTraits:{militaryPrecision:!0,bureaucraticState:!0,junkertradition:!0},economyTraits:{resourceBias:{iron:1.6,coal:1.4,tools:1.3,science:1.2}},specialAbilities:[{type:"military_industry",desc:""},{type:"disciplined_trade",desc:""}]},{id:"american_frontier",name:"",type:"",color:"text-blue-300",desc:"",appearEpoch:5,expireEpoch:7,marketVolatility:.32,aggression:.45,wealth:2300,culturalTraits:{manifestDestiny:!0,frontierSpirit:!0,democraticIdeals:!0},economyTraits:{resourceBias:{food:1.5,coal:1.4,steel:1.3,silver:1.2}},specialAbilities:[{type:"resource_trade",desc:""},{type:"moderate_expansion",desc:""}]},{id:"tsarist_empire",name:"",type:"",color:"text-indigo-400",desc:"",appearEpoch:4,expireEpoch:7,marketVolatility:.35,aggression:.6,wealth:1900,culturalTraits:{vastTerritory:!0,autocraticRule:!0,orthodoxFaith:!0},economyTraits:{resourceBias:{food:1.4,iron:1.3,wood:1.5,coal:1.2}},specialAbilities:[{type:"timber_export",desc:""},{type:"vast_resources",desc:""}]},{id:"dutch_voc",name:"",type:"",color:"text-orange-300",desc:"",appearEpoch:4,expireEpoch:6,marketVolatility:.18,aggression:.3,wealth:2600,culturalTraits:{financialInnovation:!0,tradingCompany:!0,religiousTolerance:!0},economyTraits:{resourceBias:{silver:1.8,spice:1.7,culture:1.3,science:1.2}},specialAbilities:[{type:"financial_center",desc:""},{type:"stable_market",desc:""}]},{id:"inca_empire",name:"",type:"",color:"text-yellow-600",desc:"",appearEpoch:3,expireEpoch:5,marketVolatility:.3,aggression:.4,wealth:1500,culturalTraits:{sunWorship:!0,roadNetwork:!0,laborTax:!0},economyTraits:{resourceBias:{stone:1.7,food:1.5,silver:1.4,culture:1.3}},specialAbilities:[{type:"mountain_trade",desc:""},{type:"agricultural_base",desc:""}]},{id:"aztec_empire",name:"",type:"",color:"text-teal-500",desc:"",appearEpoch:3,expireEpoch:5,marketVolatility:.38,aggression:.75,wealth:1300,culturalTraits:{sacrificialCulture:!0,flowerWars:!0,floatingGardens:!0},economyTraits:{resourceBias:{food:1.6,culture:1.5,stone:1.3,silver:1.2}},specialAbilities:[{type:"food_culture",desc:""},{type:"warrior_society",desc:""}]},{id:"byzantine_remnant",name:"",type:"",color:"text-violet-400",desc:"",appearEpoch:3,expireEpoch:5,marketVolatility:.28,aggression:.45,wealth:1700,culturalTraits:{imperialLegacy:!0,orthodoxCenter:!0,diplomaticMastery:!0},economyTraits:{resourceBias:{culture:1.7,silver:1.4,science:1.3,stone:1.2}},specialAbilities:[{type:"trade_focus",desc:""},{type:"diplomatic_focus",desc:""}]},{id:"mali_mansa",name:"",type:"",color:"text-yellow-400",desc:"",appearEpoch:3,expireEpoch:5,marketVolatility:.25,aggression:.3,wealth:2400,culturalTraits:{goldTrade:!0,islamicLearning:!0,transaharaTrade:!0},economyTraits:{resourceBias:{silver:2,culture:1.5,spice:1.3,food:1.2}},specialAbilities:[{type:"gold_trade",desc:""},{type:"peaceful_merchant",desc:""}]},{id:"mughal_splendor",name:"",type:"",color:"text-emerald-300",desc:"",appearEpoch:4,expireEpoch:6,marketVolatility:.27,aggression:.5,wealth:2300,culturalTraits:{artisticPatronage:!0,religiousSyncretism:!0,imperialGrandeur:!0},economyTraits:{resourceBias:{culture:1.8,spice:1.6,silver:1.4,stone:1.3}},specialAbilities:[{type:"luxury_export",desc:""},{type:"wealthy_stable",desc:""}]},{id:"zulu_impi",name:"",type:"",color:"text-green-500",desc:"",appearEpoch:5,expireEpoch:7,marketVolatility:.4,aggression:.8,wealth:1e3,culturalTraits:{militaryInnovation:!0,ageRegiments:!0,cattleWealth:!0},economyTraits:{resourceBias:{food:1.5,iron:1.3,tools:1.1,culture:.8}},specialAbilities:[{type:"basic_resources",desc:""},{type:"warrior_nation",desc:""}]},{id:"polish_winged",name:"",type:"",color:"text-red-200",desc:"",appearEpoch:4,expireEpoch:6,marketVolatility:.32,aggression:.55,wealth:1600,culturalTraits:{nobleRepublic:!0,cavalryTradition:!0,religiousTolerance:!0},economyTraits:{resourceBias:{food:1.4,iron:1.3,culture:1.2,wood:1.2}},specialAbilities:[{type:"cavalry_focus",desc:""},{type:"balanced_aggression",desc:""}]}],Bp=(t,s)=>{const r={0:{light:["militia","slinger"],medium:["militia","slinger"],heavy:["militia","slinger"]},1:{light:["militia","slinger","spearman"],medium:["spearman","archer","light_cavalry"],heavy:["spearman","archer","light_cavalry","swordsman"]},2:{light:["spearman","archer","light_cavalry"],medium:["heavy_infantry","crossbowman","knight"],heavy:["heavy_infantry","crossbowman","knight","swordsman"]},3:{light:["heavy_infantry","crossbowman","knight"],medium:["heavy_infantry","crossbowman","knight"],heavy:["heavy_infantry","crossbowman","knight"]},4:{light:["musketeer","dragoon"],medium:["musketeer","dragoon","cannon"],heavy:["musketeer","dragoon","cannon"]},5:{light:["rifleman","modern_infantry"],medium:["rifleman","modern_infantry","tank"],heavy:["rifleman","modern_infantry","tank","artillery"]},6:{light:["modern_infantry","tank"],medium:["modern_infantry","tank","modern_artillery"],heavy:["modern_infantry","tank","modern_artillery"]}},o=r[Math.min(t,6)]||r[0];return o[s]||o.medium},ky=[{id:"raid",name:"",desc:"",difficulty:"",difficultyLevel:1,unitScale:"light",baseUnitCount:{min:6,max:10},enemyUnits:[],lootConfig:{food:{enemyPercent:.035,playerPercent:.025,baseMin:50},wood:{enemyPercent:.025,playerPercent:.02,baseMin:30},stone:{enemyPercent:.015,playerPercent:.012,baseMin:15},cloth:{enemyPercent:.02,playerPercent:.015,baseMin:20},silver:{enemyPercent:.045,playerPercent:.03,baseMin:80},copper:{enemyPercent:.015,playerPercent:.01,baseMin:10},plank:{enemyPercent:.01,playerPercent:.008,baseMin:8},dye:{enemyPercent:.012,playerPercent:.008,baseMin:6},ale:{enemyPercent:.018,playerPercent:.012,baseMin:10},delicacies:{enemyPercent:.01,playerPercent:.006,baseMin:5},spice:{enemyPercent:.012,playerPercent:.008,baseMin:5},coffee:{enemyPercent:.01,playerPercent:.006,baseMin:4}},loot:{food:[40,120],wood:[20,60],silver:[60,140]},influence:{win:5,lose:-4},winScore:8,loseScore:6,wealthDamage:15},{id:"assault",name:"",desc:"",difficulty:"",difficultyLevel:2,unitScale:"medium",baseUnitCount:{min:12,max:18},enemyUnits:[],requiresTech:"bronze_working",lootConfig:{food:{enemyPercent:.045,playerPercent:.03,baseMin:70},wood:{enemyPercent:.03,playerPercent:.022,baseMin:40},stone:{enemyPercent:.025,playerPercent:.018,baseMin:25},cloth:{enemyPercent:.025,playerPercent:.018,baseMin:25},iron:{enemyPercent:.035,playerPercent:.025,baseMin:30},copper:{enemyPercent:.028,playerPercent:.02,baseMin:20},tools:{enemyPercent:.025,playerPercent:.018,baseMin:15},steel:{enemyPercent:.02,playerPercent:.012,baseMin:8},coal:{enemyPercent:.022,playerPercent:.015,baseMin:12},silver:{enemyPercent:.065,playerPercent:.04,baseMin:180},plank:{enemyPercent:.02,playerPercent:.015,baseMin:15},brick:{enemyPercent:.018,playerPercent:.012,baseMin:12},dye:{enemyPercent:.015,playerPercent:.01,baseMin:8},fine_clothes:{enemyPercent:.012,playerPercent:.008,baseMin:5},ale:{enemyPercent:.02,playerPercent:.015,baseMin:12},delicacies:{enemyPercent:.015,playerPercent:.01,baseMin:8},furniture:{enemyPercent:.01,playerPercent:.006,baseMin:4},spice:{enemyPercent:.015,playerPercent:.01,baseMin:6},coffee:{enemyPercent:.012,playerPercent:.008,baseMin:5},papyrus:{enemyPercent:.012,playerPercent:.008,baseMin:6}},loot:{food:[60,160],iron:[20,50],silver:[150,240]},influence:{win:10,lose:-6},winScore:25,loseScore:20,wealthDamage:30},{id:"siege",name:"",desc:"",difficulty:"",difficultyLevel:3,unitScale:"heavy",baseUnitCount:{min:15,max:25},enemyUnits:[],requiresTech:"fortification",lootConfig:{food:{enemyPercent:.06,playerPercent:.04,baseMin:100},wood:{enemyPercent:.045,playerPercent:.03,baseMin:60},stone:{enemyPercent:.04,playerPercent:.028,baseMin:50},cloth:{enemyPercent:.038,playerPercent:.025,baseMin:40},iron:{enemyPercent:.045,playerPercent:.032,baseMin:45},copper:{enemyPercent:.038,playerPercent:.028,baseMin:35},coal:{enemyPercent:.035,playerPercent:.025,baseMin:30},steel:{enemyPercent:.03,playerPercent:.02,baseMin:20},tools:{enemyPercent:.035,playerPercent:.025,baseMin:25},plank:{enemyPercent:.032,playerPercent:.022,baseMin:25},brick:{enemyPercent:.03,playerPercent:.02,baseMin:25},dye:{enemyPercent:.025,playerPercent:.018,baseMin:15},silver:{enemyPercent:.09,playerPercent:.055,baseMin:300},fine_clothes:{enemyPercent:.028,playerPercent:.018,baseMin:15},furniture:{enemyPercent:.025,playerPercent:.015,baseMin:12},ale:{enemyPercent:.03,playerPercent:.022,baseMin:20},delicacies:{enemyPercent:.028,playerPercent:.02,baseMin:18},spice:{enemyPercent:.025,playerPercent:.018,baseMin:15},coffee:{enemyPercent:.022,playerPercent:.015,baseMin:12},papyrus:{enemyPercent:.025,playerPercent:.018,baseMin:15},science:{enemyPercent:.015,playerPercent:.008,baseMin:10},culture:{enemyPercent:.012,playerPercent:.006,baseMin:8}},loot:{food:[80,180],wood:[40,100],tools:[10,25],silver:[200,320]},influence:{win:14,lose:-10},winScore:52,loseScore:54,wealthDamage:45},{id:"naval_raid",name:"",desc:"",difficulty:"",difficultyLevel:2,unitScale:"medium",baseUnitCount:{min:8,max:14},enemyUnits:[],requiresTech:"sailing",lootConfig:{spice:{enemyPercent:.045,playerPercent:.035,baseMin:30},coffee:{enemyPercent:.04,playerPercent:.03,baseMin:25},dye:{enemyPercent:.035,playerPercent:.028,baseMin:22},fine_clothes:{enemyPercent:.03,playerPercent:.022,baseMin:18},furniture:{enemyPercent:.025,playerPercent:.018,baseMin:12},ale:{enemyPercent:.028,playerPercent:.02,baseMin:15},delicacies:{enemyPercent:.032,playerPercent:.025,baseMin:20},cloth:{enemyPercent:.03,playerPercent:.022,baseMin:25},copper:{enemyPercent:.025,playerPercent:.018,baseMin:18},iron:{enemyPercent:.022,playerPercent:.015,baseMin:15},silver:{enemyPercent:.07,playerPercent:.045,baseMin:200},papyrus:{enemyPercent:.02,playerPercent:.015,baseMin:12},tools:{enemyPercent:.018,playerPercent:.012,baseMin:10}},loot:{silver:[150,280],spice:[20,50],cloth:[20,45]},influence:{win:8,lose:-5},winScore:32,loseScore:38,wealthDamage:25},{id:"scorched_earth",name:"",desc:"",difficulty:"",difficultyLevel:3,unitScale:"heavy",baseUnitCount:{min:12,max:20},enemyUnits:[],requiresTech:"military_training",lootConfig:{food:{enemyPercent:.05,playerPercent:.035,baseMin:80},wood:{enemyPercent:.04,playerPercent:.028,baseMin:50},stone:{enemyPercent:.025,playerPercent:.018,baseMin:30},cloth:{enemyPercent:.03,playerPercent:.02,baseMin:25},dye:{enemyPercent:.02,playerPercent:.012,baseMin:12},silver:{enemyPercent:.055,playerPercent:.035,baseMin:150},coal:{enemyPercent:.025,playerPercent:.018,baseMin:18},tools:{enemyPercent:.02,playerPercent:.012,baseMin:10},ale:{enemyPercent:.025,playerPercent:.018,baseMin:15}},loot:{food:[60,140],wood:[40,90],silver:[100,200]},influence:{win:12,lose:-8},winScore:48,loseScore:42,wealthDamage:60}],a5=[{id:"welcome",title:"",icon:"Globe",iconColor:"text-blue-400",lead:"",paragraphs:["",'""'],callouts:[{tone:"info",icon:"Lightbulb",title:"",text:""}]},{id:"market_economy",title:"",icon:"TrendingUp",iconColor:"text-emerald-400",lead:"",paragraphs:['""'],cards:[{icon:"Coins",iconColor:"text-yellow-400",title:"",text:""},{icon:"BarChart",iconColor:"text-blue-400",title:"",text:""},{icon:"ArrowUpCircle",iconColor:"text-emerald-400",title:"",text:""}],callouts:[{tone:"tip",icon:"Lightbulb",title:"",text:'""  '}]},{id:"resources",title:"",icon:"Package",iconColor:"text-yellow-400",paragraphs:[""],cards:[{icon:"Wheat",iconColor:"text-yellow-400",title:"",text:""},{icon:"Factory",iconColor:"text-blue-400",title:"",text:""},{icon:"Pickaxe",iconColor:"text-emerald-400",title:"",text:""}]},{id:"population",title:"",icon:"Users",iconColor:"text-blue-400",lead:"",paragraphs:[""],cards:[{icon:"Wheat",iconColor:"text-yellow-400",title:"",text:""},{icon:"Home",iconColor:"text-blue-400",title:"",text:""},{icon:"Users",iconColor:"text-purple-400",title:"",text:'""'},{icon:"Heart",iconColor:"text-red-400",title:"",text:""}]},{id:"technology",title:"",icon:"Cpu",iconColor:"text-purple-400",lead:"",paragraphs:[""],cards:[{icon:"BookOpen",iconColor:"text-blue-400",title:"",text:""},{icon:"TrendingUp",iconColor:"text-yellow-400",title:"",text:""},{icon:"Zap",iconColor:"text-purple-400",title:"",text:""}]},{id:"trade_diplomacy",title:"",icon:"Globe",iconColor:"text-cyan-400",lead:"",paragraphs:[""],cards:[{icon:"Handshake",iconColor:"text-emerald-400",title:"",text:""},{icon:"Flag",iconColor:"text-blue-400",title:"",text:""},{icon:"Swords",iconColor:"text-red-400",title:"",text:""}],callouts:[{tone:"tip",icon:"Lightbulb",title:"",text:""}]},{id:"government",title:"",icon:"Gavel",iconColor:"text-amber-400",lead:"",paragraphs:[""],cards:[{icon:"Scale",iconColor:"text-blue-400",title:"",text:""},{icon:"Gavel",iconColor:"text-amber-400",title:"",text:""},{icon:"AlertTriangle",iconColor:"text-red-400",title:"",text:""}],callouts:[{tone:"warning",icon:"AlertTriangle",title:"",text:'"" '}]},{id:"autosave",title:"",icon:"Save",iconColor:"text-emerald-400",paragraphs:["",""],cards:[{icon:"Clock",iconColor:"text-emerald-300",title:"",text:""},{icon:"Save",iconColor:"text-green-200",title:"",text:""},{icon:"Download",iconColor:"text-purple-300",title:"",text:""}],callouts:[{tone:"warning",icon:"AlertTriangle",title:"",text:""}]},{id:"journey",title:"",icon:"Sparkles",iconColor:"text-yellow-400",lead:"",paragraphs:[""," "," "," "," "," "],callouts:[{tone:"success",icon:"Check",title:"",text:""},{tone:"info",icon:"Gift",title:"",text:" 2 "},{tone:"tip",icon:"MessageSquare",title:"",text:""}],wikiPrompt:{text:"",buttonLabel:""},footerNote:""}],Cy=[{id:"plague_outbreak",name:"",icon:"AlertTriangle",image:null,description:"",triggerConditions:{minPopulation:80,minEpoch:1},options:[{id:"quarantine",text:"",description:"",effects:{resourcePercent:{food:-.03,silver:-.012},populationPercent:-.015,stability:-5,approval:{peasant:-10,merchant:-15},resourceDemandMod:{cloth:.2},buildingProductionMod:{market:-.2}}},{id:"pray",text:"",description:"",effects:{resourcePercent:{silver:-.012},populationPercent:-.03,stability:5,approval:{peasant:10,cleric:15},resourceDemandMod:{culture:.15}}},{id:"ignore",text:"",description:"",effects:{populationPercent:-.1,stability:-15,approval:{peasant:-20,merchant:-15},resourceDemandMod:{food:.15},buildingProductionMod:{all:-.25}}}]},{id:"merchant_caravan",name:"",icon:"Users",image:null,description:"",triggerConditions:{minEpoch:1},options:[{id:"trade",text:"",description:"",effects:{resourcePercent:{silver:-.02,delicacies:.02,furniture:.02,fine_clothes:.02,tools:.012},approval:{merchant:15},resourceDemandMod:{spice:.2},stratumDemandMod:{merchant:.15},buildingProductionMod:{market:.1}}},{id:"tax",text:"",description:"",effects:{resourcePercent:{silver:.012},approval:{merchant:-10},resourceDemandMod:{spice:.05}}},{id:"refuse",text:"",description:"",effects:{stability:-3,approval:{merchant:-15,peasant:-5},stratumDemandMod:{merchant:-.1},buildingProductionMod:{market:-.1}}}]},{id:"good_harvest",name:"",icon:"Sun",image:null,description:"",triggerConditions:{minEpoch:0},options:[{id:"store",text:"",description:"",effects:{resourcePercent:{food:.03},approval:{peasant:10},resourceDemandMod:{food:-.15},buildingProductionMod:{farm:.2}}},{id:"sell",text:"",description:"",effects:{resourcePercent:{food:.035,silver:.03},approval:{merchant:15,peasant:-5},stratumDemandMod:{merchant:.15},buildingProductionMod:{market:.15}}},{id:"celebrate",text:"",description:"",effects:{resourcePercent:{food:.02,silver:-.012},stability:10,approval:{peasant:20,merchant:5},resourceDemandMod:{ale:.25}}}]},{id:"technological_breakthrough",name:"",icon:"Lightbulb",image:null,description:"",triggerConditions:{minEpoch:2,minScience:100},options:[{id:"invest",text:"",description:"",effects:{resourcePercent:{silver:-.03,tools:-.015},science:.05,approval:{artisan:20,merchant:10},resourceDemandMod:{tools:.25},buildingProductionMod:{industry:.15}}},{id:"gradual",text:"",description:"",effects:{resourcePercent:{silver:-.012},science:.02,approval:{artisan:10},buildingProductionMod:{industry:.08}}},{id:"monopoly",text:"",description:"",effects:{resourcePercent:{silver:.012},science:.01,stability:-5,approval:{artisan:-15,merchant:-10},resourceDemandMod:{science:-.1},buildingProductionMod:{industry:-.05}}}]},{id:"natural_disaster",name:"",icon:"CloudRain",image:null,description:"",triggerConditions:{minPopulation:60},options:[{id:"relief",text:"",description:"",effects:{resourcePercent:{silver:-.025,food:-.03,wood:-.02},stability:5,approval:{peasant:20,merchant:5},resourceDemandMod:{food:.25,wood:.3},buildingProductionMod:{farm:-.3}}},{id:"rebuild",text:"",description:"",effects:{resourcePercent:{silver:-.02,wood:-.025,stone:-.02},approval:{peasant:15,artisan:10},resourceDemandMod:{wood:.4},buildingProductionMod:{farm:-.2,quarry:.1,lumber_camp:.15}}},{id:"minimal",text:"",description:"",effects:{resourcePercent:{food:-.02},stability:-10,approval:{peasant:-15,merchant:-10},resourceDemandMod:{food:.35},buildingProductionMod:{farm:-.4}}}]},{id:"stone_age_hungry_peasants",name:"",icon:"Wheat",image:null,description:"",triggerConditions:{minEpoch:0,maxEpoch:0,classConditions:{peasant:{minPop:15,maxWealth:250,minApproval:0,maxApproval:55}}},options:[{id:"share_food",text:"",description:"",effects:{resourcePercent:{food:-.015},stability:5,approval:{peasant:18}}},{id:"organize_hunt",text:"",description:"",effects:{resourcePercent:{food:.015},stability:-3,approval:{peasant:8}}},{id:"ignore_hunger",text:'""',description:"",effects:{stability:-8,approval:{peasant:-18}}}]},{id:"stone_age_elder_council",name:"",icon:"ScrollText",image:null,description:"",triggerConditions:{minEpoch:0,classConditions:{peasant:{minPop:10},cleric:{maxPop:2,maxApproval:70}}},options:[{id:"ritual_apology",text:"",description:"",effects:{stability:4,approval:{peasant:10,cleric:5},resourceDemandMod:{culture:.1},stratumDemandMod:{cleric:.08},buildingProductionMod:{lumber_camp:.05}}},{id:"gift_to_elder",text:"",description:"",effects:{resourcePercent:{silver:-.028},stability:2,approval:{peasant:-5,cleric:12},resourceDemandMod:{culture:.03},stratumDemandMod:{cleric:.1},buildingProductionMod:{stone_tool_workshop:.05}}},{id:"reject_council",text:"",description:"",effects:{stability:-6,approval:{peasant:-8,cleric:-6},resourceDemandMod:{culture:-.08},stratumDemandMod:{cleric:-.1},buildingProductionMod:{lumber_camp:-.03}}}]},{id:"bronze_age_miner_unrest",name:"",icon:"Pickaxe",image:null,description:"",triggerConditions:{minEpoch:1,classConditions:{miner:{minPop:12,maxApproval:55}}},options:[{id:"improve_safety",text:"",description:"",effects:{resourcePercent:{wood:-.06,stone:-.045},stability:6,approval:{miner:18,worker:5},resourceDemandMod:{wood:.1,stone:.08,tools:.05},stratumDemandMod:{miner:.15,worker:.08},buildingProductionMod:{copper_mine:.1,quarry:.05}}},{id:"raise_wage",text:"",description:"",effects:{resourcePercent:{silver:-.022},stability:3,approval:{miner:15},resourceDemandMod:{food:.05,tools:.03},stratumDemandMod:{miner:.12},buildingProductionMod:{copper_mine:.08}}},{id:"crackdown_miner",text:"",description:"",effects:{stability:-10,approval:{miner:-20,soldier:8},resourceDemandMod:{tools:.1,food:.05},stratumDemandMod:{miner:-.2,soldier:.15},buildingProductionMod:{copper_mine:-.15}}}]},{id:"bronze_age_merchant_boom",name:"",icon:"Coins",image:null,description:"",triggerConditions:{minEpoch:1,classConditions:{merchant:{minPop:3,minInfluenceShare:.18,minWealthShare:.18}}},options:[{id:"support_merchant",text:"",description:"",effects:{resourcePercent:{silver:.012},stability:-3,approval:{merchant:20,peasant:-6},resourceDemandMod:{spice:.15,cloth:.1,delicacies:.08},stratumDemandMod:{merchant:.2,peasant:-.05},buildingProductionMod:{market:.15,bronze_foundry:.05}}},{id:"tax_merchant",text:"",description:"",effects:{resourcePercent:{silver:.028},stability:1,approval:{merchant:-10,peasant:4},resourceDemandMod:{spice:.05,cloth:.05,delicacies:.03},stratumDemandMod:{merchant:-.08,peasant:.05},buildingProductionMod:{market:.05}}},{id:"protect_peasant",text:"",description:"",effects:{stability:4,approval:{merchant:-12,peasant:10},resourceDemandMod:{food:-.08,spice:-.1},stratumDemandMod:{merchant:-.15,peasant:.12},buildingProductionMod:{farm:.08,market:-.1}}}]},{id:"classical_scribe_salon",name:"",icon:"BookOpen",image:null,description:"",triggerConditions:{minEpoch:2,minScience:800,classConditions:{scribe:{minPop:4},scribe:{minInfluenceShare:.12,minApproval:60}}},options:[{id:"fund_academy",text:"",description:"",effects:{resourcePercent:{papyrus:-80,silver:-.02,science:.08},approval:{scribe:15},resourceDemandMod:{papyrus:.1,science:.12,culture:.08},stratumDemandMod:{scribe:.15},buildingProductionMod:{school:.1,library:.08}}},{id:"guide_public_opinion",text:"",description:"",effects:{stability:6,approval:{scribe:5,peasant:6},resourceDemandMod:{culture:.08},stratumDemandMod:{scribe:.08,peasant:.05},buildingProductionMod:{market:.03}}},{id:"limit_discussion",text:"",description:"",effects:{stability:3,approval:{scribe:-12,landowner:8},resourceDemandMod:{culture:-.1,science:-.08},stratumDemandMod:{scribe:-.15,landowner:.1},buildingProductionMod:{library:-.08}}}]},{id:"classical_landowner_pressure",name:"",icon:"Castle",image:null,description:"",triggerConditions:{minEpoch:2,classConditions:{landowner:{minWealthShare:.25,minInfluenceShare:.2},peasant:{maxApproval:55}}},options:[{id:"grant_privileges",text:"",description:"",effects:{stability:4,approval:{landowner:18,peasant:-10,serf:-8},resourceDemandMod:{delicacies:.12,fine_clothes:.1,furniture:.08},stratumDemandMod:{landowner:.2,peasant:-.12,serf:-.1},buildingProductionMod:{farm:-.08}}},{id:"balance_reform",text:"",description:"",effects:{stability:-4,approval:{landowner:-12,peasant:12},resourceDemandMod:{tools:.08,food:.06},stratumDemandMod:{landowner:-.15,peasant:.15},buildingProductionMod:{farm:.08}}},{id:"stand_with_people",text:"",description:"",effects:{stability:-10,approval:{landowner:-22,peasant:20},resourceDemandMod:{food:.12,tools:.15},stratumDemandMod:{landowner:-.25,peasant:.22},buildingProductionMod:{farm:.15}}}]},{id:"feudal_knight_parade",name:"",icon:"Shield",image:null,description:"",triggerConditions:{minEpoch:3,classConditions:{knight:{minPop:3,minInfluenceShare:.15},soldier:{maxApproval:70}}},options:[{id:"hold_tournament",text:"",description:"",effects:{resourcePercent:{food:-.05,silver:-.022},stability:6,approval:{knight:15,soldier:8,peasant:4},resourceDemandMod:{food:.08,ale:.12,cloth:.1},stratumDemandMod:{knight:.18,soldier:.1,peasant:.06},buildingProductionMod:{market:.08,brewery:.1}}},{id:"praise_soldiers",text:"",description:"",effects:{stability:3,approval:{soldier:15,knight:-8},resourceDemandMod:{food:.05,tools:.08},stratumDemandMod:{soldier:.12,knight:-.1},buildingProductionMod:{training_ground:.1}}},{id:"limit_knight_power",text:"",description:"",effects:{stability:-8,approval:{knight:-20,landowner:-10},resourceDemandMod:{tools:-.1,furniture:-.05},stratumDemandMod:{knight:-.18,landowner:-.08,official:.1}}}]},{id:"feudal_cleric_scandal",name:"",icon:"Cross",image:null,description:"",triggerConditions:{minEpoch:3,classConditions:{cleric:{minWealthShare:.15,maxApproval:80}}},options:[{id:"reform_monastery",text:"",description:"",effects:{resourcePercent:{silver:.03},stability:4,approval:{cleric:-10,peasant:8},resourceDemandMod:{delicacies:-.12,fine_clothes:-.1},stratumDemandMod:{cleric:-.15,peasant:.1},buildingProductionMod:{church:-.2,farm:.08}}},{id:"cover_up",text:"",description:"",effects:{stability:-6,approval:{cleric:10,peasant:-12},resourceDemandMod:{delicacies:.1,fine_clothes:.08},stratumDemandMod:{cleric:.15,peasant:-.1},buildingProductionMod:{church:.12,farm:-.05}}},{id:"tax_church",text:"",description:'""',effects:{resourcePercent:{silver:.02},stability:-2,approval:{cleric:-15,peasant:5},resourceDemandMod:{silver:.08,delicacies:-.05},stratumDemandMod:{cleric:-.12,peasant:.08,official:.06},buildingProductionMod:{church:-.1}}}]},{id:"age_of_exploration_merchant_monopoly",name:"",icon:"Ship",image:null,description:"",triggerConditions:{minEpoch:4,classConditions:{merchant:{minInfluenceShare:.25,minWealthShare:.25}}},options:[{id:"charter_company",text:"",description:"",effects:{resourcePercent:{silver:.045},stability:3,approval:{merchant:20,peasant:-8,worker:-6},resourceDemandMod:{spice:.18,cloth:.15,delicacies:.12},stratumDemandMod:{merchant:.22,peasant:-.1,worker:-.08},buildingProductionMod:{market:.2,trade_port:.15,farm:-.05}}},{id:"break_monopoly",text:"",description:"",effects:{stability:-5,approval:{merchant:-15,peasant:8,worker:6},resourceDemandMod:{spice:.08,cloth:.06,delicacies:.05},stratumDemandMod:{merchant:-.18,peasant:.1,worker:.08},buildingProductionMod:{market:.12,industry:.08}}},{id:"raise_tariff",text:"",description:"",effects:{resourcePercent:{silver:.035},stability:-2,approval:{merchant:-10},resourceDemandMod:{spice:-.1,cloth:-.08,delicacies:-.06},stratumDemandMod:{merchant:-.12},buildingProductionMod:{trade_port:-.15,market:-.1}}}]},{id:"age_of_exploration_colonial_unrest",name:"",icon:"Globe2",image:null,description:"",triggerConditions:{minEpoch:4,classConditions:{worker:{minPop:20,maxApproval:55},miner:{maxApproval:55}}},options:[{id:"send_commissioner",text:"",description:"",effects:{resourcePercent:{silver:-.022},stability:5,approval:{worker:10,miner:10},resourceDemandMod:{food:.08,tools:.06},stratumDemandMod:{worker:.12,miner:.1,official:.08},buildingProductionMod:{mine:.1,bronze_foundry:.05}}},{id:"use_force",text:"",description:"",effects:{stability:-12,approval:{worker:-20,miner:-20,soldier:10},resourceDemandMod:{tools:.15,food:.1},stratumDemandMod:{worker:-.25,miner:-.22,soldier:.18},buildingProductionMod:{mine:-.3,training_ground:.15}}},{id:"cut_tax",text:"",description:"",effects:{resourcePercent:{silver:-.012},stability:3,approval:{worker:8,miner:8,merchant:6},resourceDemandMod:{food:.06,tools:.05},stratumDemandMod:{worker:.1,miner:.08,merchant:.08},buildingProductionMod:{mine:.12,trade_port:.05}}}]},{id:"enlightenment_pamphlet_storm",name:"",icon:"FileText",image:null,description:"",triggerConditions:{minEpoch:5,classConditions:{scribe:{minPop:5},scribe:{minInfluenceShare:.18,minApproval:70}}},options:[{id:"allow_debate",text:"",description:"",effects:{resourcePercent:{science:.08,culture:.08},stability:-6,approval:{scribe:18,peasant:4},resourceDemandMod:{papyrus:.25,culture:.15,science:.12},stratumDemandMod:{scribe:.2,peasant:.08,merchant:.05},buildingProductionMod:{school:.1,library:.15,tavern:.08}}},{id:"censor_print",text:"",description:"",effects:{stability:4,approval:{scribe:-12,cleric:8}}},{id:"coopt_scribes",text:"",description:"",effects:{resourcePercent:{silver:-.025},stability:5,approval:{scribe:10,official:6}}}]},{id:"enlightenment_coffeehouse_circle",name:"",icon:"Coffee",image:null,description:"",triggerConditions:{minEpoch:5,classConditions:{merchant:{minInfluenceShare:.18},engineer:{minInfluenceShare:.12}}},options:[{id:"support_innovation_club",text:"",description:"",effects:{resourcePercent:{silver:-.028,science:.08},approval:{engineer:15,merchant:10},resourceDemandMod:{coffee:.3,delicacies:.15,papyrus:.1,science:.12},stratumDemandMod:{merchant:.18,engineer:.15,scribe:.12,official:.05},buildingProductionMod:{coffee_house:.2,tavern:.1,market:.08}}},{id:"monitor_circle",text:"",description:"",effects:{stability:3,approval:{official:6,merchant:-6}}},{id:"tax_coffee",text:"",description:"",effects:{resourcePercent:{silver:.02},approval:{merchant:-8,engineer:-5,peasant:3}}}]},{id:"industrial_general_strike",name:"",icon:"Hammer",image:null,description:"",triggerConditions:{minEpoch:6,classConditions:{worker:{minPop:30,maxApproval:50,maxWealthDelta:5}}},options:[{id:"agree_partial",text:"",description:"",effects:{resourcePercent:{silver:-.012},stability:6,approval:{worker:20,capitalist:-8},resourceDemandMod:{food:.1,cloth:.08,ale:.05},stratumDemandMod:{worker:.15,capitalist:-.1,official:.08},buildingProductionMod:{textile_mill:.12,industry:.1,market:.05}}},{id:"bring_in_replacements",text:"",description:"",effects:{stability:-10,approval:{worker:-20,peasant:-6,capitalist:10}}},{id:"negotiate_commission",text:"",description:"",effects:{stability:4,approval:{worker:12,capitalist:-4,official:6}}}]},{id:"industrial_capitalist_boom",name:"",icon:"Briefcase",image:null,description:"",triggerConditions:{minEpoch:6,classConditions:{capitalist:{minWealthShare:.3,minInfluenceShare:.22,minWealthDelta:40}}},options:[{id:"encourage_investment",text:"",description:"",effects:{resourcePercent:{science:.06},stability:4,approval:{capitalist:18,worker:-6},resourceDemandMod:{coffee:.2,delicacies:.25,fine_clothes:.18,furniture:.15,steel:.1},stratumDemandMod:{capitalist:.22,merchant:.15,engineer:.12,worker:-.08},buildingProductionMod:{steel_foundry:.18,coffee_house:.1,market:.12}}},{id:"tax_windfall",text:"",description:"",effects:{resourcePercent:{silver:.045},stability:-5,approval:{capitalist:-20,worker:10,peasant:6}}},{id:"fund_welfare",text:"",description:"",effects:{resourcePercent:{silver:-.025},stability:8,approval:{worker:16,capitalist:4}}}]},{id:"comet_sighted",name:"",icon:"Sparkles",image:null,description:"",triggerConditions:{minEpoch:1},options:[{id:"divine_omen",text:"",description:"",effects:{stability:10,approval:{cleric:15,peasant:10,scribe:-10}}},{id:"scientific_phenomenon",text:"",description:"",effects:{resourcePercent:{science:.08},approval:{scribe:15,cleric:-10}}},{id:"ignore_comet",text:"",description:"",effects:{stability:-5,approval:{peasant:-5}}}]},{id:"inventor_plea",name:"",icon:"Lightbulb",image:null,description:"",triggerConditions:{minEpoch:5,classConditions:{engineer:{minPop:5},capitalist:{minPop:2}}},options:[{id:"fund_invention",text:"",description:"",effects:{resourcePercent:{silver:-.012,iron:-.025,tools:-.06,science:.08},approval:{engineer:20,capitalist:15,scribe:10}}},{id:"limited_support",text:"",description:"",effects:{resourcePercent:{silver:-.025,wood:-.02,science:.08},approval:{engineer:10,capitalist:5}}},{id:"reject_invention",text:"",description:"",effects:{approval:{engineer:-15,scribe:-5,capitalist:-5}}}]},{id:"great_flood",name:"",icon:"Waves",image:null,description:"",triggerConditions:{minPopulation:30},options:[{id:"organize_rescue",text:"",description:"",effects:{resourcePercent:{silver:-.03,food:-.05,wood:-.02},populationPercent:-.012,stability:10,approval:{peasant:25,official:10}}},{id:"build_dams",text:"",description:"",effects:{resourcePercent:{stone:-.03,wood:-.025},populationPercent:-.015,stability:-5,approval:{peasant:-15,capitalist:10,landowner:5}}},{id:"let_it_be",text:"",description:"",effects:{populationPercent:-.03,stability:-15,approval:{peasant:-30,cleric:-10}}}]},{id:"stone_age_new_water",name:"",icon:"Waves",image:null,description:"",triggerConditions:{minEpoch:0,maxEpoch:0,resourcePercent:{food:{max:100}}},options:[{id:"develop_water_source",text:"",description:"",effects:{resourcePercent:{wood:-.022,food:.03},maxPop:8,stability:5,approval:{peasant:12}}},{id:"secret_protection",text:"",description:"",effects:{resourcePercent:{food:.015},stability:-3,approval:{peasant:-5,cleric:5}}},{id:"ignore_water_source",text:"",description:"",effects:{stability:-5,approval:{peasant:-8}}}]},{id:"stone_age_stranger_footprints",name:"",icon:"Users",image:null,description:"",triggerConditions:{minEpoch:0,maxEpoch:0,minPopulation:15},options:[{id:"ambush_expel",text:"",description:"",effects:{resourcePercent:{food:-.012},approval:{soldier:10}},randomEffects:[{chance:.25,effects:{populationPercent:-.01,stability:-5,approval:{peasant:-5}}}]},{id:"leave_gifts",text:"",description:"",effects:{resourcePercent:{food:-.015,wood:-.012},culture:.02,stability:5,approval:{peasant:8,cleric:5}}},{id:"increase_patrol",text:"",description:"",effects:{resourcePercent:{food:-.012},stability:-2,approval:{soldier:5}}}]},{id:"stone_age_harsh_winter",name:"",icon:"CloudRain",image:null,description:"",triggerConditions:{minEpoch:0,maxEpoch:0,minPopulation:20,resourcePercent:{food:{max:150}}},options:[{id:"distribute_rations",text:"",description:"",effects:{resourcePercent:{food:-.05,wood:-.06},populationPercent:-.015,stability:10,approval:{peasant:15}}},{id:"encourage_hunting",text:"",description:"",effects:{populationPercent:-.03,resourcePercent:{food:.035},stability:-8,approval:{soldier:12,peasant:-15}}},{id:"sacrifice_weak",text:"",description:"",effects:{populationPercent:-.012,stability:-20,approval:{peasant:-30,cleric:-15}}}]},{id:"stone_age_unexpected_discovery",name:"",icon:"Gem",image:null,description:"",triggerConditions:{minEpoch:0,maxEpoch:0,resourcePercent:{science:{max:50}}},options:[{id:"research_stones",text:"",description:"",effects:{resourcePercent:{wood:-.012,science:.05},stability:3,approval:{artisan:15,peasant:5}}},{id:"worship_stones",text:"",description:"",effects:{resourcePercent:{culture:.04},stability:8,approval:{cleric:20,artisan:-8}}},{id:"disregard_stones",text:"",description:"",effects:{stability:-3,approval:{peasant:-5}}}]},{id:"stone_age_tribal_legend",name:"",icon:"BookOpen",image:null,description:"",triggerConditions:{minEpoch:0,maxEpoch:0,minPopulation:25,minStability:50,resourcePercent:{science:{max:100}}},options:[{id:"send_expedition",text:"",description:"",effects:{resourcePercent:{food:-.012,science:.08,culture:.07},populationPercent:-.015,stability:5,approval:{soldier:15}}},{id:"forbid_exploration",text:"",description:"",effects:{resourcePercent:{culture:-.2},stability:3,approval:{soldier:-10,peasant:-5}}},{id:"encourage_legends",text:"",description:"",effects:{resourcePercent:{culture:.06},stability:6,approval:{cleric:12,scribe:8}}}]},{id:"bronze_age_bronze_vein",name:"",icon:"Gem",image:null,description:"",triggerConditions:{minEpoch:1,maxEpoch:1,minPopulation:30},options:[{id:"immediate_mine",text:"",description:"",effects:{resourcePercent:{copper:.15,iron:.012,wood:-.015},populationPercent:-.015,stability:-5,approval:{miner:15,peasant:-8}}},{id:"research_mining",text:"",description:"",effects:{resourcePercent:{science:.06,silver:-.012},approval:{scribe:10,miner:5}}},{id:"secret_mine",text:"",description:"",effects:{resourcePercent:{copper:.05,iron:.016},stability:-3,approval:{peasant:-5}}}]},{id:"bronze_age_merchant_plea",name:"",icon:"Handshake",image:null,description:"",triggerConditions:{minEpoch:1,maxEpoch:1,minPopulation:40,classConditions:{merchant:{minPop:1}}},options:[{id:"send_escort",text:"",description:"",effects:{resourcePercent:{silver:.012,food:-.015},populationPercent:-.006,stability:5,approval:{merchant:20,soldier:10}}},{id:"provide_aid",text:"",description:"",effects:{resourcePercent:{food:-.02,wood:-.015},stability:3,approval:{merchant:10,peasant:5}}},{id:"refuse_aid",text:"",description:"",effects:{stability:-5,approval:{merchant:-15,soldier:-5}}}]},{id:"bronze_age_drought",name:"",icon:"Droplets",image:null,description:"",triggerConditions:{minEpoch:1,maxEpoch:1,minPopulation:50,resourcePercent:{food:{max:200}}},options:[{id:"build_irrigation",text:"",description:"",effects:{resourcePercent:{wood:-.06,stone:-.03,food:.02},stability:8,approval:{peasant:20,worker:10}}},{id:"intensive_hunt",text:"/",description:"",effects:{resourcePercent:{food:.04},populationPercent:-.025,stability:-5,approval:{peasant:-10,soldier:10}}},{id:"seek_tribute",text:"",description:"",effects:{resourcePercent:{food:.05},stability:-10,approval:{soldier:15,peasant:-15}}}]},{id:"bronze_age_new_priest",name:"",icon:"Cross",image:null,description:"",triggerConditions:{minEpoch:1,maxEpoch:1,minPopulation:35,classConditions:{cleric:{minPop:1}}},options:[{id:"endorse_priest",text:"",description:"",effects:{resourcePercent:{culture:.08},stability:10,approval:{cleric:20,peasant:15,scribe:-10}}},{id:"limit_power",text:"",description:"",effects:{stability:-5,approval:{cleric:-15,peasant:-5,landowner:5}}},{id:"challenge_divinity",text:"",description:"",effects:{resourcePercent:{science:.05},stability:-15,approval:{cleric:-25,peasant:-20,scribe:15}}}]},{id:"bronze_age_skirmish",name:"",icon:"Swords",image:null,description:"",triggerConditions:{minEpoch:1,maxEpoch:1,minPopulation:60,classConditions:{soldier:{minPop:2}}},options:[{id:"declare_war",text:"",description:"",effects:{stability:-10,approval:{soldier:20,peasant:-10}}},{id:"send_emissary",text:"",description:"",effects:{resourcePercent:{silver:-.012,food:-.015},stability:5,approval:{merchant:10,peasant:8}}},{id:"fortify_border",text:"",description:"",effects:{resourcePercent:{wood:-.02,stone:-.015},stability:-3,approval:{soldier:5,peasant:-5}}}]},{id:"classical_philosopher_challenge",name:"",icon:"BookOpen",image:null,description:"",triggerConditions:{minEpoch:2,maxEpoch:2,minPopulation:80,classConditions:{scribe:{minPop:2},cleric:{minPop:2}}},options:[{id:"embrace_philosophy",text:"",description:"",effects:{resourcePercent:{science:.25,culture:.15},approval:{scribe:20,cleric:-15,peasant:-5}}},{id:"public_debate",text:"",description:"",effects:{resourcePercent:{science:.08,culture:.06},stability:-8,approval:{scribe:10,cleric:-5}}},{id:"exile_philosopher",text:"",description:"",effects:{stability:5,approval:{cleric:15,landowner:10,scribe:-25}}}]},{id:"classical_written_law",name:"",icon:"Gavel",image:null,description:"",triggerConditions:{minEpoch:2,maxEpoch:2,minPopulation:35,classConditions:{official:{minPop:3},merchant:{minPop:5}}},options:[{id:"establish_just_code",text:"",description:"",effects:{resourcePercent:{silver:-.025,papyrus:-50},stability:15,approval:{official:15,merchant:10,peasant:5,landowner:-10}}},{id:"favor_elite_code",text:"",description:"",effects:{resourcePercent:{silver:-.012},stability:-5,approval:{landowner:20,official:5,merchant:-15,peasant:-10}}},{id:"maintain_oral_tradition",text:"",description:"",effects:{stability:-10,approval:{official:-5,merchant:-10,peasant:-5}}}]},{id:"classical_artistic_patronage",name:"",icon:"Palette",image:null,description:"",triggerConditions:{minEpoch:2,maxEpoch:2,buildingConditions:{amphitheater:{min:1}}},options:[{id:"fund_grand_performance",text:"",description:"",effects:{resourcePercent:{silver:-.03,culture:.2},stability:8,approval:{cleric:15,scribe:10,peasant:5}}},{id:"offer_limited_support",text:"",description:"",effects:{resourcePercent:{silver:-.012,culture:.06},approval:{cleric:5,scribe:5}}},{id:"dismiss_as_frivolous",text:"",description:"",effects:{resourcePercent:{culture:-.5},approval:{scribe:-10,cleric:-5}}}]},{id:"classical_aqueduct_proposal",name:"",icon:"Waves",image:null,description:"",triggerConditions:{minEpoch:2,maxEpoch:2,minPopulation:40},options:[{id:"build_aqueduct",text:"",description:"",effects:{resourcePercent:{silver:-.05,stone:-.08,brick:-.06},maxPop:25,stability:15,approval:{peasant:20,worker:15,official:10}}},{id:"build_smaller_version",text:"",description:"",effects:{resourcePercent:{silver:-.025,stone:-.08},maxPop:10,stability:5,approval:{peasant:8,worker:5}}},{id:"dig_more_wells",text:"",description:"",effects:{resourcePercent:{wood:-.015},stability:-5,approval:{peasant:-5,scribe:-8}}}]},{id:"feudal_guild_charter",name:"",icon:"Gavel",image:null,description:"",triggerConditions:{minEpoch:3,maxEpoch:3,classConditions:{artisan:{minPop:10,minInfluenceShare:.1},merchant:{minPop:5}}},options:[{id:"grant_charter",text:"",description:"",effects:{resourcePercent:{culture:.08},stability:5,approval:{artisan:20,merchant:-10}}},{id:"regulate_guilds",text:"",description:"",effects:{resourcePercent:{silver:.02},stability:-3,approval:{artisan:-8,official:10}}},{id:"suppress_guilds",text:"",description:"",effects:{stability:-8,approval:{artisan:-25,merchant:15}}}]},{id:"feudal_crusade_call",name:"",icon:"Cross",image:null,description:"",triggerConditions:{minEpoch:3,maxEpoch:3,classConditions:{knight:{minPop:2},cleric:{minPop:3}}},options:[{id:"fund_crusade",text:"",description:"",effects:{resourcePercent:{silver:-.04,food:-.015},populationPercent:-.01,approval:{knight:25,cleric:20,merchant:-15}}},{id:"offer_prayers",text:"",description:"",effects:{stability:-5,approval:{cleric:10,knight:-10}}},{id:"denounce_call",text:"",description:"",effects:{stability:-10,approval:{cleric:-20,knight:-15,merchant:15,scribe:10}}}]},{id:"feudal_levy_dispute",name:"",icon:"ShieldAlert",image:null,description:"",triggerConditions:{minEpoch:3,maxEpoch:3,classConditions:{landowner:{minPop:3,minInfluenceShare:.15},knight:{minPop:1}}},options:[{id:"force_compliance",text:"",description:"",effects:{stability:-15,approval:{landowner:-25,soldier:15,official:10}}},{id:"accept_scutage",text:"",description:"",effects:{resourcePercent:{silver:.045},stability:-5,approval:{landowner:15,knight:-10}}},{id:"forgive_levy",text:"",description:"",effects:{stability:5,approval:{landowner:20,knight:-15,official:-10}}}]},{id:"feudal_university_founding",name:"",icon:"Landmark",image:null,description:"",triggerConditions:{minEpoch:3,maxEpoch:3,minPopulation:50,classConditions:{scribe:{minPop:5},cleric:{minPop:5}}},options:[{id:"grant_university_charter",text:"",description:"",effects:{resourcePercent:{silver:-.012,science:.3,culture:.2},approval:{scribe:25,cleric:15,landowner:-10}}},{id:"church_control",text:"",description:"",effects:{resourcePercent:{culture:.15},stability:5,approval:{cleric:20,scribe:-15,landowner:5}}},{id:"reject_university",text:"",description:"",effects:{approval:{scribe:-20,cleric:-10}}}]},{id:"feudal_plague_doctor",name:"",icon:"Heart",image:null,description:"",triggerConditions:{minEpoch:3,maxEpoch:4,minPopulation:40},options:[{id:"hire_doctor",text:"",description:"",effects:{resourcePercent:{silver:-.02,science:.06},populationPercent:.03,stability:5,approval:{peasant:15,cleric:-10}}},{id:"let_him_practice",text:"",description:"",effects:{populationPercent:.015,stability:-3,approval:{peasant:5,merchant:5}}},{id:"expel_as_charlatan",text:"",description:"",effects:{populationPercent:-.03,stability:-8,approval:{peasant:-15,cleric:15}}}]},{id:"exploration_new_world",name:"",icon:"Globe",image:null,description:"",triggerConditions:{minEpoch:4,maxEpoch:4,classConditions:{navigator:{minPop:3}}},options:[{id:"fund_colonial_expedition",text:"",description:"",effects:{resourcePercent:{silver:-.012,food:-.02,plank:-200,tools:-.012},populationPercent:-.012,approval:{navigator:25,merchant:20,soldier:15}}},{id:"establish_trading_post",text:"",description:"",effects:{resourcePercent:{silver:-.03,plank:-80},populationPercent:-.015,approval:{navigator:15,merchant:15}}},{id:"sell_maps",text:"",description:"",effects:{resourcePercent:{silver:.02},approval:{navigator:-25,merchant:-10},nationRelation:{random:15},nationWealth:{random:200}}}]},{id:"exploration_renaissance_artist",name:"",icon:"Palette",image:null,description:"",triggerConditions:{minEpoch:4,maxEpoch:5,classConditions:{scribe:{minPop:8},artisan:{minPop:10}}},options:[{id:"patronize_masterpiece",text:"",description:"",effects:{resourcePercent:{silver:-.05,culture:.35,science:.08},stability:10,approval:{scribe:20,artisan:15,cleric:10}}},{id:"modest_commission",text:"",description:"",effects:{resourcePercent:{silver:-.022,culture:.08},approval:{scribe:8,artisan:5}}},{id:"dismiss_artist",text:"",description:"",effects:{approval:{scribe:-15,artisan:-10}}}]},{id:"exploration_banking_family",name:"",icon:"Landmark",image:null,description:"",triggerConditions:{minEpoch:4,maxEpoch:5,classConditions:{merchant:{minPop:10,minWealthShare:.2},capitalist:{minPop:1}}},options:[{id:"charter_private_bank",text:"",description:"",effects:{resourcePercent:{silver:.03},stability:-5,approval:{merchant:25,capitalist:20,landowner:-10}}},{id:"establish_state_bank",text:"",description:"",effects:{resourcePercent:{silver:-.04},stability:10,approval:{official:20,merchant:-15,capitalist:-10}}},{id:"forbid_banking",text:"",description:"",effects:{stability:-8,approval:{merchant:-20,capitalist:-15,cleric:15}}}]},{id:"exploration_mercenary_offer",name:"",icon:"Swords",image:null,description:"",triggerConditions:{minEpoch:4,maxEpoch:5,classConditions:{soldier:{minPop:10}}},options:[{id:"hire_mercenaries",text:"",description:"",effects:{resourcePercent:{silver:-.05},stability:-8,approval:{soldier:20,knight:-10}}},{id:"one_time_contract",text:"",description:"",effects:{resourcePercent:{silver:-.012},approval:{soldier:10}}},{id:"reject_offer",text:"",description:"",effects:{approval:{soldier:-5,knight:10}}}]},{id:"exploration_gunpowder_plot",name:"",icon:"Bomb",image:null,description:"",triggerConditions:{minEpoch:4,maxEpoch:5,minStability:0,maxStability:40},options:[{id:"raid_hideout",text:"",description:"",effects:{stability:15,approval:{official:15,landowner:10}}},{id:"public_warning",text:"",description:"",effects:{resourcePercent:{silver:-.02},stability:5,approval:{peasant:-8,merchant:-5}}},{id:"ignore_threat",text:"",description:"",effects:{},randomEffects:[{chance:.25,effects:{populationPercent:-.01,stability:-20,approval:{peasant:-10}}}]}]}],n5=[{id:"bread_price_crisis",name:"",icon:"ShoppingCart",image:null,description:'""',triggerConditions:{minEpoch:3,minPopulation:50,classConditions:{peasant:{maxApproval:50},merchant:{minWealthShare:.2}}},options:[{id:"price_control",text:'""',description:"",effects:{resourcePercent:{silver:-.012},stability:8,approval:{peasant:20,worker:15,merchant:-25,capitalist:-15},resourceDemandMod:{food:-.1},buildingProductionMod:{market:-.15,factory:-.1,farm:-.1}}},{id:"open_granary",text:"",description:"",effects:{resourcePercent:{food:-.015,silver:-.012},stability:15,approval:{peasant:25,worker:20,merchant:5},resourceDemandMod:{food:-.15}}},{id:"let_them_eat_cake",text:'""',description:"",effects:{stability:-20,approval:{peasant:-35,worker:-30,merchant:10,landowner:5},stratumDemandMod:{peasant:-.2,worker:-.2},buildingProductionMod:{all:-.2}},randomEffects:[{chance:.4,effects:{populationPercent:-.01,stability:-25}}]}]},{id:"worker_peasant_alliance",name:"",icon:"Users",image:null,description:"",triggerConditions:{minEpoch:5,classConditions:{worker:{minPop:20,maxApproval:55},peasant:{maxApproval:55},capitalist:{minWealthShare:.25}}},options:[{id:"allow_mutual_aid",text:"",description:"",effects:{stability:-8,approval:{worker:20,peasant:18,capitalist:-20,landowner:-15},stratumDemandMod:{worker:.1,peasant:.1}}},{id:"divide_and_rule",text:"",description:"",effects:{resourcePercent:{silver:-.04},stability:5,approval:{worker:-10,peasant:-10,official:8},buildingProductionMod:{farm:-.05,factory:-.05}}},{id:"preemptive_reform",text:"",description:"",effects:{resourcePercent:{silver:-.03},stability:10,approval:{worker:15,peasant:12,capitalist:-12,official:5},stratumDemandMod:{worker:.05,peasant:.05}}}]},{id:"land_reform_proposal",name:"",icon:"Map",image:null,description:'""',triggerConditions:{minEpoch:2,classConditions:{landowner:{minWealthShare:.3,minInfluenceShare:.25},peasant:{maxApproval:50,maxWealthShare:.1}}},options:[{id:"support_reform",text:"",description:"",effects:{resourcePercent:{food:.05},stability:-20,approval:{peasant:35,worker:15,landowner:-40,knight:-20,official:-10},stratumDemandMod:{peasant:.2,landowner:-.3},buildingProductionMod:{farm:.15,large_estate:-.3}}},{id:"compromise_reform",text:"",description:"",effects:{stability:-5,approval:{peasant:12,landowner:-15,official:5},stratumDemandMod:{peasant:.05,landowner:-.1},buildingProductionMod:{farm:.05,large_estate:-.1}}},{id:"reject_reform",text:'""',description:"",effects:{stability:5,approval:{peasant:-25,worker:-15,landowner:25,knight:10},buildingProductionMod:{farm:-.1}},randomEffects:[{chance:.3,effects:{populationPercent:-.03,stability:-15,approval:{peasant:-20}}}]}]},{id:"progressive_tax_debate",name:"",icon:"Coins",image:null,description:'""""',triggerConditions:{minEpoch:4,minPopulation:100,classConditions:{capitalist:{minWealthShare:.2},merchant:{minWealthShare:.15}}},options:[{id:"progressive_tax",text:"",description:"",effects:{resourcePercent:{silver:.05},stability:-8,approval:{peasant:20,worker:18,merchant:-20,capitalist:-30,landowner:-15},stratumDemandMod:{peasant:.1,worker:.08,capitalist:-.15,landowner:-.1}}},{id:"poll_tax",text:"",description:"",effects:{resourcePercent:{silver:.012},stability:-15,approval:{peasant:-25,worker:-20,merchant:15,capitalist:20}}},{id:"tax_compromise",text:"",description:"",effects:{resourcePercent:{silver:.045},stability:-3,approval:{peasant:5,worker:5,merchant:-8,capitalist:-10},stratumDemandMod:{peasant:.05,worker:.04,capitalist:-.08,landowner:-.05}}}]},{id:"slave_gladiator_revolt",name:"",icon:"Swords",image:null,description:'""',triggerConditions:{minEpoch:2,maxEpoch:3,minPopulation:40,classConditions:{serf:{minPop:30,maxApproval:40},peasant:{maxApproval:50}}},options:[{id:"military_suppression",text:"",description:"",effects:{resourcePercent:{food:-.05,silver:-.03},populationPercent:-.015,stability:10,approval:{serf:-30,peasant:-15,soldier:15,landowner:20},buildingProductionMod:{mine:-.2,quarry:-.15}}},{id:"negotiate_freedom",text:"",description:"",effects:{resourcePercent:{silver:-.02},stability:-10,approval:{serf:25,peasant:15,landowner:-30,merchant:-10},buildingProductionMod:{mine:-.1,quarry:-.08}}},{id:"bribe_leaders",text:"",description:"",effects:{resourcePercent:{silver:-.012},stability:5,approval:{serf:-10,peasant:-5,official:-10},buildingProductionMod:{mine:-.05,quarry:-.05}}}]},{id:"assassination_plot",name:"",icon:"AlertTriangle",image:null,description:'""',triggerConditions:{minEpoch:2,classConditions:{landowner:{maxApproval:35,minInfluenceShare:.2},knight:{maxApproval:40}}},options:[{id:"preemptive_purge",text:'""',description:"",effects:{resourcePercent:{silver:-.02},stability:15,approval:{landowner:-25,knight:-20,official:10,peasant:5}}},{id:"public_trial",text:"",description:"",effects:{resourcePercent:{silver:-.012},stability:5,approval:{peasant:15,worker:10,landowner:-20,scribe:8}}},{id:"offer_reconciliation",text:"",description:"",effects:{stability:-5,approval:{landowner:20,knight:15,peasant:-20,worker:-15}}}]},{id:"bank_run_panic",name:"",icon:"Building",image:null,description:"",triggerConditions:{minEpoch:5,classConditions:{merchant:{minPop:10},capitalist:{minPop:5}}},options:[{id:"government_bailout",text:"",description:"",effects:{resourcePercent:{silver:-.05},stability:10,approval:{capitalist:15,merchant:20,peasant:-15,worker:-20}}},{id:"let_it_fail",text:'""',description:"",effects:{resourcePercent:{silver:-.02},stability:-25,approval:{capitalist:-30,merchant:-25,peasant:10,worker:5},buildingProductionMod:{market:-.2,factory:-.15}}},{id:"partial_guarantee",text:"",description:"",effects:{resourcePercent:{silver:-.03},stability:-5,approval:{peasant:15,worker:12,capitalist:-20,merchant:-10},buildingProductionMod:{market:-.1,factory:-.05}}}]},{id:"colonial_tea_protest",name:"",icon:"Coffee",image:null,description:'""',triggerConditions:{minEpoch:4,classConditions:{merchant:{maxApproval:45,minInfluenceShare:.15}}},options:[{id:"harsh_punishment",text:"",description:"",effects:{resourcePercent:{silver:.012},stability:-20,approval:{merchant:-30,peasant:-20,worker:-15,soldier:10},buildingProductionMod:{trade_port:-.25,market:-.2}}},{id:"repeal_monopoly",text:"",description:"",effects:{resourcePercent:{silver:-.012},stability:10,approval:{merchant:25,peasant:10,official:-15},buildingProductionMod:{trade_port:.1,market:.1}}},{id:"token_compromise",text:"",description:"",effects:{resourcePercent:{silver:-.012},stability:-5,approval:{merchant:-10,peasant:-5,official:5},buildingProductionMod:{trade_port:-.05,market:-.05}}}]},{id:"machine_breakers",name:"",icon:"Hammer",image:null,description:'""""',triggerConditions:{minEpoch:6,classConditions:{artisan:{minPop:15,maxApproval:50},capitalist:{minPop:5}}},options:[{id:"protect_factories",text:"",description:"",effects:{resourcePercent:{silver:-.012},stability:5,approval:{artisan:-25,worker:-10,capitalist:20,engineer:15},buildingProductionMod:{factory:.1,textile_mill:.1}}},{id:"slow_mechanization",text:"",description:"",effects:{resourcePercent:{science:-.05},stability:8,approval:{artisan:15,worker:10,capitalist:-15,engineer:-10},buildingProductionMod:{factory:-.1,textile_mill:-.1}}},{id:"retraining_program",text:"",description:"",effects:{resourcePercent:{silver:-.025,science:.03},stability:10,approval:{artisan:12,worker:15,capitalist:5},buildingProductionMod:{school:.1,library:.05}}}]},{id:"constitutional_crisis",name:"",icon:"FileText",image:null,description:"",triggerConditions:{minEpoch:5,classConditions:{capitalist:{minInfluenceShare:.2,minApproval:40},scribe:{minInfluenceShare:.1},landowner:{minInfluenceShare:.2}}},options:[{id:"grant_constitution",text:"",description:"",effects:{resourcePercent:{science:.08,culture:.06},stability:-10,approval:{capitalist:25,scribe:30,merchant:20,landowner:-30,cleric:-20,knight:-25},buildingProductionMod:{university:.15,library:.1}}},{id:"crack_down",text:"",description:"",effects:{stability:-15,approval:{capitalist:-30,scribe:-35,merchant:-20,landowner:20,cleric:15,soldier:10},buildingProductionMod:{all:-.05}},randomEffects:[{chance:.35,effects:{populationPercent:-.012,stability:-25}}]},{id:"delay_tactics",text:'"..."',description:"",effects:{stability:-5,approval:{capitalist:-15,scribe:-20,landowner:-10,official:10}}}]},{id:"spy_scandal",name:"",icon:"Eye",image:null,description:'""',triggerConditions:{minEpoch:5,classConditions:{soldier:{minInfluenceShare:.15},scribe:{minInfluenceShare:.1}}},options:[{id:"support_military",text:"",description:"",effects:{stability:5,approval:{soldier:15,knight:10,scribe:-25,merchant:-10},buildingProductionMod:{barracks:-.1,training_ground:-.1}}},{id:"reopen_case",text:"",description:"",effects:{resourcePercent:{silver:-.02},stability:-10,approval:{soldier:-20,knight:-15,scribe:25,merchant:10,peasant:5},buildingProductionMod:{library:.1,university:.1}}},{id:"quiet_pardon",text:"",description:"",effects:{stability:-3,approval:{soldier:-10,scribe:-15,official:5}}}]},{id:"robber_baron_monopoly",name:"",icon:"Briefcase",image:null,description:'""',triggerConditions:{minEpoch:6,classConditions:{capitalist:{minWealthShare:.35,minInfluenceShare:.25},merchant:{maxApproval:55}}},options:[{id:"break_up_trusts",text:"",description:"",effects:{resourcePercent:{silver:.03},stability:-10,approval:{capitalist:-35,merchant:20,worker:15,peasant:10},buildingProductionMod:{factory:-.2,steel_works:-.2}}},{id:"regulate_prices",text:"",description:"",effects:{stability:5,approval:{capitalist:-15,merchant:10,worker:8},buildingProductionMod:{factory:-.1,steel_works:-.1}}},{id:"laissez_faire",text:'""',description:"",effects:{resourcePercent:{silver:.012},stability:-8,approval:{capitalist:25,merchant:-20,worker:-15,peasant:-10},buildingProductionMod:{factory:.1,steel_works:.1}}}]},{id:"three_estates_assembly",name:"",icon:"Landmark",image:null,description:'"95%"',triggerConditions:{minEpoch:4,resourcePercent:{silver:{max:200}},classConditions:{landowner:{minInfluenceShare:.2},cleric:{minInfluenceShare:.1},merchant:{minPop:10}}},options:[{id:"support_third_estate",text:"",description:"",effects:{resourcePercent:{silver:.012},stability:-15,approval:{peasant:25,worker:25,merchant:20,artisan:20,landowner:-35,cleric:-30,knight:-25},buildingProductionMod:{university:.15,library:.1}}},{id:"maintain_tradition",text:"",description:"",effects:{resourcePercent:{silver:.012},stability:-10,approval:{peasant:-25,worker:-20,merchant:-20,landowner:20,cleric:15},buildingProductionMod:{farm:-.1,factory:-.1}},randomEffects:[{chance:.4,effects:{stability:-20,approval:{peasant:-15}}}]},{id:"dissolve_assembly",text:"",description:"",effects:{stability:-20,approval:{peasant:-20,merchant:-25,landowner:-15,cleric:-10}}}]},{id:"salt_tax_protest",name:"",icon:"Users",image:null,description:'""',triggerConditions:{minEpoch:5,classConditions:{peasant:{minPop:100,maxApproval:50},cleric:{minApproval:50}}},options:[{id:"mass_arrest",text:"",description:"",effects:{resourcePercent:{silver:-.02},stability:-15,approval:{peasant:-25,worker:-20,cleric:-15,soldier:10},buildingProductionMod:{farm:-.15,factory:-.1}}},{id:"abolish_salt_tax",text:"",description:"",effects:{resourcePercent:{silver:-.025},stability:15,approval:{peasant:30,worker:25,cleric:10,merchant:-10},buildingProductionMod:{farm:.1,factory:.05}}},{id:"negotiate_with_leader",text:"",description:"",effects:{resourcePercent:{silver:-.012},stability:5,approval:{peasant:10,cleric:15,official:5},buildingProductionMod:{library:.05,market:.05}}}]},{id:"merchant_scholar_alliance",name:"",icon:"BookOpen",image:null,description:"",triggerConditions:{minEpoch:5,classConditions:{merchant:{minWealthShare:.2,minApproval:55},scribe:{minInfluenceShare:.12,minApproval:55}}},options:[{id:"embrace_new_ideas",text:"",description:"",effects:{resourcePercent:{science:.08,culture:.06},stability:-5,approval:{merchant:20,scribe:25,capitalist:15,landowner:-20,cleric:-25},buildingProductionMod:{university:.1,library:.08}}},{id:"censor_publications",text:"",description:'""',effects:{resourcePercent:{science:-.05},stability:8,approval:{merchant:-15,scribe:-25,landowner:15,cleric:20},buildingProductionMod:{library:-.15,university:-.1}}},{id:"cootp_movement",text:"",description:"",effects:{resourcePercent:{silver:-.02},stability:3,approval:{scribe:5,merchant:5,official:10},buildingProductionMod:{library:.05,university:.05}}}]},{id:"military_coup_threat",name:"",icon:"Swords",image:null,description:'""',triggerConditions:{minEpoch:3,classConditions:{soldier:{minInfluenceShare:.2,maxApproval:60},knight:{minInfluenceShare:.15}}},options:[{id:"preemptive_dismissal",text:"",description:"...",effects:{stability:-15,approval:{soldier:-25,knight:-20,official:15}},randomEffects:[{chance:.3,effects:{populationPercent:-.01,stability:-30}}]},{id:"appease_general",text:"",description:"",effects:{resourcePercent:{silver:-.025},stability:5,approval:{soldier:15,knight:10,peasant:-10,official:-15},buildingProductionMod:{barracks:.1,training_ground:.1}}},{id:"build_loyal_force",text:"",description:"",effects:{resourcePercent:{silver:-.03,food:-.03},stability:3,approval:{soldier:-10,official:10},buildingProductionMod:{barracks:.05,training_ground:.05}}}]},{id:"great_famine",name:"",icon:"CloudRain",image:null,description:'""',triggerConditions:{minEpoch:2,minPopulation:50,resourcePercent:{food:{max:100}}},options:[{id:"requisition_grain",text:"",description:"",effects:{resourcePercent:{food:.03},stability:5,approval:{peasant:25,worker:20,landowner:-35,merchant:-30},buildingProductionMod:{farm:.1,factory:.05}}},{id:"buy_grain",text:"",description:"",effects:{resourcePercent:{food:.015,silver:-.05},stability:8,approval:{peasant:15,merchant:20,landowner:10},buildingProductionMod:{market:.1,trade_port:.1}}},{id:"let_market_decide",text:'""',description:"",effects:{populationPercent:-.025,stability:-25,approval:{peasant:-40,worker:-35,merchant:15,landowner:10},buildingProductionMod:{all:-.2}}}]},{id:"peasant_crusade",name:"",icon:"Cross",image:null,description:'""',triggerConditions:{minEpoch:3,maxEpoch:4,classConditions:{peasant:{minPop:80},cleric:{minInfluenceShare:.15,minApproval:60}}},options:[{id:"bless_and_send",text:"",description:"",effects:{resourcePercent:{food:-.05,culture:.06},populationPercent:-.012,stability:10,approval:{cleric:25,peasant:15,landowner:-20}}},{id:"redirect_to_charity",text:"",description:"",effects:{resourcePercent:{silver:-.012,culture:.04},stability:8,approval:{cleric:10,peasant:10}}},{id:"ban_movement",text:"",description:"",effects:{resourcePercent:{food:.02},stability:-10,approval:{cleric:-30,peasant:-20,landowner:15}}}]},{id:"urban_rural_tension",name:"",icon:"Building",image:null,description:"",triggerConditions:{minEpoch:4,classConditions:{worker:{minPop:30,maxApproval:55},peasant:{minPop:50,maxApproval:55}}},options:[{id:"subsidize_farmers",text:"",description:"",effects:{resourcePercent:{silver:-.03,food:.035},stability:10,approval:{peasant:20,worker:15}}},{id:"price_ceiling",text:"",description:"",effects:{resourcePercent:{food:-.02},stability:-5,approval:{worker:15,peasant:-25,merchant:-10}}},{id:"let_negotiate",text:"",description:"",effects:{resourcePercent:{silver:-.012},stability:3,approval:{worker:5,peasant:5,official:8}}}]},{id:"foreign_drug_trade",name:"",icon:"AlertTriangle",image:null,description:'""',triggerConditions:{minEpoch:5,classConditions:{merchant:{minPop:15}}},options:[{id:"strict_prohibition",text:"",description:"",effects:{resourcePercent:{silver:-.02},stability:10,approval:{peasant:20,official:15,soldier:10,merchant:-25},nationRelation:{strongest:-40},nationAggression:{strongest:.25}},randomEffects:[{chance:.4,effects:{stability:-30,populationPercent:-.012,triggerWar:"strongest"},description:""}]},{id:"legalize_and_tax",text:"",description:"",effects:{resourcePercent:{silver:.012},stability:-10,approval:{peasant:-25,cleric:-20,merchant:20,official:-10}}},{id:"diplomatic_negotiation",text:"",description:"",effects:{resourcePercent:{silver:-.012},stability:3,approval:{official:10,merchant:5},nationRelation:{strongest:-5}},randomEffects:[{chance:.4,effects:{nationRelation:{strongest:10},stability:5},description:""}]}]},{id:"guild_monopoly_crisis",name:"",icon:"Users",image:null,description:"",triggerConditions:{minEpoch:4,classConditions:{artisan:{minPop:20,minInfluenceShare:.1},worker:{minPop:15,maxApproval:55}}},options:[{id:"abolish_guilds",text:"",description:"",effects:{resourcePercent:{science:.05},stability:-10,approval:{artisan:-25,worker:20,merchant:15,capitalist:20},stratumDemandMod:{peasant:-.12,worker:-.1,capitalist:.1}}},{id:"reform_guilds",text:"",description:"",effects:{stability:5,approval:{artisan:-5,worker:10,merchant:5}}},{id:"strengthen_guilds",text:"",description:"",effects:{resourcePercent:{science:-30},stability:8,approval:{artisan:20,worker:-15,merchant:-10,capitalist:-15}}}]},{id:"court_faction_war",name:"",icon:"Users",image:null,description:'""""',triggerConditions:{minEpoch:5,classConditions:{official:{minPop:10},scribe:{minInfluenceShare:.1}}},options:[{id:"support_reformers",text:"",description:"",effects:{resourcePercent:{science:.08,silver:-.02},stability:-15,approval:{scribe:25,merchant:15,official:-10,landowner:-25,cleric:-20},buildingProductionMod:{library:-.1,university:-.1}}},{id:"support_conservatives",text:"",description:"",effects:{resourcePercent:{culture:.05},stability:10,approval:{landowner:20,cleric:15,scribe:-25,merchant:-15}}},{id:"balance_factions",text:"",description:"",effects:{stability:-5,approval:{official:10,scribe:-10,landowner:-10}}}]},{id:"eight_hour_day_movement",name:"",icon:"Clock",image:null,description:'""',triggerConditions:{minEpoch:6,classConditions:{worker:{minPop:40,maxApproval:55},capitalist:{minWealthShare:.25}}},options:[{id:"pass_labor_law",text:"",description:"",effects:{resourcePercent:{science:-30},stability:10,approval:{worker:30,peasant:15,capitalist:-30,merchant:-15}}},{id:"voluntary_guidelines",text:"",description:"",effects:{stability:3,approval:{worker:5,capitalist:5}}},{id:"crush_movement",text:"",description:"",effects:{stability:-15,approval:{worker:-35,peasant:-20,capitalist:20,soldier:10},buildingProductionMod:{factory:-.25,steel_works:-.25}},randomEffects:[{chance:.3,effects:{populationPercent:-.01,stability:-20}}]}]},{id:"anti_foreign_movement",name:"",icon:"Flag",image:null,description:"",triggerConditions:{minEpoch:5,classConditions:{peasant:{minPop:60,maxApproval:50},cleric:{maxApproval:60}}},options:[{id:"support_movement",text:'""',description:"",effects:{stability:-20,approval:{peasant:25,soldier:15,cleric:-20,merchant:-25,scribe:-20},nationRelation:{all:-35},nationAggression:{all:.25}},randomEffects:[{chance:.5,effects:{populationPercent:-.015,stability:-30,resourcePercent:{silver:-.04},triggerWar:"strongest"},description:""}]},{id:"suppress_movement",text:"",description:"",effects:{resourcePercent:{silver:-.02},stability:10,approval:{peasant:-30,soldier:-10,cleric:15,merchant:20},nationRelation:{all:25},nationAggression:{all:-.15}}},{id:"ambiguous_stance",text:"",description:"",effects:{stability:-10,approval:{peasant:5,merchant:-15,official:-10}}}]},{id:"bread_and_circuses",name:"",icon:"Theater",image:null,description:'""',triggerConditions:{minEpoch:2,classConditions:{peasant:{maxApproval:50},worker:{maxApproval:50}}},options:[{id:"grand_spectacle",text:"",description:"",effects:{resourcePercent:{silver:-.012,food:-.03,culture:.06},stability:15,approval:{peasant:20,worker:18,merchant:5,capitalist:-10}}},{id:"free_grain",text:"",description:"",effects:{resourcePercent:{food:-.015},stability:12,approval:{peasant:25,worker:20,landowner:-15}}},{id:"address_real_issues",text:"",description:"",effects:{resourcePercent:{silver:-.025},stability:-5,approval:{peasant:8,worker:10,scribe:15,official:-10}}}]},{id:"palace_guard_demands",name:"",icon:"Shield",image:null,description:'""""',triggerConditions:{minEpoch:2,classConditions:{soldier:{minInfluenceShare:.18,maxApproval:55}}},options:[{id:"pay_demands",text:"",description:"",effects:{resourcePercent:{silver:-.04},stability:10,approval:{soldier:25,knight:15,peasant:-15,merchant:-10}}},{id:"face_them_down",text:'""',description:"",effects:{stability:-10,approval:{soldier:-20,official:15,peasant:10}},randomEffects:[{chance:.25,effects:{populationPercent:-.015,stability:-25,approval:{soldier:-20}}}]},{id:"reform_guard",text:"",description:"",effects:{resourcePercent:{silver:-.025},stability:5,approval:{soldier:-5,official:10,peasant:5}}}]},{id:"nobles_charter_demand",name:"",icon:"Scroll",image:null,description:'""...',triggerConditions:{minEpoch:3,classConditions:{landowner:{minInfluenceShare:.25,maxApproval:45},knight:{minInfluenceShare:.15,maxApproval:50}}},options:[{id:"sign_charter",text:"",description:"",effects:{resourcePercent:{culture:.08},stability:10,approval:{landowner:30,knight:25,peasant:-10,official:-20}}},{id:"reject_and_fight",text:"",description:"",effects:{resourcePercent:{silver:-.03,food:-.05},populationPercent:-.01,stability:-20,approval:{landowner:-35,knight:-30,soldier:15,peasant:10}}},{id:"delay_and_divide",text:"",description:"",effects:{resourcePercent:{silver:-.02},stability:-5,approval:{landowner:10,knight:5,official:10}}}]},{id:"tenant_strike",name:"",icon:"Wheat",image:null,description:'""',triggerConditions:{minEpoch:3,classConditions:{peasant:{minPop:50,maxApproval:45},landowner:{minWealthShare:.25},serf:{minPop:20,maxApproval:45}}},options:[{id:"force_rent_reduction",text:"",description:"",effects:{resourcePercent:{food:.035},stability:5,approval:{peasant:30,serf:25,landowner:-35,knight:-15},buildingProductionMod:{farm:.1,large_estate:-.1}}},{id:"send_troops",text:"",description:"",effects:{stability:-10,approval:{peasant:-30,serf:-25,landowner:25,soldier:10}}},{id:"mediate",text:"",description:"",effects:{resourcePercent:{silver:-.012},stability:3,approval:{peasant:10,serf:8,landowner:-10,official:8}}}]},{id:"currency_crisis",name:"",icon:"Coins",image:null,description:'""...',triggerConditions:{minEpoch:2,resourcePercent:{silver:{max:150}}},options:[{id:"debase_currency",text:"",description:"",effects:{resourcePercent:{silver:.05},stability:-8,approval:{merchant:-20,capitalist:-25,peasant:-10,official:10},buildingProductionMod:{barracks:-.15,training_ground:-.1}},randomEffects:[{chance:.5,effects:{stability:-15,approval:{merchant:-20,peasant:-15}}}]},{id:"raise_taxes",text:"",description:"",effects:{resourcePercent:{silver:.03},stability:-5,approval:{peasant:-15,merchant:-10,landowner:-10}}},{id:"cut_spending",text:"",description:"",effects:{resourcePercent:{silver:.02},stability:-3,approval:{official:-20,soldier:-15,peasant:5}}}]},{id:"witch_hunt_hysteria",name:"",icon:"Flame",image:null,description:'""',triggerConditions:{minEpoch:3,maxEpoch:5,classConditions:{cleric:{minInfluenceShare:.15},peasant:{maxApproval:55}}},options:[{id:"allow_trial",text:"",description:"",effects:{resourcePercent:{culture:-.3},stability:5,approval:{cleric:20,peasant:10,scribe:-25}},randomEffects:[{chance:.4,effects:{populationPercent:-.015,stability:-10}}]},{id:"demand_evidence",text:"",description:"",effects:{resourcePercent:{science:.03},stability:-5,approval:{cleric:-15,peasant:-10,scribe:20,official:10}}},{id:"release_accused",text:"",description:"",effects:{resourcePercent:{science:.05},stability:-15,approval:{cleric:-30,peasant:-20,scribe:30}}}]},{id:"church_noble_alliance",name:"",icon:"Handshake",image:null,description:'""',triggerConditions:{minEpoch:3,classConditions:{cleric:{minInfluenceShare:.15,minWealthShare:.1},landowner:{minInfluenceShare:.2,minWealthShare:.25}}},options:[{id:"submit_to_pressure",text:"",description:"",effects:{stability:10,approval:{cleric:25,landowner:25,peasant:-20,worker:-15,merchant:-10},buildingProductionMod:{all:-.1}}},{id:"divide_alliance",text:"",description:"",effects:{resourcePercent:{silver:-.025},stability:3,approval:{cleric:5,landowner:-15,official:10}}},{id:"defy_alliance",text:"",description:"",effects:{stability:-15,approval:{cleric:-30,landowner:-30,peasant:25,worker:20,merchant:15}}}]},{id:"succession_dispute",name:"",icon:"Crown",image:null,description:"",triggerConditions:{minEpoch:2,minStability:40,classConditions:{landowner:{minInfluenceShare:.15},official:{minPop:5}}},options:[{id:"support_eldest",text:"",description:"",effects:{stability:5,approval:{landowner:15,cleric:10,official:-10,peasant:-5}}},{id:"support_younger",text:"",description:"",effects:{resourcePercent:{culture:-.3},stability:-10,approval:{landowner:-20,cleric:-15,official:15,peasant:10}}},{id:"split_inheritance",text:"",description:"",effects:{maxPop:-20,stability:-5,approval:{landowner:5,official:5}}}]},{id:"bread_riot",name:"",icon:"AlertTriangle",image:null,description:'""',triggerConditions:{minEpoch:3,minPopulation:40,resourcePercent:{food:{max:80}},classConditions:{peasant:{maxApproval:40},worker:{maxApproval:40}}},options:[{id:"distribute_reserves",text:"",description:"",effects:{resourcePercent:{food:-.05},stability:15,approval:{peasant:30,worker:28,merchant:-10}}},{id:"military_response",text:"",description:"",effects:{populationPercent:-.01,stability:-15,approval:{peasant:-35,worker:-30,soldier:10,landowner:15}}},{id:"blame_hoarders",text:"",description:"",effects:{resourcePercent:{food:.015},stability:-5,approval:{peasant:25,worker:22,merchant:-30,landowner:-25}}}]},{id:"guild_master_corruption",name:"",icon:"Briefcase",image:null,description:"",triggerConditions:{minEpoch:3,classConditions:{artisan:{minPop:15},official:{minPop:5}}},options:[{id:"full_investigation",text:"",description:"",effects:{resourcePercent:{silver:-.012},stability:-5,approval:{artisan:25,worker:15,official:-20,merchant:10},buildingProductionMod:{factory:-.05,market:-.05}}},{id:"quiet_removal",text:"",description:"",effects:{stability:3,approval:{artisan:5,official:10,worker:-5},buildingProductionMod:{factory:.05,market:.05}}},{id:"ignore_accusations",text:"",description:"",effects:{stability:-8,approval:{artisan:-20,worker:-15,official:15},buildingProductionMod:{school:.1,library:.05}}}]},{id:"peasant_jacquerie",name:"",icon:"Swords",image:null,description:'""""',triggerConditions:{minEpoch:3,maxEpoch:5,classConditions:{peasant:{minPop:80,maxApproval:35},serf:{minPop:30,maxApproval:35},landowner:{minWealthShare:.3}}},options:[{id:"brutal_suppression",text:"",description:"",effects:{resourcePercent:{silver:-.025,food:-.03},populationPercent:-.02,stability:5,approval:{peasant:-40,serf:-35,landowner:30,knight:20,soldier:15},buildingProductionMod:{farm:-.25,large_estate:-.3}}},{id:"negotiate_grievances",text:"",description:"",effects:{stability:-10,approval:{peasant:20,serf:18,landowner:-30,knight:-20},buildingProductionMod:{university:.1,library:.05}}},{id:"divide_rebels",text:"",description:"",effects:{resourcePercent:{silver:-.012},populationPercent:-.012,stability:0,approval:{peasant:-5,serf:-5,landowner:5,official:10},buildingProductionMod:{farm:-.1,large_estate:-.15}}}]},{id:"union_recognition_fight",name:"",icon:"Users",image:null,description:"",triggerConditions:{minEpoch:6,classConditions:{worker:{minPop:50,maxApproval:55},capitalist:{minWealthShare:.3}}},options:[{id:"legalize_unions",text:"",description:"",effects:{stability:-10,approval:{worker:35,peasant:15,capitalist:-35,merchant:-15},buildingProductionMod:{factory:-.1,steel_works:-.1}}},{id:"ban_unions",text:"",description:"",effects:{stability:-20,approval:{worker:-40,peasant:-20,capitalist:30,soldier:10}},randomEffects:[{chance:.4,effects:{populationPercent:-.012,stability:-25}}]},{id:"regulated_unions",text:"",description:"",effects:{stability:0,approval:{worker:10,capitalist:-10,official:10},buildingProductionMod:{factory:-.05,steel_works:-.05}}}]},{id:"enclosure_movement",name:"",icon:"Fence",image:null,description:"",triggerConditions:{minEpoch:4,classConditions:{landowner:{minWealthShare:.25,minInfluenceShare:.2},peasant:{minPop:60}}},options:[{id:"support_enclosure",text:"",description:"",effects:{resourcePercent:{food:.05,science:.03},stability:-15,approval:{landowner:30,capitalist:20,peasant:-35,worker:10},buildingProductionMod:{farm:.1,large_estate:.15}}},{id:"protect_commons",text:"",description:"",effects:{stability:10,approval:{peasant:25,landowner:-30,capitalist:-15},buildingProductionMod:{farm:-.05,large_estate:-.05}}},{id:"compensation_scheme",text:"",description:"",effects:{resourcePercent:{food:.03},stability:-5,approval:{peasant:5,landowner:-15,worker:8},buildingProductionMod:{farm:.05,large_estate:.08}}}]},{id:"press_freedom_debate",name:"",icon:"Newspaper",image:null,description:'""',triggerConditions:{minEpoch:5,classConditions:{scribe:{minInfluenceShare:.12},official:{minPop:10}}},options:[{id:"protect_press",text:"",description:"",effects:{resourcePercent:{culture:.06},stability:-5,approval:{scribe:30,merchant:15,peasant:10,official:-25},buildingProductionMod:{library:.1,university:.1}}},{id:"shut_down_paper",text:"",description:'""',effects:{resourcePercent:{culture:-.4},stability:5,approval:{scribe:-35,merchant:-10,peasant:-15,official:20},buildingProductionMod:{library:-.15,university:-.1}}},{id:"regulate_press",text:"",description:'""',effects:{resourcePercent:{culture:-.2},stability:3,approval:{scribe:-20,official:15,merchant:5},buildingProductionMod:{library:-.05,university:-.05}}}]},{id:"tax_farmer_abuse",name:"",icon:"Coins",image:null,description:"",triggerConditions:{minEpoch:3,classConditions:{merchant:{minWealthShare:.2},peasant:{maxApproval:50}}},options:[{id:"abolish_tax_farming",text:"",description:"",effects:{resourcePercent:{silver:-.02},stability:8,approval:{peasant:25,worker:15,merchant:-25,official:15}}},{id:"regulate_tax_farmers",text:"",description:"",effects:{resourcePercent:{silver:-.012},stability:3,approval:{peasant:10,merchant:-10,official:5}}},{id:"crack_down_resisters",text:"",description:"",effects:{populationPercent:-.01,stability:-10,approval:{peasant:-30,worker:-20,merchant:15,soldier:10}}}]},{id:"reign_of_terror",name:"",icon:"Skull",image:null,description:'""""""',triggerConditions:{minEpoch:5,minStability:20,maxStability:45,classConditions:{peasant:{minApproval:55},landowner:{maxApproval:35}}},options:[{id:"end_terror",text:"",description:"",effects:{stability:10,approval:{landowner:25,merchant:20,cleric:15,peasant:-20,worker:-15}}},{id:"intensify_terror",text:"",description:'""',effects:{populationPercent:-.012,stability:-15,approval:{peasant:15,worker:10,landowner:-35,merchant:-30,cleric:-30}}},{id:"redirect_terror",text:"",description:'""',effects:{populationPercent:-.03,stability:5,approval:{peasant:-5,official:15,merchant:10},buildingProductionMod:{all:-.05}}}]},{id:"stock_market_crash",name:"",icon:"TrendingDown",image:null,description:"",triggerConditions:{minEpoch:6,classConditions:{capitalist:{minPop:8,minWealthShare:.25},merchant:{minPop:15}}},options:[{id:"massive_intervention",text:"",description:"",effects:{resourcePercent:{silver:-.012},stability:10,approval:{capitalist:20,merchant:15,worker:-15,peasant:-20}}},{id:"let_market_correct",text:"",description:'""',effects:{stability:-20,approval:{capitalist:-30,merchant:-25,worker:5,peasant:5}}},{id:"protect_small_investors",text:"",description:"",effects:{resourcePercent:{silver:-.03},stability:-5,approval:{capitalist:-25,merchant:10,worker:15,peasant:12}}}]},{id:"education_reform_debate",name:"",icon:"GraduationCap",image:null,description:'""""""',triggerConditions:{minEpoch:5,classConditions:{scribe:{minInfluenceShare:.1},cleric:{minInfluenceShare:.1}}},options:[{id:"universal_education",text:"",description:"",effects:{resourcePercent:{silver:-.04,science:.08,culture:.08},stability:-5,approval:{scribe:30,peasant:15,worker:15,cleric:-25,landowner:-20}}},{id:"church_education",text:"",description:"",effects:{resourcePercent:{silver:-.02,culture:.05},stability:5,approval:{cleric:25,landowner:10,scribe:-20,peasant:-10}}},{id:"elite_education",text:"",description:"",effects:{resourcePercent:{silver:-.025,science:.06},stability:3,approval:{scribe:10,landowner:15,peasant:-15,worker:-15}}}]},{id:"religious_schism",name:"",icon:"Cross",image:null,description:"",triggerConditions:{minEpoch:3,classConditions:{cleric:{minInfluenceShare:.15},peasant:{minPop:50}}},options:[{id:"support_orthodox",text:"",description:'""',effects:{stability:5,approval:{cleric:20,landowner:10,peasant:-10,scribe:-15},buildingProductionMod:{all:-.1}}},{id:"support_reformers",text:"",description:"",effects:{resourcePercent:{culture:.05},stability:-10,approval:{cleric:-25,peasant:15,scribe:20,landowner:-15},buildingProductionMod:{all:-.1}}},{id:"religious_tolerance",text:"",description:"",effects:{resourcePercent:{culture:.03},stability:-5,approval:{cleric:-15,merchant:15,scribe:15,peasant:5},buildingProductionMod:{all:.05}}}]}],Ty=[{id:"mammoth_hunt",name:"",icon:"Target",image:null,description:"",triggerConditions:{minPopulation:30,maxEpoch:1},options:[{id:"full_hunt",text:"",description:"",effects:{resourcePercent:{food:.015},populationPercent:-.015,approval:{soldier:15,peasant:10},resourceDemandMod:{food:.05,wood:.03},buildingProductionMod:{lumber_camp:-.05,stone_tool_workshop:-.05}},randomEffects:[{chance:.3,effects:{resourcePercent:{food:.07},approval:{soldier:20}},description:""}]},{id:"small_party",text:"",description:"",effects:{resourcePercent:{food:.03},approval:{soldier:10},resourceDemandMod:{food:.02,wood:.01},buildingProductionMod:{stone_tool_workshop:-.02}}},{id:"let_it_go",text:"",description:"",effects:{stability:5,approval:{peasant:5,soldier:-10},stratumDemandMod:{soldier:-.05}}}]},{id:"fire_discovery",name:"",icon:"Flame",image:null,description:'""',triggerConditions:{maxEpoch:0},options:[{id:"honor_elder",text:"",description:"",effects:{resourcePercent:{science:.03,food:-.012},approval:{cleric:15,peasant:5},resourceDemandMod:{food:.02},buildingProductionMod:{all:.02}}},{id:"force_knowledge",text:"",description:"",effects:{resourcePercent:{science:.02},stability:-10,approval:{cleric:-20,soldier:10},buildingProductionMod:{stone_tool_workshop:.03}}},{id:"reject_offer",text:"",description:'""',effects:{approval:{cleric:-10,soldier:5},stratumDemandMod:{cleric:-.05}}}]},{id:"cave_dispute",name:"",icon:"Home",image:null,description:"",triggerConditions:{minPopulation:40,maxEpoch:0},options:[{id:"favor_stronger",text:"",description:"",effects:{stability:-5,approval:{soldier:15,peasant:-10},resourceDemandMod:{stone:.08,food:.05}}},{id:"share_cave",text:"",description:"",effects:{stability:5,approval:{peasant:10,soldier:-5},stratumDemandMod:{peasant:.03}}},{id:"build_new",text:"",description:"",effects:{resourcePercent:{food:-.02},population:2,stability:3,approval:{peasant:15,artisan:10},resourceDemandMod:{wood:.05,stone:.03}}}]},{id:"shaman_ritual",name:"",icon:"Star",image:null,description:"",triggerConditions:{maxEpoch:1},options:[{id:"grand_ritual",text:"",description:"",effects:{resourcePercent:{food:-.04,culture:.02},stability:10,approval:{cleric:25,peasant:5},resourceDemandMod:{culture:.1,food:.05}},randomEffects:[{chance:.4,effects:{stability:15,approval:{cleric:15}},description:""}]},{id:"simple_ritual",text:"",description:"",effects:{resourcePercent:{food:-.012,culture:.012},approval:{cleric:-5},resourceDemandMod:{culture:.03,food:.02}}},{id:"ignore_shaman",text:"",description:"",effects:{stability:-5,approval:{cleric:-20,soldier:10},stratumDemandMod:{cleric:-.1}}}]},{id:"stone_tool_innovation",name:"",icon:"Hammer",image:null,description:"",triggerConditions:{maxEpoch:0},options:[{id:"embrace_innovation",text:"",description:"",effects:{resourcePercent:{science:.03},approval:{artisan:20,cleric:-15,peasant:10},resourceDemandMod:{wood:.02,stone:.03}}},{id:"keep_tradition",text:"",description:"",effects:{resourcePercent:{culture:.02},approval:{cleric:15,artisan:-15},stratumDemandMod:{artisan:-.08}}},{id:"test_first",text:"",description:"",effects:{resourcePercent:{science:.02,culture:.012},approval:{artisan:10,scribe:10},resourceDemandMod:{wood:.01,stone:.01}}}]},{id:"bronze_secret",name:"",icon:"Gem",image:null,description:"",triggerConditions:{minEpoch:1,maxEpoch:2},options:[{id:"buy_secret",text:"",description:"",effects:{resourcePercent:{silver:-.03,science:.05},approval:{artisan:20,merchant:-10},resourceDemandMod:{copper:.15,silver:.05}}},{id:"grant_citizenship",text:"",description:"",effects:{resourcePercent:{science:.04},populationPercent:.015,approval:{artisan:15,landowner:-10},stratumDemandMod:{peasant:.05}}},{id:"steal_secret",text:"",description:"",effects:{resourcePercent:{science:.03},stability:-10,approval:{soldier:10,merchant:-15},stratumDemandMod:{merchant:-.08}}},{id:"refuse_offer",text:"",description:"",effects:{approval:{artisan:5},stratumDemandMod:{artisan:-.03}}}]},{id:"writing_invention",name:"",icon:"BookOpen",image:null,description:"",triggerConditions:{minEpoch:1,maxEpoch:2},options:[{id:"sacred_only",text:"",description:"",effects:{resourcePercent:{culture:.04},approval:{cleric:25,merchant:-20,scribe:-10},resourceDemandMod:{papyrus:.1}}},{id:"limited_secular",text:"",description:"",effects:{resourcePercent:{culture:.03,science:.02},approval:{cleric:5,scribe:15,merchant:-5},resourceDemandMod:{papyrus:.05}}},{id:"public_writing",text:"",description:"",effects:{resourcePercent:{science:.04,culture:.015},approval:{cleric:-20,merchant:20,scribe:25,artisan:10},resourceDemandMod:{papyrus:.2}}}]},{id:"irrigation_project",name:"",icon:"Droplet",image:null,description:"",triggerConditions:{minEpoch:1,maxEpoch:3},options:[{id:"forced_labor",text:"",description:"",effects:{resourcePercent:{food:.05},stability:-15,approval:{landowner:10,peasant:-25,artisan:-15},resourceDemandMod:{food:.1,wood:.05}}},{id:"paid_workers",text:"",description:"",effects:{resourcePercent:{silver:-.025,food:.04},approval:{peasant:15,artisan:10,merchant:-5},resourceDemandMod:{silver:.05,food:.03}}},{id:"noble_contribution",text:"",description:"",effects:{resourcePercent:{food:.035},approval:{landowner:-20,peasant:20},resourceDemandMod:{food:.02,silver:.01}}},{id:"postpone_project",text:"",description:"",effects:{approval:{peasant:-10,landowner:5},stratumDemandMod:{peasant:-.05}}}]},{id:"slave_rebellion_bronze",name:"",icon:"Users",image:null,description:"",triggerConditions:{minEpoch:1,maxEpoch:3},options:[{id:"crush_rebellion",text:"",description:"",effects:{stability:-10,populationPercent:-.03,approval:{soldier:15,landowner:20,peasant:-20},resourceDemandMod:{tools:.1,food:.05}}},{id:"negotiate_freedom",text:"",description:"",effects:{populationPercent:.05,approval:{landowner:-25,peasant:15,artisan:10},resourceDemandMod:{food:.08,silver:.03}}},{id:"improve_conditions",text:"",description:"",effects:{resourcePercent:{food:-.02},stability:5,approval:{landowner:-10,peasant:5},resourceDemandMod:{food:.05}}}]},{id:"city_state_alliance",name:"",icon:"Handshake",image:null,description:"",triggerConditions:{minEpoch:1,maxEpoch:3},options:[{id:"join_alliance",text:"",description:"",effects:{resourcePercent:{silver:.012},stability:10,approval:{merchant:20,landowner:10,soldier:-10},resourceDemandMod:{silver:.05,tools:.03}}},{id:"trade_only",text:"",description:"",effects:{resourcePercent:{silver:.012},approval:{merchant:15,soldier:5},resourceDemandMod:{silver:.03}}},{id:"refuse_alliance",text:"",description:"",effects:{stability:-5,approval:{soldier:15,merchant:-15},stratumDemandMod:{merchant:-.08}}}]},{id:"philosophy_school",name:"",icon:"BookOpen",image:null,description:"",triggerConditions:{minEpoch:2,maxEpoch:4},options:[{id:"support_rationalists",text:"",description:"",effects:{resourcePercent:{science:.05,culture:.02},approval:{scribe:25,cleric:-20,merchant:10},resourceDemandMod:{papyrus:.1,culture:.05}}},{id:"support_traditionalists",text:"",description:"",effects:{resourcePercent:{culture:.05},stability:10,approval:{cleric:20,scribe:-15,landowner:15},resourceDemandMod:{culture:.08}}},{id:"public_debate",text:"",description:"",effects:{resourcePercent:{culture:.03,science:.03},approval:{scribe:15,cleric:5,peasant:10},resourceDemandMod:{papyrus:.05}}},{id:"ban_both",text:"",description:"",effects:{stability:15,approval:{scribe:-30,cleric:-10,soldier:10},stratumDemandMod:{scribe:-.15}}}]},{id:"olympic_games",name:"",icon:"Trophy",image:null,description:"",triggerConditions:{minEpoch:2,maxEpoch:4},options:[{id:"grand_games",text:"",description:"",effects:{resourcePercent:{silver:-.04,culture:.08},stability:15,approval:{landowner:20,soldier:25,peasant:15},resourceDemandMod:{food:.1,silver:.05}}},{id:"modest_games",text:"",description:"",effects:{resourcePercent:{silver:-.02,culture:.04},stability:5,approval:{soldier:15,peasant:10},resourceDemandMod:{food:.05,silver:.02}}},{id:"decline_hosting",text:"",description:"",effects:{approval:{landowner:-15,soldier:-10,merchant:10},stratumDemandMod:{landowner:-.08}}}]},{id:"democratic_reform",name:"",icon:"Vote",image:null,description:'""',triggerConditions:{minEpoch:2,maxEpoch:4},options:[{id:"full_democracy",text:"",description:"",effects:{stability:-10,approval:{peasant:30,artisan:25,merchant:20,landowner:-30,cleric:-15},resourceDemandMod:{papyrus:.15}}},{id:"limited_representation",text:"",description:"",effects:{stability:5,approval:{peasant:10,artisan:15,landowner:-10},resourceDemandMod:{food:.03}}},{id:"reject_democracy",text:"",description:"",effects:{stability:-5,approval:{landowner:20,peasant:-25,artisan:-20},stratumDemandMod:{peasant:-.1}}}]},{id:"theatrical_competition",name:"",icon:"Drama",image:null,description:"",triggerConditions:{minEpoch:2,maxEpoch:4},options:[{id:"allow_satire",text:"",description:"",effects:{resourcePercent:{culture:.04},stability:-5,approval:{scribe:25,peasant:15,landowner:-15},resourceDemandMod:{culture:.1}}},{id:"only_heroic",text:"",description:"",effects:{resourcePercent:{culture:.03},stability:10,approval:{landowner:15,soldier:10,scribe:-20},stratumDemandMod:{scribe:-.1}}},{id:"fair_competition",text:"",description:"",effects:{resourcePercent:{culture:.04},approval:{scribe:15,peasant:10,merchant:10},resourceDemandMod:{culture:.08}}}]},{id:"gladiator_question",name:"",icon:"Swords",image:null,description:"",triggerConditions:{minEpoch:2,maxEpoch:4},options:[{id:"expand_games",text:"",description:"",effects:{resourcePercent:{silver:-.012},stability:15,approval:{peasant:20,soldier:15,cleric:-15},resourceDemandMod:{food:.1,tools:.05}}},{id:"reform_games",text:"",description:"",effects:{resourcePercent:{silver:-.028},stability:5,approval:{cleric:10,peasant:5},resourceDemandMod:{stone:.05,tools:.03}}},{id:"abolish_games",text:"",description:"",effects:{stability:-10,approval:{cleric:25,peasant:-20,soldier:-15},stratumDemandMod:{peasant:-.1}}}]},{id:"crusade_call",name:"",icon:"Cross",image:null,description:"",triggerConditions:{minEpoch:3,maxEpoch:4},options:[{id:"lead_crusade",text:"",description:"",effects:{resourcePercent:{silver:-.012,culture:.06},populationPercent:-.025,approval:{cleric:30,soldier:25,landowner:15,peasant:-20},resourceDemandMod:{food:.1,tools:.08}},randomEffects:[{chance:.4,effects:{resourcePercent:{silver:.08,culture:.05},approval:{soldier:20}},description:""},{chance:.3,effects:{populationPercent:-.012,stability:-15},description:"..."}]},{id:"send_army",text:"",description:"",effects:{resourcePercent:{silver:-.03,culture:.03},populationPercent:-.012,approval:{cleric:15,soldier:10},resourceDemandMod:{food:.05,tools:.03}}},{id:"financial_support",text:"",description:"",effects:{resourcePercent:{silver:-.025},approval:{cleric:10,soldier:-10,merchant:-5},resourceDemandMod:{silver:.05}}},{id:"refuse_crusade",text:"",description:"",effects:{approval:{cleric:-25,soldier:-15,merchant:15,peasant:10},stratumDemandMod:{cleric:-.1}}}]},{id:"black_death",name:"",icon:"Skull",image:null,description:"",triggerConditions:{minEpoch:3,maxEpoch:5},options:[{id:"quarantine",text:"",description:"",effects:{populationPercent:-.012,resourcePercent:{silver:-.02},stability:-10,approval:{merchant:-25,peasant:-10,cleric:10},resourceDemandMod:{cloth:.1,food:.05}}},{id:"blame_outsiders",text:"",description:"",effects:{populationPercent:-.02,stability:5,approval:{peasant:10,merchant:-20,cleric:-10},stratumDemandMod:{merchant:-.1}}},{id:"prayer_procession",text:"",description:"",effects:{populationPercent:-.025,resourcePercent:{culture:.02},approval:{cleric:25,peasant:5},resourceDemandMod:{culture:.08}}},{id:"medical_research",text:"",description:"",effects:{populationPercent:-.015,resourcePercent:{silver:-.03,science:.04},approval:{scribe:20,cleric:-15},resourceDemandMod:{papyrus:.05,silver:.03}}}]},{id:"peasant_revolt_feudal",name:"",icon:"Pitchfork",image:null,description:"",triggerConditions:{minEpoch:3,maxEpoch:5,classConditions:{peasant:{maxApproval:30}}},options:[{id:"crush_revolt",text:"",description:"",effects:{populationPercent:-.02,stability:-15,approval:{landowner:25,soldier:15,peasant:-35},resourceDemandMod:{tools:.15,food:.08}}},{id:"negotiate_terms",text:"",description:"",effects:{resourcePercent:{silver:-.02},stability:10,approval:{peasant:25,landowner:-20,artisan:10},resourceDemandMod:{silver:.05,food:.03}}},{id:"promise_reforms",text:"",description:"",effects:{stability:5,approval:{peasant:10},stratumDemandMod:{peasant:.05}},randomEffects:[{chance:.5,effects:{stability:-20,approval:{peasant:-30}},description:""}]}]},{id:"cathedral_construction",name:"",icon:"Church",image:null,description:"",triggerConditions:{minEpoch:3,maxEpoch:5},options:[{id:"grand_cathedral",text:"",description:"",effects:{resourcePercent:{silver:-.02,culture:.08},approval:{cleric:35,artisan:20,peasant:-10,merchant:-15}}},{id:"modest_church",text:"",description:"",effects:{resourcePercent:{silver:-.03,culture:.03},approval:{cleric:10,peasant:5},resourceDemandMod:{food:.05,silver:.02}}},{id:"secular_building",text:"",description:"",effects:{resourcePercent:{silver:-.04,science:.03},approval:{cleric:-25,merchant:20,artisan:15},resourceDemandMod:{silver:.05,brick:.05}}}]},{id:"guild_monopoly",name:"",icon:"Shield",image:null,description:"",triggerConditions:{minEpoch:3,maxEpoch:5},options:[{id:"grant_monopoly",text:"",description:"",effects:{resourcePercent:{culture:.02},stability:10,approval:{artisan:25,merchant:-20,peasant:-10},resourceDemandMod:{tools:.1,cloth:.05}}},{id:"break_monopoly",text:"",description:"",effects:{resourcePercent:{silver:.012},approval:{artisan:-25,merchant:25,peasant:15},resourceDemandMod:{tools:.08,cloth:.03}}},{id:"regulate_guilds",text:"",description:"",effects:{stability:5,approval:{artisan:-5,merchant:10,peasant:5},stratumDemandMod:{artisan:-.03}}}]},{id:"new_world_discovery",name:"",icon:"Compass",image:null,description:"",triggerConditions:{minEpoch:4,maxEpoch:6},options:[{id:"colonize_aggressively",text:"",description:"",effects:{resourcePercent:{silver:.02,food:.015},stability:-10,approval:{soldier:20,merchant:25,cleric:-20,peasant:-10},resourceDemandMod:{food:.1,tools:.08}}},{id:"trade_relations",text:"",description:"",effects:{resourcePercent:{silver:.012,culture:.03},approval:{merchant:30,cleric:10,soldier:-10},resourceDemandMod:{spice:.1,silver:.05}}},{id:"missionary_work",text:"",description:"",effects:{resourcePercent:{silver:.012,culture:.05},approval:{cleric:30,merchant:5},resourceDemandMod:{culture:.1}}},{id:"limited_contact",text:"",description:"",effects:{resourcePercent:{silver:.02},stability:5,approval:{merchant:10,cleric:5},resourceDemandMod:{spice:.05}}}]},{id:"printing_revolution",name:"",icon:"Book",image:null,description:"",triggerConditions:{minEpoch:4,maxEpoch:6},options:[{id:"embrace_printing",text:"",description:"",effects:{resourcePercent:{science:.06,culture:.04},approval:{scribe:30,merchant:20,cleric:-25},resourceDemandMod:{papyrus:.15}}},{id:"church_control",text:"",description:"",effects:{resourcePercent:{science:.03,culture:.02},approval:{cleric:15,scribe:-10},resourceDemandMod:{papyrus:.05}}},{id:"ban_printing",text:"",description:"",effects:{stability:10,approval:{cleric:20,scribe:-35,merchant:-20},stratumDemandMod:{scribe:-.15}}}]},{id:"reformation_movement",name:"",icon:"ScrollText",image:null,description:"",triggerConditions:{minEpoch:4,maxEpoch:6},options:[{id:"support_reformers",text:"",description:"",effects:{resourcePercent:{culture:.05},stability:-20,approval:{cleric:-30,scribe:25,merchant:20,peasant:15}}},{id:"support_church",text:"",description:"",effects:{resourcePercent:{culture:.02},stability:10,approval:{cleric:30,scribe:-20,peasant:-10},stratumDemandMod:{scribe:-.1}}},{id:"allow_both",text:"",description:"",effects:{stability:-10,approval:{cleric:-15,scribe:15,merchant:25,peasant:10},resourceDemandMod:{silver:.08}}}]},{id:"spice_trade_war",name:"",icon:"Anchor",image:null,description:"",triggerConditions:{minEpoch:4,maxEpoch:6},options:[{id:"naval_war",text:"",description:"",effects:{resourcePercent:{silver:-.04},populationPercent:-.012,approval:{merchant:25,soldier:20,peasant:-15},resourceDemandMod:{tools:.15,silver:.08}},randomEffects:[{chance:.5,effects:{resourcePercent:{silver:.08}},description:""}]},{id:"trade_company",text:"",description:"",effects:{resourcePercent:{silver:-.03},approval:{merchant:30,landowner:-10},resourceDemandMod:{silver:.05,plank:.05}}},{id:"find_alternative",text:"",description:"",effects:{resourcePercent:{silver:-.025,science:.03},approval:{merchant:15,scribe:15},resourceDemandMod:{silver:.03,science:.02}}}]},{id:"witch_trials",name:"",icon:"Flame",image:null,description:"",triggerConditions:{minEpoch:4,maxEpoch:5},options:[{id:"full_trials",text:"",description:"",effects:{populationPercent:-.01,stability:5,approval:{cleric:25,peasant:10,scribe:-25},resourceDemandMod:{culture:.1}}},{id:"proper_investigation",text:"",description:"",effects:{resourcePercent:{science:.02},approval:{scribe:20,cleric:-10,peasant:-5},resourceDemandMod:{silver:.02}}},{id:"stop_trials",text:"",description:"",effects:{stability:-10,approval:{cleric:-30,scribe:30,peasant:-15},stratumDemandMod:{cleric:-.15}}}]},{id:"encyclopedie",name:"",icon:"Library",image:null,description:'""',triggerConditions:{minEpoch:5,maxEpoch:6},options:[{id:"fund_encyclopedia",text:"",description:"",effects:{resourcePercent:{silver:-.05,science:.08,culture:.06},approval:{scribe:35,merchant:15,cleric:-25,landowner:-15},resourceDemandMod:{papyrus:.15,silver:.05}}},{id:"censored_version",text:"",description:"",effects:{resourcePercent:{silver:-.04,science:.05,culture:.03},approval:{scribe:5,cleric:5},resourceDemandMod:{papyrus:.08}}},{id:"ban_encyclopedia",text:"",description:"",effects:{stability:5,approval:{cleric:20,landowner:15,scribe:-35,merchant:-15},stratumDemandMod:{scribe:-.15}}}]},{id:"salon_culture",name:"",icon:"Users",image:null,description:"",triggerConditions:{minEpoch:5,maxEpoch:6},options:[{id:"encourage_salons",text:"",description:"",effects:{resourcePercent:{culture:.05,science:.03},stability:-5,approval:{scribe:25,landowner:15,cleric:-15},resourceDemandMod:{coffee:.1,delicacies:.05}}},{id:"monitor_salons",text:"",description:"",effects:{resourcePercent:{culture:.03,science:.02},approval:{scribe:-10,landowner:5},resourceDemandMod:{silver:.02}}},{id:"ban_salons",text:"",description:"",effects:{stability:10,approval:{scribe:-30,landowner:-20,cleric:10},stratumDemandMod:{scribe:-.15}}}]},{id:"social_contract",name:"",icon:"FileText",image:null,description:"",triggerConditions:{minEpoch:5,maxEpoch:6},options:[{id:"embrace_ideas",text:"",description:"",effects:{resourcePercent:{culture:.04},stability:-15,approval:{scribe:30,peasant:25,artisan:20,landowner:-25,cleric:-20},resourceDemandMod:{papyrus:.15}}},{id:"academic_only",text:"",description:"",effects:{resourcePercent:{science:.03},approval:{scribe:10,landowner:-5},resourceDemandMod:{papyrus:.05}}},{id:"burn_books",text:"",description:"",effects:{stability:10,approval:{cleric:20,landowner:15,scribe:-40,peasant:-15},stratumDemandMod:{scribe:-.2}}}]},{id:"scientific_academy",name:"",icon:"Microscope",image:null,description:"",triggerConditions:{minEpoch:5,maxEpoch:6},options:[{id:"grand_academy",text:"",description:"",effects:{resourcePercent:{silver:-.05,science:.08},approval:{scribe:35,merchant:15,landowner:-10},resourceDemandMod:{silver:.05,papyrus:.1}}},{id:"modest_academy",text:"",description:"",effects:{resourcePercent:{silver:-.03,science:.05},approval:{scribe:20}}},{id:"private_funding",text:"",description:"",effects:{resourcePercent:{science:.03},approval:{merchant:15,scribe:10},resourceDemandMod:{silver:.02}}}]},{id:"vaccination_debate",name:"",icon:"Syringe",image:null,description:'""',triggerConditions:{minEpoch:5,maxEpoch:6},options:[{id:"mandatory_vaccination",text:"",description:"",effects:{population:30,resourcePercent:{silver:-.035,science:.04},approval:{scribe:25,cleric:-25,peasant:-15},resourceDemandMod:{silver:.03,science:.02}}},{id:"voluntary_vaccination",text:"",description:"",effects:{populationPercent:.04,resourcePercent:{silver:-.012,science:.03},approval:{scribe:15,peasant:5},resourceDemandMod:{silver:.01,science:.01}}},{id:"ban_vaccination",text:"",description:"",effects:{approval:{cleric:20,peasant:10,scribe:-30},stratumDemandMod:{scribe:-.15}}}]},{id:"factory_conditions",name:"",icon:"Factory",image:null,description:"",triggerConditions:{minEpoch:6},options:[{id:"strict_regulation",text:"",description:"",effects:{resourcePercent:{silver:-.02},stability:10,approval:{worker:35,artisan:20,merchant:-25,landowner:-15},resourceDemandMod:{silver:.02,tools:.05}}},{id:"mild_reform",text:"",description:"",effects:{resourcePercent:{silver:-.012},approval:{worker:15,merchant:-5},resourceDemandMod:{silver:.01}}},{id:"free_market",text:"",description:"",effects:{resourcePercent:{silver:.012},stability:-10,approval:{merchant:25,worker:-30,artisan:-20},stratumDemandMod:{worker:-.15}}}]},{id:"railway_mania",name:"",icon:"Train",image:null,description:"",triggerConditions:{minEpoch:6},options:[{id:"state_railway",text:"",description:"",effects:{resourcePercent:{silver:-.015,science:.04},populationPercent:.05,stability:5,resourceDemandMod:{iron:.3,coal:.35,wood:.2,steel:.15},approval:{worker:20,merchant:-15,landowner:-10}}},{id:"regulate_private",text:"",description:"",effects:{resourcePercent:{silver:-.03,science:.03},populationPercent:.03,resourceDemandMod:{iron:.2,coal:.2,wood:.15,steel:.1},approval:{merchant:15,worker:10}}},{id:"laissez_faire",text:"",description:"",effects:{resourcePercent:{science:.02},resourceDemandMod:{iron:.15,coal:.1,steel:.08},approval:{merchant:25}},randomEffects:[{chance:.4,effects:{resourcePercent:{silver:-.05},stability:-15},description:""}]}]},{id:"labor_union_formation",name:"",icon:"Users",image:null,description:"",triggerConditions:{minEpoch:6},options:[{id:"legalize_unions",text:"",description:"",effects:{stability:5,resourceDemandMod:{food:.15,cloth:.1},approval:{worker:40,artisan:25,merchant:-30,landowner:-20},resourceDemandMod:{food:.1,cloth:.05}}},{id:"limited_rights",text:"",description:"",effects:{resourceDemandMod:{food:.05},approval:{worker:15,merchant:-10},resourceDemandMod:{food:.05}}},{id:"ban_unions",text:"",description:"",effects:{stability:-15,resourceDemandMod:{food:-.1},approval:{merchant:20,landowner:15,worker:-40,artisan:-25}}}]},{id:"urban_poverty",name:"",icon:"Home",image:null,description:"",triggerConditions:{minEpoch:6},options:[{id:"public_housing",text:"",description:"",effects:{resourcePercent:{silver:-.05},populationPercent:.04,resourceDemandMod:{wood:.3,stone:.25,brick:.2},stability:10,approval:{worker:30,peasant:20,merchant:-15,landowner:-10}}},{id:"incentivize_private",text:"",description:"",effects:{resourcePercent:{silver:-.02},populationPercent:.02,approval:{merchant:15,worker:5},resourceDemandMod:{brick:.08,steel:.03}}},{id:"demolish_slums",text:"",description:"",effects:{populationPercent:-.012,stability:-10,approval:{landowner:15,worker:-30,peasant:-25},stratumDemandMod:{worker:-.15}}}]},{id:"communist_manifesto",name:"",icon:"BookOpen",image:null,description:"",triggerConditions:{minEpoch:6},options:[{id:"suppress_movement",text:"",description:"",effects:{stability:5,resourceDemandMod:{food:-.1},approval:{landowner:20,merchant:15,worker:-35,artisan:-20}}},{id:"reform_to_defuse",text:"",description:"",effects:{resourcePercent:{silver:-.03},stability:10,resourceDemandMod:{food:.05,cloth:.08},approval:{worker:20,artisan:15,merchant:-15},resourceDemandMod:{food:.05,cloth:.03}}},{id:"allow_debate",text:"",description:"",effects:{resourcePercent:{culture:.03},stability:-15,resourceDemandMod:{culture:.1},approval:{worker:25,scribe:20,landowner:-25,merchant:-20}}}]},{id:"ritual_reform",name:"",icon:"Scroll",description:'""',triggerConditions:{minEpoch:1,maxEpoch:3,minPopulation:100},options:[{id:"establish_ritual",text:"",description:"",effects:{resourcePercent:{culture:.05,silver:-.012},stability:20,approval:{landowner:25,official:30,cleric:20,peasant:-15,worker:-10}}},{id:"simplify_ritual",text:"",description:"",effects:{resourcePercent:{culture:.02},stability:5,approval:{merchant:15,artisan:10,peasant:10,official:-10}}},{id:"reject_ritual",text:"",description:"",effects:{stability:-15,approval:{peasant:20,worker:20,landowner:-30,official:-25}}}]},{id:"wandering_sage",name:"",icon:"User",description:'""',triggerConditions:{minEpoch:2,maxEpoch:4,minPopulation:150},options:[{id:"hire_sage",text:"",description:"",effects:{resourcePercent:{culture:.08,silver:-.012},stability:15,approval:{scribe:35,official:25,cleric:20,peasant:10,merchant:-10},resourceDemandMod:{papyrus:.1,silver:.05}}},{id:"allow_teaching",text:"",description:"",effects:{resourcePercent:{culture:.04},stability:5,approval:{scribe:25,peasant:15,worker:10,official:-5}}},{id:"expel_sage",text:"",description:"",effects:{resourcePercent:{culture:-.02},stability:5,approval:{soldier:10,merchant:10,scribe:-30,cleric:-20}}}]},{id:"great_wall_project",name:"",icon:"Building",description:"",triggerConditions:{minEpoch:2,maxEpoch:4,minPopulation:250},options:[{id:"build_wall",text:"",description:"",effects:{resourcePercent:{stone:-.03,silver:-.02},populationPercent:-.012,stability:-20,approval:{soldier:30,landowner:20,peasant:-40,worker:-35,serf:-40},resourceDemandMod:{stone:.2,food:.15}},randomEffects:[{chance:.4,effects:{stability:30,approval:{soldier:20}},description:""},{chance:.3,effects:{stability:-30,populationPercent:-.012,approval:{peasant:-30}},description:""}]},{id:"limited_fortification",text:"",description:"",effects:{resourcePercent:{stone:-.06,silver:-.028},populationPercent:-.03,stability:5,approval:{soldier:15,peasant:-10},stratumDemandMod:{peasant:-.05}}},{id:"reject_wall",text:"",description:"",effects:{approval:{peasant:20,worker:15,soldier:-20,landowner:-15}},randomEffects:[{chance:.3,effects:{resourcePercent:{silver:-.012,food:-.03},stability:-20},description:""}]}]},{id:"vassal_rebellion",name:"",icon:"Swords",description:'""',triggerConditions:{minEpoch:2,maxEpoch:4,minPopulation:200,classConditions:{landowner:{maxApproval:40}}},options:[{id:"crush_rebellion",text:"",description:"",effects:{resourcePercent:{silver:-.025},stability:-25,approval:{soldier:20,official:15,landowner:-30},resourceDemandMod:{tools:.15,food:.1}},randomEffects:[{chance:.6,effects:{stability:35,resourcePercent:{silver:.012},approval:{landowner:-20,official:20}},description:""},{chance:.4,effects:{stability:-40,populationPercent:-.015,approval:{soldier:-20,peasant:-30}},description:""}]},{id:"negotiate_peace",text:"",description:"",effects:{stability:10,approval:{landowner:25,official:-20,soldier:-15},stratumDemandMod:{official:-.1}}},{id:"abandon_reform",text:"",description:"",effects:{stability:15,approval:{landowner:40,official:-30,peasant:-10},stratumDemandMod:{official:-.15}}}]},{id:"frontier_general_rebellion",name:"",icon:"Horse",description:"",triggerConditions:{minEpoch:3,maxEpoch:5,minPopulation:350,classConditions:{soldier:{maxApproval:50}}},options:[{id:"flee_capital",text:"",description:"",effects:{resourcePercent:{silver:-.03},stability:-40,populationPercent:-.012,approval:{official:-30,soldier:-20,peasant:-25,merchant:-30},resourceDemandMod:{silver:.05}},randomEffects:[{chance:.5,effects:{stability:30,approval:{soldier:30}},description:""}]},{id:"defend_capital",text:"",description:"",effects:{resourcePercent:{silver:-.02},stability:-20,approval:{soldier:25,official:20,peasant:10},resourceDemandMod:{tools:.2,food:.15}},randomEffects:[{chance:.4,effects:{stability:40,approval:{soldier:30,official:25}},description:""},{chance:.4,effects:{stability:-50,populationPercent:-.012,approval:{soldier:-30,peasant:-40}},description:""}]},{id:"seek_foreign_aid",text:"",description:"",effects:{resourcePercent:{silver:-.025},stability:-10,approval:{soldier:-15,peasant:-20,official:10},resourceDemandMod:{silver:.08}},randomEffects:[{chance:.6,effects:{stability:25},description:""},{chance:.3,effects:{resourcePercent:{silver:-.02,food:-.05},stability:-20},description:""}]}]},{id:"disarm_generals",name:"",icon:"Wine",description:"",triggerConditions:{minEpoch:3,maxEpoch:5,minPopulation:250},options:[{id:"release_generals",text:"",description:"",effects:{resourcePercent:{silver:-.03},stability:30,approval:{soldier:-25,knight:-30,official:30,landowner:20,merchant:15},resourceDemandMod:{silver:.05}}},{id:"partial_release",text:"",description:"",effects:{resourcePercent:{silver:-.012},stability:15,approval:{soldier:-10,knight:-15,official:15},stratumDemandMod:{soldier:-.05}}},{id:"keep_military",text:"",description:"",effects:{approval:{soldier:20,knight:25,official:-10},stratumDemandMod:{official:-.05}},randomEffects:[{chance:.25,effects:{stability:-35,approval:{soldier:-20}},description:""}]}]},{id:"radical_reform",name:"",icon:"FileText",description:'""',triggerConditions:{minEpoch:3,maxEpoch:5,minPopulation:300},options:[{id:"full_reform",text:"",description:"",effects:{resourcePercent:{silver:.012,culture:-.03},stability:-25,approval:{official:-30,landowner:-35,merchant:20,peasant:15,soldier:20},resourceDemandMod:{papyrus:.1,silver:.05}},randomEffects:[{chance:.4,effects:{resourcePercent:{silver:.03},stability:20},description:""},{chance:.35,effects:{stability:-30,approval:{peasant:-30,official:-20}},description:""}]},{id:"gradual_reform",text:"",description:"",effects:{resourcePercent:{silver:.012},stability:-5,approval:{official:-10,landowner:-15,merchant:10,peasant:5},resourceDemandMod:{papyrus:.05,silver:.02}}},{id:"reject_reform",text:"",description:"",effects:{stability:10,approval:{official:20,landowner:25,merchant:-15,peasant:-10},stratumDemandMod:{peasant:-.05}}}]},{id:"emperor_personal_campaign",name:"",icon:"Crown",description:"",triggerConditions:{minEpoch:3,maxEpoch:5,minPopulation:350},options:[{id:"personal_campaign",text:"",description:"",effects:{resourcePercent:{silver:-.03},stability:-15,approval:{soldier:30,official:-25},resourceDemandMod:{tools:.2,food:.15}},randomEffects:[{chance:.25,effects:{stability:40,resourcePercent:{culture:.05},approval:{soldier:30,official:20}},description:""},{chance:.5,effects:{stability:-60,populationPercent:-.025,resourcePercent:{silver:-.04},approval:{soldier:-40,official:-30,peasant:-30}},description:""}]},{id:"send_general",text:"",description:"",effects:{resourcePercent:{silver:-.02},stability:5,approval:{soldier:15,official:15},resourceDemandMod:{tools:.1,food:.08}},randomEffects:[{chance:.5,effects:{stability:20,approval:{soldier:15}},description:""}]},{id:"negotiate_tribute",text:"",description:"",effects:{resourcePercent:{silver:-.025},stability:10,approval:{soldier:-25,merchant:15,peasant:10,official:-10}}}]},{id:"grand_secretary_reform",name:"",icon:"Scale",description:'""',triggerConditions:{minEpoch:4,maxEpoch:6,minPopulation:350},options:[{id:"support_reform",text:"",description:"",effects:{resourcePercent:{silver:.03},stability:-15,approval:{official:-30,landowner:-35,peasant:25,merchant:20,worker:15},resourceDemandMod:{papyrus:.1,silver:.05}},randomEffects:[{chance:.5,effects:{resourcePercent:{silver:.012},stability:25},description:""},{chance:.3,effects:{stability:-25,approval:{official:-20}},description:""}]},{id:"moderate_reform",text:"",description:"",effects:{resourcePercent:{silver:.012},stability:5,approval:{official:-10,landowner:-15,peasant:10},resourceDemandMod:{papyrus:.05,silver:.02}}},{id:"block_reform",text:"",description:"",effects:{stability:10,approval:{official:25,landowner:30,peasant:-20,merchant:-15},resourceDemandMod:{brick:.15,steel:.08}}}]},{id:"universal_taxation",name:"",icon:"Coins",description:"",triggerConditions:{minEpoch:4,maxEpoch:6,minPopulation:350},options:[{id:"enforce_universal_tax",text:"",description:"",effects:{resourcePercent:{silver:.012},stability:-20,approval:{official:-40,landowner:-35,scribe:-30,peasant:30,worker:25,merchant:10},resourceDemandMod:{silver:.05,papyrus:.03}},randomEffects:[{chance:.4,effects:{resourcePercent:{silver:.012},stability:20},description:""},{chance:.3,effects:{stability:-30,approval:{official:-20,scribe:-15}},description:""}]},{id:"partial_reform",text:"",description:"",effects:{resourcePercent:{silver:.02},stability:-5,approval:{landowner:-20,official:-15,scribe:-10,peasant:15},resourceDemandMod:{silver:.02,papyrus:.01}}},{id:"maintain_privilege",text:"",description:"",effects:{stability:5,approval:{official:20,landowner:25,scribe:20,peasant:-20,worker:-15},resourceDemandMod:{papyrus:.05}}}]},{id:"black_ships",name:"",icon:"Ship",description:"",triggerConditions:{minEpoch:5,maxEpoch:6,minPopulation:350},options:[{id:"open_ports",text:"",description:"",effects:{resourcePercent:{silver:.012,culture:.03},stability:-20,approval:{merchant:35,official:-20,soldier:-30,peasant:-15,landowner:-20},nationRelation:{all:20},nationAggression:{all:-.15}},randomEffects:[{chance:.5,effects:{resourcePercent:{silver:.012,science:.05},stability:15,nationRelation:{random:10}},description:""},{chance:.3,effects:{stability:-25,approval:{peasant:-20,worker:-20}},description:""}]},{id:"limited_trade",text:"",description:"",effects:{resourcePercent:{silver:.012},stability:-5,approval:{merchant:15,official:5,soldier:-10},resourceDemandMod:{silver:.02,tools:.01}}},{id:"resist_foreigners",text:"",description:"",effects:{stability:-10,approval:{soldier:30,peasant:15,merchant:-30,official:10},nationRelation:{all:-30},nationAggression:{all:.2}},randomEffects:[{chance:.6,effects:{resourcePercent:{silver:-.025},populationPercent:-.012,stability:-30,triggerWar:"strongest"},description:""}]}]},{id:"defenestration",name:"",icon:"Landmark",description:"",triggerConditions:{minEpoch:3,maxEpoch:5,minPopulation:250,classConditions:{cleric:{maxApproval:50}}},options:[{id:"punish_rebels",text:"",description:"",effects:{resourcePercent:{silver:-.02},stability:-30,approval:{cleric:20,official:25,landowner:-30,peasant:-20},resourceDemandMod:{tools:.15,food:.1}},randomEffects:[{chance:.5,effects:{stability:-40,populationPercent:-.1},description:""}]},{id:"negotiate_settlement",text:"",description:"",effects:{stability:-10,approval:{cleric:-10,official:-15,landowner:15,merchant:10},resourceDemandMod:{silver:.03}}},{id:"religious_freedom",text:"",description:"",effects:{resourcePercent:{culture:.03},stability:-5,approval:{cleric:-35,landowner:20,merchant:20,peasant:15,worker:10},resourceDemandMod:{culture:.05}}}]},{id:"cave_painting_masterpiece",name:"",icon:"Edit3",description:"",triggerConditions:{maxEpoch:0,minPopulation:40},options:[{id:"sacred_site",text:"",description:"",effects:{resourcePercent:{culture:.1},stability:10,approval:{cleric:20,peasant:10},resourceDemandMod:{culture:.05}}},{id:"hunting_magic",text:"",description:"",effects:{resourcePercent:{food:.05,culture:.03},approval:{soldier:15,peasant:5},resourceDemandMod:{food:.02}}}]},{id:"wolf_domestication",name:"",icon:"Dog",description:"",triggerConditions:{maxEpoch:0,minPopulation:20},options:[{id:"tame_wolves",text:"",description:"",effects:{resourcePercent:{food:-.05},approval:{soldier:20,peasant:10},resourceDemandMod:{food:.05},buildingProductionMod:{lumber_camp:.1}},randomEffects:[{chance:.5,effects:{resourcePercent:{food:.15}},description:""}]},{id:"drive_away",text:"",description:"",effects:{resourcePercent:{food:.02},stability:5,approval:{peasant:5}}}]},{id:"star_gazer",name:"",icon:"Star",description:"",triggerConditions:{maxEpoch:0},options:[{id:"support_observer",text:"",description:"",effects:{resourcePercent:{science:.05,food:-.01},approval:{cleric:10,peasant:5},resourceDemandMod:{food:.01}}},{id:"mystic_interpretation",text:"",description:"",effects:{resourcePercent:{culture:.05},approval:{cleric:20},resourceDemandMod:{culture:.05}}}]},{id:"first_fermentation",name:"",icon:"Wine",description:"",triggerConditions:{maxEpoch:0},options:[{id:"celebrate_discovery",text:"",description:"",effects:{stability:10,approval:{peasant:20,soldier:15},resourceDemandMod:{food:.1}},randomEffects:[{chance:.3,effects:{stability:-5,resourcePercent:{food:-.05}},description:""}]},{id:"control_usage",text:"",description:"",effects:{resourcePercent:{culture:.02},stability:5,approval:{cleric:10}}}]},{id:"obsidian_trade",name:"",icon:"Gem",description:"",triggerConditions:{maxEpoch:0},options:[{id:"establish_trade",text:"",description:"",effects:{resourcePercent:{food:-.05,science:.02},approval:{artisan:20,soldier:10},buildingProductionMod:{stone_tool_workshop:.2}}},{id:"raiding_party",text:"",description:"",effects:{resourcePercent:{food:.05},stability:-5,approval:{soldier:20,peasant:-10},nationRelation:{all:-10}}}]},{id:"burial_rites",name:"",icon:"Moon",description:"",triggerConditions:{maxEpoch:0},options:[{id:"elaborate_burial",text:"",description:"",effects:{resourcePercent:{culture:.08,food:-.02,tools:-.01},stability:15,approval:{cleric:25,peasant:10}}},{id:"simple_burial",text:"",description:"",effects:{resourcePercent:{food:.01},approval:{cleric:-15,peasant:-5}}}]},{id:"code_of_law",name:"",icon:"Scale",description:'""',triggerConditions:{minEpoch:1,maxEpoch:2},options:[{id:"enact_code",text:"",description:"",effects:{resourcePercent:{culture:.05,silver:-.02},stability:25,approval:{peasant:20,merchant:15,landowner:-10},resourceDemandMod:{stone:.05}}},{id:"noble_justice",text:"",description:"",effects:{stability:-5,approval:{landowner:25,peasant:-20,merchant:-10}}}]},{id:"flood_myth",name:"",icon:"Droplet",description:"",triggerConditions:{minEpoch:1,maxEpoch:2},options:[{id:"unite_people",text:"",description:"",effects:{populationPercent:.02,stability:10,approval:{peasant:15,worker:10},buildingProductionMod:{farm:.05}}},{id:"worship_gods",text:"",description:"",effects:{resourcePercent:{culture:.08,food:-.03},approval:{cleric:25,peasant:5},resourceDemandMod:{culture:.1}}}]},{id:"standardized_weights",name:"",icon:"BarChart",description:"",triggerConditions:{minEpoch:1,maxEpoch:2},options:[{id:"standardize",text:"",description:"",effects:{resourcePercent:{silver:.05,science:.02},stability:10,approval:{merchant:25,artisan:10,peasant:10},buildingProductionMod:{market:.15}}},{id:"laissez_faire_weights",text:"",description:"",effects:{resourcePercent:{silver:-.02},approval:{merchant:-10}}}]},{id:"oracle_bones",name:"",icon:"Bone",description:"",triggerConditions:{minEpoch:1,maxEpoch:2},options:[{id:"record_history",text:"",description:"",effects:{resourcePercent:{culture:.1,science:.03},approval:{scribe:25,cleric:20},resourceDemandMod:{culture:.05}}},{id:"pure_divination",text:"",description:"",effects:{resourcePercent:{culture:.05},approval:{cleric:15}}}]},{id:"bronze_collapse_fear",name:"",icon:"Anchor",description:"",triggerConditions:{minEpoch:1,maxEpoch:2},options:[{id:"fortify_coast",text:"",description:"",effects:{resourcePercent:{stone:-.05,silver:-.03},stability:5,approval:{soldier:20,merchant:10},nationAggression:{all:-.1}}},{id:"absorb_refugees",text:"",description:"",effects:{populationPercent:.05,resourcePercent:{food:-.05},stability:-5,approval:{artisan:15,peasant:-10},buildingProductionMod:{industry:.05}}}]},{id:"chariot_warfare",name:"",icon:"Swords",description:"",triggerConditions:{minEpoch:1,maxEpoch:2},options:[{id:"invest_chariots",text:"",description:"",effects:{resourcePercent:{silver:-.04,wood:-.03},approval:{soldier:25,landowner:20},militaryBonus:.15}},{id:"counter_tactics",text:"",description:"",effects:{resourcePercent:{science:.03},approval:{soldier:10},militaryBonus:.05}}]},{id:"great_library",name:"",icon:"BookOpen",description:"",triggerConditions:{minEpoch:2,maxEpoch:3},options:[{id:"build_library",text:"",description:"",effects:{resourcePercent:{science:.1,culture:.08,silver:-.05},approval:{scribe:40,merchant:10},resourceDemandMod:{papyrus:.2}}},{id:"small_archive",text:"",description:"",effects:{resourcePercent:{culture:.03},approval:{scribe:15,official:10}}}]},{id:"silk_road_opening",name:"",icon:"Map",description:"",triggerConditions:{minEpoch:2},options:[{id:"open_trade_route",text:"",description:"",effects:{resourcePercent:{silver:.08,culture:.05},approval:{merchant:40,soldier:10},resourceDemandMod:{spice:.1,cloth:.1},nationRelation:{all:10}}},{id:"close_borders",text:"",description:"",effects:{stability:5,approval:{soldier:15,merchant:-20},resourcePercent:{silver:-.02}}}]},{id:"roman_roads",name:"",icon:"Move",description:"",triggerConditions:{minEpoch:2},options:[{id:"massive_infrastructure",text:"",description:"",effects:{resourcePercent:{stone:-.1,silver:-.05},stability:15,approval:{merchant:25,soldier:20,peasant:10},buildingProductionMod:{all:.1}}},{id:"local_roads",text:"",description:"",effects:{resourcePercent:{stone:-.02},approval:{merchant:5},buildingProductionMod:{all:.02}}}]},{id:"academy_founding",name:"",icon:"Book",description:"",triggerConditions:{minEpoch:2,maxEpoch:3},options:[{id:"state_academy",text:"",description:"",effects:{resourcePercent:{science:.06,culture:.04},approval:{scribe:30,official:20},resourceDemandMod:{papyrus:.05}}},{id:"free_lectures",text:"",description:"",effects:{resourcePercent:{culture:.08,science:.02},stability:-5,approval:{scribe:25,peasant:10}}}]},{id:"census_taking",name:"",icon:"Clipboard",description:"",triggerConditions:{minEpoch:2},options:[{id:"thorough_census",text:"",description:"",effects:{resourcePercent:{silver:.1},stability:-10,approval:{official:20,peasant:-15,landowner:-15},resourceDemandMod:{papyrus:.1}}},{id:"loose_census",text:"",description:"",effects:{resourcePercent:{silver:.02},approval:{official:5,peasant:5}}}]},{id:"aqueduct_project",name:"",icon:"Droplet",description:"",triggerConditions:{minEpoch:2,minPopulation:300},options:[{id:"build_aqueduct",text:"",description:"",effects:{resourcePercent:{stone:-.08,silver:-.04},populationPercent:.05,stability:15,approval:{peasant:25,worker:20,artisan:15}}},{id:"dig_wells",text:"",description:"",effects:{resourcePercent:{stone:-.01},approval:{peasant:5}}}]},{id:"magna_carta_demand",name:"",icon:"Scroll",description:"",triggerConditions:{minEpoch:3,maxEpoch:4},options:[{id:"sign_charter",text:"",description:"",effects:{stability:20,approval:{landowner:35,merchant:15,peasant:5},resourcePercent:{silver:-.05},stratumDemandMod:{landowner:.1}}},{id:"reject_charter",text:"",description:"",effects:{stability:-25,approval:{landowner:-40,soldier:-10}},randomEffects:[{chance:.6,effects:{stability:-30,resourcePercent:{silver:-.1}},description:""}]}]},{id:"knightly_tournament",name:"",icon:"Shield",description:"",triggerConditions:{minEpoch:3,maxEpoch:4},options:[{id:"host_grand_tournament",text:"",description:"",effects:{resourcePercent:{silver:-.05,culture:.05},stability:10,approval:{soldier:25,landowner:20,peasant:15},militaryBonus:.05}},{id:"cancel_tournament",text:"",description:"",effects:{resourcePercent:{silver:.02},approval:{soldier:-10,landowner:-10,peasant:-5}}}]},{id:"university_founding",name:"",icon:"Book",description:"",triggerConditions:{minEpoch:3,maxEpoch:4},options:[{id:"grant_charter",text:"",description:"",effects:{resourcePercent:{science:.08,culture:.05},approval:{scribe:35,merchant:10,cleric:-10},resourceDemandMod:{papyrus:.1}}},{id:"church_control",text:"",description:"",effects:{resourcePercent:{culture:.05},approval:{cleric:20,scribe:-10}}}]},{id:"alchemist_discovery",name:"",icon:"FlaskConical",description:"",triggerConditions:{minEpoch:3,maxEpoch:4},options:[{id:"weaponize",text:"",description:"",effects:{resourcePercent:{science:.05,silver:-.05},militaryBonus:.1,approval:{soldier:20}},randomEffects:[{chance:.3,effects:{resourcePercent:{science:-.02,stone:-.05}},description:""}]},{id:"ignore_magic",text:"",description:"",effects:{resourcePercent:{science:-.01},approval:{cleric:10}}}]},{id:"hanseatic_league",name:"",icon:"Ship",description:"",triggerConditions:{minEpoch:3,maxEpoch:4},options:[{id:"cooperate_league",text:"",description:"",effects:{resourcePercent:{silver:.1,food:.05},approval:{merchant:35,artisan:15},nationRelation:{all:15},resourceDemandMod:{cloth:.1,spice:.1}}},{id:"compete_league",text:"",description:"",effects:{resourcePercent:{silver:.02},stability:-5,approval:{merchant:10,landowner:10}}}]},{id:"chivalric_romance",name:"",icon:"Feather",description:"",triggerConditions:{minEpoch:3,maxEpoch:4},options:[{id:"sponsor_poets",text:"",description:"",effects:{resourcePercent:{culture:.08,silver:-.02},approval:{landowner:20,soldier:10,scribe:15}}},{id:"ban_frivolous",text:"",description:"",effects:{resourcePercent:{culture:-.02},approval:{soldier:10,cleric:10,landowner:-15}}}]},{id:"potato_introduction",name:"",icon:"Sprout",description:'""',triggerConditions:{minEpoch:4},options:[{id:"promote_planting",text:"",description:"",effects:{resourcePercent:{food:.2},populationPercent:.05,stability:15,approval:{peasant:30,landowner:10},buildingProductionMod:{farm:.15}}},{id:"cautious_testing",text:"",description:"",effects:{resourcePercent:{food:.05},approval:{science:10}}}]},{id:"heliocentrism",name:"",icon:"Sun",description:"",triggerConditions:{minEpoch:4},options:[{id:"support_science",text:"",description:"",effects:{resourcePercent:{science:.15},stability:-15,approval:{scribe:40,science:30,cleric:-40},resourceDemandMod:{papyrus:.1}}},{id:"condemn_heresy",text:"",description:"",effects:{resourcePercent:{science:-.05},stability:10,approval:{cleric:30,peasant:10,scribe:-25}}}]},{id:"privateer_commission",name:"",icon:"Skull",description:"",triggerConditions:{minEpoch:4},options:[{id:"issue_letters",text:"",description:"",effects:{resourcePercent:{silver:.1,food:.05},nationAggression:{all:.2},nationRelation:{all:-20},approval:{merchant:15,soldier:10},militaryBonus:.05}},{id:"uphold_honor",text:"",description:"",effects:{nationRelation:{all:10},approval:{landowner:5}}}]},{id:"tulip_mania",name:"",icon:"Flower",description:"",triggerConditions:{minEpoch:4},options:[{id:"market_intevention",text:"",description:"",effects:{resourcePercent:{silver:-.1},stability:10,approval:{merchant:-25,peasant:10}}},{id:"join_speculation",text:"",description:"",effects:{resourcePercent:{silver:.15},stability:-10,approval:{merchant:10}},randomEffects:[{chance:.5,effects:{resourcePercent:{silver:-.2},stability:-20},description:""}]}]},{id:"kabuki_plays",name:"",icon:"Image",description:"",triggerConditions:{minEpoch:4},options:[{id:"promote_culture",text:"",description:"",effects:{resourcePercent:{culture:.12,silver:.03},approval:{merchant:25,artisan:30,peasant:15,landowner:-10},resourceDemandMod:{culture:.1}}},{id:"censor_art",text:"",description:"",effects:{resourcePercent:{culture:-.05},stability:5,approval:{landowner:20,cleric:15,merchant:-15}}}]},{id:"tea_trade_boom",name:"",icon:"Coffee",description:"",triggerConditions:{minEpoch:4},options:[{id:"expand_trade",text:"",description:"",effects:{resourcePercent:{silver:-.05,culture:.05},approval:{merchant:30,landowner:15,peasant:10},resourceDemandMod:{food:.05}}},{id:"grow_locally",text:"",description:"",effects:{resourcePercent:{science:.02,silver:.02},approval:{merchant:15,landowner:10},buildingProductionMod:{farm:.05}}}]},{id:"hot_air_balloon",name:"",icon:"Wind",description:"",triggerConditions:{minEpoch:5},options:[{id:"fund_aeronautics",text:"",description:"",effects:{resourcePercent:{science:.1,silver:-.05},approval:{science:30,merchant:10},nationRelation:{all:10}}},{id:"military_scout",text:"",description:"",effects:{militaryBonus:.1,approval:{soldier:20},resourcePercent:{silver:-.03}}}]},{id:"mozart_concert",name:"",icon:"Music",description:"",triggerConditions:{minEpoch:5},options:[{id:"royal_patronage",text:"",description:"",effects:{resourcePercent:{culture:.15,silver:-.05},stability:10,approval:{landowner:25,merchant:20}}},{id:"public_concert",text:"",description:"",effects:{resourcePercent:{culture:.1,silver:.02},approval:{merchant:15,artisan:20,peasant:15},stability:5}}]},{id:"lightning_rod",name:"",icon:"Zap",description:"",triggerConditions:{minEpoch:5},options:[{id:"install_rods",text:"",description:"",effects:{resourcePercent:{science:.05,copper:-.02},stability:5,approval:{science:25,peasant:10},buildingProductionMod:{industry:.05}}},{id:"study_electricity",text:"",description:"",effects:{resourcePercent:{science:.15},approval:{science:30},resourceDemandMod:{copper:.05}}}]},{id:"taxation_representation",name:"",icon:"Flag",description:'""',triggerConditions:{minEpoch:5},options:[{id:"grant_representation",text:"",description:"",effects:{stability:20,stability:20,approval:{merchant:40,merchant:20,landowner:-10},resourcePercent:{silver:.05},nationRelation:{all:30}}},{id:"suppress_protest",text:"",description:"",effects:{stability:-20,approval:{soldier:10,landowner:15,merchant:-50},nationRelation:{all:-40}}}]},{id:"agricultural_revolution",name:"",icon:"Wheat",description:"",triggerConditions:{minEpoch:5},options:[{id:"promote_new_methods",text:"",description:"",effects:{resourcePercent:{food:.25},populationPercent:.1,approval:{landowner:30,science:20},buildingProductionMod:{farm:.2}}},{id:"enclosure_movement",text:"",description:"",effects:{resourcePercent:{food:.3,silver:.1},stability:-25,approval:{landowner:40,peasant:-40},populationPercent:.05}}]},{id:"romanticism_movement",name:"",icon:"Heart",description:"",triggerConditions:{minEpoch:5},options:[{id:"embrace_romanticism",text:"",description:"",effects:{resourcePercent:{culture:.2},stability:-10,approval:{artisan:40,peasant:30,official:-10}}},{id:"uphold_rationalism",text:"",description:"",effects:{resourcePercent:{science:.1},stability:10,stability:10,approval:{official:20,science:15,artisan:-20}}}]},{id:"steam_engine_revolution",name:"",icon:"Settings",description:"",triggerConditions:{minEpoch:6},options:[{id:"industrialize_rapidly",text:"",description:"",effects:{buildingProductionMod:{industry:.3},resourcePercent:{coal:-.2},approval:{capitalist:40,science:20},buildingProductionMod:{factory:.5,mine:.3}}},{id:"regulated_adoption",text:"",description:"",effects:{resourcePercent:{industry:.15,coal:-.1},stability:5,approval:{official:10},buildingProductionMod:{factory:.2}}}]},{id:"telephone_patent",name:"",icon:"Phone",description:'""',triggerConditions:{minEpoch:6},options:[{id:"build_network",text:"",description:"",effects:{resourcePercent:{science:.1,silver:-.05},stability:10,approval:{merchant:30,worker:20},resourceDemandMod:{copper:.2},nationRelation:{all:5}}},{id:"exclusive_use",text:"",description:"",effects:{militaryBonus:.1,stability:15,approval:{official:20,soldier:15}}}]},{id:"impressionist_exhibition",name:"",icon:"Eye",description:'""',triggerConditions:{minEpoch:6},options:[{id:"support_innovators",text:"",description:"",effects:{resourcePercent:{culture:.2},approval:{artisan:50,peasant:25,landowner:-20},nationRelation:{all:20}}},{id:"mock_them",text:"",description:"",effects:{stability:5,stability:5,approval:{landowner:30,artisan:-30}}}]},{id:"world_fair",name:"",icon:"Globe",description:"",triggerConditions:{minEpoch:6},options:[{id:"host_fair",text:"",description:"",effects:{resourcePercent:{silver:-.2,culture:.3},stability:20,approval:{merchant:40,worker:30},nationRelation:{all:30},buildingProductionMod:{market:.2,library:.2}}},{id:"participate_only",text:"",description:"",effects:{resourcePercent:{silver:-.05,culture:.1},nationRelation:{all:10},approval:{merchant:15}}}]},{id:"x_ray_discovery",name:"",icon:"Activity",description:"",triggerConditions:{minEpoch:6},options:[{id:"medical_application",text:"",description:"",effects:{resourcePercent:{science:.15},populationPercent:.05,approval:{science:40,worker:20}}},{id:"pure_research",text:"",description:"",effects:{resourcePercent:{science:.25},approval:{science:50}}}]},{id:"suffrage_march",name:"",icon:"UserCheck",description:"",triggerConditions:{minEpoch:6},options:[{id:"universal_suffrage",text:"",description:"",effects:{stability:10,approval:{worker:50,worker:50,merchant:40,landowner:-30},resourcePercent:{culture:.1}}},{id:"suppress_movement",text:"",description:"",effects:{stability:-30,stability:-30,approval:{landowner:30,worker:-40,merchant:-30},buildingProductionMod:{industry:-.1}},randomEffects:[{chance:.4,effects:{stability:-40},description:""}]}]}],s5=[{id:"trade_boom",name:"",icon:"Coins",description:"",triggerConditions:{minPopulation:60,minEpoch:1,maxEpoch:5},options:[{id:"encourage_trade",text:"",effects:{approval:{merchant:15,capitalist:10},resourceDemandMod:{cloth:.25,spice:.3},buildingProductionMod:{industry:.1}}},{id:"regulate_trade",text:"",effects:{resourcePercent:{silver:.05},approval:{merchant:-10,official:5},resourceDemandMod:{cloth:-.1}}},{id:"monopolize",text:"",effects:{resourcePercent:{silver:.08},approval:{merchant:-20,capitalist:-15},buildingProductionMod:{industry:-.15},stability:-5}}]},{id:"silk_road_revival",name:"",icon:"Compass",description:"",triggerConditions:{minPopulation:120,minEpoch:2,maxEpoch:4},options:[{id:"embrace_trade",text:"",effects:{approval:{merchant:20,capitalist:15},resourceDemandMod:{cloth:.4,spice:.5},buildingProductionMod:{loom_house:.2,dye_works:.15},stability:3}},{id:"cautious_opening",text:"",effects:{approval:{artisan:10,merchant:-5},resourceDemandMod:{cloth:.15},buildingProductionMod:{industry:.05}}},{id:"close_borders",text:"",effects:{approval:{merchant:-25,peasant:5},resourceDemandMod:{spice:-.3,cloth:-.2},stability:-3}}]},{id:"harvest_festival",name:"",icon:"Wheat",description:"",triggerConditions:{minPopulation:50},options:[{id:"celebrate",text:"",effects:{resourcePercent:{silver:-.02},approval:{peasant:15,serf:10},buildingProductionMod:{farm:.15,gather:.1},stability:5}},{id:"store_grain",text:"",effects:{resourcePercent:{food:.08},approval:{peasant:-5},resourceDemandMod:{food:-.1}}},{id:"sell_surplus",text:"",effects:{resourcePercent:{food:-.05,silver:.08},approval:{merchant:10}}}]},{id:"locust_plague",name:"",icon:"AlertTriangle",description:"",triggerConditions:{minPopulation:80},options:[{id:"organize_extermination",text:"",effects:{resourcePercent:{silver:-.03},buildingProductionMod:{farm:-.2,gather:-.15},approval:{peasant:5},stability:-3}},{id:"pray_to_gods",text:"",effects:{resourcePercent:{silver:-.02},buildingProductionMod:{farm:-.3},approval:{cleric:10,peasant:-5},stability:-5}},{id:"import_grain",text:"",effects:{resourcePercent:{silver:-.08},resourceDemandMod:{food:.3},approval:{peasant:10},buildingProductionMod:{farm:-.25}}}]},{id:"new_technology",name:"",icon:"Lightbulb",description:"",triggerConditions:{minPopulation:80,minEpoch:2,maxEpoch:5},options:[{id:"promote_innovation",text:"",effects:{resourcePercent:{silver:-.03,science:.08},approval:{artisan:15,engineer:20},buildingProductionMod:{industry:.2,all:.05}}},{id:"control_technology",text:"",effects:{resourcePercent:{science:.05},approval:{official:10,artisan:-10},buildingProductionMod:{industry:.1}}},{id:"suppress_innovation",text:"",effects:{approval:{artisan:-15,cleric:10},buildingProductionMod:{industry:-.1},stability:-5}}]},{id:"mining_discovery",name:"",icon:"Gem",description:"",triggerConditions:{minPopulation:70,minEpoch:1,maxEpoch:5},options:[{id:"state_mining",text:"",effects:{resourcePercent:{silver:.05},buildingProductionMod:{mine:.25,quarry:.15},approval:{miner:-10,official:10}}},{id:"private_mining",text:"",effects:{buildingProductionMod:{mine:.35,quarry:.2},approval:{miner:15,capitalist:10},resourceDemandMod:{iron:.2,stone:.15}}},{id:"careful_extraction",text:"",effects:{buildingProductionMod:{mine:.1},approval:{peasant:10,miner:-10},stability:3}}]},{id:"luxury_craze",name:"",icon:"Sparkles",description:"",triggerConditions:{minPopulation:100,minEpoch:2,maxEpoch:5},options:[{id:"encourage_luxury",text:"",effects:{approval:{landowner:15,merchant:10,artisan:10},stratumDemandMod:{landowner:.3,merchant:.2},resourceDemandMod:{cloth:.2,spice:.25},buildingProductionMod:{loom_house:.15,dye_works:.1}}},{id:"tax_luxury",text:"",effects:{resourcePercent:{silver:.05},approval:{landowner:-15,peasant:5},stratumDemandMod:{landowner:-.15}}},{id:"ban_luxury",text:"",effects:{approval:{landowner:-25,cleric:15},stratumDemandMod:{landowner:-.3,merchant:-.2},resourceDemandMod:{cloth:-.15,spice:-.2},stability:-5}}]},{id:"tea_coffee_introduction",name:"",icon:"Coffee",description:"/",triggerConditions:{minPopulation:100,minEpoch:3,maxEpoch:6},options:[{id:"promote_drink",text:"",effects:{approval:{merchant:15,landowner:10},resourceDemandMod:{coffee:.4},stratumDemandMod:{landowner:.1,merchant:.15},buildingProductionMod:{industry:.05}}},{id:"monopolize_trade",text:"",effects:{resourcePercent:{silver:.06},approval:{merchant:-15},resourceDemandMod:{coffee:.2}}},{id:"restrict_import",text:"",effects:{approval:{peasant:5,merchant:-10},resourceDemandMod:{coffee:-.1}}}]},{id:"currency_crisis",name:"",icon:"AlertTriangle",description:"",triggerConditions:{minPopulation:80,minEpoch:2,maxEpoch:5},options:[{id:"mint_new_coins",text:"",effects:{resourcePercent:{silver:-.08},approval:{merchant:15,peasant:10},resourceDemandMod:{iron:.2,copper:.3},stability:5}},{id:"price_control",text:"",effects:{approval:{merchant:-20,peasant:10},buildingProductionMod:{industry:-.1},stability:-3}},{id:"do_nothing",text:"",effects:{approval:{merchant:5,peasant:-15},stratumDemandMod:{peasant:-.2,serf:-.2},stability:-8}}]},{id:"banking_emergence",name:"",icon:"Landmark",description:"",triggerConditions:{minPopulation:150,minEpoch:3,maxEpoch:5},options:[{id:"support_banking",text:"",effects:{approval:{merchant:20,capitalist:25,cleric:-10},buildingProductionMod:{industry:.15},stratumDemandMod:{merchant:.1,capitalist:.15},stability:3}},{id:"regulate_banking",text:"",effects:{approval:{merchant:-5,official:10},buildingProductionMod:{industry:.05}}},{id:"ban_usury",text:"",effects:{approval:{cleric:15,merchant:-20,capitalist:-25},buildingProductionMod:{industry:-.1},stability:-5}}]},{id:"labor_shortage",name:"",icon:"Users",description:"",triggerConditions:{minPopulation:100},options:[{id:"increase_wages",text:"",effects:{resourcePercent:{silver:-.05},approval:{peasant:15,worker:15,artisan:10},buildingProductionMod:{all:-.1},stratumDemandMod:{peasant:.1,worker:.1}}},{id:"forced_labor",text:"",effects:{approval:{peasant:-20,serf:-25},buildingProductionMod:{gather:.1,industry:.05},stability:-10}},{id:"import_labor",text:"",effects:{populationPercent:.05,approval:{peasant:-10},buildingProductionMod:{all:.05}}}]},{id:"guild_conflict",name:"",icon:"Handshake",description:"",triggerConditions:{minPopulation:100,minEpoch:2,maxEpoch:4},options:[{id:"mediate",text:"",effects:{resourcePercent:{silver:-.02},approval:{artisan:5,merchant:5,official:5},buildingProductionMod:{industry:.05},stability:3}},{id:"support_guilds",text:"",effects:{approval:{artisan:15,merchant:-10},buildingProductionMod:{industry:.1},resourceDemandMod:{tools:.15}}},{id:"abolish_guilds",text:"",effects:{approval:{artisan:-20,merchant:15,capitalist:20},buildingProductionMod:{industry:-.05},stability:-5}}]},{id:"forest_depletion",name:"",icon:"Trees",description:"",triggerConditions:{minPopulation:100,minEpoch:2,maxEpoch:5},options:[{id:"plant_trees",text:"",effects:{resourcePercent:{silver:-.03},buildingProductionMod:{lumber_camp:-.3},resourceDemandMod:{wood:-.2},approval:{peasant:5},stability:5},randomEffects:[{chance:.5,effects:{buildingProductionMod:{lumber_camp:.2}}}]},{id:"import_wood",text:"",effects:{resourcePercent:{silver:-.05},resourceDemandMod:{wood:.3},approval:{merchant:10}}},{id:"find_alternatives",text:"",effects:{resourcePercent:{science:.05},resourceDemandMod:{wood:-.15,stone:.2,brick:.25},buildingProductionMod:{quarry:.15,brickworks:.2}}}]},{id:"salt_shortage",name:"",icon:"Droplets",description:"",triggerConditions:{minPopulation:100},options:[{id:"government_distribution",text:"",effects:{resourcePercent:{silver:-.04},approval:{peasant:15,serf:10},stratumDemandMod:{peasant:-.1,serf:-.1},stability:5}},{id:"increase_production",text:"",effects:{resourcePercent:{silver:-.03},buildingProductionMod:{gather:.1},approval:{worker:5}}},{id:"crack_down_hoarding",text:"",effects:{approval:{merchant:-15,peasant:10},stability:-3}}]},{id:"foreign_embargo",name:"",icon:"Globe",description:"",triggerConditions:{minPopulation:100,minEpoch:2,maxEpoch:5},options:[{id:"develop_domestic",text:"",effects:{resourcePercent:{silver:-.05},buildingProductionMod:{industry:.2},resourceDemandMod:{spice:-.3,cloth:-.2},approval:{artisan:15,capitalist:10},stability:-3,nationRelation:{hostile:-10}}},{id:"smuggling",text:"",effects:{approval:{merchant:10,official:-10},resourceDemandMod:{spice:.1},stability:-5,nationRelation:{hostile:-15}}},{id:"negotiate",text:"",effects:{resourcePercent:{silver:-.03},approval:{official:5},nationRelation:{hostile:5}},randomEffects:[{chance:.4,effects:{resourceDemandMod:{spice:.2,cloth:.15},stability:5,nationRelation:{hostile:20}},description:""}]}]},{id:"trade_route_discovery",name:"",icon:"Ship",description:"",triggerConditions:{minPopulation:250,minEpoch:4,maxEpoch:5},options:[{id:"fund_expedition",text:"",effects:{resourcePercent:{silver:-.08},approval:{navigator:25,merchant:15},resourceDemandMod:{spice:.5,cloth:.3},buildingProductionMod:{dockyard:.3}},randomEffects:[{chance:.3,effects:{resourcePercent:{silver:.08},approval:{merchant:10}}}]},{id:"cautious_expansion",text:"",effects:{resourcePercent:{silver:-.03},approval:{navigator:10},resourceDemandMod:{spice:.2}}},{id:"isolationism",text:"",effects:{approval:{navigator:-20,merchant:-15,peasant:10},stability:3}}]},{id:"bubble_economy",name:"",icon:"TrendingUp",description:"",triggerConditions:{minPopulation:130,minEpoch:3,maxEpoch:6},options:[{id:"join_speculation",text:"",effects:{resourcePercent:{silver:-.05}},randomEffects:[{chance:.4,effects:{resourcePercent:{silver:.08},approval:{merchant:10}}},{chance:.6,effects:{resourcePercent:{silver:-.08},stability:-10,approval:{merchant:-15,peasant:-10}}}]},{id:"ban_speculation",text:"",effects:{approval:{merchant:-20,capitalist:-15},stability:5}},{id:"warn_people",text:"",effects:{approval:{official:5}},randomEffects:[{chance:.5,effects:{stability:-5,approval:{peasant:-10}}}]}]},{id:"counterfeiting_ring",name:"",icon:"Shield",description:"",triggerConditions:{minPopulation:80,minEpoch:2,maxEpoch:5},options:[{id:"harsh_punishment",text:"",effects:{approval:{official:10,merchant:10},stability:5}},{id:"currency_reform",text:"",effects:{resourcePercent:{silver:-.08},approval:{merchant:15},resourceDemandMod:{copper:.3,iron:.2},stability:3}},{id:"cover_up",text:"",effects:{approval:{official:-10},stability:-8},randomEffects:[{chance:.5,effects:{approval:{peasant:-15,merchant:-15},stability:-10}}]}]},{id:"tulip_mania",name:"",icon:"Flower",description:"",triggerConditions:{minPopulation:120,minEpoch:4,maxEpoch:5},options:[{id:"join_speculation",text:"",effects:{resourcePercent:{silver:-.06}},randomEffects:[{chance:.3,effects:{resourcePercent:{silver:.12},approval:{merchant:15,landowner:10}},description:""},{chance:.5,effects:{resourcePercent:{silver:-.1},stability:-15,approval:{merchant:-20,peasant:-10}},description:""}]},{id:"ban_trading",text:"",effects:{approval:{merchant:-25,landowner:-15},stability:5}},{id:"tax_transactions",text:"",effects:{resourcePercent:{silver:.04},approval:{merchant:-15}}}]},{id:"south_sea_bubble",name:"",icon:"Ship",description:'""',triggerConditions:{minPopulation:150,minEpoch:5,maxEpoch:6},options:[{id:"invest_heavily",text:"",effects:{resourcePercent:{silver:-.08}},randomEffects:[{chance:.25,effects:{resourcePercent:{silver:.15},approval:{capitalist:20}},description:""},{chance:.6,effects:{resourcePercent:{silver:-.12},stability:-20,approval:{capitalist:-25,merchant:-15}},description:""}]},{id:"regulate_market",text:"",effects:{resourcePercent:{silver:-.02},approval:{capitalist:-15,official:10},stability:8}},{id:"let_it_crash",text:"",effects:{},randomEffects:[{chance:.7,effects:{stability:-15,approval:{merchant:-20,capitalist:-20}},description:""}]}]},{id:"merchant_league",name:"",icon:"Handshake",description:"",triggerConditions:{minPopulation:120,minEpoch:3,maxEpoch:5},options:[{id:"grant_privileges",text:"",effects:{resourcePercent:{silver:.06},approval:{merchant:30,capitalist:20,artisan:-15},buildingProductionMod:{dockyard:.25},nationRelation:{all:10}}},{id:"partial_cooperation",text:"",effects:{resourcePercent:{silver:.03},approval:{merchant:10,official:5}}},{id:"reject_league",text:"",effects:{approval:{merchant:-25,official:15,soldier:10},stability:-5}}]},{id:"trading_company",name:"",icon:"Building",description:"/",triggerConditions:{minPopulation:150,minEpoch:4,maxEpoch:6},options:[{id:"charter_company",text:"",effects:{resourcePercent:{silver:.08},approval:{merchant:25,capitalist:30,artisan:-10},resourceDemandMod:{spice:.4,cloth:.3},nationRelation:{random:15}}},{id:"state_monopoly",text:"",effects:{resourcePercent:{silver:.05},approval:{merchant:-20,official:15},buildingProductionMod:{dockyard:.15}}},{id:"free_trade",text:"",effects:{approval:{merchant:15,capitalist:-10},resourceDemandMod:{spice:.2},nationRelation:{all:5}}}]},{id:"great_famine",name:"",icon:"Skull",description:"",triggerConditions:{minPopulation:150,minEpoch:2,maxEpoch:5},options:[{id:"free_distribution",text:"",effects:{resourcePercent:{food:-.1,silver:-.03},populationPercent:-.02,approval:{peasant:25,serf:20,merchant:-15},stability:10}},{id:"import_grain",text:"",effects:{resourcePercent:{silver:-.08},populationPercent:-.015,approval:{merchant:10,peasant:10},nationRelation:{friendly:10},nationWealth:{friendly:200}}},{id:"let_market_handle",text:"",effects:{populationPercent:-.05,stability:-20,approval:{peasant:-30,serf:-25,merchant:10}}}]},{id:"salt_tax_rebellion",name:"",icon:"AlertTriangle",description:"",triggerConditions:{minPopulation:150,minEpoch:2,maxEpoch:5},options:[{id:"lower_tax",text:"",effects:{resourcePercent:{silver:-.04},approval:{peasant:20,merchant:15},stability:10}},{id:"suppress_rebellion",text:"",effects:{resourcePercent:{silver:-.02},populationPercent:-.01,approval:{peasant:-25,soldier:10},stability:-10}},{id:"reform_salt_system",text:"",effects:{resourcePercent:{silver:-.03},approval:{official:10,merchant:5,peasant:10},stability:5}}]},{id:"coin_debasement",name:"",icon:"Coins",description:'""',triggerConditions:{minPopulation:150,minEpoch:2,maxEpoch:5},options:[{id:"debase_secretly",text:"",effects:{resourcePercent:{silver:.06}},randomEffects:[{chance:.6,effects:{stability:-25,approval:{merchant:-30,peasant:-20},resourceDemandMod:{iron:.3,copper:.2}},description:""}]},{id:"open_devaluation",text:"",effects:{resourcePercent:{silver:.04},stability:-10,approval:{merchant:-15,peasant:-10,official:5}}},{id:"find_alternatives",text:"",effects:{approval:{official:10}}}]},{id:"enclosure_movement",name:"",icon:"Fence",description:'""',triggerConditions:{minPopulation:200,minEpoch:4,maxEpoch:6},options:[{id:"allow_enclosure",text:"",effects:{resourceDemandMod:{cloth:.3},buildingProductionMod:{loom_house:.2},approval:{landowner:25,capitalist:15,peasant:-30,serf:-25},stability:-10}},{id:"compensate_peasants",text:"",effects:{resourcePercent:{silver:-.05},resourceDemandMod:{cloth:.2},approval:{landowner:10,peasant:-10},stability:-3}},{id:"protect_commons",text:"",effects:{approval:{peasant:20,serf:15,landowner:-20,capitalist:-15},stability:5}}]},{id:"railroad_mania",name:"",icon:"Train",description:"",triggerConditions:{minPopulation:180,minEpoch:6,maxEpoch:7},options:[{id:"encourage_investment",text:"",effects:{buildingProductionMod:{industry:.25},approval:{capitalist:25,engineer:20,worker:10}},randomEffects:[{chance:.5,effects:{stability:-15,approval:{capitalist:-20},resourcePercent:{silver:-.05}},description:""}]},{id:"state_railways",text:"",effects:{resourcePercent:{silver:-.06},buildingProductionMod:{industry:.15},approval:{official:15,capitalist:-10},stability:5}},{id:"cautious_approach",text:"",effects:{approval:{capitalist:-10,engineer:-5}}}]},{id:"bank_run",name:"",icon:"Landmark",description:"",triggerConditions:{minPopulation:150,minEpoch:4,maxEpoch:6},options:[{id:"bailout",text:"",effects:{resourcePercent:{silver:-.08},approval:{merchant:15,capitalist:20,peasant:-10},stability:10}},{id:"let_it_fail",text:"",effects:{approval:{merchant:-25,capitalist:-30,peasant:5},stability:-15,buildingProductionMod:{industry:-.1}}},{id:"temporary_closure",text:"",effects:{approval:{merchant:-15,official:10},stability:-5,buildingProductionMod:{industry:-.05}}}]},{id:"winter_preparation",name:"",icon:"Snowflake",description:"",triggerConditions:{minPopulation:50},options:[{id:"encourage_stockpiling",text:"",effects:{resourceDemandMod:{food:.25,cloth:.3,wood:.2},stratumDemandMod:{peasant:.15,worker:.12},approval:{peasant:10},stability:3}},{id:"price_control",text:"",effects:{resourceDemandMod:{food:.1,cloth:.15},approval:{merchant:-15,peasant:15},stability:5}},{id:"do_nothing",text:"",effects:{resourceDemandMod:{food:.35,cloth:.4},stratumDemandMod:{landowner:.2,merchant:.15},approval:{peasant:-10},stability:-5}}]},{id:"festival_season",name:"",icon:"Gift",description:"",triggerConditions:{minPopulation:80},options:[{id:"grand_celebration",text:"",effects:{resourcePercent:{silver:-.03},resourceDemandMod:{ale:.4,delicacies:.35,cloth:.25,spice:.3},stratumDemandMod:{landowner:.25,merchant:.2,official:.15},approval:{peasant:15,merchant:20},stability:8}},{id:"modest_celebration",text:"",effects:{resourceDemandMod:{ale:.15,delicacies:.1},stratumDemandMod:{peasant:.1},approval:{peasant:5},stability:3}},{id:"ban_festivities",text:"",effects:{resourceDemandMod:{ale:-.1,delicacies:-.15,spice:-.1},stratumDemandMod:{landowner:-.15,merchant:-.1},approval:{merchant:-20,landowner:-15,cleric:10},stability:-3}}]},{id:"fashion_trend",name:"",icon:"Shirt",description:"",triggerConditions:{minPopulation:100,minEpoch:1},options:[{id:"follow_trend",text:"",effects:{resourceDemandMod:{cloth:.35,fine_clothes:.4},stratumDemandMod:{landowner:.3,official:.25,merchant:.2},approval:{landowner:15,artisan:10},buildingProductionMod:{loom_house:.25,dye_works:.2}}},{id:"promote_local",text:"",effects:{resourceDemandMod:{cloth:.2},approval:{artisan:15,merchant:-5},buildingProductionMod:{loom_house:.3}}},{id:"sumptuary_laws",text:"",effects:{resourceDemandMod:{cloth:-.1,fine_clothes:-.2},stratumDemandMod:{landowner:-.2},approval:{landowner:-20,cleric:10,peasant:5},stability:-5}}]},{id:"construction_boom",name:"",icon:"Building2",description:"",triggerConditions:{minPopulation:120,minEpoch:1},options:[{id:"support_construction",text:"",effects:{resourceDemandMod:{wood:.3,stone:.35,brick:.4,plank:.25},stratumDemandMod:{worker:.2,artisan:.15},approval:{worker:15,capitalist:10},buildingProductionMod:{quarry:.2,lumber_camp:.15,brickworks:.15}}},{id:"regulate_construction",text:"",effects:{resourceDemandMod:{stone:.2,brick:.25},resourcePercent:{silver:-.02},approval:{official:10},stability:5}},{id:"limit_expansion",text:"",effects:{resourceDemandMod:{wood:-.1,stone:-.1},approval:{capitalist:-15,worker:-10},stability:3}}]},{id:"arms_race",name:"",icon:"Sword",description:"",triggerConditions:{minPopulation:100,minEpoch:1},options:[{id:"militarize",text:"",effects:{resourceDemandMod:{tools:.4,iron:.35,food:.2},stratumDemandMod:{soldier:.35,knight:.25},approval:{soldier:25,knight:20,peasant:-10},stability:-5,buildingProductionMod:{military:.2,iron_tool_workshop:.15}}},{id:"moderate_buildup",text:"",effects:{resourceDemandMod:{tools:.2,iron:.15},stratumDemandMod:{soldier:.15},approval:{soldier:10,official:5},buildingProductionMod:{military:.1}}},{id:"diplomatic_solution",text:"",effects:{resourcePercent:{silver:-.02},resourceDemandMod:{tools:-.05},approval:{soldier:-10,cleric:10},stability:5}}]},{id:"academic_boom",name:"",icon:"BookOpen",description:"",triggerConditions:{minPopulation:80,minEpoch:1},options:[{id:"patronize_scholars",text:"",effects:{resourcePercent:{silver:-.03,science:.05},resourceDemandMod:{papyrus:.4,culture:.25},stratumDemandMod:{scribe:.3,cleric:.15},approval:{scribe:25,official:10},buildingProductionMod:{library:.2,university:.15}}},{id:"limited_support",text:"",effects:{resourceDemandMod:{papyrus:.2},stratumDemandMod:{scribe:.15},resourcePercent:{science:.02},approval:{scribe:10}}},{id:"control_knowledge",text:"",effects:{resourceDemandMod:{papyrus:-.1},stratumDemandMod:{scribe:-.15},approval:{scribe:-20,official:15},stability:-3}}]},{id:"brewing_prosperity",name:"",icon:"Wine",description:"",triggerConditions:{minPopulation:60,minEpoch:1},options:[{id:"encourage_brewing",text:"",effects:{resourceDemandMod:{ale:.35,food:.1},stratumDemandMod:{worker:.15,soldier:.2,navigator:.18},approval:{worker:15,soldier:10},buildingProductionMod:{gather:.05,brewery:.25}}},{id:"regulate_alcohol",text:"",effects:{resourceDemandMod:{ale:.15},resourcePercent:{silver:.02},approval:{cleric:10,worker:-5},stability:3}},{id:"prohibit_alcohol",text:"",effects:{resourceDemandMod:{ale:-.2},stratumDemandMod:{worker:-.1},approval:{cleric:20,worker:-20,soldier:-15},stability:-8}}]},{id:"raw_material_shortage",name:"",icon:"Package",description:"",triggerConditions:{minPopulation:80},options:[{id:"import_materials",text:"",effects:{resourcePercent:{silver:-.04},resourceDemandMod:{wood:.1,iron:.1},approval:{artisan:10,merchant:5}}},{id:"ration_materials",text:"",effects:{resourceDemandMod:{wood:-.15,iron:-.15,copper:-.1},buildingProductionMod:{industry:-.1},approval:{artisan:-15,official:10}}},{id:"develop_alternatives",text:"",effects:{resourcePercent:{silver:-.02,science:.03},resourceDemandMod:{stone:.2,brick:.25},approval:{engineer:15},buildingProductionMod:{brickworks:.2}}}]},{id:"noble_extravagance",name:"",icon:"Crown",description:"",triggerConditions:{minPopulation:120,minEpoch:2},options:[{id:"let_them_spend",text:"",effects:{stratumDemandMod:{landowner:.4,official:.3,knight:.25},resourceDemandMod:{delicacies:.35,spice:.3,fine_clothes:.4,furniture:.3,coffee:.25},approval:{landowner:20,artisan:15,peasant:-15},buildingProductionMod:{loom_house:.2,furniture_workshop:.25,delicacies_producer:.15}}},{id:"tax_luxury",text:"",effects:{resourcePercent:{silver:.04},stratumDemandMod:{landowner:-.15},resourceDemandMod:{delicacies:-.1,spice:-.1},approval:{landowner:-20,peasant:10}}},{id:"moral_campaign",text:"",effects:{stratumDemandMod:{landowner:-.25,official:-.2},resourceDemandMod:{delicacies:-.2,spice:-.15},approval:{cleric:20,landowner:-25,peasant:15},stability:-5}}]},{id:"wage_demands",name:"",icon:"HandCoins",description:"",triggerConditions:{minPopulation:100,minEpoch:2},options:[{id:"raise_wages",text:"",effects:{stratumDemandMod:{worker:.25,artisan:.15,miner:.2},resourceDemandMod:{cloth:.15,ale:.2,food:.12},approval:{worker:25,artisan:15,capitalist:-20},buildingProductionMod:{industry:.05}}},{id:"partial_raise",text:"",effects:{stratumDemandMod:{worker:.1},resourceDemandMod:{cloth:.08},approval:{worker:5,capitalist:-10}}},{id:"refuse_demands",text:"",effects:{stratumDemandMod:{worker:-.1},approval:{worker:-25,artisan:-15,capitalist:15},stability:-10,buildingProductionMod:{industry:-.15}}}]},{id:"coffee_craze",name:"",icon:"Coffee",description:"",triggerConditions:{minPopulation:150,minEpoch:4},options:[{id:"embrace_coffee",text:"",effects:{resourceDemandMod:{coffee:.5},stratumDemandMod:{merchant:.2,scribe:.25,official:.15,capitalist:.2},approval:{merchant:15,scribe:20},resourcePercent:{science:.02},buildingProductionMod:{coffee_plantation:.2,coffee_house:.15}}},{id:"regulate_coffeehouses",text:"",effects:{resourceDemandMod:{coffee:.2},stratumDemandMod:{scribe:.1},approval:{official:10,merchant:-10}}},{id:"ban_coffeehouses",text:"",effects:{resourceDemandMod:{coffee:-.2},stratumDemandMod:{merchant:-.1,scribe:-.15},approval:{merchant:-20,scribe:-25,cleric:10},stability:-8}}]},{id:"furniture_fashion",name:"",icon:"Armchair",description:"",triggerConditions:{minPopulation:100,minEpoch:2},options:[{id:"support_craftsmen",text:"",effects:{resourceDemandMod:{furniture:.4,wood:.25,plank:.3},stratumDemandMod:{landowner:.2,official:.15,capitalist:.18},approval:{artisan:20,merchant:10},buildingProductionMod:{furniture_workshop:.3}}},{id:"quality_standards",text:"",effects:{resourceDemandMod:{furniture:.2,wood:.15},approval:{artisan:10,official:10},buildingProductionMod:{furniture_workshop:.15}}},{id:"discourage_waste",text:"",effects:{resourceDemandMod:{furniture:-.1},stratumDemandMod:{landowner:-.1},approval:{cleric:15,landowner:-15}}}]}],Sy=[{id:"border_dispute",name:"",icon:"MapPin",description:"",triggerConditions:{minPopulation:100,minEpoch:1,maxEpoch:5},options:[{id:"negotiate",text:"",effects:{resourcePercent:{silver:-.03},approval:{official:10},nationRelation:{random:10},stability:3}},{id:"military_posturing",text:"",effects:{approval:{soldier:15,peasant:-5},nationRelation:{random:-15},nationAggression:{random:.1},stability:-5}},{id:"concede_territory",text:"",effects:{populationPercent:-.02,approval:{soldier:-20,peasant:5},nationRelation:{random:20},nationAggression:{random:-.1},stability:-3}}]},{id:"diplomatic_incident",name:"",icon:"AlertTriangle",description:"",triggerConditions:{minPopulation:150,minEpoch:2,maxEpoch:5},options:[{id:"demand_apology",text:"",effects:{approval:{official:5},nationRelation:{random:-10}},randomEffects:[{chance:.4,effects:{nationRelation:{random:15},stability:5},description:""},{chance:.3,effects:{nationRelation:{random:-20},nationAggression:{random:.15}},description:""}]},{id:"expel_diplomats",text:"",effects:{approval:{soldier:10,official:-5},nationRelation:{random:-25},nationAggression:{random:.1},stability:-3}},{id:"ignore_incident",text:"",effects:{approval:{soldier:-10,official:-5,peasant:5},nationRelation:{random:5},stability:-5}}]},{id:"spy_discovered",name:"",icon:"Eye",description:"",triggerConditions:{minPopulation:200,minEpoch:2,maxEpoch:6},options:[{id:"public_trial",text:"",effects:{approval:{soldier:15,official:10},nationRelation:{random:-30},nationAggression:{random:.15},stability:5}},{id:"exchange_prisoners",text:"",effects:{approval:{official:5},nationRelation:{random:-5}}},{id:"turn_double_agent",text:"",effects:{resourcePercent:{silver:-.02},approval:{official:15},nationWealth:{random:-200}},randomEffects:[{chance:.3,effects:{nationRelation:{random:-40},triggerWar:"random"},description:""}]}]},{id:"trade_delegation",name:"",icon:"Handshake",description:"",triggerConditions:{minPopulation:150,minEpoch:2,maxEpoch:6},options:[{id:"welcome_trade",text:"",effects:{resourcePercent:{silver:.05},approval:{merchant:20,capitalist:15},nationRelation:{random:25},nationAggression:{random:-.1},stability:3}},{id:"negotiate_terms",text:"",effects:{approval:{merchant:10,official:5},nationRelation:{random:10}},randomEffects:[{chance:.5,effects:{resourcePercent:{silver:.08},nationRelation:{random:5}},description:""},{chance:.3,effects:{nationRelation:{random:-10}},description:""}]},{id:"reject_delegation",text:"",effects:{approval:{merchant:-15,soldier:10},nationRelation:{random:-20},nationAggression:{random:.05}}}]},{id:"trade_war",name:"",icon:"Scale",description:"",triggerConditions:{minPopulation:200,minEpoch:3,maxEpoch:6},options:[{id:"retaliate",text:"",effects:{approval:{merchant:5,official:10},nationRelation:{random:-20},nationWealth:{random:-300},resourceDemandMod:{spice:-.2,cloth:-.15},stability:-3}},{id:"seek_new_markets",text:"",effects:{resourcePercent:{silver:-.03},approval:{merchant:10,navigator:15},nationRelation:{all:5,exclude:["hostile"]}}},{id:"negotiate_end",text:"",effects:{resourcePercent:{silver:-.02},approval:{official:5}},randomEffects:[{chance:.5,effects:{nationRelation:{random:15},resourceDemandMod:{spice:.1}},description:""}]}]},{id:"resource_competition",name:"",icon:"Pickaxe",description:"",triggerConditions:{minPopulation:180,minEpoch:2,maxEpoch:5},options:[{id:"claim_territory",text:"",effects:{buildingProductionMod:{mine:.2},approval:{soldier:15,miner:10},nationRelation:{random:-35},nationAggression:{random:.2}},randomEffects:[{chance:.3,effects:{triggerWar:"random"},description:""}]},{id:"joint_development",text:"",effects:{buildingProductionMod:{mine:.1},approval:{official:10},nationRelation:{random:15},nationWealth:{random:200},stability:5}},{id:"abandon_claim",text:"",effects:{approval:{miner:-15,soldier:-10,peasant:5},nationRelation:{random:25},nationAggression:{random:-.15}}}]},{id:"military_alliance_offer",name:"",icon:"Shield",description:"",triggerConditions:{minPopulation:200,minEpoch:2,maxEpoch:5},options:[{id:"accept_alliance",text:"",effects:{approval:{soldier:20,official:10},nationRelation:{random:40},nationAggression:{random:-.2},stability:5}},{id:"conditional_alliance",text:"",effects:{resourcePercent:{silver:.03},approval:{official:15},nationRelation:{random:20}}},{id:"decline_politely",text:"",effects:{approval:{merchant:5},nationRelation:{random:-10}}}]},{id:"arms_race",name:"",icon:"Swords",description:"",triggerConditions:{minPopulation:200,minEpoch:2,maxEpoch:6},options:[{id:"expand_military",text:"",effects:{resourcePercent:{silver:-.08},approval:{soldier:25,worker:10},nationAggression:{random:.1},stability:-3}},{id:"diplomatic_solution",text:"",effects:{resourcePercent:{silver:-.03},approval:{official:10,merchant:10},nationRelation:{random:15},nationAggression:{random:-.1}}},{id:"seek_allies",text:"",effects:{resourcePercent:{silver:-.02},nationRelation:{all:5}},randomEffects:[{chance:.4,effects:{nationAggression:{random:-.15},stability:5},description:""}]}]},{id:"war_threat",name:"",icon:"Flame",description:"",triggerConditions:{minPopulation:150,minEpoch:2,maxEpoch:5},options:[{id:"refuse_and_prepare",text:"",effects:{approval:{soldier:30,peasant:10},nationRelation:{hostile:-20},stability:-5},randomEffects:[{chance:.6,effects:{triggerWar:"hostile"},description:""},{chance:.4,effects:{nationAggression:{hostile:-.1},stability:10},description:""}]},{id:"pay_tribute",text:"",effects:{resourcePercent:{silver:-.1},approval:{soldier:-25,peasant:-10},nationRelation:{hostile:10},nationAggression:{hostile:.1},stability:-10}},{id:"stall_for_time",text:"",effects:{approval:{official:10}},randomEffects:[{chance:.5,effects:{triggerWar:"hostile"},description:""},{chance:.3,effects:{nationRelation:{hostile:5}},description:""}]}]},{id:"cultural_exchange",name:"",icon:"BookOpen",description:"",triggerConditions:{minPopulation:150,minEpoch:2,maxEpoch:6},options:[{id:"welcome_exchange",text:"",effects:{resourcePercent:{silver:-.02,culture:.08},approval:{scribe:20,cleric:10},nationRelation:{random:20},stability:5}},{id:"limited_exchange",text:"",effects:{resourcePercent:{culture:.03},approval:{scribe:10},nationRelation:{random:10}}},{id:"reject_exchange",text:"",effects:{approval:{cleric:15,scribe:-10},nationRelation:{random:-10}}}]},{id:"religious_mission",name:"",icon:"Church",description:"",triggerConditions:{minPopulation:150,minEpoch:2,maxEpoch:5},options:[{id:"allow_mission",text:"",effects:{approval:{cleric:-20,peasant:-5},nationRelation:{random:25},nationAggression:{random:-.1},stability:-5}},{id:"restrict_mission",text:"",effects:{approval:{cleric:10},nationRelation:{random:-5}}},{id:"expel_missionaries",text:"",effects:{approval:{cleric:20,peasant:5},nationRelation:{random:-25},nationAggression:{random:.1}}}]},{id:"refugee_crisis",name:"",icon:"Users",description:"",triggerConditions:{minPopulation:150,minEpoch:1,maxEpoch:6},options:[{id:"accept_refugees",text:"",effects:{populationPercent:.05,resourcePercent:{food:-.05},approval:{cleric:15,peasant:-10},nationRelation:{random:20},nationWealth:{random:-200},stability:-5}},{id:"selective_admission",text:"",effects:{populationPercent:.02,approval:{artisan:10,scribe:10,peasant:-5},nationRelation:{random:5}}},{id:"close_borders",text:"",effects:{approval:{peasant:10,soldier:5,cleric:-10},nationRelation:{random:-15}}}]},{id:"plague_spread",name:"",icon:"Skull",description:"",triggerConditions:{minPopulation:150,minEpoch:1,maxEpoch:5},options:[{id:"quarantine_border",text:"",effects:{resourcePercent:{silver:-.03},approval:{merchant:-15,peasant:10},nationRelation:{all:-10},resourceDemandMod:{spice:-.3,cloth:-.2},stability:3}},{id:"send_aid",text:"",effects:{resourcePercent:{silver:-.05},approval:{cleric:15},nationRelation:{random:30},nationAggression:{random:-.15}},randomEffects:[{chance:.3,effects:{populationPercent:-.03,stability:-5},description:""}]},{id:"do_nothing",text:"",effects:{},randomEffects:[{chance:.4,effects:{populationPercent:-.05,stability:-10},description:""}]}]},{id:"natural_disaster_aid",name:"",icon:"CloudLightning",description:"",triggerConditions:{minPopulation:150,minEpoch:1,maxEpoch:6},options:[{id:"generous_aid",text:"",effects:{resourcePercent:{food:-.05,silver:-.03},approval:{cleric:15,official:10},nationRelation:{random:35},nationAggression:{random:-.2},nationWealth:{random:300}}},{id:"modest_aid",text:"",effects:{resourcePercent:{food:-.02},approval:{cleric:5},nationRelation:{random:15},nationWealth:{random:100}}},{id:"exploit_weakness",text:"",effects:{approval:{soldier:10,cleric:-15},nationRelation:{random:-25},nationAggression:{random:.2},nationWealth:{random:-400}},randomEffects:[{chance:.2,effects:{triggerWar:"random"},description:""}]}]},{id:"royal_marriage",name:"",icon:"Heart",description:"",triggerConditions:{minPopulation:200,minEpoch:2,maxEpoch:5},options:[{id:"accept_marriage",text:"",effects:{resourcePercent:{silver:-.05},approval:{landowner:15,official:10},nationRelation:{random:40},nationAggression:{random:-.25},stability:5}},{id:"negotiate_dowry",text:"",effects:{approval:{official:5}},randomEffects:[{chance:.5,effects:{resourcePercent:{silver:.08},nationRelation:{random:25}},description:""},{chance:.3,effects:{nationRelation:{random:-15}},description:""}]},{id:"decline_marriage",text:"",effects:{nationRelation:{random:-10}}}]},{id:"succession_crisis",name:"",icon:"Crown",description:"",triggerConditions:{minPopulation:200,minEpoch:2,maxEpoch:5},options:[{id:"support_pretender",text:"",effects:{resourcePercent:{silver:-.05},approval:{soldier:10,official:10}},randomEffects:[{chance:.5,effects:{nationRelation:{random:40},nationAggression:{random:-.2}},description:""},{chance:.3,effects:{nationRelation:{random:-30},nationAggression:{random:.2}},description:""}]},{id:"stay_neutral",text:"",effects:{approval:{merchant:5},nationWealth:{random:-300}}},{id:"seize_opportunity",text:"",effects:{populationPercent:.03,approval:{soldier:20},nationRelation:{random:-40},nationAggression:{random:.3},stability:-5},randomEffects:[{chance:.4,effects:{triggerWar:"random"},description:""}]}]},{id:"intelligence_opportunity",name:"",icon:"Search",description:"",triggerConditions:{minPopulation:200,minEpoch:3,maxEpoch:6},options:[{id:"buy_intelligence",text:"",effects:{resourcePercent:{silver:-.04},nationWealth:{random:-150},nationMarketVolatility:{random:.1}},randomEffects:[{chance:.3,effects:{nationRelation:{random:-30}},description:""}]},{id:"plant_agent",text:"",effects:{resourcePercent:{silver:-.06},approval:{official:10}},randomEffects:[{chance:.4,effects:{nationAggression:{random:-.1}},description:""},{chance:.2,effects:{nationRelation:{random:-40},triggerWar:"random"},description:""}]},{id:"ignore_opportunity",text:"",effects:{approval:{cleric:5},stability:2}}]},{id:"sabotage_discovered",name:"",icon:"Bomb",description:"",triggerConditions:{minPopulation:200,minEpoch:3,maxEpoch:6},options:[{id:"retaliate_sabotage",text:"",effects:{resourcePercent:{silver:-.03},nationWealth:{random:-500},nationRelation:{random:-20}},randomEffects:[{chance:.4,effects:{triggerWar:"random"},description:""}]},{id:"demand_compensation",text:"",effects:{approval:{official:10},nationRelation:{random:-15}},randomEffects:[{chance:.4,effects:{resourcePercent:{silver:.05},nationRelation:{random:10}},description:""}]},{id:"strengthen_security",text:"",effects:{resourcePercent:{silver:-.04},approval:{soldier:10,official:10},stability:5}}]},{id:"tribute_demand",name:"",icon:"Crown",description:"",triggerConditions:{minPopulation:150,minEpoch:2,maxEpoch:5},options:[{id:"accept_vassalage",text:"",effects:{resourcePercent:{silver:-.05},approval:{soldier:-25,landowner:-15,peasant:5},nationRelation:{strongest:50},nationAggression:{strongest:-.3},stability:-10}},{id:"refuse_proudly",text:"",effects:{approval:{soldier:20,peasant:10},nationRelation:{strongest:-30},nationAggression:{strongest:.2}},randomEffects:[{chance:.5,effects:{triggerWar:"strongest"},description:""}]},{id:"negotiate_terms",text:"",effects:{resourcePercent:{silver:-.02},approval:{official:10},nationRelation:{strongest:10}}}]},{id:"vassal_rebellion",name:"",icon:"Flag",description:"",triggerConditions:{minPopulation:250,minEpoch:3,maxEpoch:6},options:[{id:"punitive_expedition",text:"",effects:{resourcePercent:{silver:-.08},approval:{soldier:20},nationRelation:{weakest:-40}},randomEffects:[{chance:.6,effects:{nationRelation:{weakest:30},nationAggression:{weakest:-.2},resourcePercent:{silver:.05}},description:""},{chance:.3,effects:{resourcePercent:{silver:-.05},stability:-5},description:""}]},{id:"recognize_independence",text:"",effects:{approval:{soldier:-10,official:-10},nationRelation:{weakest:30},stability:-5}},{id:"economic_pressure",text:"",effects:{nationRelation:{weakest:-20},nationWealth:{weakest:-400}},randomEffects:[{chance:.4,effects:{nationRelation:{weakest:20}},description:""}]}]},{id:"great_congress",name:"",icon:"Users",description:"",triggerConditions:{minPopulation:250,minEpoch:5,maxEpoch:6},options:[{id:"active_participation",text:"",effects:{resourcePercent:{silver:-.04},approval:{official:15,soldier:10},nationRelation:{all:10},stability:5}},{id:"defensive_stance",text:"",effects:{approval:{official:5},nationRelation:{strongest:5}}},{id:"boycott_congress",text:"",effects:{approval:{soldier:10,official:-10},nationRelation:{all:-15},nationAggression:{all:.05}}}]},{id:"secret_alliance",name:"",icon:"FileText",description:"",triggerConditions:{minPopulation:200,minEpoch:4,maxEpoch:6},options:[{id:"seek_membership",text:"",effects:{resourcePercent:{silver:-.03},approval:{official:10,soldier:15},nationRelation:{strongest:30},nationAggression:{weakest:.1}}},{id:"form_counter_alliance",text:"",effects:{resourcePercent:{silver:-.05},approval:{soldier:20,official:10},nationRelation:{strongest:-20,weakest:25},nationAggression:{strongest:.15}}},{id:"remain_neutral",text:"",effects:{resourcePercent:{silver:-.04},approval:{merchant:15},nationRelation:{all:-5}}}]},{id:"intercepted_telegram",name:"",icon:"Mail",description:"",triggerConditions:{minPopulation:250,minEpoch:5,maxEpoch:6},options:[{id:"publish_telegram",text:"",effects:{approval:{official:15,peasant:10},nationRelation:{hostile:-40},nationAggression:{hostile:.2}},randomEffects:[{chance:.4,effects:{nationRelation:{friendly:20}},description:""}]},{id:"secret_diplomacy",text:"",effects:{approval:{official:10},nationRelation:{hostile:-15}},randomEffects:[{chance:.5,effects:{nationRelation:{hostile:20},nationAggression:{hostile:-.1}},description:""}]},{id:"keep_secret",text:"",effects:{approval:{soldier:10},nationAggression:{hostile:-.05}}}]},{id:"colonial_standoff",name:"",icon:"Flag",description:"",triggerConditions:{minPopulation:250,minEpoch:5,maxEpoch:6},options:[{id:"stand_firm",text:"",effects:{approval:{soldier:25,official:10},nationRelation:{random:-35},nationAggression:{random:.25}},randomEffects:[{chance:.4,effects:{triggerWar:"random"},description:""},{chance:.3,effects:{nationRelation:{random:15},nationAggression:{random:-.1}},description:""}]},{id:"negotiate_partition",text:"",effects:{approval:{official:10,soldier:-10},nationRelation:{random:10},stability:5}},{id:"strategic_retreat",text:"",effects:{approval:{soldier:-20,peasant:-10,merchant:10},nationRelation:{random:20},nationAggression:{random:-.15}}}]},{id:"diplomatic_insult",name:"",icon:"MessageCircle",description:"",triggerConditions:{minPopulation:200,minEpoch:4,maxEpoch:6},options:[{id:"declare_war",text:'""',effects:{approval:{soldier:30,peasant:15,official:10},nationRelation:{random:-50},triggerWar:"random"}},{id:"demand_retraction",text:"",effects:{approval:{official:10},nationRelation:{random:-20}},randomEffects:[{chance:.3,effects:{nationRelation:{random:25},stability:5},description:""},{chance:.4,effects:{nationRelation:{random:-15},nationAggression:{random:.1}},description:""}]},{id:"ignore_insult",text:"",effects:{approval:{soldier:-15,peasant:-10,merchant:10},nationRelation:{random:5},stability:-5}}]},{id:"assassination_abroad",name:"",icon:"Target",description:"",triggerConditions:{minPopulation:250,minEpoch:5,maxEpoch:6},options:[{id:"ultimatum",text:"",effects:{approval:{soldier:20,official:15},nationRelation:{random:-40},nationAggression:{random:.2}},randomEffects:[{chance:.5,effects:{triggerWar:"random"},description:""},{chance:.3,effects:{nationRelation:{random:10},resourcePercent:{silver:.05}},description:""}]},{id:"joint_investigation",text:"",effects:{approval:{official:10},nationRelation:{random:-10}},randomEffects:[{chance:.4,effects:{nationRelation:{random:15},stability:5},description:""}]},{id:"measured_response",text:"",effects:{approval:{soldier:-10,merchant:15},nationRelation:{random:5},stability:3}}]},{id:"forced_trade",name:"",icon:"Ship",description:"",triggerConditions:{minPopulation:250,minEpoch:5,maxEpoch:6},options:[{id:"resist_invasion",text:"",effects:{approval:{soldier:30,peasant:20,merchant:-20},nationRelation:{strongest:-50}},randomEffects:[{chance:.7,effects:{populationPercent:-.02,stability:-30,resourcePercent:{silver:-.08},triggerWar:"strongest"},description:""},{chance:.2,effects:{nationRelation:{strongest:20},nationAggression:{strongest:-.2}},description:""}]},{id:"sign_treaty",text:"",effects:{resourcePercent:{silver:.03},stability:-20,approval:{merchant:15,soldier:-30,peasant:-15},nationRelation:{strongest:30},nationAggression:{strongest:-.2}}},{id:"delay_tactics",text:"",effects:{approval:{official:5},nationRelation:{strongest:-15}},randomEffects:[{chance:.5,effects:{nationAggression:{strongest:.15},triggerWar:"strongest"},description:""}]}]},{id:"appeasement_demand",name:"",icon:"FileText",description:'""',triggerConditions:{minPopulation:250,minEpoch:5,maxEpoch:6},options:[{id:"appease",text:'""',effects:{stability:5,approval:{merchant:15,soldier:-25,official:-10},nationRelation:{hostile:20},nationAggression:{hostile:.2},nationWealth:{hostile:500}}},{id:"stand_against",text:'""',effects:{resourcePercent:{silver:-.02},approval:{soldier:10,official:5},nationRelation:{hostile:-15,weakest:10},nationAggression:{hostile:.05}},randomEffects:[{chance:.1,effects:{triggerWar:"hostile"},description:""}]},{id:"guarantee_independence",text:"",effects:{resourcePercent:{silver:-.08},approval:{soldier:25,official:15},nationRelation:{hostile:-35,weakest:40},nationAggression:{hostile:-.1}},randomEffects:[{chance:.4,effects:{triggerWar:"hostile"},description:""}]}]},{id:"strategic_canal",name:"",icon:"Anchor",description:"",triggerConditions:{minPopulation:250,minEpoch:5,maxEpoch:6},options:[{id:"support_nationalization",text:"",effects:{approval:{peasant:15,official:10},nationRelation:{random:25,strongest:-20},nationAggression:{strongest:.1}}},{id:"join_intervention",text:"",effects:{resourcePercent:{silver:-.05},approval:{soldier:15,merchant:10},nationRelation:{random:-30,strongest:15}},randomEffects:[{chance:.4,effects:{triggerWar:"random"},description:""}]},{id:"call_for_negotiation",text:"",effects:{approval:{official:10},nationRelation:{all:5},stability:3}}]},{id:"weapons_deployment",name:"",icon:"Target",description:"/",triggerConditions:{minPopulation:200,minEpoch:4,maxEpoch:6},options:[{id:"demand_removal",text:"",effects:{approval:{soldier:20,official:10},nationRelation:{random:-25}},randomEffects:[{chance:.4,effects:{nationRelation:{random:20},nationAggression:{random:-.15}},description:""},{chance:.3,effects:{nationAggression:{random:.2},triggerWar:"random"},description:""}]},{id:"counter_deployment",text:"",effects:{resourcePercent:{silver:-.06},approval:{soldier:20},nationRelation:{random:-20},nationAggression:{random:.1},stability:-5}},{id:"secret_deal",text:"",effects:{approval:{official:5,soldier:-10},nationRelation:{random:15},nationAggression:{random:-.1}}}]},{id:"colonial_conference",name:"",icon:"Map",description:'""',triggerConditions:{minPopulation:250,minEpoch:5,maxEpoch:6},options:[{id:"claim_territory",text:"",effects:{resourcePercent:{silver:-.05},populationPercent:.02,approval:{soldier:15,merchant:20,official:10},nationRelation:{all:-10}},randomEffects:[{chance:.3,effects:{nationRelation:{random:-25}},description:""}]},{id:"trade_rights_only",text:"",effects:{resourcePercent:{silver:.04},approval:{merchant:15},nationRelation:{all:5}}},{id:"denounce_conference",text:"",effects:{approval:{cleric:15,merchant:-10},nationRelation:{all:-15},stability:3}}]},{id:"naval_arms_race",name:"",icon:"Anchor",description:"",triggerConditions:{minPopulation:250,minEpoch:5,maxEpoch:6},options:[{id:"build_fleet",text:"",effects:{resourcePercent:{silver:-.1},buildingProductionMod:{dockyard:.3},approval:{soldier:25,worker:15,merchant:-10},nationRelation:{random:-15},nationAggression:{random:.1}}},{id:"seek_alliance",text:"",effects:{resourcePercent:{silver:-.03},approval:{official:10},nationRelation:{strongest:20},nationAggression:{random:-.05}}},{id:"develop_submarines",text:"",effects:{resourcePercent:{silver:-.05,science:.05},approval:{engineer:20,soldier:10}}}]}];function i5(t,s){if(!t.triggerConditions)return!0;const r=t.triggerConditions;if(r.minPopulation&&s.population<r.minPopulation||r.minEpoch!==void 0&&s.epoch<r.minEpoch||r.maxEpoch!==void 0&&s.epoch>r.maxEpoch||r.minScience&&s.resources.science<r.minScience)return!1;if(r.classConditions){const o=s.popStructure||{},c=s.classApproval||{},u=s.classInfluence||{},p=s.classWealth||{},m=s.classWealthDelta||{},h=s.classIncome||{};let x=s.totalInfluence;(!x||x<=0)&&(x=Object.values(u).reduce((b,j)=>b+(j||0),0));let g=s.totalWealth;(!g||g<=0)&&(g=Object.values(p).reduce((b,j)=>b+(j||0),0));for(const b in r.classConditions){const j=r.classConditions[b];if(!j)continue;const _=o[b]||0,N=c[b]??50,M=u[b]||0,R=p[b]||0,E=m[b]||0,T=h[b]||0,D=x>0?M/x:0,O=g>0?R/g:0;if(j.minPop!==void 0&&_<j.minPop||j.maxPop!==void 0&&_>j.maxPop||j.minApproval!==void 0&&N<j.minApproval||j.maxApproval!==void 0&&N>j.maxApproval||j.minInfluenceShare!==void 0&&D<j.minInfluenceShare||j.maxInfluenceShare!==void 0&&D>j.maxInfluenceShare||j.minWealth!==void 0&&R<j.minWealth||j.maxWealth!==void 0&&R>j.maxWealth||j.minWealthShare!==void 0&&O<j.minWealthShare||j.maxWealthShare!==void 0&&O>j.maxWealthShare||j.minWealthDelta!==void 0&&E<j.minWealthDelta||j.maxWealthDelta!==void 0&&E>j.maxWealthDelta||j.minIncome!==void 0&&T<j.minIncome||j.maxIncome!==void 0&&T>j.maxIncome)return!1}}return!0}function r5(t,s,r=0){if(!s||s.length===0)return t;const o=s.filter(p=>{if(p.visible===!1)return!1;const m=p.appearEpoch??0,h=p.expireEpoch;return!(r<m||h!=null&&r>h)});if(o.length===0)return t;const c=JSON.parse(JSON.stringify(t)),u=o[Math.floor(Math.random()*o.length)];return c._resolvedRandomNation=u?{id:u.id,name:u.name}:null,c.options&&(c.options=c.options.map(p=>{const m={...p};return m.effects&&(m.effects=d1(m.effects,u)),m.randomEffects&&(m.randomEffects=m.randomEffects.map(h=>({...h,effects:d1(h.effects,u)}))),m})),c}function d1(t,s){if(!t||!s)return t;const r={...t};return["nationRelation","nationAggression","nationWealth","nationMarketVolatility"].forEach(c=>{if(r[c]&&typeof r[c]=="object"){const u={...r[c]};"random"in u&&(u[s.id]=u.random,u._originalRandom=s.id,delete u.random),r[c]=u}}),r.triggerWar==="random"&&(r.triggerWar=s.id,r._triggerWarFromRandom=!0),r.triggerPeace==="random"&&(r.triggerPeace=s.id,r._triggerPeaceFromRandom=!0),r}function o5(t,s){const r=s.filter(m=>i5(m,t));if(r.length===0)return null;const o=Math.floor(Math.random()*r.length),c=r[o],u=t.nations||[],p=t.epoch||0;return r5(c,u,p)}const Mo=2e3,No=3,yf=3,Ay=yf*365;function Lp(t,s){return{id:`war_declaration_${t.id}_${Date.now()}`,name:`${t.name}`,icon:"Swords",image:null,description:`${t.name}`,isDiplomaticEvent:!0,options:[{id:"acknowledge",text:"",description:"-5",effects:{stability:-5},callback:s}]}}function l5(t,s,r){return{id:`gift_${t.id}_${Date.now()}`,name:`${t.name}`,icon:"Gift",image:null,description:`${t.name}${s}`,isDiplomaticEvent:!0,options:[{id:"accept",text:"",description:`${s}`,effects:{resources:{silver:s}},callback:r}]}}function c5(t,s,r,o){const c=[];if(r>450){const p=Math.floor(s*2),m=t.population||1e3,h=Math.min(Mo,Math.max(10,Math.floor(m*.08))),x=t.population||1e3;c.push({id:"annex",text:" ",description:`${t.name}${Math.round(x)}`,effects:{},callback:()=>o(!0,"annex",x)}),c.push({id:"demand_more",text:"",description:`${p}100%`,effects:{resources:{silver:p}},callback:()=>o(!0,"demand_more",p)}),c.push({id:"demand_population",text:"",description:` ${h}`,effects:{},callback:()=>o(!0,"population",h)}),c.push({id:"accept_standard",text:"",description:`${s}`,effects:{resources:{silver:s}},callback:()=>o(!0,"standard",s)})}else if(r>200){const p=Math.floor(s*1.5),m=Math.ceil(p*No),h=Math.ceil(m/365),x=t.population||1e3,g=Math.min(Mo,Math.max(6,Math.floor(x*.04)));c.push({id:"demand_more",text:"",description:`${p}50%`,effects:{resources:{silver:p}},callback:()=>o(!0,"demand_more",p)}),c.push({id:"demand_installment",text:"",description:`${h}${h*365}`,effects:{},callback:()=>o(!0,"installment",h)}),c.push({id:"demand_population",text:"",description:` ${g}`,effects:{},callback:()=>o(!0,"population",g)}),c.push({id:"demand_open_market",text:"",description:`${t.name}${yf}`,effects:{},callback:()=>o(!0,"open_market",Ay)}),c.push({id:"accept_standard",text:"",description:`${s}`,effects:{resources:{silver:s}},callback:()=>o(!0,"standard",s)})}else if(r>50){const p=Math.ceil(s*No),m=Math.ceil(p/365),h=t.population,x=Math.min(Mo,Math.max(4,Math.floor(h*.02)));c.push({id:"accept",text:"",description:`${s}`,effects:{resources:{silver:s}},callback:()=>o(!0,"standard",s)}),c.push({id:"demand_installment",text:"",description:`${m}${m*365}`,effects:{},callback:()=>o(!0,"installment",m)}),c.push({id:"demand_population",text:"",description:` ${x}`,effects:{},callback:()=>o(!0,"population",x)})}else c.push({id:"accept",text:"",description:`${s}`,effects:{resources:{silver:s}},callback:()=>o(!0,"standard",s)});c.push({id:"reject",text:"",description:"",effects:{},callback:()=>o(!1)});let u="";return r>450?u=`${t.name}`:r>200?u=`${t.name}${s}`:r>50?u=`${t.name}${s}`:u=`${t.name}${s}`,{id:`enemy_peace_request_${t.id}_${Date.now()}`,name:r>450?`${t.name}`:`${t.name}`,icon:r>450?"Flag":"HandHeart",image:null,description:u,isDiplomaticEvent:!0,options:c}}function d5(t,s,r,o,c={},u){const p=[],m=Math.max(200,c.population||c.maxPopulation||1e3),h=(g,b)=>{const j=Math.abs(Math.min(s,0))/b,_=Math.max(0,r||0)/4e3,N=Math.min(g,Math.max(.012,j+_)),M=Math.floor(m*N),R=Math.floor(m*g);return Math.min(Mo,Math.max(3,Math.min(R,M)))};if(s>350){const g=Math.min(t.wealth||0,Math.ceil(s*60+o*4)),b=t.population||1e3,j=Math.min(Mo,Math.max(10,Math.floor(b*.08))),_=t.population||1e3;p.push({id:"demand_annex",text:" ",description:`${t.name}${Math.round(_)}`,effects:{},callback:()=>u("demand_annex",_)}),p.push({id:"demand_high",text:"",description:`${g}`,effects:{},callback:()=>u("demand_high",g)}),p.push({id:"demand_population",text:"",description:` ${j}`,effects:{},callback:()=>u("demand_population",j)}),p.push({id:"peace_only",text:"",description:"",effects:{},callback:()=>u("peace_only",0)})}else if(s>150){const g=Math.min(t.wealth||0,Math.ceil(s*50+o*3)),b=Math.min(t.wealth||0,Math.ceil(s*40+o*2)),j=Math.ceil(g*No),_=Math.ceil(j/365),N=t.population||1e3,M=Math.min(Mo,Math.max(5,Math.floor(N*.03)));p.push({id:"demand_high",text:"",description:`${g}`,effects:{},callback:()=>u("demand_high",g)}),p.push({id:"demand_installment",text:"",description:`${_}${_*365}`,effects:{},callback:()=>u("demand_installment",_)}),p.push({id:"demand_population",text:"",description:` ${M}`,effects:{},callback:()=>u("demand_population",M)}),p.push({id:"demand_open_market",text:"",description:`${t.name}${yf}`,effects:{},callback:()=>u("demand_open_market",Ay)}),p.push({id:"demand_standard",text:"",description:`${b}`,effects:{},callback:()=>u("demand_standard",b)}),p.push({id:"peace_only",text:"",description:"",effects:{},callback:()=>u("peace_only",0)})}else if(s>50){const g=Math.min(t.wealth||0,Math.ceil(s*40+o*2)),b=Math.ceil(g*No),j=Math.ceil(b/365),_=t.population,N=Math.min(Mo,Math.max(5,Math.floor(_*.01)));p.push({id:"demand_tribute",text:"",description:`${g}`,effects:{},callback:()=>u("demand_tribute",g)}),p.push({id:"demand_installment",text:"",description:`${j}${j*365}`,effects:{},callback:()=>u("demand_installment",j)}),p.push({id:"demand_population",text:"",description:` ${N}`,effects:{},callback:()=>u("demand_population",N)}),p.push({id:"peace_only",text:"",description:"",effects:{},callback:()=>u("peace_only",0)})}else if(s<-150){const g=Math.max(150,Math.ceil(Math.abs(s)*35+r*6)),b=Math.ceil(g*No),j=Math.ceil(b/365),_=h(.05,320);p.push({id:"pay_high",text:`${g}`,description:"",effects:{},callback:()=>u("pay_high",g)}),p.push({id:"pay_installment",text:"",description:`${j}${j*365}`,effects:{},callback:()=>u("pay_installment",j)}),p.push({id:"offer_population",text:` ${_}`,description:"",effects:{},callback:()=>u("offer_population",_)})}else if(s<-50){const g=Math.max(100,Math.ceil(Math.abs(s)*30+r*5)),b=Math.ceil(g*No),j=Math.ceil(b/365),_=h(.03,480);p.push({id:"pay_standard",text:`${g}`,description:"",effects:{},callback:()=>u("pay_standard",g)}),p.push({id:"pay_installment",text:"",description:`${j}${j*365}`,effects:{},callback:()=>u("pay_installment",j)}),p.push({id:"offer_population",text:` ${_}`,description:"",effects:{},callback:()=>u("offer_population",_)})}else{const g=Math.max(50,Math.ceil(Math.abs(s)*20+r*3)),b=Math.ceil(g*No),j=Math.ceil(b/365);p.push({id:"pay_moderate",text:`${g}`,description:"",effects:{},callback:()=>u("pay_moderate",g)}),p.push({id:"pay_installment_moderate",text:"",description:`${j}${j*365}`,effects:{},callback:()=>u("pay_installment_moderate",j)}),p.push({id:"peace_only",text:"",description:"",effects:{},callback:()=>u("peace_only",0)})}p.push({id:"cancel",text:"",description:"",effects:{},callback:()=>u("cancel",0)});let x="";return s>450?x=`${t.name}`:s>200?x=`${t.name}`:s>50?x=`${t.name}`:s<-200?x=`${t.name}`:s<-50?x=`${t.name}`:x=`${t.name}`,{id:`player_peace_proposal_${t.id}_${Date.now()}`,name:`${t.name}`,icon:"HandHeart",image:null,description:x,isDiplomaticEvent:!0,options:p}}function u5(t,s,r,o,c){return{id:`ai_request_${t.id}_${Date.now()}`,name:`${t.name}`,icon:"HandCoins",image:null,description:`${t.name}${r}${o}${r}`,isDiplomaticEvent:!0,options:[{id:"accept",text:"",description:`${o}${r}`,effects:{resources:{[s]:-o}},callback:()=>c(!0)},{id:"reject",text:"",description:"",effects:{},callback:()=>c(!1)}]}}function p5(t,s){return{id:`alliance_request_${t.id}_${Date.now()}`,name:`${t.name}`,icon:"Users",image:null,description:`${t.name}


 
 
 
 `,isDiplomaticEvent:!0,options:[{id:"accept",text:"",description:"",effects:{},callback:()=>s(!0)},{id:"reject",text:"",description:"",effects:{},callback:()=>s(!1)}]}}function u1(t,s,r){return s?{id:`alliance_accepted_${t.id}_${Date.now()}`,name:`${t.name}`,icon:"UserCheck",image:null,description:`${t.name}`,isDiplomaticEvent:!0,options:[{id:"acknowledge",text:"",description:"",effects:{},callback:r}]}:{id:`alliance_rejected_${t.id}_${Date.now()}`,name:`${t.name}`,icon:"UserX",image:null,description:`${t.name}`,isDiplomaticEvent:!0,options:[{id:"acknowledge",text:"",description:"",effects:{},callback:r}]}}function f5(t,s,r){const c={relation_low:"",player_break:"",ai_break:`${t.name}`,war_conflict:""}[s];return{id:`alliance_break_${t.id}_${Date.now()}`,name:`${t.name}`,icon:"UserMinus",image:null,description:`${c}${t.name}`,isDiplomaticEvent:!0,options:[{id:"acknowledge",text:"",description:"",effects:{},callback:r}]}}function B0(t,s,r,o,c){const u=o==="war_annex";let p="",m="";return u?(m=` ${t.name}`,p=`${t.name}

 
 ${s.toLocaleString()}
 +${r.toLocaleString()}

${t.name}`):(m=` ${t.name}`,p=`${t.name}

${s.toLocaleString()}

 ${s.toLocaleString()}
 +${r.toLocaleString()}

`),{id:`nation_annexed_${t.id}_${Date.now()}`,name:m,icon:u?"Crown":"Skull",image:null,description:p,isDiplomaticEvent:!0,options:[{id:"acknowledge",text:u?"":"",description:u?"":"",effects:{},callback:c}]}}function m5(t,s,r){const o=Math.floor(200+Math.random()*300);return{id:`ally_cold_${t.id}_${Date.now()}`,name:`${t.name}`,icon:"HeartCrack",image:null,description:`${t.name}${Math.round(s)}`,isDiplomaticEvent:!0,options:[{id:"gift",text:`${o}`,description:"+15",effects:{resources:{silver:-o}},callback:()=>r("gift",o)},{id:"ignore",text:"",description:"",effects:{},callback:()=>r("ignore")}]}}function h5(t,s,r){return{id:`ally_attacked_${t.id}_${Date.now()}`,name:`${t.name}`,icon:"AlertTriangle",image:null,description:`${t.name}${s.name}


 ${t.name}-40
 
 -10
 ""

`,isDiplomaticEvent:!0,options:[{id:"intervene",text:"",description:`${s.name}`,effects:{stability:-5},callback:()=>r(!0)},{id:"abandon",text:"",description:"",effects:{},callback:()=>r(!1)}]}}function x5(t,s,r,o){const u={tribute:`${r.amount}`,territory:`${r.amount}`,open_market:`${Math.round(r.amount/365)}`}[r.type]||"";return{id:`ai_demand_surrender_${t.id}_${Date.now()}`,name:`${t.name}`,icon:"Swords",image:null,description:`${t.name}${Math.abs(Math.round(s))}

${u}

`,isDiplomaticEvent:!0,options:[{id:"accept",text:"",description:u,effects:{},callback:()=>o(!0)},{id:"reject",text:"",description:"",effects:{},callback:()=>o(!1)}]}}const ii={NONE:"none",BREWING:"brewing",PLOTTING:"plotting",ACTIVE:"active"},ko={INVESTIGATE_SUCCESS_BASE:.6,ARREST_SUCCESS_BASE:.4,SUPPRESS_SUCCESS_BASE:.5,REBEL_NATION_BASE_WEALTH:300,REBEL_NATION_BASE_AGGRESSION:.7};function Do(t){return Ke[t]?.name||t}function g5(t,s,r,o,c){const u=Do(t),p=[];return p.push({id:"subsidize",text:"",description:`${u}`,effects:{resources:{silver:-150},approval:{[t]:15},stability:3}}),p.push({id:"public_statement",text:"",description:`${u}`,effects:{approval:{[t]:8},stability:-2}}),p.push({id:"surveillance",text:"",description:"",effects:{approval:{[t]:-5},stability:5},randomEffects:[{chance:.3,description:"",effects:{approval:{[t]:-15},stability:-8}}]}),p.push({id:"ignore",text:"",description:"",effects:{}}),{id:`rebellion_brewing_${t}_${Date.now()}`,name:`${u}`,icon:"AlertTriangle",image:null,description:`${u}

30%${(s.influenceShare*100).toFixed(1)}%

`,isRebellionEvent:!0,rebellionPhase:ii.BREWING,rebellionStratum:t,options:p}}function y5(t,s,r,o,c){const u=Do(t),p=[];return p.push({id:"major_concession",text:"",description:`${u}`,effects:{resources:{silver:-500},approval:{[t]:30},stability:10}}),p.push({id:"negotiate",text:"",description:`${u}`,effects:{resources:{silver:-200},approval:{[t]:15},stability:3}}),r&&!o&&p.push({id:"show_force",text:"",description:"",effects:{approval:{[t]:-10,soldier:5},stability:8},randomEffects:[{chance:.25,description:"",effects:{approval:{[t]:-20},stability:-15}}]}),p.push({id:"divide",text:"",description:"",effects:{stability:-3},randomEffects:[{chance:.4,description:"",effects:{approval:{[t]:10},stability:5}},{chance:.3,description:"",effects:{approval:{[t]:-20},stability:-10}}]}),p.push({id:"ignore",text:"",description:"",effects:{stability:-5}}),{id:`rebellion_plotting_${t}_${Date.now()}`,name:`${u}`,icon:"Flame",image:null,description:`${u}

70%${(s.influenceShare*100).toFixed(1)}%


`,isRebellionEvent:!0,rebellionPhase:ii.PLOTTING,rebellionStratum:t,options:p}}function p1(t,s,r,o,c,u){const p=Do(t),m=[];return r&&!o&&m.push({id:"suppress",text:"",description:"",effects:{stability:-5,approval:{[t]:-10}},callback:()=>u("suppress",t)}),m.push({id:"accept_war",text:"",description:"",effects:{stability:-3},callback:()=>u("accept_war",t,c)}),{id:`rebellion_active_${t}_${Date.now()}`,name:`${p}`,icon:"Skull",image:null,description:`${p}"${c.name}"

${p}

${c.population}
${c.wealth}`,isRebellionEvent:!0,rebellionPhase:ii.ACTIVE,rebellionStratum:t,options:m}}function b5(t,s,r,o){const c=Do(t);return s?{id:`rebellion_investigation_success_${t}_${Date.now()}`,name:"",icon:"Search",description:`${c}${r||""}

`,isRebellionEvent:!0,options:[{id:"ok",text:"",effects:{},callback:()=>o("investigation_success",t)}]}:{id:`rebellion_investigation_fail_${t}_${Date.now()}`,name:"",icon:"XCircle",description:`${c}`,isRebellionEvent:!0,options:[{id:"ok",text:"",effects:{},callback:()=>o("investigation_fail",t)}]}}function v5(t,s,r){const o=Do(t);return s?{id:`rebellion_arrest_success_${t}_${Date.now()}`,name:"",icon:"Shield",description:`

${o}`,isRebellionEvent:!0,options:[{id:"execute",text:"",description:"",effects:{stability:5,classApproval:{[t]:-15}},callback:()=>r("arrest_execute",t)},{id:"imprison",text:"",description:"",effects:{},callback:()=>r("arrest_imprison",t)},{id:"exile",text:"",description:"",effects:{classApproval:{[t]:-5}},callback:()=>r("arrest_exile",t)}]}:{id:`rebellion_arrest_fail_${t}_${Date.now()}`,name:"",icon:"AlertTriangle",description:"",isRebellionEvent:!0,options:[{id:"ok",text:"",effects:{},callback:()=>r("arrest_fail",t)}]}}function j5(t,s,r,o,c){const u=Do(t);return s?{id:`rebellion_suppress_success_${t}_${Date.now()}`,name:"",icon:"Trophy",description:`${u}

${r}
${o}

`,isRebellionEvent:!0,options:[{id:"mercy",text:"",description:"",effects:{classApproval:{[t]:10}},callback:()=>c("suppress_mercy",t)},{id:"strict",text:"",description:"",effects:{stability:10,classApproval:{[t]:-20}},callback:()=>c("suppress_strict",t)}]}:{id:`rebellion_suppress_fail_${t}_${Date.now()}`,name:"",icon:"Skull",description:`

${r}
${o}

`,isRebellionEvent:!0,options:[{id:"ok",text:"",effects:{},callback:()=>c("suppress_fail",t)}]}}function f1(t,s,r,o,c=null,u=null){const p=Do(t),m=`rebel_${t}_${Date.now()}`,h=c??Math.max(10,Math.floor(s*.8));let x=Math.floor(r*.5),g=0;const b={};if(u&&u.resources&&u.marketPrices){const{resources:N,marketPrices:M}=u,R=Math.min(.3,o*.5);Object.keys(N).forEach(E=>{if(E==="silver"||E==="science"||E==="culture")return;const T=N[E]||0;if(T<=0)return;const D=Math.floor(T*R);if(D>0){const O=M[E]||1;g+=D*O,b[E]=D}})}const j=Math.max(ko.REBEL_NATION_BASE_WEALTH,x+g);return{nation:{id:m,name:`${p}`,desc:`${p}`,color:"#8B0000",icon:"Flame",wealth:j,population:h,aggression:ko.REBEL_NATION_BASE_AGGRESSION,relation:0,isAtWar:!0,warScore:0,militaryStrength:Math.min(1.5,.5+o*2),isRebelNation:!0,rebellionStratum:t,visible:!0,economyTraits:{resourceBias:{},baseWealth:j,basePopulation:h},foreignPower:{baseRating:.5,volatility:.5,appearEpoch:0,populationFactor:1,wealthFactor:1},inventory:{},budget:Math.floor(j*.3),enemyLosses:0,warDuration:0,warStartDay:0,foreignWars:{}},lootedResources:b,lootedValue:g}}function Vp(t,s,r){return s?{id:`rebellion_end_victory_${Date.now()}`,name:"",icon:"Trophy",description:`${t.name}

`,isRebellionEvent:!0,options:[{id:"celebrate",text:"",description:"",effects:{stability:15,resources:{silver:-200,culture:80}},callback:()=>r("end_celebrate",t)},{id:"rebuild",text:"",description:"",effects:{stability:8,resources:{silver:150},buildingProductionMod:{all:.1}},callback:()=>r("end_rebuild",t)}]}:{id:`rebellion_end_defeat_${Date.now()}`,name:"",icon:"Frown",description:`${t.name}...`,isRebellionEvent:!0,options:[{id:"accept",text:"",description:"",effects:{stability:-20},callback:()=>r("end_defeat",t)}]}}function bf(t){return Ke[t]?.name||t}function w5(t,s,r,o,c,u=.1){const p=t.map(E=>bf(E));let m;t.length===2?m=`${p[0]}${p[1]}`:t.length===3?m=`${p[0]}${p[1]}${p[2]}`:m="";const h=`coalition_rebel_${Date.now()}`;let x=0,g=0,b=0;t.forEach(E=>{const T=s[E]||0,D=r[E]||0,O=o[E]||0;x+=Math.floor(T*.7),g+=Math.floor(D*.5),b+=O});const j=1+u,_=Math.max(20,Math.floor(x*j)),N=Math.max(ko.REBEL_NATION_BASE_WEALTH*2,Math.floor(g*j)),M=c>0?b/c:0,R=Math.min(2,.6+M*2.5);return console.log(`[COALITION] Creating coalition rebel nation: ${m}`),console.log(`[COALITION] Population: ${x} -> ${_} (with bonus)`),console.log(`[COALITION] Wealth: ${g} -> ${N} (with bonus)`),console.log(`[COALITION] Military Strength: ${R.toFixed(2)}`),{id:h,name:m,desc:`${p.join("")}`,color:"#4B0000",icon:"Users",wealth:N,population:_,aggression:Math.min(1,ko.REBEL_NATION_BASE_AGGRESSION+.1),relation:0,isAtWar:!0,warScore:0,militaryStrength:R,isRebelNation:!0,isCoalitionRebellion:!0,coalitionStrata:t,rebellionStratum:t[0],visible:!0,economyTraits:{resourceBias:{},baseWealth:N,basePopulation:_},foreignPower:{baseRating:.6+t.length*.1,volatility:.4,appearEpoch:0,populationFactor:1.2,wealthFactor:1.2},inventory:{},budget:Math.floor(N*.4),enemyLosses:0,warDuration:0,warStartDay:null,foreignWars:{}}}function N5(t,s,r,o,c,u){const m=t.map(g=>bf(g)).join(""),h=[];r&&!o&&h.push({id:"suppress",text:"",description:"",effects:{stability:-5,approval:{[t[0]]:-10}},callback:()=>u("suppress",t[0])}),h.push({id:"accept_war",text:"",description:"",effects:{stability:-3},callback:()=>u("accept_war",t[0],s)});const x=c.map(({stratumName:g,loss:b})=>`${g}${b}`).join("");return{id:`coalition_rebellion_${Date.now()}`,name:"",icon:"Users",image:null,description:`${m}"${s.name}"



 
 ${s.population}
 ${s.wealth}
 ${(s.militaryStrength*100).toFixed(0)}%

 
${x}`,isRebellionEvent:!0,rebellionPhase:ii.ACTIVE,isCoalitionRebellion:!0,coalitionStrata:t,rebellionStratum:t[0],options:h}}function M5(t,s){const r=[];let o=0;return t.forEach(c=>{const u=s[c]||0,p=Math.floor(u*.7);p>0&&(r.push({stratumKey:c,stratumName:bf(c),loss:p}),o+=p)}),{details:r,totalLoss:o}}const vf=[...Cy,...n5,...Ty,...s5,...Sy];function _5(t){return o5(t,vf)}const un={militia:{id:"militia",name:"",desc:"",epoch:0,icon:"Users",category:"infantry",attack:6,defense:4,speed:3,range:1,recruitCost:{food:25,wood:12},maintenanceCost:{food:.35,silver:.12},trainingTime:2,populationCost:1,abilities:[""],counters:{cavalry:1.2,siege:1.3},weakAgainst:["archer"],obsoleteAfterEpochs:2},slinger:{id:"slinger",name:"",desc:"",epoch:0,icon:"Circle",category:"archer",attack:6,defense:2,speed:3,range:3,recruitCost:{food:30,wood:15,stone:5},maintenanceCost:{food:.4,silver:.15,stone:.1},trainingTime:3,populationCost:1,abilities:[""],counters:{infantry:1.4},weakAgainst:["cavalry"],obsoleteAfterEpochs:2},spearman:{id:"spearman",name:"",desc:"",epoch:1,icon:"Sword",category:"infantry",attack:12,defense:9,speed:3,range:1,recruitCost:{food:55,wood:35,copper:12},maintenanceCost:{food:.55,silver:.35,copper:.05},trainingTime:4,populationCost:1,abilities:[""],counters:{cavalry:1.8,siege:1.2},weakAgainst:["archer"],obsoleteAfterEpochs:2},archer:{id:"archer",name:"",desc:"",epoch:1,icon:"Target",category:"archer",attack:14,defense:6,speed:4,range:4,recruitCost:{food:65,wood:45,silver:25},maintenanceCost:{food:.65,silver:.45,wood:.2},trainingTime:5,populationCost:1,abilities:["",""],counters:{infantry:1.5,siege:1.4},weakAgainst:["cavalry"],obsoleteAfterEpochs:2},chariot:{id:"chariot",name:"",desc:"",epoch:1,icon:"Truck",category:"cavalry",attack:15,defense:8,speed:6,range:1,recruitCost:{food:100,wood:60,copper:30,silver:40},maintenanceCost:{food:1.2,silver:.7,wood:.3},trainingTime:6,populationCost:1,abilities:["",""],counters:{archer:1.6},weakAgainst:["infantry"],obsoleteAfterEpochs:2},hoplite:{id:"hoplite",name:"",desc:"",epoch:2,icon:"Shield",category:"infantry",attack:16,defense:14,speed:2,range:1,recruitCost:{food:100,copper:40,iron:20,silver:50},maintenanceCost:{food:.75,silver:.55,iron:.08},trainingTime:6,populationCost:1,abilities:["",""],counters:{cavalry:1.7,siege:1.3},weakAgainst:["archer"],obsoleteAfterEpochs:2},composite_archer:{id:"composite_archer",name:"",desc:"",epoch:2,icon:"Target",category:"archer",attack:18,defense:7,speed:4,range:5,recruitCost:{food:85,wood:50,copper:25,silver:45},maintenanceCost:{food:.7,silver:.5,wood:.25,copper:.05},trainingTime:6,populationCost:1,abilities:["",""],counters:{infantry:1.6,siege:1.3},weakAgainst:["cavalry"],obsoleteAfterEpochs:2},light_cavalry:{id:"light_cavalry",name:"",desc:"",epoch:2,icon:"Navigation",category:"cavalry",attack:18,defense:8,speed:8,range:1,recruitCost:{food:120,silver:60,iron:25},maintenanceCost:{food:1.2,silver:.8,iron:.06},trainingTime:7,populationCost:1,abilities:["",""],counters:{archer:1.8},weakAgainst:["infantry"],obsoleteAfterEpochs:2},battering_ram:{id:"battering_ram",name:"",desc:"",epoch:2,icon:"Hammer",category:"siege",attack:30,defense:15,speed:1,range:1,recruitCost:{food:150,wood:200,iron:50,silver:80},maintenanceCost:{food:1.2,silver:.8,wood:.5,iron:.1},trainingTime:10,populationCost:2,abilities:[""],counters:{},weakAgainst:["cavalry","archer","infantry"],obsoleteAfterEpochs:2},heavy_infantry:{id:"heavy_infantry",name:"",desc:"",epoch:3,icon:"ShieldAlert",category:"infantry",attack:20,defense:18,speed:2,range:1,recruitCost:{food:140,iron:60,silver:80},maintenanceCost:{food:.9,silver:.7,iron:.12},trainingTime:8,populationCost:1,abilities:["",""],counters:{cavalry:1.6,siege:1.4},weakAgainst:["archer"],obsoleteAfterEpochs:2},crossbowman:{id:"crossbowman",name:"",desc:"",epoch:3,icon:"Crosshair",category:"archer",attack:22,defense:9,speed:3,range:5,recruitCost:{food:110,wood:70,iron:45,silver:55},maintenanceCost:{food:.8,silver:.6,wood:.15,iron:.1},trainingTime:7,populationCost:1,abilities:["",""],counters:{infantry:1.7,siege:1.4},weakAgainst:["cavalry"],obsoleteAfterEpochs:2},knight:{id:"knight",name:"",desc:"",epoch:3,icon:"Crown",category:"cavalry",attack:28,defense:22,speed:6,range:1,recruitCost:{food:250,iron:100,silver:160},maintenanceCost:{food:1.8,silver:1.3,iron:.2},trainingTime:10,populationCost:1,abilities:["","",""],counters:{archer:1.9},weakAgainst:["infantry"],obsoleteAfterEpochs:2},trebuchet:{id:"trebuchet",name:"",desc:"",epoch:3,icon:"Mountain",category:"siege",attack:45,defense:8,speed:1,range:6,recruitCost:{food:200,wood:250,iron:80,silver:150},maintenanceCost:{food:1.5,silver:1.2,wood:.8,iron:.15,stone:.3},trainingTime:12,populationCost:3,abilities:["",""],counters:{infantry:1.3},weakAgainst:["cavalry","archer"],obsoleteAfterEpochs:2},pikeman:{id:"pikeman",name:"",desc:"",epoch:4,icon:"Swords",category:"infantry",attack:22,defense:20,speed:2,range:2,recruitCost:{food:160,wood:60,iron:70,silver:90},maintenanceCost:{food:1,silver:.8,iron:.1},trainingTime:8,populationCost:1,abilities:["",""],counters:{cavalry:2,siege:1.3},weakAgainst:["archer","gunpowder"],obsoleteAfterEpochs:2},arquebus:{id:"arquebus",name:"",desc:"",epoch:4,icon:"Flame",category:"gunpowder",attack:28,defense:8,speed:2,range:4,recruitCost:{food:140,iron:60,tools:30,silver:100},maintenanceCost:{food:.9,silver:.8,iron:.08,tools:.15},trainingTime:9,populationCost:1,abilities:["","",""],counters:{infantry:1.5,cavalry:1.4},weakAgainst:["cavalry"],obsoleteAfterEpochs:2},cuirassier:{id:"cuirassier",name:"",desc:"",epoch:4,icon:"Shield",category:"cavalry",attack:32,defense:24,speed:6,range:1,recruitCost:{food:300,iron:120,silver:200},maintenanceCost:{food:2,silver:1.5,iron:.25},trainingTime:11,populationCost:1,abilities:["","",""],counters:{archer:1.9,gunpowder:1.5},weakAgainst:["infantry"],obsoleteAfterEpochs:2},bombard:{id:"bombard",name:"",desc:"",epoch:4,icon:"Bomb",category:"siege",attack:55,defense:10,speed:1,range:6,recruitCost:{food:250,iron:150,tools:60,silver:200},maintenanceCost:{food:1.8,silver:1.5,iron:.3,tools:.25},trainingTime:14,populationCost:3,abilities:["","",""],counters:{infantry:1.5},weakAgainst:["cavalry"],obsoleteAfterEpochs:2},musketeer:{id:"musketeer",name:"",desc:"",epoch:5,icon:"Zap",category:"infantry",attack:30,defense:14,speed:3,range:3,recruitCost:{food:180,iron:70,tools:40,silver:110},maintenanceCost:{food:1.1,silver:1,iron:.1,tools:.18},trainingTime:9,populationCost:1,abilities:["","",""],counters:{cavalry:1.6,siege:1.4},weakAgainst:["gunpowder"],obsoleteAfterEpochs:2},rifleman:{id:"rifleman",name:"",desc:"",epoch:5,icon:"Target",category:"gunpowder",attack:35,defense:10,speed:3,range:5,recruitCost:{food:200,iron:80,tools:50,silver:130},maintenanceCost:{food:1.2,silver:1.1,iron:.12,tools:.22},trainingTime:10,populationCost:1,abilities:["","",""],counters:{infantry:1.7,cavalry:1.5,siege:1.5},weakAgainst:["cavalry"],obsoleteAfterEpochs:2},dragoon:{id:"dragoon",name:"",desc:"",epoch:5,icon:"Navigation",category:"cavalry",attack:35,defense:18,speed:7,range:2,recruitCost:{food:280,iron:90,tools:45,silver:180},maintenanceCost:{food:2,silver:1.5,iron:.15,tools:.2},trainingTime:12,populationCost:1,abilities:["","",""],counters:{archer:1.8,gunpowder:1.6},weakAgainst:["infantry"],obsoleteAfterEpochs:2},cannon:{id:"cannon",name:"",desc:"",epoch:5,icon:"Bomb",category:"siege",attack:60,defense:12,speed:2,range:7,recruitCost:{food:300,iron:180,tools:80,silver:250},maintenanceCost:{food:2,silver:1.8,iron:.35,tools:.35},trainingTime:15,populationCost:3,abilities:["","",""],counters:{infantry:1.7,gunpowder:1.5},weakAgainst:["cavalry"],obsoleteAfterEpochs:2},line_infantry:{id:"line_infantry",name:"",desc:"",epoch:6,icon:"Users",category:"infantry",attack:40,defense:20,speed:3,range:4,recruitCost:{food:250,iron:100,tools:60,silver:160},maintenanceCost:{food:1.4,silver:1.3,iron:.15,tools:.28},trainingTime:10,populationCost:1,abilities:["","",""],counters:{cavalry:1.7,siege:1.5},weakAgainst:["gunpowder"],obsoleteAfterEpochs:3},gatling:{id:"gatling",name:"",desc:"",epoch:6,icon:"Zap",category:"gunpowder",attack:50,defense:12,speed:2,range:5,recruitCost:{food:300,iron:150,tools:100,silver:250},maintenanceCost:{food:1.6,silver:1.8,iron:.25,tools:.45},trainingTime:12,populationCost:2,abilities:["","",""],counters:{infantry:2,cavalry:1.8},weakAgainst:["siege"],obsoleteAfterEpochs:3},lancer:{id:"lancer",name:"",desc:"",epoch:6,icon:"Compass",category:"cavalry",attack:38,defense:20,speed:8,range:1,recruitCost:{food:320,iron:100,tools:50,silver:200},maintenanceCost:{food:2.2,silver:1.6,iron:.12,tools:.22},trainingTime:11,populationCost:1,abilities:["","",""],counters:{archer:1.9,gunpowder:1.7},weakAgainst:["infantry"],obsoleteAfterEpochs:3},artillery:{id:"artillery",name:"",desc:"",epoch:6,icon:"Bomb",category:"siege",attack:80,defense:15,speed:1,range:8,recruitCost:{food:400,iron:250,tools:120,silver:350},maintenanceCost:{food:2.5,silver:2.2,iron:.5,tools:.55},trainingTime:18,populationCost:4,abilities:["","",""],counters:{infantry:2,gunpowder:1.8,siege:1.5},weakAgainst:["cavalry"],obsoleteAfterEpochs:3}},hr={infantry:{name:"",icon:"Swords",color:"text-red-400",description:"/"},archer:{name:"",icon:"Target",color:"text-green-400",description:""},cavalry:{name:"",icon:"Navigation",color:"text-blue-400",description:"/"},gunpowder:{name:"",icon:"Flame",color:"text-yellow-400",description:"/"},siege:{name:"",icon:"Bomb",color:"text-orange-400",description:""}},jf=(t={})=>{let s=0;return Object.entries(t).forEach(([r,o])=>{if(o<=0)return;const c=un[r];if(!c)return;const u=c.maintenanceCost?.food||0;s+=u*o}),s},sd=(t,s,r=0,o=50)=>{let c=0;Object.entries(t).forEach(([h,x])=>{if(x<=0)return;const g=un[h];if(!g)return;let b=(g.attack+g.defense)*x;const j=s-g.epoch;j>0&&j<=(g.obsoleteAfterEpochs||2)&&(b*=1+j*.05);const _=g.obsoleteAfterEpochs||2;if(j>_){const N=j-_,M=Math.min(.75,N*.25);b*=1-M}c+=b}),c*=1+r;const u=50,p=Math.max(0,(o-u)/u),m=Math.min(1.5,1+p*.5);return c*=m,c},m1=(t,s)=>{let r=1,o=0;return Object.entries(t).forEach(([c,u])=>{if(u<=0)return;const p=un[c];p&&Object.entries(s).forEach(([m,h])=>{if(h<=0)return;const x=un[m];if(x&&p.counters[x.category]){const g=p.counters[x.category],b=u*h/100;r+=(g-1)*b,o++}})}),{multiplier:r,counterCount:o}},Wp=(t,s)=>{const{army:r,epoch:o,militaryBuffs:c=0}=t,{army:u,epoch:p,militaryBuffs:m=0,wealth:h=1e3}=s;let x=sd(r,o,c),g=sd(u,p,m);const b=m1(r,u),j=m1(u,r);x*=b.multiplier,g*=j.multiplier,g*=1.2;const _=.85+Math.random()*.3,N=.85+Math.random()*.3;x*=_,g*=N;const M=x+g,R=x/M,E=g/M,T=R>.5,D=Math.abs(R-.5)>.3,O=T?.1+E*.3:.3+E*.5,q=T?.4+R*.6:.2+R*.3,I={},Z={};Object.entries(r).forEach(([U,S])=>{I[U]=Math.floor(S*O)}),Object.entries(u).forEach(([U,S])=>{Z[U]=Math.floor(S*q)});let Y={};if(T){const S=h*(D?.08:.04);Y={food:Math.floor(S*.25),wood:Math.floor(S*.12),stone:Math.floor(S*.08),silver:Math.floor(S*.3),iron:Math.floor(S*.1),copper:Math.floor(S*.05),cloth:Math.floor(S*.05),tools:Math.floor(S*.05)},Object.keys(Y).forEach(Q=>{Y[Q]<=0&&delete Y[Q]})}return{victory:T,decisive:D,attackerPower:Math.floor(x),defenderPower:Math.floor(g),attackerAdvantage:(R*100).toFixed(1),defenderAdvantage:(E*100).toFixed(1),attackerLosses:I,defenderLosses:Z,attackerCounter:b.counterCount,defenderCounter:j.counterCount,loot:Y,battleReport:E5({victory:T,decisive:D,attackerPower:x,defenderPower:g,attackerCounter:b.counterCount,defenderCounter:j.counterCount,attackerLosses:I,defenderLosses:Z,loot:Y})}},E5=t=>{const{victory:s,decisive:r,attackerPower:o,defenderPower:c,attackerCounter:u,defenderCounter:p,attackerLosses:m,defenderLosses:h,loot:x}=t;let g=[];s?r?g.push(" "):g.push(" "):r?g.push(" "):g.push(" "),g.push(` ${Math.floor(o)} vs  ${Math.floor(c)}`),u>0&&g.push(`  ${u} `),p>0&&g.push(`  ${p} `);const b=Object.values(m).reduce((_,N)=>_+N,0),j=Object.values(h).reduce((_,N)=>_+N,0);if(g.push(`${b} `),g.push(`${j} `),s&&x){const _=Object.entries(x).filter(([,N])=>N>0).map(([N,M])=>`${N} ${M}`).join(", ");_&&g.push(`${_}`)}return g},Py=t=>{const s={};return Object.entries(t).forEach(([r,o])=>{if(o<=0)return;const c=un[r];c&&Object.entries(c.maintenanceCost).forEach(([u,p])=>{s[u]=(s[u]||0)+p*o})}),s},wf=t=>{let s=0;return Object.entries(t).forEach(([r,o])=>{if(o<=0)return;const c=un[r];c&&(s+=c.populationCost*o)}),s},k5={food_chain:{id:"food_chain",name:"",desc:"",unlockEpoch:0,stages:[{stage:"extraction",name:"",buildings:["farm","large_estate"],output:"food",efficiency:1,workers:["peasant","serf"]},{stage:"storage",name:"",buildings:["granary"],input:"food",output:"food",efficiency:1.1,bonus:{preservation:.05}},{stage:"processing",name:"",buildings:["culinary_kitchen"],input:"food",output:"delicacies",ratio:1.6,efficiency:1,workers:["artisan","peasant"]},{stage:"consumption",name:"",consumers:["all_classes"],input:"food"},{stage:"consumption",name:"",consumers:["merchant","official","landowner","capitalist","knight"],input:"delicacies",bonus:{approval:.1,stability:.05}}],upgrades:[{id:"irrigation",name:"",unlockEpoch:1,cost:{stone:200,wood:150},bonus:{efficiency:.15,output:.1}},{id:"crop_rotation",name:"",unlockEpoch:2,cost:{science:500},bonus:{efficiency:.2,sustainability:.15}},{id:"mechanized_farming",name:"",unlockEpoch:6,cost:{steel:300,tools:200},bonus:{efficiency:.4,workers:-.3}}]},wood_chain:{id:"wood_chain",name:"",desc:"",unlockEpoch:0,stages:[{stage:"extraction",name:"",buildings:["lumber_camp"],output:"wood",efficiency:1,workers:["lumberjack"]},{stage:"processing",name:"",buildings:["sawmill"],input:"wood",output:"plank",ratio:2.5,efficiency:1,workers:["worker","artisan"]},{stage:"advanced",name:"",buildings:["furniture_workshop"],input:["wood","stone"],output:"furniture",ratio:2.2,efficiency:1,workers:["artisan"]},{stage:"consumption",name:"",consumers:["buildings","ships","tools"],input:["wood","plank"]},{stage:"consumption",name:"",consumers:["merchant","official","landowner","capitalist","knight"],input:"furniture",bonus:{approval:.08,culture:.05}}],upgrades:[{id:"forestry_management",name:"",unlockEpoch:2,cost:{science:400,silver:200},bonus:{efficiency:.15,sustainability:.2}},{id:"advanced_sawmill",name:"",unlockEpoch:4,cost:{iron:150,tools:100},bonus:{processing:.25,waste:-.15}}]},textile_chain:{id:"textile_chain",name:"",desc:"",unlockEpoch:0,stages:[{stage:"extraction",name:"",buildings:["loom_house"],output:"cloth",efficiency:1,workers:["peasant"]},{stage:"processing",name:"",buildings:["dye_works"],input:"food",output:"dye",ratio:.4,efficiency:1,workers:["peasant","artisan"]},{stage:"advanced",name:"",buildings:["tailor_workshop"],input:["cloth","dye"],output:"fine_clothes",ratio:.8,efficiency:1,workers:["artisan"],bonus:{culture:.1}},{stage:"consumption",name:"",consumers:["all_classes"],input:"cloth",bonus:{approval:.05,stability:.02}},{stage:"consumption",name:"",consumers:["merchant","landowner","official","capitalist","knight"],input:"fine_clothes",bonus:{approval:.1,culture:.05}}],upgrades:[{id:"loom_standardization",name:"",unlockEpoch:1,cost:{wood:80,stone:30},bonus:{cloth_output:.2,efficiency:.15}},{id:"dyeworks_expansion",name:"",unlockEpoch:2,cost:{papyrus:60,silver:150},bonus:{dye_output:.25,efficiency:.15}}]},mining_chain:{id:"mining_chain",name:"",desc:"",unlockEpoch:1,stages:[{stage:"extraction",name:"",buildings:["quarry","copper_mine","mine","coal_mine"],output:["stone","copper","iron","coal"],efficiency:1,workers:["miner"]},{stage:"processing",name:"",buildings:["smelter","forge"],input:["copper","iron","coal"],output:["tools","steel"],efficiency:1,workers:["artisan","engineer"]},{stage:"advanced",name:"",buildings:["factory","steel_mill"],input:["iron","coal","tools"],output:"steel",efficiency:1,workers:["engineer","worker"]},{stage:"consumption",name:"",consumers:["military","buildings","machinery"],input:["tools","steel","iron"]}],upgrades:[{id:"deep_mining",name:"",unlockEpoch:3,cost:{iron:200,tools:150},bonus:{extraction:.25,depth:2}},{id:"blast_furnace",name:"",unlockEpoch:5,cost:{brick:300,coal:200},bonus:{processing:.35,efficiency:.2}},{id:"industrial_complex",name:"",unlockEpoch:6,cost:{steel:500,coal:400},bonus:{efficiency:.5,output:.3}}]},knowledge_chain:{id:"knowledge_chain",name:"",desc:"",unlockEpoch:2,stages:[{stage:"extraction",name:"",buildings:["reed_works"],output:"papyrus",efficiency:1,workers:["peasant","scribe"]},{stage:"processing",name:"",buildings:["library","scriptorium"],input:"papyrus",output:"culture",efficiency:1,workers:["scribe","scholar"]},{stage:"advanced",name:"",buildings:["printing_house","university"],input:["papyrus","culture"],output:["culture","science"],efficiency:1.2,workers:["scholar","scribe"]},{stage:"consumption",name:"",consumers:["education","research"],input:["culture","science"]}],upgrades:[{id:"printing_press",name:"",unlockEpoch:5,cost:{iron:150,tools:100},bonus:{efficiency:.4,spread:.5}},{id:"public_library",name:"",unlockEpoch:4,cost:{brick:300,papyrus:200},bonus:{access:.3,culture:.2}}]},luxury_chain:{id:"luxury_chain",name:"",desc:"",unlockEpoch:4,stages:[{stage:"extraction",name:"",buildings:["spice_market","coffee_plantation"],output:["spice","coffee"],efficiency:1,workers:["merchant","serf"]},{stage:"processing",name:"",buildings:["coffee_house","trade_port"],input:["spice","coffee"],output:"culture",efficiency:1,workers:["merchant","artisan"]},{stage:"consumption",name:"",consumers:["noble","merchant","scholar"],input:["spice","coffee"],bonus:{approval:.15}}],upgrades:[{id:"trade_network",name:"",unlockEpoch:5,cost:{silver:500,plank:200},bonus:{efficiency:.3,price:.2}},{id:"luxury_monopoly",name:"",unlockEpoch:5,cost:{silver:800},bonus:{profit:.5,influence:.25}}]},military_chain:{id:"military_chain",name:"",desc:"",unlockEpoch:1,stages:[{stage:"extraction",name:"",buildings:["mine","copper_mine"],output:["iron","copper"],efficiency:1,workers:["miner"]},{stage:"processing",name:"",buildings:["forge","armory"],input:["iron","copper","coal"],output:"weapons",efficiency:1,workers:["artisan","engineer"]},{stage:"advanced",name:"",buildings:["barracks","training_ground"],input:["weapons","food"],output:"military_power",efficiency:1,workers:["soldier"]},{stage:"consumption",name:"",consumers:["defense","conquest","patrol"],input:["military_power","food","silver"]}],upgrades:[{id:"standardized_weapons",name:"",unlockEpoch:4,cost:{iron:300,tools:200},bonus:{efficiency:.25,cost:-.15}},{id:"military_logistics",name:"",unlockEpoch:5,cost:{silver:600,plank:300},bonus:{supply:.3,mobility:.2}},{id:"arms_factory",name:"",unlockEpoch:6,cost:{steel:400,coal:300},bonus:{production:.5,quality:.3}}]}},Dy={epoch0:[{id:"stone_harvest_blessing",name:"",description:"",icon:"Wheat",type:"temporary",duration:360,effects:{categories:{gather:.25}},flavorText:""},{id:"stone_fertility_rite",name:"",description:"",icon:"Users",type:"temporary",duration:360,effects:{maxPop:5},flavorText:""},{id:"stone_tool_innovation",name:"",description:"",icon:"Wrench",type:"permanent",effects:{production:.05},flavorText:""},{id:"stone_hunting_ritual",name:"",description:"",icon:"Target",type:"temporary",duration:360,effects:{categories:{gather:.2},stability:.1},flavorText:""},{id:"stone_fire_mastery",name:"",description:"",icon:"Flame",type:"permanent",effects:{industry:.06},flavorText:""},{id:"stone_tribal_unity",name:"",description:"",icon:"Heart",type:"temporary",duration:360,effects:{stability:.2},flavorText:""},{id:"stone_cave_painting",name:"",description:"",icon:"Image",type:"permanent",effects:{cultureBonus:.08},flavorText:""},{id:"stone_elder_wisdom",name:"",description:"",icon:"BookOpen",type:"temporary",duration:360,effects:{production:.15,stability:.15},flavorText:""},{id:"stone_spirit_dance",name:"",description:"",icon:"Music",type:"temporary",duration:360,effects:{maxPop:8,stability:.12},flavorText:""},{id:"stone_stone_working",name:"",description:"",icon:"Hammer",type:"permanent",effects:{categories:{gather:.1}},flavorText:""}],epoch1:[{id:"bronze_trade_fair",name:"",description:"",icon:"ShoppingCart",type:"temporary",duration:360,effects:{taxIncome:.3},flavorText:""},{id:"bronze_military_parade",name:"",description:"",icon:"Shield",type:"temporary",duration:360,effects:{militaryBonus:.15},flavorText:""},{id:"bronze_metallurgy_advance",name:"",description:"",icon:"Flame",type:"permanent",effects:{industry:.08},flavorText:""},{id:"bronze_irrigation_festival",name:"",description:"",icon:"Droplet",type:"temporary",duration:360,effects:{categories:{gather:.35}},flavorText:""},{id:"bronze_writing_system",name:"",description:"",icon:"FileText",type:"permanent",effects:{cultureBonus:.1,scienceBonus:.1},flavorText:""},{id:"bronze_warrior_training",name:"",description:"",icon:"Swords",type:"temporary",duration:360,effects:{militaryBonus:.25,stability:.15},flavorText:""},{id:"bronze_merchant_guild",name:"",description:"",icon:"Coins",type:"permanent",effects:{taxIncome:.12},flavorText:""},{id:"bronze_temple_blessing",name:"",description:"",icon:"Church",type:"temporary",duration:360,effects:{production:.18,stability:.2,cultureBonus:.15},flavorText:""},{id:"bronze_wheel_invention",name:"",description:"",icon:"Circle",type:"permanent",effects:{production:.08,taxIncome:.1},flavorText:""},{id:"bronze_bronze_age_prosperity",name:"",description:"",icon:"TrendingUp",type:"temporary",duration:360,effects:{industry:.25,maxPop:12,taxIncome:.2},flavorText:""}],epoch2:[{id:"classical_philosophy_debate",name:"",description:"",icon:"BookOpen",type:"temporary",duration:360,effects:{scienceBonus:.25,cultureBonus:.25},flavorText:""},{id:"classical_olympic_games",name:"",description:"",icon:"Award",type:"temporary",duration:360,effects:{stability:.15,maxPop:10},flavorText:""},{id:"classical_architecture_school",name:"",description:"",icon:"Building",type:"permanent",effects:{categories:{industry:.1}},flavorText:""},{id:"classical_library_foundation",name:"",description:"",icon:"Library",type:"permanent",effects:{scienceBonus:.12,cultureBonus:.12},flavorText:""},{id:"classical_senate_reform",name:"",description:"",icon:"Scale",type:"temporary",duration:360,effects:{stability:.25},flavorText:""},{id:"classical_aqueduct_celebration",name:"",description:"",icon:"Waves",type:"temporary",duration:360,effects:{maxPop:15,production:.2},flavorText:""},{id:"classical_legion_triumph",name:"",description:"",icon:"Trophy",type:"temporary",duration:360,effects:{militaryBonus:.3,taxIncome:.25,stability:.18},flavorText:""},{id:"classical_theater_arts",name:"",description:"",icon:"Drama",type:"permanent",effects:{cultureBonus:.15,stability:.08},flavorText:""},{id:"classical_trade_routes",name:"",description:"",icon:"Route",type:"permanent",effects:{taxIncome:.15,production:.08},flavorText:""},{id:"classical_golden_age",name:"",description:"",icon:"Sun",type:"temporary",duration:360,effects:{production:.25,scienceBonus:.3,cultureBonus:.3,stability:.2},flavorText:""}],epoch3:[{id:"feudal_knights_tournament",name:"",description:"",icon:"Sword",type:"temporary",duration:360,effects:{militaryBonus:.2,cultureBonus:.15},flavorText:""},{id:"feudal_harvest_festival",name:"",description:"",icon:"Leaf",type:"temporary",duration:360,effects:{categories:{gather:.3},taxIncome:.2},flavorText:""},{id:"feudal_guild_system",name:"",description:"",icon:"Users",type:"permanent",effects:{production:.05},flavorText:""},{id:"feudal_castle_construction",name:"",description:"",icon:"Castle",type:"temporary",duration:360,effects:{militaryBonus:.25,stability:.2},flavorText:""},{id:"feudal_monastery_learning",name:"",description:"",icon:"BookHeart",type:"permanent",effects:{scienceBonus:.1,cultureBonus:.12},flavorText:""},{id:"feudal_manor_system",name:"",description:"",icon:"Home",type:"temporary",duration:360,effects:{production:.22,taxIncome:.25,categories:{gather:.2}},flavorText:""},{id:"feudal_crusade_fervor",name:"",description:"",icon:"Cross",type:"temporary",duration:360,effects:{militaryBonus:.35,cultureBonus:.2,stability:.15},flavorText:""},{id:"feudal_market_charter",name:"",description:"",icon:"Store",type:"permanent",effects:{taxIncome:.18},flavorText:""},{id:"feudal_chivalry_code",name:"",description:"",icon:"Heart",type:"permanent",effects:{militaryBonus:.12,cultureBonus:.1,stability:.08},flavorText:""},{id:"feudal_feudal_prosperity",name:"",description:"",icon:"Crown",type:"temporary",duration:360,effects:{production:.2,maxPop:18,stability:.18},flavorText:""}],epoch4:[{id:"exploration_discovery_expo",name:"",description:"",icon:"Compass",type:"temporary",duration:360,effects:{scienceBonus:.3,taxIncome:.25},flavorText:""},{id:"exploration_naval_review",name:"",description:"",icon:"Anchor",type:"temporary",duration:360,effects:{militaryBonus:.25,stability:.2},flavorText:""},{id:"exploration_navigation_school",name:"",description:"",icon:"Map",type:"permanent",effects:{production:.1,scienceBonus:.08},flavorText:""},{id:"exploration_colonial_trade",name:"",description:"",icon:"Ship",type:"temporary",duration:360,effects:{taxIncome:.4,production:.15},flavorText:""},{id:"exploration_cartography",name:"",description:"",icon:"MapPin",type:"permanent",effects:{scienceBonus:.12,taxIncome:.15},flavorText:""},{id:"exploration_spice_trade",name:"",description:"",icon:"Coffee",type:"temporary",duration:360,effects:{taxIncome:.35,cultureBonus:.2,stability:.15},flavorText:""},{id:"exploration_printing_press",name:"",description:"",icon:"Printer",type:"permanent",effects:{cultureBonus:.15,scienceBonus:.15},flavorText:""},{id:"exploration_renaissance_art",name:"",description:"",icon:"Palette",type:"temporary",duration:360,effects:{cultureBonus:.4,stability:.25,scienceBonus:.2},flavorText:""},{id:"exploration_gunpowder_weapons",name:"",description:"",icon:"Zap",type:"permanent",effects:{militaryBonus:.18,industry:.1},flavorText:""},{id:"exploration_age_of_discovery",name:"",description:"",icon:"Globe",type:"temporary",duration:360,effects:{production:.25,scienceBonus:.3,taxIncome:.35,stability:.2},flavorText:""}],epoch5:[{id:"enlightenment_science_fair",name:"",description:"",icon:"Microscope",type:"temporary",duration:360,effects:{scienceBonus:.4},flavorText:""},{id:"enlightenment_salon_culture",name:"",description:"",icon:"Coffee",type:"temporary",duration:360,effects:{cultureBonus:.35},flavorText:""},{id:"enlightenment_education_reform",name:"",description:"",icon:"GraduationCap",type:"permanent",effects:{scienceBonus:.12,cultureBonus:.12},flavorText:""},{id:"enlightenment_constitution",name:"",description:"",icon:"FileText",type:"temporary",duration:360,effects:{stability:.35,cultureBonus:.2},flavorText:""},{id:"enlightenment_encyclopedia",name:"",description:"",icon:"Book",type:"permanent",effects:{scienceBonus:.18,cultureBonus:.15},flavorText:""},{id:"enlightenment_free_trade",name:"",description:"",icon:"TrendingUp",type:"temporary",duration:360,effects:{taxIncome:.4,production:.25,stability:.15},flavorText:""},{id:"enlightenment_scientific_method",name:"",description:"",icon:"Beaker",type:"permanent",effects:{scienceBonus:.2,production:.1},flavorText:""},{id:"enlightenment_industrial_dawn",name:"",description:"",icon:"Cog",type:"temporary",duration:360,effects:{industry:.35,production:.3,scienceBonus:.2},flavorText:""},{id:"enlightenment_human_rights",name:"",description:"",icon:"Users",type:"permanent",effects:{stability:.15,cultureBonus:.12},flavorText:""},{id:"enlightenment_age_of_reason",name:"",description:"",icon:"Brain",type:"temporary",duration:360,effects:{scienceBonus:.35,cultureBonus:.35,stability:.25},flavorText:""}],epoch6:[{id:"industrial_world_fair",name:"",description:"",icon:"Globe",type:"temporary",duration:360,effects:{production:.2,scienceBonus:.25,cultureBonus:.25,taxIncome:.3},flavorText:""},{id:"industrial_labor_movement",name:"",description:"",icon:"Briefcase",type:"temporary",duration:360,effects:{stability:.25,industry:.2},flavorText:""},{id:"industrial_assembly_line",name:"",description:"",icon:"Factory",type:"permanent",effects:{industry:.15,production:.12},flavorText:""},{id:"industrial_railway_network",name:"",description:"",icon:"Train",type:"temporary",duration:360,effects:{taxIncome:.35,production:.3},flavorText:""},{id:"industrial_steel_production",name:"",description:"",icon:"Hammer",type:"permanent",effects:{industry:.18,militaryBonus:.15,production:.1},flavorText:""},{id:"industrial_telegraph_system",name:"",description:"",icon:"Radio",type:"temporary",duration:360,effects:{taxIncome:.25,stability:.2},flavorText:""},{id:"industrial_public_health",name:"",description:"",icon:"Heart",type:"permanent",effects:{maxPop:25,stability:.12,production:.08},flavorText:""},{id:"industrial_urbanization",name:"",description:"",icon:"Building2",type:"temporary",duration:360,effects:{maxPop:30,industry:.25,taxIncome:.3},flavorText:""},{id:"industrial_electricity",name:"",description:"",icon:"Zap",type:"permanent",effects:{production:.15,industry:.2,scienceBonus:.15,cultureBonus:.1},flavorText:""},{id:"industrial_golden_era",name:"",description:"",icon:"Award",type:"temporary",duration:360,effects:{production:.3,industry:.35,taxIncome:.4,stability:.25},flavorText:""}],epoch7:[{id:"modern_innovation_summit",name:"",description:"",icon:"Lightbulb",type:"temporary",duration:360,effects:{scienceBonus:.5,production:.25},flavorText:""},{id:"modern_cultural_renaissance",name:"",description:"",icon:"Palette",type:"temporary",duration:360,effects:{cultureBonus:.45,stability:.3},flavorText:""},{id:"modern_digital_revolution",name:"",description:"",icon:"Cpu",type:"permanent",effects:{production:.15,scienceBonus:.15,cultureBonus:.15},flavorText:""},{id:"modern_space_program",name:"",description:"",icon:"Rocket",type:"temporary",duration:360,effects:{scienceBonus:.45,cultureBonus:.35,stability:.25},flavorText:""},{id:"modern_internet_age",name:"",description:"",icon:"Wifi",type:"permanent",effects:{scienceBonus:.2,cultureBonus:.18,taxIncome:.2},flavorText:""},{id:"modern_green_energy",name:"",description:"",icon:"Leaf",type:"temporary",duration:360,effects:{production:.3,stability:.28,industry:.25},flavorText:""},{id:"modern_ai_revolution",name:"",description:"AI",icon:"Brain",type:"permanent",effects:{scienceBonus:.25,production:.2,industry:.2},flavorText:""},{id:"modern_biotech_breakthrough",name:"",description:"",icon:"Dna",type:"temporary",duration:360,effects:{maxPop:40,scienceBonus:.4,stability:.22},flavorText:""},{id:"modern_global_cooperation",name:"",description:"",icon:"Globe",type:"permanent",effects:{stability:.2,taxIncome:.25,cultureBonus:.15},flavorText:""},{id:"modern_information_age",name:"",description:"",icon:"Database",type:"temporary",duration:360,effects:{scienceBonus:.45,cultureBonus:.4,production:.3,stability:.25},flavorText:""}]},C5=t=>{const s=`epoch${t}`;return Dy[s]||[]},T5=t=>{const s=C5(t);if(s.length<=3)return[...s];const r=[...s];for(let o=r.length-1;o>0;o--){const c=Math.floor(Math.random()*(o+1));[r[o],r[c]]=[r[c],r[o]]}return r.slice(0,3)},S5=12,L0=30,A5=["","","","","","","","","","","",""],pp=[{name:"",months:[3,4,5]},{name:"",months:[6,7,8]},{name:"",months:[9,10,11]},{name:"",months:[12,1,2]}],id=(t=0)=>{const s=Math.max(0,Math.floor(t))+1,r=S5*L0,o=Math.floor((s-1)/r)+1,c=(s-1)%r+1,u=Math.floor((c-1)/L0)+1,p=(c-1)%L0+1,m=A5[u-1]||`${u}`,h=pp.find(g=>g.months.includes(u))||pp[0],x=h.months.indexOf(u)*L0+p;return{totalDays:s,year:o,month:u,monthName:m,day:p,dayOfYear:c,season:h.name,seasonIndex:pp.indexOf(h),seasonDay:x,formatted:`${o} ${h.name}  ${m}${p}`}},V0="civ_game_save_data_v1",uc="civ_game_autosave_v1",h1={food:200,wood:200,stone:200,cloth:80,plank:0,brick:0,iron:0,tools:0,copper:0,papyrus:0,spice:0,coffee:0,coal:0,steel:0,silver:400,science:0,culture:300},x1=()=>{const t={};return Object.keys(Ke).forEach(s=>{t[s]=Ke[s].startingWealth||0}),t},g1=()=>{const t={};return Object.keys(Ke).forEach(s=>{t[s]=[]}),t},y1=()=>{const t={};return Object.keys(Ke).forEach(s=>{t[s]=[]}),t},b1=()=>{const t={};return Object.keys(Ke).forEach(s=>{t[s]={streak:0,level:null}}),t},v1=()=>{const t={};return Object.keys(Ke).forEach(s=>{t[s]={pop:[],income:[],expense:[]}}),{treasury:[],tax:[],population:[],class:t}},j1=()=>({pendingTrades:[],lastTradeTime:0,lockedCapital:0}),w1={approval:{duration:30,decayRate:.04},stability:{duration:30,decayRate:.04},resourceDemand:{duration:60,decayRate:.02},stratumDemand:{duration:60,decayRate:.02},buildingProduction:{duration:45,decayRate:.025}},P5=()=>({approval:[],stability:[],resourceDemand:[],stratumDemand:[],buildingProduction:[]}),N1=()=>({routes:[]}),D5=t=>{if(!t||!Array.isArray(t))return nd;const s={};return t.forEach(r=>{s[r.id]=r.active}),nd.map(r=>({...r,active:s[r.id]??r.active}))},Ry=t=>{if(t==="silver")return!1;const s=Re[t];return s?!s.type||s.type!=="virtual":!1},M1=()=>{const t={};return Object.keys(Re).forEach(s=>{Ry(s)&&(t[s]=Math.max(.5,Re[s].basePrice||1))}),{prices:t,demand:{},supply:{},wages:{},priceHistory:{},supplyHistory:{},demandHistory:{}}},_1=()=>{const t={};return Object.keys(Ke).forEach(s=>{t[s]=1}),t},E1=()=>{const t={};return Object.keys(Re).forEach(s=>{Ry(s)&&(t[s]=.05)}),t},k1=()=>({}),C1=()=>t5.map(t=>{const s={};t.economyTraits?.resourceBias&&Object.entries(t.economyTraits.resourceBias).forEach(([j,_])=>{_>1?s[j]=Math.floor(500*(1.2+Math.random()*.6)):_<1?s[j]=Math.floor(500*(.2+Math.random()*.3)):s[j]=Math.floor(500*(.8+Math.random()*.4))});const o=t.wealth??800,c=Math.floor(o*.5),u=t.appearEpoch??0,p=Math.max(.4,o/800),m=typeof t.marketVolatility=="number"?Math.min(.9,Math.max(.1,t.marketVolatility)):.3,h=t.culturalTraits?.agriculturalFocus?1.15:1,x=Math.min(2.5,Math.max(.6,p*h)),g=Math.min(3.5,Math.max(.5,p*(1+Math.max(0,u)*.05))),b=1e3+Math.floor(Math.random()*500);return{...t,relation:50,warScore:t.warScore??0,isAtWar:t.isAtWar??!1,wealth:o,budget:c,inventory:s,enemyLosses:0,warDuration:0,warStartDay:null,militaryStrength:1,population:b,wealthTemplate:o,foreignPower:{baseRating:p,volatility:m,appearEpoch:u,populationFactor:x,wealthFactor:g},economyTraits:{...t.economyTraits,baseWealth:o,basePopulation:b}}}),R5=()=>{const[t,s]=$.useState(h1),[r,o]=$.useState(5),[c,u]=$.useState({}),[p,m]=$.useState(10),[h,x]=$.useState(0),[g,b]=$.useState(0),[j,_]=$.useState({}),[N,M]=$.useState([]),[R,E]=$.useState(0),[T,D]=$.useState("build"),[O,q]=$.useState(1),[I,Z]=$.useState(!1),[Y,U]=$.useState(!1),[S,Q]=$.useState(60),[ne,Ne]=$.useState(!0),[$e,de]=$.useState(()=>Date.now()),[P,z]=$.useState(!1),V=$.useRef(null),[F,re]=$.useState(nd),[C,L]=$.useState(C1()),[ie,H]=$.useState({}),[ve,me]=$.useState({}),[X,qe]=$.useState(x1()),[fe,Je]=$.useState({}),[tt,Mt]=$.useState({}),[jt,ot]=$.useState({}),[B,Ue]=$.useState(g1()),[ht,ft]=$.useState(y1()),[$t,It]=$.useState(0),[oe,Ye]=$.useState(0),[bt,Pe]=$.useState([]),[lt,Vt]=$.useState([]),[oa,Ka]=$.useState({}),[gn,Zt]=$.useState(50),[la,qt]=$.useState(null),[Gt,kt]=$.useState(null),[ta,Ht]=$.useState({}),[se,pe]=$.useState({}),[he,K]=$.useState(b1()),[je,J]=$.useState(!1),[le,ue]=$.useState(v1()),[Me,Ie]=$.useState(w1),[at,Ze]=$.useState(P5()),[Ce,rt]=$.useState(0),[zt,Ve]=$.useState({}),[ca,ha]=$.useState([]),[Ra,xe]=$.useState(null),[Tt,et]=$.useState(null),[Ae,it]=$.useState([]),[Xe,be]=$.useState(1.5),[Qt,gt]=$.useState(null),[Rt,ua]=$.useState([]),[An,wa]=$.useState(1),[Na,ze]=$.useState(j1),[Pn,ja]=$.useState(N1),[vs,Vn]=$.useState({tradeTax:0}),[ns,us]=$.useState({}),[ps,Ti]=$.useState({}),[Qr,js]=$.useState([]),[Si,Wn]=$.useState(null),[fs,xa]=$.useState({}),[qs,hi]=$.useState(()=>!localStorage.getItem("tutorial_completed")),[Un,Vi]=$.useState(null),[Ai,oi]=$.useState([]),[Dn,xi]=$.useState([" 1 "]),[Wi,li]=$.useState([]),[ws,Ui]=$.useState({}),[Gs,Ds]=$.useState({total:0,breakdown:{headTax:0,industryTax:0,subsidy:0,policyIncome:0,policyExpense:0},efficiency:1}),[Jr,gi]=$.useState({headTaxRates:_1(),resourceTaxRates:E1(),businessTaxRates:k1()}),[Fs,Oe]=$.useState({}),[Ge,dt]=$.useState({}),[Nt,st]=$.useState(M1());$.useEffect(()=>()=>{V.current&&clearTimeout(V.current)},[]);const Ct=Ee=>{xi(We=>[Ee,...We].slice(0,8))};$.useEffect(()=>{if(!(typeof window>"u"))try{const Ee=localStorage.getItem(uc);if(!Ee)return;const We=localStorage.getItem(V0);if(!We){Ct(" ");return}const xt=JSON.parse(Ee),Fa=JSON.parse(We);(xt?.updatedAt||0)>(Fa?.updatedAt||0)&&Ct(" ")}catch(Ee){console.warn("Auto-save detection failed:",Ee)}},[]);const He=()=>{z(!0),V.current&&clearTimeout(V.current),V.current=setTimeout(()=>{z(!1),V.current=null},1e3)};return{resources:t,setResources:s,market:Nt,setMarket:st,population:r,setPopulation:o,popStructure:c,setPopStructure:u,maxPop:p,setMaxPop:m,maxPopBonus:g,setMaxPopBonus:b,birthAccumulator:h,setBirthAccumulator:x,buildings:j,setBuildings:_,techsUnlocked:N,setTechsUnlocked:M,epoch:R,setEpoch:E,daysElapsed:Ce,setDaysElapsed:rt,activeTab:T,setActiveTab:D,gameSpeed:O,setGameSpeed:q,isPaused:I,setIsPaused:Z,pausedBeforeEvent:Y,setPausedBeforeEvent:U,autoSaveInterval:S,setAutoSaveInterval:Q,isAutoSaveEnabled:ne,setIsAutoSaveEnabled:Ne,lastAutoSaveTime:$e,setLastAutoSaveTime:de,isSaving:P,decrees:F,setDecrees:re,nations:C,setNations:L,selectedTarget:Ra,setSelectedTarget:xe,classApproval:ie,setClassApproval:H,classInfluence:ve,setClassInfluence:me,classWealth:X,setClassWealth:qe,classWealthDelta:fe,setClassWealthDelta:Je,classIncome:tt,setClassIncome:Mt,classExpense:jt,setClassExpense:ot,classWealthHistory:B,setClassWealthHistory:Ue,classNeedsHistory:ht,setClassNeedsHistory:ft,totalInfluence:$t,setTotalInfluence:It,totalWealth:oe,setTotalWealth:Ye,activeBuffs:bt,setActiveBuffs:Pe,activeDebuffs:lt,setActiveDebuffs:Vt,classInfluenceShift:oa,setClassInfluenceShift:Ka,stability:gn,setStability:Zt,stratumDetailView:la,setStratumDetailView:qt,resourceDetailView:Gt,setResourceDetailView:kt,classShortages:ta,setClassShortages:Ht,classLivingStandard:se,setClassLivingStandard:pe,livingStandardStreaks:he,setLivingStandardStreaks:K,populationDetailView:je,setPopulationDetailView:J,history:le,setHistory:ue,eventEffectSettings:Me,setEventEffectSettings:Ie,activeEventEffects:at,setActiveEventEffects:Ze,army:zt,setArmy:Ve,militaryQueue:ca,setMilitaryQueue:ha,battleResult:Tt,setBattleResult:et,battleNotifications:Ae,setBattleNotifications:it,militaryWageRatio:Xe,setMilitaryWageRatio:be,festivalModal:Qt,setFestivalModal:gt,activeFestivalEffects:Rt,setActiveFestivalEffects:ua,lastFestivalYear:An,setLastFestivalYear:wa,merchantState:Na,setMerchantState:ze,tradeRoutes:Pn,setTradeRoutes:ja,tradeStats:vs,setTradeStats:Vn,actionCooldowns:ns,setActionCooldowns:us,actionUsage:ps,setActionUsage:Ti,promiseTasks:Qr,setPromiseTasks:js,showTutorial:qs,setShowTutorial:hi,currentEvent:Un,setCurrentEvent:Vi,eventHistory:Ai,setEventHistory:oi,playerInstallmentPayment:Si,setPlayerInstallmentPayment:Wn,rebellionStates:fs,setRebellionStates:xa,logs:Dn,setLogs:xi,clicks:Wi,setClicks:li,rates:ws,setRates:Ui,taxes:Gs,setTaxes:Ds,taxPolicies:Jr,setTaxPolicies:gi,jobFill:Fs,setJobFill:Oe,jobsAvailable:Ge,setJobsAvailable:dt,saveGame:({source:Ee="manual"}={})=>{try{const We=Date.now(),Fa={resources:t,population:r,popStructure:c,maxPop:p,maxPopBonus:g,birthAccumulator:h,buildings:j,techsUnlocked:N,epoch:R,activeTab:T,gameSpeed:O,isPaused:I,decrees:F,nations:C,classApproval:ie,classInfluence:ve,classWealth:X,classWealthDelta:fe,classIncome:tt,classExpense:jt,classWealthHistory:B,classNeedsHistory:ht,totalInfluence:$t,totalWealth:oe,activeBuffs:bt,activeDebuffs:lt,classInfluenceShift:oa,stability:gn,stratumDetailView:la,resourceDetailView:Gt,classShortages:ta,classLivingStandard:se,livingStandardStreaks:he,populationDetailView:je,history:le,daysElapsed:Ce,army:zt,militaryQueue:ca,selectedTarget:Ra,battleResult:Tt,militaryWageRatio:Xe,festivalModal:Qt,activeFestivalEffects:Rt,lastFestivalYear:An,showTutorial:qs,currentEvent:Un,eventHistory:Ai,logs:Dn,clicks:Wi,rates:ws,taxes:Gs,taxPolicies:Jr,jobFill:Fs,market:Nt,merchantState:Na,tradeRoutes:Pn,tradeStats:vs,eventEffectSettings:Me,activeEventEffects:at,rebellionStates:fs,actionCooldowns:ns,actionUsage:ps,promiseTasks:Qr,autoSaveInterval:S,isAutoSaveEnabled:ne,lastAutoSaveTime:Ee==="auto"?We:$e,updatedAt:We,saveSource:Ee},nt=Ee==="auto"?uc:V0;localStorage.setItem(nt,JSON.stringify(Fa)),He(),Ee==="auto"?de(We):Ct(" ")}catch(We){console.error(`${Ee==="auto"?"Auto":"Manual"} save failed:`,We),Ct(Ee==="auto"?` ${We.message}`:` ${We.message}`),z(!1)}},loadGame:({source:Ee="manual"}={})=>{try{const We=Ee==="auto"?uc:V0,xt=Ee==="auto"?"":"",Fa=localStorage.getItem(We);if(!Fa){Ct(` ${xt}`);return}const nt=JSON.parse(Fa);s(nt.resources||h1),o(nt.population??5),u(nt.popStructure||{}),m(nt.maxPop??10),b(nt.maxPopBonus||0),x(nt.birthAccumulator||0),_(nt.buildings||{}),M(nt.techsUnlocked||[]),E(nt.epoch??0),D(nt.activeTab||"build"),q(nt.gameSpeed??1),Z(nt.isPaused??!1),re(D5(nt.decrees)),L(nt.nations||C1()),H(nt.classApproval||{}),me(nt.classInfluence||{}),qe(nt.classWealth||x1()),Je(nt.classWealthDelta||{}),Mt(nt.classIncome||{}),ot(nt.classExpense||{}),Ue(nt.classWealthHistory||g1()),ft(nt.classNeedsHistory||y1()),It(nt.totalInfluence||0),Ye(nt.totalWealth||0),Pe(nt.activeBuffs||[]),Vt(nt.activeDebuffs||[]),Ka(nt.classInfluenceShift||{}),Zt(nt.stability??50),qt(nt.stratumDetailView||null),kt(nt.resourceDetailView||null),Ht(nt.classShortages||{}),pe(nt.classLivingStandard||{}),K(nt.livingStandardStreaks||b1()),J(nt.populationDetailView||!1),ue(nt.history||v1()),rt(nt.daysElapsed||0),Ve(nt.army||{}),ha(nt.militaryQueue||[]),xe(nt.selectedTarget||null),et(nt.battleResult||null),be(nt.militaryWageRatio||1.5),gt(nt.festivalModal||null),ua(nt.activeFestivalEffects||[]),wa(nt.lastFestivalYear||1),hi(nt.showTutorial??!0),Vi(nt.currentEvent||null),oi(nt.eventHistory||[]),xi(nt.logs||[]),li(nt.clicks||[]),Ui(nt.rates||{}),Ds(nt.taxes||{total:0,breakdown:{headTax:0,industryTax:0,subsidy:0,policyIncome:0,policyExpense:0},efficiency:1}),gi(nt.taxPolicies||{headTaxRates:_1(),resourceTaxRates:E1(),businessTaxRates:k1()}),Oe(nt.jobFill||{}),st(nt.market||M1()),ze(nt.merchantState||j1()),ja(nt.tradeRoutes||N1()),Vn(nt.tradeStats||{tradeTax:0}),Q(nt.autoSaveInterval??60),Ne(nt.isAutoSaveEnabled??!0),de(nt.lastAutoSaveTime||Date.now()),Ie(nt.eventEffectSettings||w1);const Jt=nt.activeEventEffects||{};Ze({approval:Array.isArray(Jt.approval)?Jt.approval:[],stability:Array.isArray(Jt.stability)?Jt.stability:[],resourceDemand:Array.isArray(Jt.resourceDemand)?Jt.resourceDemand:[],stratumDemand:Array.isArray(Jt.stratumDemand)?Jt.stratumDemand:[],buildingProduction:Array.isArray(Jt.buildingProduction)?Jt.buildingProduction:[]}),xa(nt.rebellionStates||{}),us(nt.actionCooldowns||{}),Ti(nt.actionUsage||{}),js(nt.promiseTasks||[]),Ct(Ee==="auto"?" ":" ")}catch(We){console.error("Load game failed:",We),Ct(` ${We.message}`)}},hasAutoSave:()=>typeof window>"u"?!1:!!localStorage.getItem(uc),resetGame:()=>{typeof window>"u"||!window.confirm("")||(localStorage.removeItem(V0),localStorage.removeItem(uc),window.location.reload())}}},si=(t,s,r=[])=>{const o=Re[t];return!(!o||o.unlockTech&&!r.includes(o.unlockTech)||typeof o.unlockEpoch=="number"&&o.unlockEpoch>s)},vl=(t,s,r=[])=>{if(!t)return{};const o={};for(const[c,u]of Object.entries(t))si(c,s,r)&&(o[c]=u);return o},T1=t=>Re[t]?.basePrice||1,jl=(t,s,r=0)=>{if(!s)return T1(t);const o=T1(t),c=s?.economyTraits?.resourceBias?.[t]??1,u=s.inventory?.[t]||0,p=500,m=Math.max(.8,Math.min(1.5,(s.wealth||1e3)/1e3)),x=1+(s.epoch||0)*.2,g=p*m*x,b=g>0?u/g:1,j=Math.max(0,1-b),_=Math.max(0,b-1),N=1+Math.min(2.5,j*.9),M=1-Math.min(.95,_*.6),R=N*M,T=1+(Math.max(.6,Math.min(1.6,c))-1)*.25,O=s.isAtWar||s.foreignWars&&Object.values(s.foreignWars).some(I=>I?.isAtWar)?1.1+(s.aggression||.2)*.3:1;let q=o*T*R*O;return q=Math.max(o*.25,Math.min(o*3.5,q)),Math.max(.5,parseFloat(q.toFixed(2)))},$5=(t="")=>t?t.split("").reduce((s,r)=>s+r.charCodeAt(0),0):0,gl=(t,s={},r=0)=>{const c=Math.max(.8,Math.min(1.5,(s.wealth||1e3)/1e3)),p=1+(s.epoch||0)*.2,m=500*c*p,h=typeof s.marketVolatility=="number"?s.marketVolatility:.3,x=s?.inventory?.[t]||0,g=$5(t),b=Math.sin(r*.05+g),j=m*(1+b*h),_=j*.9,N=j*1.1,M=Math.max(0,_-x),R=Math.max(0,x-N);return{isShortage:M>0,isSurplus:R>0,shortageAmount:M,surplusAmount:R,target:j}},cl={DESTITUTE:{level:"",icon:"Skull",color:"text-gray-400",bgColor:"bg-gray-900/30",borderColor:"border-gray-500/30",approvalCap:30},POOR:{level:"",icon:"AlertTriangle",color:"text-red-400",bgColor:"bg-red-900/20",borderColor:"border-red-500/30",approvalCap:50},SUBSISTENCE:{level:"",icon:"UtensilsCrossed",color:"text-yellow-400",bgColor:"bg-yellow-900/20",borderColor:"border-yellow-500/30",approvalCap:70},COMFORTABLE:{level:"",icon:"Home",color:"text-green-400",bgColor:"bg-green-900/20",borderColor:"border-green-500/30",approvalCap:85},PROSPEROUS:{level:"",icon:"Gem",color:"text-blue-400",bgColor:"bg-blue-900/20",borderColor:"border-blue-500/30",approvalCap:95},LUXURIOUS:{level:"",icon:"Crown",color:"text-purple-400",bgColor:"bg-purple-900/20",borderColor:"border-purple-500/30",approvalCap:100}};function O5(t){let s;return t<=0?s=.3:t<1?s=.3+t*.7:s=Math.sqrt(t)*(1+Math.log(t)*.25),Math.max(.3,Math.min(6,s))}function z5(t,s=1,r=0){return t<.5?cl.DESTITUTE:t<1||s<.5?cl.POOR:t<2||r===0?cl.SUBSISTENCE:t<4||r<.3?cl.COMFORTABLE:t<8||r<.7?cl.PROSPEROUS:cl.LUXURIOUS}function B5(t,s,r){const o=Math.min(40,t*4),c=s*30,u=r*30;return Math.min(100,o+c+u)}function $y({count:t,wealthValue:s,startingWealth:r,shortagesCount:o=0,effectiveNeedsCount:c=0,unlockedLuxuryTiers:u=0,totalLuxuryTiers:p=0}){const m=t>0?s/t:0,h=r>0?m/r:0,x=O5(h),g=c>0?Math.max(0,(c-o)/c):1,b=p>0?u/p:0,j=z5(h,g,b),_=B5(h,g,b);return{wealthPerCapita:m,wealthRatio:h,wealthMultiplier:x,satisfactionRate:g,luxuryUnlockRatio:b,unlockedLuxuryTiers:u,totalLuxuryTiers:p,level:j.level,icon:j.icon,color:j.color,bgColor:j.bgColor,borderColor:j.borderColor,approvalCap:j.approvalCap,score:_}}function L5(t){return t<.5?{icon:"Skull",color:"text-gray-400",level:"",approvalCap:30}:t<1?{icon:"AlertTriangle",color:"text-red-400",level:"",approvalCap:50}:t<2?{icon:"UtensilsCrossed",color:"text-yellow-400",level:"",approvalCap:70}:t<4?{icon:"Home",color:"text-green-400",level:"",approvalCap:85}:t<8?{icon:"Gem",color:"text-blue-400",level:"",approvalCap:95}:{icon:"Crown",color:"text-purple-400",level:"",approvalCap:100}}const ni=["official","cleric","capitalist","landowner","knight","engineer","navigator","merchant","soldier","scribe","worker","artisan","miner","lumberjack","serf","peasant"],S1=.1,Is=(t,s,r)=>!Number.isFinite(t)||t<s?s:t>r?r:t,V5=new Set(["science","culture"]),mi=t=>{if(t==="silver")return!1;const s=Re[t];return s?V5.has(t)?!0:!s.type||s.type!=="virtual":!1},W5=30,U5=(t={})=>{const s={...t};return Object.keys(Ke).forEach(r=>{s[r]===void 0&&(s[r]=Ke[r]?.startingWealth||0)}),s},xc=t=>t==="silver"?1:Re[t]?.basePrice||1,dl=.5,W0=1,I5=(t={},s={},r={})=>{const o={};return Object.entries(Ke).forEach(([c,u])=>{let p=0,m=0;const h=u.needs||{};Object.entries(h).forEach(([b,j])=>{if(!j||j<=0)return;const _=t?.[b]??Re[b]?.basePrice??xc(b);if(!Number.isFinite(_)||_<=0)return;const N=Math.max(0,r?.[b]||0);p+=j*_,m+=j*_*N});const x=Math.max(0,u.headTaxBase??0),g=Math.max(0,s?.[c]??1);m+=x*g,o[c]={needsCost:Number.isFinite(p)?p:0,taxCost:Number.isFinite(m)?m:0}}),o},U0=(t={},s={})=>{const r=Number.isFinite(s.livingCostWeight)?s.livingCostWeight:1,o=Number.isFinite(s.taxCostWeight)?s.taxCostWeight:1,c={};return Object.entries(t).forEach(([u,p])=>{const m=p?.needsCost||0,h=p?.taxCost||0;c[u]=Math.max(0,m*r+h*o)}),c},H5=_l.reduce((t,s)=>(t[s.id]=s,t),{}),Up=(t={},s=1)=>{if(!t||typeof t!="object")return{};const r={};return Object.entries(t).forEach(([o,c])=>{typeof c=="number"?r[o]=c*s:c&&typeof c=="object"&&!Array.isArray(c)?r[o]=Up(c,s):r[o]=c}),r},q5=({res:t,wealth:s,popStructure:r,supply:o,demand:c,nations:u,tick:p,taxPolicies:m,taxBreakdown:h,getLocalPrice:x,roleExpense:g,roleWagePayout:b,pendingTrades:j=[],lastTradeTime:_=0,gameSpeed:N=1,logs:M})=>{const R=r?.merchant||0;if(R<=0)return{pendingTrades:j,lastTradeTime:_,lockedCapital:0,capitalInvestedThisTick:0};let E=0;const T=m?.resourceTaxRates||{},D=V=>T[V]||0,O=Array.isArray(u)?u.filter(V=>V&&(V.inventory||V.economyTraits)):[],q={},I=V=>{if(q[V]!==void 0)return q[V];if(O.length===0)return q[V]=null,null;let F=0,re=0;O.forEach(L=>{const ie=jl(V,L,p);Number.isFinite(ie)&&ie>0&&(F+=ie,re+=1)});const C=re>0?F/re:null;return q[V]=C,C},Z=Ke.merchant?.tradeConfig||{minProfitMargin:.1,maxPurchaseAmount:20,exportProbability:.5,maxInventoryRatio:.3,minWealthForTrade:10,tradeDuration:3,tradeCooldown:0,enableDebugLog:!1},Y=[];j.forEach(V=>{V.daysRemaining-=1,V.daysRemaining<=0?(b.merchant=(b.merchant||0)+V.revenue,V.type==="import"&&(t[V.resource]=(t[V.resource]||0)+V.amount,o[V.resource]=(o[V.resource]||0)+V.amount),Z.enableDebugLog&&console.log("[]  :",{type:V.type==="export"?"":"",resource:V.resource,amount:V.amount,revenue:V.revenue,profit:V.profit})):Y.push(V)}),Z.enableDebugLog&&console.log("[]  :",{tick:p,lastTradeTime:_,pendingTradesCount:j.length,updatedPendingTradesCount:Y.length,merchantCount:r.merchant||0});const U=p-_;if(!(U>=Z.tradeCooldown))return Z.enableDebugLog&&console.log(`[]   ${(Z.tradeCooldown-U).toFixed(1)} `),{pendingTrades:Y,lastTradeTime:_};const Q=Object.keys(Re).filter(V=>mi(V)),ne=[],Ne=[];Q.forEach(V=>{const F=x(V),re=I(V),C=t[V]||0;if(re===null||F===null)return;const L=re-F,ie=Math.abs(L)/F,H=re>F&&ie>=Z.minProfitMargin&&C>0,ve=re<F&&ie>=Z.minProfitMargin;H&&ne.push(V),ve&&Ne.push(V)});const $e=R>100?100:R,de=R>100?R/100:1,P=Math.min($e,50);for(let V=0;V<P;V++){const F=s.merchant||0;if(F<=Z.minWealthForTrade)break;const re=Math.random(),C=F/($e-V);if(re<Z.exportProbability&&ne.length>0){const L=ne[Math.floor(Math.random()*ne.length)],ie=x(L),H=I(L);if(H===null||ie===null||H<=ie)continue;const ve=D(L),me=ie*(1+ve),X=me>0?C/me:3,fe=(t[L]||0)/de*Z.maxInventoryRatio,Je=Math.min(Z.maxPurchaseAmount,X,fe);if(Je<=.1)continue;const tt=ie*Je,Mt=tt*ve,jt=H*Je;let ot=tt,B=0;if(Mt<0){const ft=Math.abs(Mt);(t.silver||0)>=ft*de?(ot-=ft,B=-ft):M.push(` ${Re[L]?.name||L} `)}else ot+=Mt,B=Mt;const Ue=jt-ot,ht=ot>0?Ue/ot:Ue>0?1/0:-1/0;if(ht>=Z.minProfitMargin){const ft=Je*de,$t=ot*de,It=B*de;if((s.merchant||0)>=$t&&(t[L]||0)>=ft){if(Z.enableDebugLog&&L==="cloth"&&console.log("[]  :",{amount:ft,cost:$t,expectedRevenue:jt*de,expectedProfit:Ue*de,profitMargin:(ht*100).toFixed(2)+"%",daysUntilSale:Z.tradeDuration}),s.merchant-=$t,It<0){const oe=Math.abs(It);t.silver-=oe,h.subsidy+=oe}else h.industryTax+=It;t[L]=Math.max(0,(t[L]||0)-ft),o[L]=Math.max(0,(o[L]||0)-ft),E+=$t,Y.push({type:"export",resource:L,amount:ft,revenue:jt*de,profit:Ue*de,daysRemaining:3,capitalLocked:$t}),_=p}}}else if(Ne.length>0){const L=Ne[Math.floor(Math.random()*Ne.length)],ie=x(L),H=I(L);if(H===null||ie===null||H>=ie)continue;const ve=D(L),me=H,X=me>0?C/me:3,qe=Math.min(Z.maxPurchaseAmount,X);if(qe<=.1)continue;const fe=H*qe,Je=ie*qe,tt=Je*ve;let Mt=Je,jt=0;if(tt<0){const Ue=Math.abs(tt);(t.silver||0)>=Ue*de?(Mt+=Ue,jt=-Ue):M.push(` ${Re[L]?.name||L} `)}else Mt-=tt,jt=tt;const ot=Mt-fe,B=fe>0?ot/fe:ot>0?1/0:-1/0;if(B>=Z.minProfitMargin){const Ue=qe*de,ht=fe*de,ft=Mt*de,$t=jt*de;if((s.merchant||0)>=ht){if(Z.enableDebugLog&&L==="cloth"&&console.log("[]  :",{amount:Ue,cost:ht,expectedNetRevenue:ft,expectedProfit:ft-ht,profitMargin:(B*100).toFixed(2)+"%",daysUntilSale:Z.tradeDuration}),s.merchant-=ht,g.merchant=(g.merchant||0)+ht,$t<0){const It=Math.abs($t);t.silver-=It,h.subsidy+=It}else h.industryTax+=$t;E+=ht,Y.push({type:"import",resource:L,amount:Ue,revenue:ft,profit:ft-ht,daysRemaining:3,capitalLocked:ht}),_=p}}}}Z.enableDebugLog&&console.log("[]  :",{pendingTradesCount:Y.length,lastTradeTime:_,pendingTrades:Y.map(V=>({type:V.type,resource:V.resource,amount:V.amount,daysRemaining:V.daysRemaining}))});const z=Y.reduce((V,F)=>V+Math.max(0,F.capitalLocked||0),0);return{pendingTrades:Y,lastTradeTime:_,lockedCapital:z,capitalInvestedThisTick:E}},G5=({resources:t,buildings:s,population:r,popStructure:o={},birthAccumulator:c=0,decrees:u,gameSpeed:p,epoch:m,market:h,classWealth:x,classApproval:g={},activeBuffs:b=[],activeDebuffs:j=[],taxPolicies:_,army:N={},militaryWageRatio:M=1,militaryQueue:R=[],nations:E=[],tick:T=0,techsUnlocked:D=[],activeFestivalEffects:O=[],classWealthHistory:q,classNeedsHistory:I,merchantState:Z={pendingTrades:[],lastTradeTime:0},maxPopBonus:Y=0,eventApprovalModifiers:U={},eventStabilityModifier:S=0,currentStability:Q=50,eventResourceDemandModifiers:ne={},eventStratumDemandModifiers:Ne={},eventBuildingProductionModifiers:$e={},livingStandardStreaks:de={}})=>{console.log("[TICK START]",T);const P={...t},z={...h?.prices||{}},V=_||{},F=V.headTaxRates||{},re=V.resourceTaxRates||{},C=V.businessTaxRates||{},L=I5(z,F,re);U0(L,go?.price||{});const ie=U0(L,go?.wage||{}),H=h?.wages||{},ve=y=>{const v=ie?.[y];return!Number.isFinite(v)||v<=0?W0*.8:Math.max(W0*.8,v*1.1)},me=y=>{const v=H?.[y];if(Number.isFinite(v)&&v>0)return Math.max(dl,v);const W=Ke[y]?.startingWealth;return Number.isFinite(W)&&W>0?Math.max(W0*.5,W/40,ve(y)):Math.max(xe,ve(y))},X={},qe={},fe=U5(x),Je=y=>{const v=F[y];return typeof v=="number"?v:1},tt=y=>{const v=re[y];return typeof v=="number"?v:0},Mt=y=>{const v=C[y];return typeof v=="number"?v:0},jt={headTax:0,industryTax:0,businessTax:0,subsidy:0,policyIncome:0,policyExpense:0},ot={},B={gather:1,industry:1,civic:1,military:1},Ue={};let ht=0,ft=0,$t=0,It=0,oe=0,Ye=0,bt=0,Pe=0;const lt={},Vt={},oa={},Ka=(y,v)=>{if(!y||typeof v!="number")return;const W=1+v;!Number.isFinite(W)||W<=0||(ot[y]=(ot[y]||1)*W)},gn=(y,v)=>{if(!y||typeof v!="number")return;const W=1+v;!Number.isFinite(W)||W<=0||(B[y]=(B[y]||1)*W)},Zt=(y,v)=>{!y||typeof v!="number"||(Ue[y]=(Ue[y]||0)+v)},la=(y={})=>{if(y){if(y.buildings&&Object.entries(y.buildings).forEach(([v,W])=>Ka(v,W)),y.categories&&Object.entries(y.categories).forEach(([v,W])=>gn(v,W)),y.passive&&Object.entries(y.passive).forEach(([v,W])=>Zt(v,W)),y.maxPop){const v=y.maxPop;v>-1&&v<1&&v!==0?It+=v:$t+=v}y.production&&(oe+=y.production),y.industry&&(Ye+=y.industry),y.taxIncome&&(bt+=y.taxIncome),y.needsReduction&&(Pe+=y.needsReduction),y.resourceDemandMod&&Object.entries(y.resourceDemandMod).forEach(([v,W])=>{typeof W=="number"&&(lt[v]=(lt[v]||0)+W)}),y.stratumDemandMod&&Object.entries(y.stratumDemandMod).forEach(([v,W])=>{typeof W=="number"&&(Vt[v]=(Vt[v]||0)+W)}),y.resourceSupplyMod&&Object.entries(y.resourceSupplyMod).forEach(([v,W])=>{typeof W=="number"&&(oa[v]=(oa[v]||0)+W)})}};D.forEach(y=>{const v=H5[y];!v||!v.effects||la(v.effects)}),u.forEach(y=>{if(!y||!y.active||!y.modifiers)return;const v=y.modifiers?.passive?.silver||0;v>0?ht+=v:v<0&&(ft+=Math.abs(v)),la(y.modifiers)}),O.forEach(y=>{!y||!y.effects||la(y.effects)});const qt=y=>(z[y]||(z[y]=xc(y)),z[y]=Math.max(dl,z[y]),z[y]),Gt=(y,v,W)=>{if(y==="silver"&&v>0){he[W]=(he[W]||0)+v;return}if(!(v<=0)&&(P[y]=(P[y]||0)+v,mi(y))){qe[y]=(qe[y]||0)+v;const Se=qt(y)*v,pt=tt(y),Qe=Se*pt;let ct=Se;if(!(Qe>0)){if(Qe<0){const _t=Math.abs(Qe);(P.silver||0)>=_t?(P.silver-=_t,ct=Se+_t,jt.subsidy+=_t):T%30===0&&gt.push(`  ${Re[y]?.name||y} `)}}he[W]=(he[W]||0)+ct}},kt={},ta=s,Ht=new Set,se={},pe={},he={},K={},je={};let J=5,le=0;J+=$t,J+=Y,wf(N);const ue=jf(N);Object.values(N).reduce((y,v)=>y+v,0),ni.forEach(y=>se[y]=0),ni.forEach(y=>{pe[y]={totalSlots:0,weightedWage:0},he[y]=0});const Me={};Object.keys(Ke).forEach(y=>{Me[y]=0}),Object.keys(Ke).forEach(y=>{}),Object.keys(Ke).forEach(y=>{});const Ie=()=>{Object.entries(he).forEach(([y,v])=>{if(v<=0){K[y]=v;return}const W=K[y]||0,te=v-W;te>0&&(fe[y]=(fe[y]||0)+te),K[y]=v})};console.log("[TICK] Processing buildings..."),Ln.forEach(y=>{const v=ta[y.id]||0;if(v>0){if(y.output?.maxPop){let W=ot[y.id]||1;const te=B[y.cat]||1;W*=te,J+=y.output.maxPop*v*W}if(y.output?.militaryCapacity){let W=ot[y.id]||1;const te=B[y.cat]||1;W*=te,le+=y.output.militaryCapacity*v*W}if(y.jobs)for(let W in y.jobs)se[W]+=y.jobs[W]*v;y.output&&Object.entries(y.output).forEach(([W,te])=>{Re[W]&&(te||0)>0&&Ht.add(W)})}}),console.log("[TICK] Buildings processed. militaryCapacity:",le);const at=new Set;if(Ln.forEach(y=>{const v=(y.epoch??0)<=m,W=!y.requiresTech||D.includes(y.requiresTech);v&&W&&y.output&&Object.entries(y.output).forEach(([te,Se])=>{Re[te]&&(Se||0)>0&&at.add(te)})}),It!==0){const y=Math.max(0,1+It);J=Math.max(0,J*y)}J=Math.floor(J);let Ze=0;Object.entries(N).forEach(([y,v])=>{if(!v||v<=0)return;const te=un[y]?.populationCost||1;Ze+=v*te});const Ce=(R||[]).reduce((y,v)=>{if(v.status==="waiting"||v.status==="training"){const te=un[v.unitId]?.populationCost||1;return y+te}return y},0),rt=Ze+Ce;console.log("[TICK] Adding soldier jobs. currentArmyPop:",Ze,"queuePop:",Ce,"total:",rt),rt>0&&(se.soldier=(se.soldier||0)+rt),console.log("[TICK] Soldier jobs added. jobsAvailable.soldier:",se.soldier),console.log("[TICK] Starting population allocation...");const zt=o&&Object.keys(o).length>0,Ve={};let ca=0;if(zt){ni.forEach(v=>{const W=o[v]||0;Ve[v]=Math.max(0,W)}),Ve.unemployed=Math.max(0,o.unemployed||0);const y=ni.reduce((v,W)=>v+(Ve[W]||0),0)+(Ve.unemployed||0);if(ca=r-y,ca>0)Ve.unemployed=(Ve.unemployed||0)+ca;else if(ca<0){let v=-ca;const W=Math.min(Ve.unemployed||0,v);if(W>0&&(Ve.unemployed-=W,v-=W),v>0){const te=ni.reduce((Se,pt)=>Se+(Ve[pt]||0),0);if(te>0){const Se=v;ni.forEach((pt,Qe)=>{if(v<=0)return;const ct=Ve[pt]||0;if(ct<=0)return;const _t=ct/te;let Dt=Math.floor(_t*Se);Dt<=0&&v>0&&(Dt=1),Qe===ni.length-1?Dt=Math.min(ct,v):Dt=Math.min(ct,Math.min(Dt,v)),!(Dt<=0)&&(Ve[pt]=ct-Dt,v-=Dt)}),v>0&&ni.forEach(pt=>{if(v<=0)return;const Qe=Ve[pt]||0;if(Qe<=0)return;const ct=Math.min(Qe,v);Ve[pt]=Qe-ct,v-=ct})}}}}else{let y=r;ni.forEach(v=>{const W=Math.max(0,se[v]||0),te=Math.min(y,W);Ve[v]=te,y-=te}),Ve.unemployed=Math.max(0,y),ni.forEach(v=>{Ve[v]=0}),Ve.unemployed=r}Ve.unemployed=Math.max(0,Ve.unemployed||0);let ha=0,Ra=0;Object.keys(Ve).forEach(y=>{const v=Ve[y]||0,W=H[y]||0;v>0&&W>0&&(ha+=W*v,Ra+=v)});const xe=Ra>0?ha/Ra:W0;ni.forEach(y=>{const v=Ve[y]||0,W=Math.max(0,se[y]||0);if(v>W){const te=v-W,Se=fe[y]||0,pt=v>0?Se/v:0;if(Ve[y]=W,Ve.unemployed=(Ve.unemployed||0)+te,pt>0){const Qe=pt*te;fe[y]=Math.max(0,Se-Qe),fe.unemployed=(fe.unemployed||0)+Qe}}});const et=Math.max(0,1),Ae=y=>{const v=me(y),te=(Ke[y]?.headTaxBase??.01)*Je(y)*et;return v-Math.max(0,te)};console.log("[vacancy debug] diff =",ca,", unemployed =",Ve.unemployed||0);const it=ni.map((y,v)=>{const W=Math.max(0,se[y]||0),te=Ve[y]||0,Se=Math.max(0,W-te);return y==="soldier"&&console.log("[SOLDIER VACANCY] slots:",W,"current:",te,"vacancy:",Se),Se<=0?null:{role:y,vacancy:Se,netIncome:Ae(y),priorityIndex:v}}).filter(Boolean).sort((y,v)=>v.netIncome!==y.netIncome?v.netIncome-y.netIncome:y.priorityIndex-v.priorityIndex);console.log("[VACANCY RANKING]",it.map(y=>`${y.role}:${y.vacancy}`).join(", ")),it.forEach(y=>{const v=Ve.unemployed||0;if(v<=0)return;const W=Math.min(y.vacancy,v);if(W<=0)return;const te=fe.unemployed||0,Se=v>0?te/v:0;if(Ve[y.role]=(Ve[y.role]||0)+W,Ve.unemployed=Math.max(0,v-W),y.role==="soldier"&&console.log("[SOLDIER HIRING] hired:",W,"new soldier count:",Ve[y.role]),Se>0){const pt=Se*W;fe.unemployed=Math.max(0,te-pt),fe[y.role]=(fe[y.role]||0)+pt}});const Xe={},be={},Qt={},gt=[],Rt={};Object.entries(Ue).forEach(([y,v])=>{if(!v)return;const W=v,te=P[y]||0;if(W>=0)P[y]=te+W,kt[y]=(kt[y]||0)+W;else{const Se=Math.abs(W),pt=Math.min(te,Se);pt>0&&(P[y]=te-pt,kt[y]=(kt[y]||0)-pt)}});const ua={},wa=1-Math.max(-2,Math.min(.95,Pe||0));Object.keys(Ke).forEach(y=>{const v=Ve[y]||0;if(v===0)return;const W=Ke[y];fe[y]===void 0&&(fe[y]=W.startingWealth||0);const te=Je(y),Se=Ke[y]?.headTaxBase??.01,pt=v*Se*te*et;if(pt!==0){const Qe=fe[y]||0;if(pt>0){const ct=Math.min(Qe,pt);fe[y]=Qe-ct,jt.headTax+=ct,Me[y]=(Me[y]||0)+ct}else{const ct=-pt,_t=P.silver||0;_t>=ct&&(P.silver=_t-ct,fe[y]=Qe+ct,jt.subsidy+=ct,he[y]=(he[y]||0)+ct)}}Xe[y]=g[y]??50,(Xe[y]||0)<=0&&(ua[y]=!0)});const Na=u.some(y=>y.id==="forced_labor"&&y.active);console.log("[TICK] Starting production loop..."),Ln.forEach(y=>{const v=ta[y.id]||0;if(v===0)return;const W=y.owner||"state";fe[W]===void 0&&(fe[W]=Ke[W]?.startingWealth||0);let te=1;const Se=wn[m];Se&&Se.bonuses&&(y.cat==="gather"&&Se.bonuses.gatherBonus&&(te*=1+Se.bonuses.gatherBonus),y.cat==="industry"&&Se.bonuses.industryBonus&&(te*=1+Se.bonuses.industryBonus));let pt=1,Qe=1;b.forEach(Be=>{Be.production&&(pt+=Be.production),Be.industryBonus&&(Qe+=Be.industryBonus)}),j.forEach(Be=>{Be.production&&(pt+=Be.production),Be.industryBonus&&(Qe+=Be.industryBonus)}),pt*=1+oe,Qe*=1+Ye,(y.cat==="gather"||y.cat==="civic")&&(te*=pt),y.cat==="industry"&&(te*=Qe),D.includes("wheel")&&y.cat==="gather"&&(te*=1.2),D.includes("pottery")&&y.id==="farm"&&(te*=1.1),D.includes("basic_irrigation")&&y.id==="farm"&&(te*=1.15);const ct=B[y.cat];ct&&ct!==1&&(te*=ct);const _t=$e[y.id]||0,Dt=$e[y.cat]||0,mt=$e.all||0,wt=_t+Dt+mt;wt!==0&&(te*=1+wt);const Bt=ot[y.id];Bt&&Bt!==1&&(te*=Bt);let At=1,Ma=0,ga=0;const ka={};let La=0;const Ca=[];if(y.jobs){Rt[y.id]=Rt[y.id]||{};for(let Be in y.jobs){const Wt=y.jobs[Be]*v;pe[Be]||(pe[Be]={totalSlots:0,weightedWage:0}),Ma+=Wt;const da=se[Be],bn=Ve[Be],Sa=da>0?Math.min(1,bn/da):0,Ya=Wt*Sa;ga+=Ya,Rt[y.id][Be]=Ya;const an=Math.max(0,Wt-Ya);if(an>.001){const nn=an>=1?Math.floor(an):1;(je[Be]||(je[Be]=[])).push({buildingId:y.id,buildingName:y.name||y.id,availableSlots:nn})}if(Be!==W&&Ya>0){const nn=ka[Be]??me(Be),sa=ve(Be),Xa=Math.max(nn,sa);ka[Be]=Xa,La+=Ya*Xa,Ca.push({role:Be,roleSlots:Wt,filled:Ya,baseWage:Xa})}}if(Ma>0&&(At=ga/Ma),Ma>0&&ga<=0)return}te*=At,Na&&(y.jobs?.serf||y.jobs?.miner)&&(te*=1.2);const Va=te;let en=1,Kt=0,yt=!1;if(y.input)for(const[Be,Wt]of Object.entries(y.input)){if(!si(Be,m,D))continue;const da=Wt*v,bn=da*Va;if(bn<=0)continue;const Sa=P[Be]||0;if(Sa<=0?en=0:en=Math.min(en,Sa/bn),mi(Be)){const Ya=qt(Be),an=tt(Be);Kt+=da*Ya*(1+an)}}let Ft=Va*Math.max(0,Math.min(1,en));if(y.cat==="gather"&&en===0&&y.input){Ft=Va*.2,yt=!0,Kt=0;const Be=Object.keys(y.input).map(Wt=>Re[Wt]?.name||Wt).join("");T%30===0&&gt.push(` ${y.name}  ${Be}20%`)}let Et=0,Yt=!1;if(y.output)for(const[Be,Wt]of Object.entries(y.output)){if(Be==="maxPop"||!mi(Be))continue;Yt=!0;const bn=Wt*v*qt(Be),Sa=tt(Be),Ya=bn*(1-Sa);Et+=Ya}const tn=Va>0?La/Va:La,_a=Et*Ft,on=Kt*Ft,Oa=tn*Ft,Hn=Math.max(0,_a-on),yn=Oa>0?Hn/Oa:1,Ta=Number.isFinite(yn)?yn>=1?Math.min(1.4,1+(yn-1)*.35):Math.max(.65,1-(1-yn)*.5):1,qn=tn*Ta,Ji=qn*Ft,wr=Mt(y.id),Di=wr*v*Ft,ao=Kt+qn;let Gn=Ft;if(Yt){const Be=on+Ji+Math.max(0,Di);if(Be>0&&_a<=0)Gn=0;else if(Be>0&&_a<Be*.98){const Wt=Math.max(0,Math.min(1,_a/Be));Gn=Ft*Wt}}if(ao>0){const Wt=(fe[W]||0)/ao;Gn=Math.min(Gn,Math.max(0,Wt))}(!Number.isFinite(Gn)||Gn<0)&&(Gn=0);const Ki=.3;let Wa=1;ua[W]&&(Wa=Math.min(Wa,Ki)),y.jobs&&Object.keys(y.jobs).forEach(Be=>{ua[Be]&&(Wa=Math.min(Wa,Ki))}),Gn*=Wa;const hs=Va>0?Math.min(1,Gn/Va):0;let er=0;if(y.input&&!yt)for(const[Be,Wt]of Object.entries(y.input)){if(!si(Be,m,D))continue;const da=Wt*v*Gn;if(!da||da<=0)continue;const bn=P[Be]||0,Sa=Math.min(da,bn);if(mi(Be)){const Ya=qt(Be),an=tt(Be),nn=Sa*Ya,sa=nn*an;let Xa=nn;if(sa<0){const Fn=Math.abs(sa);(P.silver||0)>=Fn?(P.silver-=Fn,jt.subsidy+=Fn,Xa-=Fn,he[W]=(he[W]||0)+Fn):T%20===0&&gt.push(` ${y.name}  ${Re[Be]?.name||Be} `)}else sa>0&&(jt.industryTax+=sa,Xa+=sa);fe[W]=Math.max(0,(fe[W]||0)-Xa),Me[W]=(Me[W]||0)+Xa,X[Be]=(X[Be]||0)+Sa}Sa<=0||(P[Be]=bn-Sa,kt[Be]=(kt[Be]||0)-Sa)}y.jobs&&Object.entries(y.jobs).forEach(([Be,Wt])=>{const da=Wt*v;da<=0||(pe[Be]||(pe[Be]={totalSlots:0,weightedWage:0}),pe[Be].totalSlots+=da)});const Lo=Ca.map(Be=>{const Wt=Be.baseWage*hs*Ta,da=Wt*Be.filled;return er+=da,{...Be,expectedSlotWage:Wt}});let no=0;if(er>0){const Be=fe[W]||0,Wt=Math.min(Be,er);fe[W]=Be-Wt,Me[W]=(Me[W]||0)+Wt,no=Wt/er}if(Lo.forEach(Be=>{const Wt=Be.expectedSlotWage*no;if(pe[Be.role].weightedWage+=Wt*Be.roleSlots,Be.filled>0&&Wt>0){const da=Wt*Be.filled;he[Be.role]=(he[Be.role]||0)+da}}),y.output)for(const[Be,Wt]of Object.entries(y.output)){let da=Wt*v*Gn;if(!(!da||da<=0)){if(mi(Be)&&Be!=="silver"){const Sa=Re[Be]?.marketConfig||{},Ya=go?.market||{},an=Sa.outputVariation!==void 0?Sa.outputVariation:Ya.outputVariation||.2,nn=1+(Math.random()*2-1)*an;da*=nn;const sa=oa[Be]||0;sa!==0&&(da*=1+sa)}Be!=="maxPop"&&(mi(Be)?(Gt(Be,da,W),kt[Be]=(kt[Be]||0)+da):P[Be]=(P[Be]||0)+da)}}if(wr!==0&&v>0){const Be=wr*v*Gn;if(Be>0){const Wt=fe[W]||0;Wt>=Be?(fe[W]=Wt-Be,Me[W]=(Me[W]||0)+Be,jt.businessTax+=Be):T%30===0&&Wt<Be*.5&&gt.push(` ${Ke[W]?.name||W}  ${y.name} `)}else if(Be<0){const Wt=Math.abs(Be),da=P.silver||0;da>=Wt?(P.silver=da-Wt,fe[W]=(fe[W]||0)+Wt,he[W]=(he[W]||0)+Wt,jt.subsidy+=Wt):T%30===0&&gt.push(`  ${y.name} `)}}if(y.id==="market"){const Be=y.owner||"merchant",Wt=(Ve[Be]||0)>0,da=T%5===0;if(Wt&&da){let Sa=fe[Be]||0;if(!(Sa<=0)){const Ya=[];if(Object.entries(P).forEach(([an,nn])=>{if(!mi(an)||an==="silver"||(nn||0)<=300||(kt[an]||0)<0)return;const sa=qt(an);Ya.push({resource:an,stock:nn,localPrice:sa})}),Ya.length>0){const an=[];if(Object.keys(Re).forEach(nn=>{if(!mi(nn)||nn==="silver")return;const sa=P[nn]||0,Xa=kt[nn]||0,Fn=Math.max(0,(X[nn]||0)-(qe[nn]||0)),Ri=Math.max(0,200-sa),Yn=Xa<0?Math.abs(Xa):0,Xs=Math.max(Fn,Ri,Yn);if(Xs<=0)return;const yi=Math.max(dl,qt(nn)*1.15),Ii=Xs*yi;Ii<=0||an.push({resource:nn,shortageAmount:Xs,importPrice:yi,requiredValue:Ii})}),an.length>0){an.sort((sa,Xa)=>Xa.requiredValue-sa.requiredValue);const nn=10;an.forEach(sa=>{if(Sa<=0)return;let Xa=sa.shortageAmount,Fn=sa.requiredValue;for(const Ri of Ya){if(Sa<=0||Xa<=0||Fn<=0)break;const Yn=Ri.resource,Xs=Ri.localPrice;if(Xs<=0)continue;const yi=P[Yn]||0;if(yi<=0)continue;const Ii=Fn/Xs,ia=yi*.05,ln=Sa/Xs,fn=Math.min(Ii,ia,ln);if(!Number.isFinite(fn)||fn<=0)continue;const En=fn*Xs;if(Sa-=En,fe[Be]=Sa,Me[Be]=(Me[Be]||0)+En,P[Yn]=Math.max(0,yi-fn),qe[Yn]=(qe[Yn]||0)+fn,kt[Yn]=(kt[Yn]||0)-fn,Ri.stock=Math.max(0,Ri.stock-fn),Fn=Math.max(0,Fn-En),sa.importPrice<=0)continue;let Aa=En/sa.importPrice;if(!Number.isFinite(Aa)||Aa<=0||(Aa=Math.min(Aa,Xa),Aa<=0))continue;const sn=Aa*sa.importPrice;fe[Be]+=sn,Sa+=sn,P[sa.resource]=(P[sa.resource]||0)+Aa,qe[sa.resource]=(qe[sa.resource]||0)+Aa,kt[sa.resource]=(kt[sa.resource]||0)+Aa,Xa=Math.max(0,Xa-Aa);const za=sn-En;za>0&&(K[Be]=(K[Be]||0)+za,he[Be]=(he[Be]||0)+za),sn>nn&&(Re[Yn]?.name,Re[sa.resource]?.name||sa.resource)}})}}}}}y.jobs&&Object.entries(y.jobs).forEach(([Be,Wt])=>{const da=Wt*v;da<=0||(pe[Be].totalSlots+=da,Be!==W&&(pe[Be].weightedWage+=0*da,Rt[y.id]?.[Be]))})});const ze=Math.max(0,M??0),Pn=qt("food"),ja=ue*Pn*ze;if(ja>0){const y=ja,v=P.silver||0;v>=y?(P.silver=v-y,kt.silver=(kt.silver||0)-y,he.soldier=(he.soldier||0)+y):y>0&&gt.push("")}console.log("[TICK] Production loop completed."),Ie(),console.log("[TICK] Starting needs calculation...");const vs={},Vn={},ns={};Object.keys(Ke).forEach(y=>{const v=Ke[y],W=Ve[y]||0;if(W===0||!v.needs){vs[y]={satisfactionRatio:1,totalTrackedNeeds:0},Vn[y]=[];return}let te=0,Se=0;const pt=[],Qe=v.startingWealth||1,_t=(fe[y]||0)/Math.max(1,W)/Qe,Dt={...v.needs};if(v.luxuryNeeds){const mt=Object.keys(v.luxuryNeeds).map(Number).sort((wt,Bt)=>wt-Bt);for(const wt of mt)if(_t>=wt){const Bt=v.luxuryNeeds[wt];for(const[At,Ma]of Object.entries(Bt))Dt[At]=(Dt[At]||0)+Ma}}for(const[mt,wt]of Object.entries(Dt)){if(v.defaultResource&&v.defaultResource===mt)continue;const Bt=Re[mt];if(Bt&&Bt.unlockTech){if(!D.includes(Bt.unlockTech))continue}else if(Bt&&typeof Bt.unlockEpoch=="number"&&Bt.unlockEpoch>m)continue;if(!at.has(mt))continue;let At=wt*W*wa;if(At<=0)continue;const Ma=ne[mt]||0,ga=lt[mt]||0,ka=Ma+ga;ka!==0&&(At*=1+ka);const La=Ne[y]||0,Ca=Vt[y]||0,Va=La+Ca;if(Va!==0&&(At*=1+Va),mi(mt)){const yt=Bt?.marketConfig||{},Ft=go?.market||{},Et=yt.demandElasticity!==void 0?yt.demandElasticity:Ft.demandElasticity||.5,Yt=v.startingWealth||1,_a=(fe[y]||0)/Math.max(1,W)/Yt;let on;_a<=0?on=.3:_a<1?on=.3+_a*.7:on=Math.sqrt(_a)*(1+Math.log(_a)*.25);const Oa=Math.max(.3,Math.min(6,on));(!ns[y]||Math.abs(Oa-1)>Math.abs(ns[y]-1))&&(ns[y]=Oa);const Hn=qt(mt),yn=Bt.basePrice||1,Ta=Hn/yn,qn=Math.pow(Ta,-Et),Ji=.8+Math.random()*.4;At*=Oa*qn*Ji,At=Math.max(0,At),At=Math.min(At,wt*W*wa*12)}const en=P[mt]||0;let Kt=0;if(mi(mt)){const yt=qt(mt),Ft=yt*(1+tt(mt)),Et=Ft>0?Math.min(At,(fe[y]||0)/Ft):At,Yt=Math.min(At,en,Et);if(Yt>0){P[mt]=en-Yt,kt[mt]=(kt[mt]||0)-Yt;const _a=tt(mt),on=Yt*yt,Oa=on*_a;let Hn=on;if(Oa<0){const yn=Math.abs(Oa);(P.silver||0)>=yn?(P.silver-=yn,jt.subsidy+=yn,Hn-=yn,he[y]=(he[y]||0)+yn):T%20===0&&gt.push(` ${Ke[y]?.name||y}  ${Re[mt]?.name||mt} `)}else Oa>0&&(jt.industryTax+=Oa,Hn+=Oa);fe[y]=Math.max(0,(fe[y]||0)-Hn),Me[y]=(Me[y]||0)+Hn,Kt=Yt,X[mt]=(X[mt]||0)+Yt}const tn=At>0?Kt/At:1;if(te+=tn,Se+=1,tn<.99){const _a=Et>=At*.99,on=en>=At*.99;let Oa="both";_a&&!on?Oa="outOfStock":!_a&&on&&(Oa="unaffordable"),pt.push({resource:mt,reason:Oa})}}else{const yt=Math.min(At,en);yt>0&&(P[mt]=en-yt,Kt=yt);const Ft=At>0?Kt/At:1;te+=Ft,Se+=1,Ft<.99&&pt.push({resource:mt,reason:"outOfStock"})}}vs[y]={satisfactionRatio:Se>0?te/Se:1,totalTrackedNeeds:Se},Vn[y]=pt});let us=0,ps=0,Ti=0;Object.keys(Ke).forEach(y=>{const v=Ve[y]||0;if(v<=0)return;ps+=v;const W=vs[y]?.satisfactionRatio??1;us+=W*v;const te=Ke[y];te&&te.needs&&(Vn[y]||[]).some(Qe=>Qe.resource==="food"||Qe.resource==="cloth")&&(Ti+=v)});let js=.3+.7*(ps>0?us/ps:1);if(Ti>0&&ps>0){const y=Ti/ps,v=y*.4;js=Math.max(.1,js-v),y>.1&&gt.push("/")}js<.999&&Object.entries(kt).forEach(([y,v])=>{const W=Re[y];if(!(!W||y==="silver"||W.type&&W.type==="virtual")&&v>0){const te=v*(1-js);kt[y]=v-te,P[y]=Math.max(0,(P[y]||0)-te)}});let Si={};u.forEach(y=>{if(y.active&&(y.modifiers&&y.modifiers.approval&&Object.entries(y.modifiers.approval).forEach(([v,W])=>{Si[v]=(Si[v]||0)+W}),y.id==="forced_labor"&&Ve.serf>0&&(Xe.serf=Math.max(0,(Xe.serf||50)-5)),y.id==="tithe")){Ve.cleric>0&&(Xe.cleric=Math.max(0,(Xe.cleric||50)-2));const v=(Ve.cleric||0)*2*et;if(v>0){const W=fe.cleric||0,te=Math.min(W,v);fe.cleric=Math.max(0,W-te),jt.headTax+=te,Me.cleric=(Me.cleric||0)+te}}});const Wn={},fs={};Object.keys(Ke).forEach(y=>{const v=Ve[y]||0;if(v===0){Wn[y]=null,fs[y]={streak:0,level:null};return}const W=Ke[y],te=fe[y]||0,Se=W.startingWealth||10,pt=(Vn[y]||[]).length,Qe=W.luxuryNeeds||{},ct=Object.keys(Qe).map(Number).sort((ga,ka)=>ga-ka),_t=Se>0?te/Math.max(v,1)/Se:0,Dt=W.needs?Object.keys(W.needs).filter(ga=>si(ga,m,D)).length:0;let mt=0,wt=Dt;for(const ga of ct)if(_t>=ga){mt++;const ka=Qe[ga],Ca=Object.keys(ka).filter(Va=>si(Va,m,D)).filter(Va=>!W.needs?.[Va]);wt+=Ca.length}Wn[y]=$y({count:v,wealthValue:te,startingWealth:Se,shortagesCount:pt,effectiveNeedsCount:wt,unlockedLuxuryTiers:mt,totalLuxuryTiers:ct.length});const Bt=de?.[y]?.streak||0,At=Wn[y]?.level||null;let Ma=Bt;At===""||At===""?Ma=Bt+1:Ma=Math.max(0,Bt-1),fs[y]={streak:Ma,level:At}}),Object.keys(Ke).forEach(y=>{const v=Ve[y]||0;if(v===0)return;const W=vs[y],te=W?.satisfactionRatio??1,pt=Wn[y]?.approvalCap??100;let Qe=70;const ct=Je(y),_t=Ke[y]?.headTaxBase??.01,Dt=Math.max(0,_t*ct*et),mt=(he[y]||0)/Math.max(1,v);mt>.001&&Dt>mt*.5?Qe=Math.min(Qe,40):ct<.6&&(Qe+=5);const wt=W?.totalTrackedNeeds??0,Bt=(Vn[y]||[]).length;Bt>0&&wt>0&&(Bt>=wt?Qe=Math.min(Qe,0):Qe=Math.min(Qe,30));const At=fs[y]||{};if(At.level===""||At.level===""){const Kt=At.level===""?2.5:1.5,yt=Math.min(30,Math.ceil((At.streak||0)*Kt));yt>0&&(Qe-=yt)}const Ma=(I||{})[y];if(Ma&&Ma.length>0){let Ft=0;for(let Et=Ma.length-1;Et>=0&&Ft<20&&Ma[Et]>=.95;Et--)Ft+=1;if(Ft>=3){const Et=Math.min(15,Ft*.6);Qe=Math.min(100,Qe+Et)}}const ga=(q||{})[y];if(ga&&ga.length>=20){const Kt=ga.slice(-10).reduce((Ft,Et)=>Ft+Et,0)/10,yt=ga.slice(-20,-10).reduce((Ft,Et)=>Ft+Et,0)/10;if(yt>1){const Ft=(Kt-yt)/yt,Et=Math.min(15,Math.abs(Ft)*50);Ft>.05?Qe+=Et:Ft<-.05&&(Qe-=Et)}}if(te>1.5&&(Qe=Math.min(100,Qe+10)),y==="unemployed"){const yt=2+v/Math.max(1,r)*30;Qe-=yt}const ka=U?.[y]||0;ka&&(Qe+=ka);const La=Si[y]||0;La&&(Qe+=La);const Ca=Xe[y]||50;let en=Ca+(Qe-Ca)*.02;en=Math.min(en,pt),Xe[y]=Math.max(0,Math.min(100,en))}),(Ve.unemployed||0)===0&&g.unemployed!==void 0&&(Xe.unemployed=Math.min(100,g.unemployed+5));let xa=r,qs=0;Object.keys(Ke).forEach(y=>{Qt[y]=Math.max(0,fe[y]||0)});let hi=Object.values(Qt).reduce((y,v)=>y+v,0);Object.keys(Ke).forEach(y=>{const v=Ve[y]||0;if(v===0)return;const W=Ke[y],te=Qt[y]||0,Se=hi>0?te/hi:0;be[y]=W.influenceBase*v+Se*10});let Un=Object.values(be).reduce((y,v)=>y+v,0),Vi=0,Ai=0;Object.keys(Ke).forEach(y=>{const v=Ve[y]||0;if(v===0)return;const W=Xe[y]||50;if(W>=25)return;const te=Un>0?(be[y]||0)/Un:0,Se=Ke[y]?.name||y;if(W<20&&te<.07){const pt=Math.max(.03,(20-W)/200),Qe=Math.min(v,Math.max(1,Math.floor(v*pt)));if(Qe>0){const Dt=fe[y]||0,wt=(v>0?Dt/v:0)*Qe;wt>0&&(fe[y]=Math.max(0,Dt-wt))}Vi+=Qe;const ct=(Vn[y]||[]).map(Dt=>{const mt=typeof Dt=="string"?Dt:Dt.resource,wt=typeof Dt=="string"?"outOfStock":Dt.reason,Bt=Re[mt]?.name||mt;return wt==="unaffordable"?`${Bt}()`:wt==="outOfStock"?`${Bt}()`:wt==="both"?`${Bt}()`:Bt}).join(""),_t=ct?`${ct}`:"";gt.push(`${Se} ${Qe}  ${(Qe*(fe[y]||0)/Math.max(1,v)).toFixed(1)} ${_t}`)}else if(te>=.12){const pt=Math.min(.2,.05+te*.15);Ai+=pt;const Qe=(Vn[y]||[]).map(_t=>{const Dt=typeof _t=="string"?_t:_t.resource,mt=typeof _t=="string"?"outOfStock":_t.reason,wt=Re[Dt]?.name||Dt;return mt==="unaffordable"?`${wt}()`:mt==="outOfStock"?`${wt}()`:mt==="both"?`${wt}()`:wt}).join(""),ct=Qe?`${Qe}`:"";gt.push(`${Se} ${ct}`)}});const oi=[],Dn=[];Object.keys(Ke).forEach(y=>{const v=Ke[y];if(!v.buffs||(Ve[y]||0)===0)return;const W=Xe[y]||50,te=(vs[y]?.satisfactionRatio??1)>=.9,Se=Un>0?(be[y]||0)/Un:0,pt=Se>.8?2:Se>.5?1.5:1,Qe=W>=85&&Se>=.3,ct=W>=85&&te;if((Qe||ct)&&v.buffs.satisfied){const _t=Up(v.buffs.satisfied,pt);oi.push({class:y,..._t})}else if(W<40&&v.buffs.dissatisfied&&Se>=.3){const _t=Up(v.buffs.dissatisfied,pt);Dn.push({class:y,..._t})}});let xi=0,Wi=0;Object.keys(Ke).forEach(y=>{if((Ve[y]||0)===0)return;const W=Xe[y]||50,te=be[y]||0,Se=Un>0?te/Un:0;xi+=W*Se,Wi+=Se});let li=Wi>0?xi:50;S&&(li+=S);let ws=0;oi.forEach(y=>{y.stability&&(ws+=y.stability)}),Dn.forEach(y=>{y.stability&&(ws+=y.stability)}),ws-=Ai;const Ui=Math.max(0,Math.min(100,li+ws)),Ds=Math.max(0,Math.min(100,Q+(Ui-Q)*.05)),gi=Math.min(1.5,Math.max(.5,1+(Ds-50)/100)),Fs=m;let Oe=0;const Ge=Math.max(5,r||5),dt=Math.max(100,P.silver??t?.silver??0);let Nt=(E||[]).map(y=>{const v={...y};if(!(Fs>=(y.appearEpoch??0)&&(y.expireEpoch==null||Fs<=y.expireEpoch)))return v.isAtWar&&(v.isAtWar=!1,v.warDuration=0,v.warScore=0,v.warStartDay=void 0,gt.push(`  ${v.name} `)),v;if(v.isRebelNation){v.economyTraits||(v.economyTraits={});const ia=Math.max(5,v.economyTraits.basePopulation||v.population||10),ln=Math.max(100,v.economyTraits.baseWealth||v.wealth||200);v.economyTraits.basePopulation=ia,v.economyTraits.baseWealth=ln;const fn=Math.max(ia,Math.floor(ia*1.1)),En=Math.max(ln,Math.floor(ln*1.15));if(v.population=Is(Math.round(v.population||ia),5,fn),v.wealth=Is(Math.round(v.wealth||ln),ln*.5,En),v.budget=Math.min(v.wealth,Math.max(0,v.budget??Math.floor(v.wealth*.3))),v.isAtWar){v.warDuration=(v.warDuration||0)+1;const mn=v.aggression??.7,Ns=Math.min(.35,.25+mn*.1);if(Math.random()<Ns){console.log(`[REBEL RAID] ${v.name} : ${(Ns*100).toFixed(1)}%`);const os=v.militaryStrength??1,cn=.08+mn*.05,Ms={},Zs=Bp(m,"light"),Xn=3+Math.random()*5,$s=Math.floor(Xn*os);Zs.forEach(ls=>{if(un[ls]){const bi=Math.floor($s/Zs.length*(.5+Math.random()*.8));bi>0&&(Ms[ls]=bi)}});const kn={...N},Os=Object.values(kn).reduce((ls,bi)=>ls+bi,0);let Ua=0,xs=0,vn=0,Ws={victory:!0,attackerLosses:{},defenderLosses:{}};Os===0?(Ua=Math.floor((P.food||0)*cn),xs=Math.floor((P.silver||0)*(cn/2)),vn=Math.min(5,Math.max(1,Math.floor(cn*25)))):(Ws=Wp({army:Ms,epoch:m,militaryBuffs:.1},{army:kn,epoch:m,militaryBuffs:0}),Ws.victory&&(Ua=Math.floor((P.food||0)*cn),xs=Math.floor((P.silver||0)*(cn/2)),vn=Math.min(5,Math.max(1,Math.floor(cn*25)))),Object.entries(Ws.defenderLosses||{}).forEach(([ls,bi])=>{N[ls]&&(N[ls]=Math.max(0,N[ls]-bi))})),Ua>0&&(P.food=Math.max(0,(P.food||0)-Ua)),xs>0&&(P.silver=Math.max(0,(P.silver||0)-xs)),vn>0&&(qs+=vn),v.warScore=(v.warScore||0)+(Ws.victory?-8:6);const $i={nationName:v.name,victory:!Ws.victory,attackerArmy:Ms,defenderArmy:kn,attackerLosses:Ws.attackerLosses||{},defenderLosses:Ws.defenderLosses||{},foodLoss:Ua,silverLoss:xs,popLoss:vn,ourPower:Ws.defenderPower||0,enemyPower:Ws.attackerPower||0,battleReport:Ws.battleReport||[],actionType:"raid",actionName:""};gt.push(`RAID_EVENT${JSON.stringify($i)}`)}const rs=-(v.warScore||0);if(rs>50&&(v.warDuration||0)>20){const os=v.lastSurrenderDemandDay||0;if(T-os>=30&&Math.random()<.05){v.lastSurrenderDemandDay=T;let cn="reform",Ms=Math.floor(50+rs*3);rs>200?(cn="massacre",Ms=Math.floor(rs/4)):rs>100&&(cn="concession",Ms=Math.floor(rs*2)),gt.push(`REBEL_DEMAND_SURRENDER:${JSON.stringify({nationId:v.id,nationName:v.name,rebellionStratum:v.rebellionStratum,warScore:v.warScore,demandType:cn,demandAmount:Ms})}`)}}}const Aa=v.warScore||0,sn=v.warDuration||0,za=Number.isFinite(v.lastPeaceRequestDay)?v.lastPeaceRequestDay:-1/0;if(T-za>=30&&!v.isPeaceRequesting){const mn=Math.max(0,Aa-20)/100+Math.max(0,sn-60)/500,Ns=Math.min(.4,mn*.5);Aa>30&&Math.random()<Ns?(v.isPeaceRequesting=!0,v.peaceTribute=0,v.lastPeaceRequestDay=T,gt.push(` ${v.name} `)):Aa>60&&sn>90&&(v.isPeaceRequesting=!0,v.peaceTribute=0,v.lastPeaceRequestDay=T,gt.push(` ${v.name} `))}return v}v.foreignPower={...v.foreignPower||{}};const te=v.foreignPower,Se=v.wealthTemplate||v.wealth||800;te.baseRating==null&&(te.baseRating=Math.max(.4,Se/800));const pt=Math.min(.9,Math.max(.1,te.volatility??v.marketVolatility??.3));if(te.volatility=pt,te.appearEpoch==null&&(te.appearEpoch=v.appearEpoch??0),te.populationFactor==null){const ia=v.culturalTraits?.agriculturalFocus?1.15:1;te.populationFactor=Is(te.baseRating*ia,.6,2.5)}if(te.wealthFactor==null){const ia=1+Math.max(0,te.appearEpoch)*.05;te.wealthFactor=Is(te.baseRating*ia,.5,3.5)}if(!te.initializedAtTick){const ln=1+Math.max(0,Fs-(te.appearEpoch??0))*.08,fn=.9+Math.random()*.25,En=Is(te.populationFactor*ln*fn,.6,2.5),Aa=Is(te.wealthFactor*ln*fn,.5,3.5),sn=Math.max(3,Math.round(Ge*En)),za=Math.max(100,Math.round(dt*Aa));v.population=sn,v.wealth=za,v.budget=Math.max(50,za*.5),v.economyTraits={...v.economyTraits||{},basePopulation:sn,baseWealth:za},te.populationFactor=En,te.wealthFactor=Aa,te.initializedAtTick=T,te.playerSnapshot={population:Ge,wealth:dt},v.wealthTemplate||(v.wealthTemplate=za)}v.inventory?v.inventory={...v.inventory}:v.inventory={},typeof v.budget!="number"&&(v.budget=(v.wealth||800)*.5);const Qe=v.economyTraits?.resourceBias||{},ct=Object.keys(Re).filter(mi);if(ct.length>0){const ln=v.isAtWar||v.foreignWars&&Object.values(v.foreignWars).some(fn=>fn?.isAtWar)?1.3+(v.aggression||.2)*.5:1;ct.forEach(fn=>{const En=Qe[fn]??1,Aa=v.inventory[fn]||0,sn=500,za=3*p,is=3*p*ln,mn=za*En,Ns=is/Math.max(En,.25),rs=Aa/sn;let os=1,cn=1;rs>1.5?(os*=.5,cn*=1.15):rs>1.1?(os*=.8,cn*=1.05):rs<.5?(os*=1.5,cn*=.85):rs<.9&&(os*=1.2,cn*=.95);const Ms=(sn-Aa)*.01*p,Zs=(Math.random()-.5)*sn*.3*p,Xn=mn*os,$s=Ns*cn,kn=Xn-$s+Ms+Zs,Os=sn*.2,Ua=sn*3,xs=Aa+kn;v.inventory[fn]=Math.max(Os,Math.min(Ua,xs))})}const _t=(v.wealth||800)*.5,Dt=.02,mt=_t-v.budget;if(v.budget=v.budget+mt*Dt*p,v.budget=Math.max(0,v.budget),v.isAtWar){if(v.warDuration=(v.warDuration||0)+1,Fs>=1){const En=v.lastMilitaryActionDay||0;v.militaryCooldownDays||(v.militaryCooldownDays=7+Math.floor(Math.random()*24));const Aa=T-En>=v.militaryCooldownDays,sn=Math.max(0,-(v.warScore||0)),za=Math.min(.18,.02+(v.aggression||.2)*.04+sn/400);if(Aa&&Math.random()<za){v.lastMilitaryActionDay=T,v.militaryCooldownDays=7+Math.floor(Math.random()*24);const is=Math.max(v.appearEpoch||0,Math.min(m,v.expireEpoch??m)),mn=v.militaryStrength??1,Ns=Math.max(.3,Math.min(1.5,(v.wealth||500)/800)),rs=1+(v.aggression||.2),os=1+Math.max(-.5,(v.warScore||0)/120),cn=v.aggression||.2;Object.values(N).reduce((Zn,_s)=>Zn+_s,0);const Ms=-(v.warScore||0),Zs=(v.traits||[]).includes("maritime")||(v.name||"").includes("")||(v.name||"").includes("");let Xn="raid",$s="light",kn={min:2,max:6},Os="",Ua=1;const xs=Math.random();mn>.7&&cn>.5&&Ms>30&&is>=2?xs<.25?(Xn="siege",$s="heavy",kn={min:15,max:25},Os="",Ua=1.5):xs<.6?(Xn="assault",$s="medium",kn={min:12,max:18},Os="",Ua=1.3):xs<.75&&cn>.6&&(Xn="scorched_earth",$s="heavy",kn={min:12,max:20},Os="",Ua=1.4):mn>.5&&Ms>10&&is>=1?xs<.35?(Xn="assault",$s="medium",kn={min:10,max:15},Os="",Ua=1.2):xs<.5&&Zs&&is>=2&&(Xn="naval_raid",$s="medium",kn={min:8,max:14},Os="",Ua=1.1):Ms<-20&&cn>.6&&xs<.3&&(Xn="scorched_earth",$s="medium",kn={min:8,max:15},Os="",Ua=1.1);const vn=(.05+cn*.05+sn/1200)*Ua,Ws=mn*Ns*rs*os,$i={},ls=Bp(is,$s),bi=kn.min+Math.random()*(kn.max-kn.min),Lc=Math.floor(bi*Ws);ls.forEach(Zn=>{if(un[Zn]){const _s=.5+Math.random()*.8,zs=Math.floor(Lc/ls.length*_s);zs>0&&($i[Zn]=zs)}});const so={...N},Vc=Object.values(so).reduce((Zn,_s)=>Zn+_s,0),$n={raid:1,assault:1.5,siege:2,naval_raid:1.2,scorched_earth:1.8}[Xn]||1,Hi={raid:{win:-8,lose:6},assault:{win:-15,lose:12},siege:{win:-25,lose:20},naval_raid:{win:-12,lose:10},scorched_earth:{win:-18,lose:15}}[Xn]||{win:-8,lose:6};if(Vc===0){const Zn=Math.floor((P.food||0)*vn*$n),_s=Math.floor((P.silver||0)*(vn/2)*$n);let zs=0;Xn==="scorched_earth"&&(zs=Math.floor((P.wood||0)*vn*.8),zs>0&&(P.wood=Math.max(0,(P.wood||0)-zs))),Zn>0&&(P.food=Math.max(0,(P.food||0)-Zn)),_s>0&&(P.silver=Math.max(0,(P.silver||0)-_s));const dn=Math.min(Math.floor(3*$n),Math.max(1,Math.floor(vn*20*$n)));qs+=dn;const Qn={nationName:v.name,victory:!1,attackerArmy:$i,defenderArmy:{},attackerLosses:{},defenderLosses:{},foodLoss:Zn,silverLoss:_s,woodLoss:zs,popLoss:dn,ourPower:0,enemyPower:0,actionType:Xn,actionName:Os},Es=`RAID_EVENT${JSON.stringify(Qn)}`;console.log(`[SIMULATION] AI${Os}:`,Es),gt.push(Es),v.warScore=(v.warScore||0)+Hi.win;const gs=Zn+_s+zs;v.wealth=(v.wealth||0)+Math.floor(gs*.08)}else{const Zn={raid:.1,assault:0,siege:-.1,naval_raid:.15,scorched_earth:.05}[Xn]||.1,_s={army:$i,epoch:is,militaryBuffs:Zn},zs={army:so,epoch:m,militaryBuffs:0,wealth:(P.food||0)+(P.silver||0)+(P.wood||0)},dn=Wp(_s,zs);let Qn=0,Es=0,gs=0,Qs=0;if(dn.victory){Qn=Math.floor((P.food||0)*vn*$n),Es=Math.floor((P.silver||0)*(vn/2)*$n),Xn==="scorched_earth"&&(gs=Math.floor((P.wood||0)*vn*.8),gs>0&&(P.wood=Math.max(0,(P.wood||0)-gs))),Qn>0&&(P.food=Math.max(0,(P.food||0)-Qn)),Es>0&&(P.silver=Math.max(0,(P.silver||0)-Es)),Qs=Math.min(Math.floor(3*$n),Math.max(1,Math.floor(vn*20*$n))),qs+=Qs;const qi=Qn+Es+gs;v.wealth=(v.wealth||0)+Math.floor(qi*.08)}Object.entries(dn.defenderLosses||{}).forEach(([qi,On])=>{N[qi]&&(N[qi]=Math.max(0,N[qi]-On))});const vi=Object.values(dn.attackerLosses||{}).reduce((qi,On)=>qi+(On||0),0);vi>0&&(v.enemyLosses=(v.enemyLosses||0)+vi);const Wc=dn.victory?Hi.win:Hi.lose;v.warScore=(v.warScore||0)+Wc;const Al={nationName:v.name,victory:!dn.victory,attackerArmy:$i,defenderArmy:so,attackerLosses:dn.attackerLosses||{},defenderLosses:dn.defenderLosses||{},foodLoss:Qn,silverLoss:Es,woodLoss:gs,popLoss:Qs,ourPower:dn.defenderPower,enemyPower:dn.attackerPower,battleReport:dn.battleReport||[],actionType:Xn,actionName:Os},Vo=`RAID_EVENT${JSON.stringify(Al)}`;console.log(`[SIMULATION] AI${Os}:`,Vo),gt.push(Vo)}}}const ia=Number.isFinite(v.lastPeaceRequestDay)?v.lastPeaceRequestDay:-1/0,ln=T-ia>=W5;if((v.warScore||0)>12&&ln){const En=Math.min(.5,.03+(v.warScore||0)/120+(v.warDuration||0)/400)+Math.min(.15,(v.enemyLosses||0)/500);if(Math.random()<En){const Aa=v.warScore||0,sn=v.enemyLosses||0,za=v.warDuration||0,is=Math.ceil(Aa*35+sn*2.2+za*4),mn=200,Ns=8e3+Math.floor(za*8),rs=Math.max(0,v.wealth||0),os=Math.min(Math.min(Ns,rs),Math.max(mn,is));gt.push(` ${v.name}  ${os} `),v.isPeaceRequesting=!0,v.peaceTribute=os,v.lastPeaceRequestDay=T}}const fn=-(v.warScore||0);if(fn>25&&(v.warDuration||0)>30){const En=v.lastSurrenderDemandDay||0;if(T-En>=60&&Math.random()<.03){v.lastSurrenderDemandDay=T;let Aa="tribute";const sn=v.warDuration||0,za=Math.ceil(fn*35+sn*6);let is=Math.max(150,za);fn>100?(Aa="territory",is=Math.min(50,Math.max(3,Math.floor(r*.05)))):fn>50&&Math.random()<.5&&(Aa="open_market",is=365*2),gt.push(`AI_DEMAND_SURRENDER:${JSON.stringify({nationId:v.id,nationName:v.name,warScore:v.warScore,demandType:Aa,demandAmount:is})}`)}}}else v.warDuration&&(v.warDuration=0);const wt=v.relation??50;let Bt=0;wt>50?Bt=-.02:wt<50&&(Bt=.02),v.relation=Math.max(0,Math.min(100,wt+Bt)),v.foreignRelations&&Object.keys(v.foreignRelations).forEach(ia=>{let ln=v.foreignRelations[ia]??50;ln>50?ln-=.02:ln<50&&(ln+=.02),v.foreignRelations[ia]=Math.max(0,Math.min(100,ln))}),v.alliedWithPlayer&&!v.isAtWar&&(wt<40||(v.allianceStrain||0)>=3)&&(v.alliedWithPlayer=!1,v.allianceStrain=0,gt.push(`AI_BREAK_ALLIANCE:${JSON.stringify({nationId:v.id,nationName:v.name,reason:wt<40?"relation_low":"player_neglect"})}`));const At=v.aggression??.2,Ma=Math.max(0,(50-wt)/70),ga=Ds<35?.02:0,ka=(E||[]).filter(ia=>ia.isAtWar===!0&&ia.id!==v.id&&!ia.isRebelNation).length,La=3,Ca=30,Va=(E||[]).some(ia=>ia.isAtWar&&ia.warStartDay&&T-ia.warStartDay<Ca&&ia.id!==v.id),en=ka>0?Math.pow(.3,ka):1,Kt=At>.5?At*.03:0;let yt=Fs>=1?Math.min(.08,At*.04+Ma*.025+ga+Kt):0;yt*=en;const Ft=v.peaceTreatyUntil&&T<v.peaceTreatyUntil,Et=wt>=80;!v.isAtWar&&!Ft&&!Et&&wt<25&&ka<La&&!Va&&Math.random()<yt&&(v.isAtWar=!0,v.warStartDay=T,v.warDuration=0,v.warDeclarationPending=!0,gt.push(` ${v.name} `),gt.push(`WAR_DECLARATION_EVENT:${JSON.stringify({nationId:v.id,nationName:v.name})}`));const tn=(P.food||0)+(P.silver||0)+(P.wood||0),_a=v.wealth||500,on=v.militaryStrength??1;if(!v.isAtWar&&!Ft&&!Et&&tn>_a*2&&on>.8&&wt<50&&At>.4&&ka<La&&!Va){const ia=.001*At*(tn/_a-1);Math.random()<ia&&(v.isAtWar=!0,v.warStartDay=T,v.warDuration=0,v.warDeclarationPending=!0,gt.push(` ${v.name} `),gt.push(`WAR_DECLARATION_EVENT:${JSON.stringify({nationId:v.id,nationName:v.name,reason:"wealth"})}`))}if(v.installmentPayment&&v.installmentPayment.remainingDays>0){const ia=v.installmentPayment.amount;P.silver=(P.silver||0)+ia,Oe+=ia,v.installmentPayment.paidAmount+=ia,v.installmentPayment.remainingDays-=1,v.installmentPayment.remainingDays===0&&(gt.push(` ${v.name} ${v.installmentPayment.totalAmount}`),delete v.installmentPayment)}if(!v.isAtWar){const ia=v.militaryStrength??1;ia<1&&(v.militaryStrength=Math.min(1,ia+.005))}const Oa=v.foreignPower||{},Hn=Is(Oa.volatility??v.marketVolatility??.3,.1,.9),yn=Is(Oa.populationFactor??Oa.baseRating??1,.6,2.5),Ta=Is(Oa.wealthFactor??(Oa.baseRating?Oa.baseRating*1.1:1.1),.5,3.5),qn=1+Math.max(0,m-(Oa.appearEpoch??0))*.03;if(!v.economyTraits?.ownBasePopulation){const ln=(v.wealthTemplate||800)/800;v.economyTraits={...v.economyTraits||{},ownBasePopulation:Math.max(5,Math.round(16*ln*(.8+Math.random()*.4))),ownBaseWealth:Math.max(500,Math.round(1e3*ln*(.8+Math.random()*.4))),developmentRate:.8+(v.aggression||.3)*.3+Math.random()*.4,lastGrowthTick:T}}const Ji=v.economyTraits.ownBasePopulation,wr=v.economyTraits.ownBaseWealth,Di=v.economyTraits.developmentRate||1;if(T-(v.economyTraits.lastGrowthTick||0)>=100){const ia=.3*Di;Math.random()<ia&&!v.isAtWar&&(v.economyTraits.ownBasePopulation=Math.round(Ji*(1.03+Math.random()*.05)),v.economyTraits.ownBaseWealth=Math.round(wr*(1.04+Math.random()*.08))),v.economyTraits.lastGrowthTick=T}const Gn=1+Math.max(0,m)*.15,Ki=v.economyTraits.ownBasePopulation*Gn*yn,Wa=v.economyTraits.ownBaseWealth*Gn*Ta,hs=.3,er=Ge*yn*qn,Lo=dt*Ta*qn,no=Ki*(1-hs)+er*hs,Be=Wa*(1-hs)+Lo*hs,Wt=Math.max(1,(v.wealthTemplate||800)/Math.max(800,dt)*.8),da=Math.max(1,(v.wealthTemplate||800)/Math.max(800,dt)*1.1),bn=Math.max(3,no*Wt),Sa=Math.max(100,Be*da);v.economyTraits={...v.economyTraits||{},basePopulation:bn,baseWealth:Sa};const Ya=v.population??bn,an=Is(1+Hn*.6+qn*.08,1,1.8),nn=(v.isAtWar?.032:.12)*an,sa=(Math.random()-.5)*Hn*bn*.04;let Xa=Ya+(bn-Ya)*nn+sa;v.isAtWar&&(Xa-=Ya*.012),v.population=Math.max(3,Math.round(Xa));const Fn=v.wealth??Sa,Ri=(v.isAtWar?.03:.11)*an,Yn=(Math.random()-.5)*Hn*Sa*.05;let Xs=Fn+(Sa-Fn)*Ri+Yn;v.isAtWar&&(Xs-=Fn*.015),v.wealth=Math.max(100,Math.round(Xs));const yi=v.wealth*.45,Ii=Number.isFinite(v.budget)?v.budget:yi;return v.budget=Math.max(0,Ii+(yi-Ii)*.35),v});Nt=Nt.map(y=>(y.foreignRelations||(y.foreignRelations={}),Nt.forEach(v=>{if(v.id!==y.id){if(y.foreignRelations[v.id]===void 0){const W=((y.aggression||.3)+(v.aggression||.3))/2;y.foreignRelations[v.id]=Math.floor(50-W*30+(Math.random()-.5)*20)}if(Math.random()<.05){const W=(Math.random()-.5)*6;y.foreignRelations[v.id]=Is((y.foreignRelations[v.id]||50)+W,0,100)}}}),y)),T%30===0&&(Nt=Nt.map(y=>{if(y.isRebelNation)return y;const v=y.relation??50,te=y.alliedWithPlayer===!0?.1:.5;let Se=v;return v>50?Se=Math.max(50,v-te):v<50&&(Se=Math.min(50,v+te)),{...y,relation:Se}})),Nt.forEach(y=>{if(y.isRebelNation||y.alliedWithPlayer!==!0||(y.relation??50)>=70)return;const v=y.lastAllyColdEventDay||0;T-v<30||Math.random()<.005&&(y.lastAllyColdEventDay=T,gt.push(`ALLY_COLD_EVENT:${JSON.stringify({nationId:y.id,nationName:y.name,relation:Math.round(y.relation??50)})}`))});const Ct=Nt.filter(y=>m>=(y.appearEpoch??0)&&(y.expireEpoch==null||m<=y.expireEpoch)&&!y.isRebelNation);Ct.forEach(y=>{if(Math.random()>.02)return;const v=y.aggression??.3,W=y.wealth||500;if(v>.6||W<300)return;const te=Ct.filter(Qe=>{if(Qe.id===y.id||y.foreignWars?.[Qe.id]?.isAtWar)return!1;const ct=y.foreignRelations?.[Qe.id]??50;return ct>=40&&ct<80});if(te.length===0)return;const Se=te[Math.floor(Math.random()*te.length)];y.foreignRelations?.[Se.id];const pt=Math.floor(50+Math.random()*100);if(W>pt*3){y.wealth=Math.max(0,(y.wealth||0)-pt),Se.wealth=(Se.wealth||0)+pt;const Qe=Math.floor(5+Math.random()*8);y.foreignRelations||(y.foreignRelations={}),Se.foreignRelations||(Se.foreignRelations={}),y.foreignRelations[Se.id]=Is((y.foreignRelations[Se.id]||50)+Qe,0,100),Se.foreignRelations[y.id]=Is((Se.foreignRelations[y.id]||50)+Qe,0,100),y.foreignRelations[Se.id]>=80&&Se.foreignRelations[y.id]>=80?gt.push(` ${y.name}  ${Se.name} `):Math.random()<.3&&gt.push(` ${y.name}  ${Se.name} `)}}),Ct.forEach(y=>{if(Math.random()>.02||y.isAtWar||(y.wealth||500)<300)return;const W=Ct.filter(ct=>ct.id===y.id||ct.isAtWar||y.foreignWars?.[ct.id]?.isAtWar?!1:(y.foreignRelations?.[ct.id]??50)>=30);if(W.length===0)return;const te=W[Math.floor(Math.random()*W.length)],Se=Math.floor(20+Math.random()*60);Se*(1-.08)-Se*.5<=0||(y.wealth=(y.wealth||0)+Se*.05,te.wealth=(te.wealth||0)+Se*.05,y.foreignRelations||(y.foreignRelations={}),te.foreignRelations||(te.foreignRelations={}),y.foreignRelations[te.id]=Math.min(100,(y.foreignRelations[te.id]||50)+1),te.foreignRelations[y.id]=Math.min(100,(te.foreignRelations[y.id]||50)+1))}),Ct.forEach(y=>{if(Math.random()>.005||y.isAtWar||(y.relation??50)<40)return;const v=y.wealth||500;if(v<400)return;const W=y.openMarketUntil&&T<y.openMarketUntil,te=W?0:.08,Se=Math.random()>.5,pt=["food","wood","stone","iron"],Qe=pt[Math.floor(Math.random()*pt.length)],ct=h?.prices?.[Qe]||Re[Qe]?.basePrice||1,_t=Math.floor(10+Math.random()*40),Dt=_t*ct,mt=Math.floor(Dt*te);if(Se){const wt=ct*1.5,Bt=_t*wt,At=Dt+mt;if(Bt<=At)return;(P[Qe]||0)>=_t&&(P[Qe]=(P[Qe]||0)-_t,P.silver=(P.silver||0)+mt,y.wealth=Math.max(0,(y.wealth||0)-Dt-mt),gt.push(`AI_TRADE_EVENT:${JSON.stringify({nationId:y.id,nationName:y.name,tradeType:"export",resourceKey:Qe,quantity:_t,baseValue:Dt,tariff:mt,isOpenMarket:W})}`),y.relation=Math.min(100,(y.relation||50)+2))}else{const wt=_t*ct*.6;if(Dt-mt<=wt)return;v>=Dt*.6&&(P[Qe]=(P[Qe]||0)+_t,P.silver=(P.silver||0)+mt,y.wealth=(y.wealth||0)+Dt-mt,gt.push(`AI_TRADE_EVENT:${JSON.stringify({nationId:y.id,nationName:y.name,tradeType:"import",resourceKey:Qe,quantity:_t,baseValue:Dt,tariff:mt,isOpenMarket:W})}`),y.relation=Math.min(100,(y.relation||50)+2))}}),Ct.forEach(y=>{const v=y.wealth||500,W=y.aggression??.3,te=y.relation||0;if(y.isAtWar===!0)return;const pt=y.lastGiftToPlayerDay||0,ct=T-pt>=365,_t=2e-4+te/5e4+v/5e6;if(ct&&v>800&&te>=60&&W<.5&&Math.random()<_t){const ga=Math.floor(20+Math.random()*40+v*.001);y.wealth=Math.max(0,y.wealth-ga),y.lastGiftToPlayerDay=T,gt.push(`AI_GIFT_EVENT:${JSON.stringify({nationId:y.id,nationName:y.name,amount:Math.floor(ga)})}`)}const Dt=3e-4+Math.max(0,(400-v)/2e5);if(m>=1&&v<400&&Math.random()<Dt){const ga=Math.floor(80+Math.random()*120);gt.push(`AI_REQUEST_EVENT:${JSON.stringify({nationId:y.id,nationName:y.name,resourceKey:"silver",resourceName:"",amount:ga})}`)}const mt=y.alliedWithPlayer===!0,wt=y.lastAllianceRequestDay||0,At=T-wt>=365,Ma=2e-4+(te-70)/3e4;At&&!mt&&te>=70&&W<.5&&Math.random()<Ma&&(y.lastAllianceRequestDay=T,gt.push(`AI_ALLIANCE_REQUEST:${JSON.stringify({nationId:y.id,nationName:y.name})}`))}),Ct.forEach(y=>{if(Math.random()>.002||(y.aggression??.3)>.6)return;y.allies||(y.allies=[]);const W=Ct.filter(Qe=>{if(Qe.id===y.id||y.allies.includes(Qe.id)||y.foreignWars?.[Qe.id]?.isAtWar)return!1;const ct=y.foreignRelations?.[Qe.id]??50,_t=Qe.foreignRelations?.[y.id]??50;return ct>=70&&_t>=70});if(W.length===0)return;const te=W[Math.floor(Math.random()*W.length)],pt=(((y.foreignRelations?.[te.id]??50)+(te.foreignRelations?.[y.id]??50))/2-60)/100;Math.random()<pt&&(te.allies||(te.allies=[]),y.allies.push(te.id),te.allies.push(y.id),gt.push(` ${y.name}  ${te.name} `))}),Ct.forEach(y=>{if(Object.values(y.foreignWars||{}).filter(Se=>Se?.isAtWar).length<3||Ct.filter(Se=>Se.foreignWars?.[y.id]?.isAtWar&&Se.id!==y.id).length>=2)return;const te=Ct.filter(Se=>Se.id===y.id||Se.foreignWars?.[y.id]?.isAtWar||(Se.allies||[]).includes(y.id)?!1:(Se.foreignRelations?.[y.id]??50)<40);if(te.length>=2&&Math.random()<.005){const Se=te[Math.floor(Math.random()*te.length)];Se.foreignWars||(Se.foreignWars={}),y.foreignWars||(y.foreignWars={}),Se.foreignWars[y.id]={isAtWar:!0,warStartDay:T,warScore:0},y.foreignWars[Se.id]={isAtWar:!0,warStartDay:T,warScore:0},gt.push(` ${Se.name}  ${y.name} `)}}),Ct.forEach(y=>{y.foreignWars||(y.foreignWars={}),Ct.forEach(v=>{if(v.id===y.id||y.foreignWars[v.id]?.isAtWar)return;const W=y.foreignWars[v.id]?.peaceTreatyUntil||0;if(T<W||(y.allies||[]).includes(v.id)||(v.allies||[]).includes(y.id))return;const Se=Object.values(y.foreignWars||{}).filter(yt=>yt?.isAtWar).length,pt=y.aggression>.7?2:1;if(Se>=pt)return;const Qe=y.population||100,ct=y.wealth||500;if(Qe<30||ct<300)return;const mt=yt=>(yt.militaryStrength??1)*(yt.population||100)*(1+(yt.aggression||.3));let wt=mt(y),Bt=mt(v);Ct.forEach(yt=>{if(yt.id===y.id||yt.id===v.id)return;((y.allies||[]).includes(yt.id)||(yt.allies||[]).includes(y.id))&&(wt+=mt(yt)),((v.allies||[]).includes(yt.id)||(yt.allies||[]).includes(v.id))&&(Bt+=mt(yt))});const At=wt/Math.max(1,Bt),Ma=y.aggression>.7?.5:.7;if(At<Ma)return;const ka=Object.values(v.foreignWars||{}).filter(yt=>yt?.isAtWar).length>0?.002:0,La=y.foreignRelations?.[v.id]??50,Ca=y.aggression??.3,Va=La<50,en=Ca>.25,Kt=La<15;if(Va&&en||Kt){let yt=Ca*.003+(50-La)/5e3;La<10?yt+=.01:La<20&&(yt+=.003),At>2?yt*=2:At>1.5?yt*=1.5:At>1.2?yt*=1.2:At<.8&&(yt*=.1),yt+=ka*.5;const Ft=v.wealth||500,Et=y.wealth||500;if(y.militaryStrength,Ft>Et*1.5&&At>.8){const Yt=.003*Ca*(Ft/Et-1);yt+=Yt}if(yt=Math.min(.003,yt),Math.random()<yt){y.foreignWars[v.id]={isAtWar:!0,warStartDay:T,warScore:0},v.foreignWars||(v.foreignWars={}),v.foreignWars[y.id]={isAtWar:!0,warStartDay:T,warScore:0};const Yt=[` ${y.name}  ${v.name} `,` ${y.name}  ${v.name} `,` ${y.name}  ${v.name} `,` ${y.name}  ${v.name} `,` ${y.name}  ${v.name} `,` ${y.name}  ${v.name} `,` ${y.name}  ${v.name} `],tn=Yt[Math.floor(Math.random()*Yt.length)];gt.push(tn);const _a=v.alliedWithPlayer===!0,on=y.alliedWithPlayer===!0,Oa=_a&&on,Hn=3,yn=Ct.filter(Ta=>Ta.isAtWar===!0&&!Ta.isRebelNation).length;Oa?gt.push(`  ${y.name}  ${v.name} `):(_a&&!y.isAtWar&&gt.push(`ALLY_ATTACKED_EVENT:${JSON.stringify({allyId:v.id,allyName:v.name,attackerId:y.id,attackerName:y.name,currentPlayerWars:yn})}`),on&&!v.isAtWar&&(yn>=Hn?gt.push(`  ${y.name}  ${v.name} `):(v.isAtWar=!0,v.warStartDay=T,v.warDuration=0,v.relation=Math.max(0,(v.relation||50)-40),gt.push(`  ${y.name}  ${v.name}  ${v.name} `)))),Ct.forEach(Ta=>{if(Ta.id===y.id||Ta.id===v.id)return;((v.allies||[]).includes(Ta.id)||(Ta.allies||[]).includes(v.id))&&(Ta.foreignWars||(Ta.foreignWars={}),Ta.foreignWars[y.id]={isAtWar:!0,warStartDay:T,warScore:0},y.foreignWars||(y.foreignWars={}),y.foreignWars[Ta.id]={isAtWar:!0,warStartDay:T,warScore:0},gt.push(` ${Ta.name}  ${v.name}  ${y.name} `))})}}}),Object.keys(y.foreignWars||{}).forEach(v=>{const W=y.foreignWars[v];if(!W?.isAtWar)return;const te=Nt.find(Bt=>Bt.id===v);if(!te)return;te.foreignWars||(te.foreignWars={}),te.foreignWars[y.id]||(te.foreignWars[y.id]={isAtWar:!0,warStartDay:W.warStartDay||T,warScore:-(W.warScore||0)});const Se=T-(W.warStartDay||T),pt=Math.min(2,1+Se/500),Qe=.995-pt*.003,ct=.998-pt*.002,_t=Object.values(y.foreignWars||{}).filter(Bt=>Bt?.isAtWar).length,Dt=Object.values(te.foreignWars||{}).filter(Bt=>Bt?.isAtWar).length,mt=Math.pow(.998,_t-1),wt=Math.pow(.998,Dt-1);if(y.wealth=Math.max(100,(y.wealth||500)*Qe*mt),y.population=Math.max(10,(y.population||100)*ct*mt),te.wealth=Math.max(100,(te.wealth||500)*Qe*wt),te.population=Math.max(10,(te.population||100)*ct*wt),(T-W.warStartDay)%10===0&&T>W.warStartDay){const Bt=(y.militaryStrength??1)*(y.population||100)*(1+(y.aggression||.3)),At=(te.militaryStrength??1)*(te.population||100)*(1+(te.aggression||.3)),Ma=Bt+At,ga=Bt/Ma,ka=.02+Math.random()*.03;if(y.population=Math.max(10,(y.population||100)*(1-ka*(1-ga))),te.population=Math.max(10,(te.population||100)*(1-ka*ga)),Math.random()<ga){W.warScore=(W.warScore||0)+5,te.foreignWars[y.id].warScore=(te.foreignWars[y.id].warScore||0)-5;const Kt=Math.floor((te.wealth||500)*.08);y.wealth=(y.wealth||500)+Kt,te.wealth=Math.max(100,(te.wealth||500)-Kt)}else{W.warScore=(W.warScore||0)-5,te.foreignWars[y.id].warScore=(te.foreignWars[y.id].warScore||0)+5;const Kt=Math.floor((y.wealth||500)*.08);te.wealth=(te.wealth||500)+Kt,y.wealth=Math.max(100,(y.wealth||500)-Kt)}const La=Math.abs(W.warScore||0),Ca=(y.population||100)<30||(y.wealth||500)<200,Va=(te.population||100)<30||(te.wealth||500)<200,en=Ca||Va?.15:.05;if(La>25||Math.random()<en){const Kt=(W.warScore||0)>0?y:te,yt=Kt.id===y.id?te:y,Ft=Math.floor((yt.population||100)*.1),Et=Math.floor((yt.wealth||500)*.15);Kt.population=(Kt.population||100)+Ft,Kt.wealth=(Kt.wealth||500)+Et,yt.population=Math.max(10,(yt.population||100)-Ft),yt.wealth=Math.max(100,(yt.wealth||500)-Et),y.foreignWars[v]={isAtWar:!1,peaceTreatyUntil:T+730},te.foreignWars[y.id]={isAtWar:!1,peaceTreatyUntil:T+730},y.foreignRelations[v]=Is((y.foreignRelations[v]||50)-20,0,100),te.foreignRelations[y.id]=Is((te.foreignRelations[y.id]||50)-20,0,100);const Yt=T-(W.warStartDay||T),tn=[` ${Kt.name}  ${yt.name} ${Yt}${yt.name} `,` ${Yt}${Kt.name}  ${yt.name}`,` ${Kt.name}  ${yt.name} ${Yt}`,` ${Yt}${Kt.name}  ${yt.name}`,` ${Kt.name}  ${yt.name} `,` ${Yt}${Kt.name} ${yt.name} `,` ${Kt.name}  ${yt.name}${Yt}`],_a=tn[Math.floor(Math.random()*tn.length)];gt.push(_a)}}})});const He=.0015,_e=5e-4,Te=20,ut=.4,vt=200;let Ee=0,We=Math.max(0,c||0),xt=Math.max(0,J-xa);if(xt>0){const y=Math.max(0,r||0)*_e;if(We+=y,r<Te){const W=Math.max(0,(Te-r)/Te);We+=ut*W}const v=Math.min(xt,Math.floor(We));v>0&&(Ee+=v,We-=v,xt-=v)}xt>0&&Object.keys(Ke).forEach(y=>{if(xt<=0)return;const v=Ve[y]||0;if(v<=0)return;const W=Xe[y]??50,te=Math.max(0,(W-25)/75);if(te<=0)return;const Se=Qt[y]||0,pt=v>0?Se/v:0,Qe=Math.max(.3,Math.min(2,pt/vt)),ct=He*te*Qe;if(ct<=0)return;let _t=v*ct;if(_t<=0)return;const Dt=Math.floor(_t);let mt=Dt;const wt=_t-Dt;Math.random()<wt&&(mt+=1),!(mt<=0)&&(mt=Math.min(mt,xt),!(mt<=0)&&(Ee+=mt,xt-=mt))}),Ee>0&&(Ve.unemployed=(Ve.unemployed||0)+Ee,xa=Math.min(J,xa+Ee)),(P.food||0)<=0&&(P.food=0,Math.random()>.9&&xa>2&&(xa=xa-1,gt.push("")));let Fa=0;Object.keys(Ke).forEach(y=>{const v=Ve[y]||0;if(v===0)return;const W=Ke[y];if(!W||!W.needs)return;const te=Vn[y]||[],Se=te.some(ct=>(typeof ct=="string"?ct:ct.resource)==="food"),pt=te.some(ct=>(typeof ct=="string"?ct:ct.resource)==="cloth"),Qe=(I||{})[y];if(Qe&&Qe.length>=5){const ct=Qe.slice(-5),_t=ct.reduce((Dt,mt)=>Dt+mt,0)/ct.length;if((Se||pt)&&_t<.6){const Dt=W.name||y,mt=Math.max(0,(.6-_t)/.6*.05),wt=Math.max(1,Math.floor(v*mt));if(wt>0){Ve[y]=Math.max(0,v-wt),Fa+=wt;const Bt=Se&&pt?"":Se?"":"";gt.push(`${Dt} ${Bt}${wt} `)}}}});const nt=qs+Vi+Fa;nt>0&&(xa=Math.max(0,xa-nt)),xa=Math.max(0,Math.floor(xa)),Object.keys(P).forEach(y=>{P[y]<0&&(P[y]=0)});const Jt=jt.headTax*gi,na=jt.industryTax*gi,St=jt.businessTax*gi,pa=Jt+na+St,$a=pa+Oe;P.silver=(P.silver||0)+$a,kt.silver=(kt.silver||0)+$a,console.log("[TICK] Starting price and wage updates...");const Mn={...z},Rn={},ms=.35;Object.entries(pe).forEach(([y,v])=>{let W=0;const te=Ve[y]||0;if(te>0){const Qe=he[y]||0,ct=Me[y]||0;W=(Qe-ct)/te}else v.weightedWage>0&&v.totalSlots>0?W=v.weightedWage/v.totalSlots:W=H[y]||0;W=Math.max(0,W);const Se=H[y]||0,pt=Se+(W-Se)*ms;Rn[y]=parseFloat(pt.toFixed(2))});const In=Math.max(0,xa??r??0),Rs=go?.market||{},Vs=Math.max(0,Rs.supplyDemandWeight??1),Oo=Math.max(0,Rs.virtualDemandPerPop||0),Kr=Math.max(.1,Rs.inventoryTargetDays??1.5),Sl=Math.max(0,Rs.inventoryPriceImpact??.25);Object.keys(Re).forEach(y=>{if(!mi(y))return;const v=Re[y],W=v?.marketConfig||{};W.supplyDemandWeight!==void 0&&Math.max(0,W.supplyDemandWeight);const te=W.virtualDemandPerPop!==void 0?Math.max(0,W.virtualDemandPerPop):Oo,Se=W.inventoryTargetDays!==void 0?Math.max(.1,W.inventoryTargetDays):Kr;W.inventoryPriceImpact!==void 0&&Math.max(0,W.inventoryPriceImpact),qe[y];const pt=X[y]||0,Qe=te*In,_t=pt+Qe,Dt=P[y]||0,mt=_t>0?Dt/_t:Se,wt=[];let Bt=0;Ln.forEach(Et=>{const Yt=Et.output?.[y];if(!Yt||Yt<=0)return;const tn=ta[Et.id]||0;if(tn<=0)return;const _a=Et.marketConfig||{},on=_a.price||go?.price||{},Oa=_a.wage||go?.wage||{};U0(L,on);const Hn=U0(L,Oa);Et.input&&Object.entries(Et.input).forEach(([Wa,hs])=>{!hs||hs<=0||(z[Wa]||xc(Wa),tt(Wa))});const yn=Et.owner&&Et.jobs&&Et.jobs[Et.owner];Et.jobs&&!yn&&Object.entries(Et.jobs).forEach(([Wa,hs])=>{!hs||hs<=0||Rn[Wa]||me(Wa)}),_?.businessTaxRates?.[Et.id],Et.businessTaxBase,Et.owner&&(Hn[Et.owner]||0)*(Et.jobs[Et.owner]||0);const Ta=mt/Se;let qn=1;Ta<.5?qn=1+(1-Ta*2)*5:Ta<1?qn=1+(1-Ta)*1:Ta>2?(qn=1-(Ta-2)*.3,qn=Math.max(.1,qn)):Ta>1&&(qn=1-(Ta-1)*.3);let Di=xc(y)*qn;const ao=v.minPrice??dl,Gn=v.maxPrice;Di=Math.max(Di,ao),Gn!==void 0&&(Di=Math.min(Di,Gn));const Ki=Yt*tn;Bt+=Ki,wt.push({price:Di,output:Ki})});let At=0;if(Bt>0&&wt.length>0){let Et=0;wt.forEach(Yt=>{Et+=Yt.price*Yt.output}),At=Et/Bt}else{const Et=xc(y),Yt=mt/Se;let tn=1;Yt<.5?tn=1+(1-Yt*2)*5:Yt<1?tn=1+(1-Yt)*1:Yt>2?(tn=1-(Yt-2)*.3,tn=Math.max(.1,tn)):Yt>1&&(tn=1-(Yt-1)*.3),At=Et*tn;const _a=v.minPrice??dl,on=v.maxPrice;At=Math.max(At,_a),on!==void 0&&(At=Math.min(At,on))}const Ma=z[y]||At,ga=Ma+(At-Ma)*.1,ka=Nt.find(Et=>Et.isPlayer);let La=0;ka&&ka.foreignWars&&(La=Object.values(ka.foreignWars).filter(Et=>Et?.isAtWar).length);let Ca=0;Nt.forEach(Et=>{!Et.isPlayer&&Et.foreignWars&&Object.values(Et.foreignWars).forEach(Yt=>{Yt?.isAtWar&&Ca++})}),Ca=Math.floor(Ca/2);const Va=1+La*.025+Ca*.01,en=ga*Va,Kt=v.minPrice??dl,yt=v.maxPrice;let Ft=en;Ft=Math.max(Ft,Kt),yt!==void 0&&(Ft=Math.min(Ft,yt)),Mn[y]=parseFloat(Ft.toFixed(2))});const eo=y=>{const v=(q||{})[y];if(!v||v.length<2)return null;const W=v[v.length-1],te=v[v.length-2],Se=Math.max(1,o?.[y]||0);return(W-te)/Se},zo=y=>{const v=je[y];return!v||v.length===0?!1:v.some(W=>W&&W.availableSlots>0)},Rc=(y,v)=>{const W=je[y];if(!W||W.length===0||v<=0)return null;let te=-1,Se=0;for(let _t=0;_t<W.length;_t++){const Dt=W[_t];if(!Dt)continue;const mt=Dt.availableSlots>=1?Math.floor(Dt.availableSlots):Dt.availableSlots>0?1:0;mt>Se&&(Se=mt,te=_t)}if(te===-1||Se<=0)return null;const pt=W[te],Qe=Math.min(v,Se),ct={buildingId:pt.buildingId,buildingName:pt.buildingName,count:Qe};return pt.availableSlots-=Qe,pt.availableSlots<=0&&W.splice(te,1),ct},$c=(y=[])=>Array.isArray(y)?y.reduce((v,W)=>v+Math.max(0,W?.capitalLocked||0),0):0,vd=Math.max(0,Z?.lockedCapital??$c(Z?.pendingTrades||[])),jd=Qt.merchant||0,Pi=q5({res:P,wealth:fe,popStructure:Ve,supply:qe,demand:X,nations:Nt,tick:T,taxPolicies:V,taxBreakdown:jt,getLocalPrice:qt,roleExpense:Me,roleWagePayout:he,pendingTrades:Z.pendingTrades||[],lastTradeTime:Z.lastTradeTime||0,gameSpeed:p,logs:gt}),Oc=Math.max(0,Pi.lockedCapital??$c(Pi.pendingTrades));Pi.lockedCapital=Oc;const wd=Pi.capitalInvestedThisTick||0;"capitalInvestedThisTick"in Pi&&delete Pi.capitalInvestedThisTick;const zc={};ni.forEach(y=>{zc[y]=Math.max(0,(se[y]||0)-(Ve[y]||0))});const Nd=y=>y==="merchant"?(Qt.merchant||0)+Oc:Qt[y]||0,Md=y=>y==="merchant"?(x?.merchant||0)+vd:x?.[y]||0,jr=ni.map(y=>{const v=Ve[y]||0,W=Nd(y),te=Md(y),Se=W-te,pt=v>0?W/v:0,Qe=v>0?Se/v:0,ct=he[y]||0,_t=Me[y]||0,Dt=y==="merchant"?wd:0,wt=(ct-_t+Dt)/Math.max(1,v),Bt=Rn[y]||me(y),Ma=(Ke[y]?.headTaxBase??.01)*Je(y)*et,ga=Bt-Ma,ka=eo(y),La=y==="merchant"?wt:Qe,Ca=ka!==null?ka:La,Va=wt!==0?wt:ga,en=y==="merchant"||Ca!==0?y==="merchant"?Va:Ca:Va,Kt=pt>0?pt*.002:0,yt=en+Kt;return{role:y,pop:v,perCap:pt,perCapDelta:La,potentialIncome:yt,vacancy:zc[y]||0}}),Bo=jr.reduce((y,v)=>v.pop>0?y+v.pop:y,0),_d=Bo>0?jr.reduce((y,v)=>y+v.potentialIncome*v.pop,0)/Bo:0;Bo>0&&jr.reduce((y,v)=>y+v.perCap*v.pop,0)/Bo;const ss=jr.filter(y=>{if(y.pop<=0||y.role==="soldier")return!1;const v=y.perCap*.05,W=-Math.max(.5,Math.min(50,v));return y.potentialIncome<_d*.7||y.perCapDelta<W}).reduce((y,v)=>!y||v.potentialIncome<y.potentialIncome||v.potentialIncome===y.potentialIncome&&v.perCapDelta<y.perCapDelta?v:y,null);let Ys=null;if(ss&&(Ys=jr.filter(y=>y.role===ss.role||y.vacancy<=0?!1:(y.role==="soldier"||zo(y.role))&&y.potentialIncome>ss.potentialIncome*1.3).reduce((y,v)=>!y||v.potentialIncome>y.potentialIncome?v:(v.potentialIncome===y.potentialIncome&&v.perCapDelta>y.perCapDelta,y),null)),ss&&Ys){let y=null,v=Math.floor(ss.pop*S1);if(v<=0&&ss.pop>0&&S1>0&&(v=1),v=Math.min(v,Ys.vacancy),v>0)if(Ys.role==="soldier")y={buildingId:null,buildingName:"",count:v};else{const W=Rc(Ys.role,v);!W||W.count<=0?v=0:(v=W.count,y=W)}if(v>0){const W=fe[ss.role]||0,Se=(ss.pop>0?W/ss.pop:0)*v;Se>0&&(fe[ss.role]=Math.max(0,W-Se),fe[Ys.role]=(fe[Ys.role]||0)+Se),Ve[ss.role]=Math.max(0,ss.pop-v),Ve[Ys.role]=(Ve[Ys.role]||0)+v,Ke[ss.role]?.name||ss.role,Ke[Ys.role]?.name||Ys.role,((Ys.potentialIncome-ss.potentialIncome)/Math.max(.01,ss.potentialIncome)*100).toFixed(0),y?.buildingName&&`${y.buildingName}`}}Ie();const to=Math.max(0,fe.merchant||0),Bc=to-jd;if(Bc!==0){Qt.merchant=to,hi+=Bc;const y=Ke.merchant;if(y){const v=Ve.merchant||0,W=y.influenceBase*v+(hi>0?to/hi*10:0),te=W-(be.merchant||0);be.merchant=W,Un+=te}}jt.policyIncome=ht,jt.policyExpense=ft;const Ed={total:pa-jt.subsidy+Oe+ht-ft,efficiency:gi,breakdown:{headTax:Jt,industryTax:na,businessTax:St,subsidy:jt.subsidy,warIndemnity:Oe,policyIncome:ht,policyExpense:ft}};return console.log("[TICK END]",T,"militaryCapacity:",le),{resources:P,rates:kt,popStructure:Ve,maxPop:J,militaryCapacity:le,population:xa,birthAccumulator:We,classApproval:Xe,classInfluence:be,classWealth:Qt,classLivingStandard:Wn,totalInfluence:Un,totalWealth:hi,activeBuffs:oi,activeDebuffs:Dn,stability:Ds,logs:gt,market:{prices:Mn,demand:X,supply:qe,wages:Rn,needsShortages:Vn},classIncome:he,classExpense:Me,jobFill:Rt,jobsAvailable:se,taxes:Ed,needsShortages:Vn,needsReport:vs,livingStandardStreaks:fs,nations:Nt,merchantState:Pi,modifiers:{resourceDemand:{...lt,...Object.fromEntries(Object.entries(ne).map(([y,v])=>[y,(lt[y]||0)+v]))},stratumDemand:{...Vt,...Object.fromEntries(Object.entries(Ne).map(([y,v])=>[y,(Vt[y]||0)+v]))},resourceSupply:oa,buildingProduction:{...ot,...$e},categoryProduction:B,sources:{decreeResourceDemand:lt,decreeStratumDemand:Vt,decreeResourceSupply:oa,eventResourceDemand:ne,eventStratumDemand:Ne,eventBuildingProduction:$e,techBuildingBonus:ot,techCategoryBonus:B,stratumWealthMultiplier:ns}}}};function I0(t){return Re[t]?.name||t}const H0={TAX_RELIEF:"tax_relief",SUBSIDY:"subsidy",RESOURCE:"resource",POLITICAL:"political"},Xi={TAX_PRESSURE:"grievance_tax_pressure",BASIC_SHORTAGE:"grievance_basic_shortage",LUXURY_SHORTAGE:"grievance_luxury_shortage",INCOME_CRISIS:"grievance_income_crisis",LIVING_STANDARD:"grievance_living_standard"},F5={[H0.TAX_RELIEF]:{name:"",icon:"Percent",color:"text-yellow-400",bgColor:"bg-yellow-900/20",borderColor:"border-yellow-500/30",description:"",requirement:"100%10",failurePenalty:{organization:15,effect:"",description:" +15%"},duration:30},[H0.SUBSIDY]:{name:"",icon:"Heart",color:"text-pink-400",bgColor:"bg-pink-900/20",borderColor:"border-pink-500/30",description:"",requirement:"5",failurePenalty:{organization:10,effect:"",description:" +10%"},duration:20},[H0.RESOURCE]:{name:"",icon:"Package",color:"text-orange-400",bgColor:"bg-orange-900/20",borderColor:"border-orange-500/30",description:"",requirement:"30",failurePenalty:{organization:20,effect:"",description:" +20%"},duration:30},[H0.POLITICAL]:{name:"",icon:"Flag",color:"text-purple-400",bgColor:"bg-purple-900/20",borderColor:"border-purple-500/30",description:"",requirement:"",failurePenalty:{organization:25,effect:"",description:" +25%"},duration:45},[Xi.TAX_PRESSURE]:{name:"",icon:"Percent",color:"text-amber-300",bgColor:"bg-amber-900/30",borderColor:"border-amber-500/30",description:"",requirement:"",failurePenalty:{description:""},duration:60},[Xi.BASIC_SHORTAGE]:{name:"",icon:"Package",color:"text-red-300",bgColor:"bg-red-900/20",borderColor:"border-red-500/30",description:"",requirement:"",failurePenalty:{description:""},duration:45},[Xi.LUXURY_SHORTAGE]:{name:"",icon:"Sparkles",color:"text-blue-300",bgColor:"bg-blue-900/20",borderColor:"border-blue-500/30",description:"/",requirement:"",failurePenalty:{description:""},duration:50},[Xi.INCOME_CRISIS]:{name:"",icon:"TrendingDown",color:"text-rose-300",bgColor:"bg-rose-900/30",borderColor:"border-rose-500/30",description:"",requirement:"",failurePenalty:{description:""},duration:60},[Xi.LIVING_STANDARD]:{name:"",icon:"Activity",color:"text-sky-300",bgColor:"bg-sky-900/30",borderColor:"border-sky-500/30",description:"/",requirement:"",failurePenalty:{description:""},duration:70}};function Y5(t,s){const r=[],o=s.classShortages?.[t]||[],c=s.classApproval?.[t]??50,u=Ke[t],p=s.classLivingStandard?.[t],m=typeof p=="object"&&p!==null?p.satisfactionRate??1:p??1,h=s.classInfluence?.[t]||0,x=s.totalInfluence||0,g=x>0?h/x:0,b=s.classIncome?.[t]||0,j=s.popStructure?.[t]||1,_=b/Math.max(j,1),N=u?.headTaxBase??0,M=s.taxPolicies?.headTaxRates?.[t]??1,R=N*M;let E=0;const T=s.taxPolicies?.resourceTaxRates||{},D=s.market||{},O=u?.needs||{};for(const[z,V]of Object.entries(O))if(V>0){const F=T[z]||0,re=D?.prices?.[z]||Re[z]?.basePrice||1;E+=V*re*F}const q=R+E,I=_>0?q/_:0,Z=o.filter(z=>z.reason==="unaffordable"),Y=o.filter(z=>z.reason==="outOfStock");if(I>.3){const z=Math.min(2,I*3),V=` ${Math.round(I*100)}%: ${R.toFixed(1)}: ${E.toFixed(1)}`;r.push({type:"tax",icon:"Percent",label:"",detail:V,contribution:z,severity:I>.5?"danger":"warning"})}const S=u?.needs||{},Q=new Set(Object.keys(S)),ne=Z.filter(z=>Q.has(z.resource)),Ne=Z.filter(z=>!Q.has(z.resource)),$e=Y.filter(z=>Q.has(z.resource)),de=Y.filter(z=>!Q.has(z.resource));if(ne.length>0){const z=Math.min(1.5,ne.length*.4);r.push({type:"unaffordable_basic",icon:"DollarSign",label:"",detail:`${ne.length}`,contribution:z,severity:ne.length>=2?"danger":"warning",resources:ne.map(V=>I0(V.resource))})}const P=Ne.length+de.length;if(P>0){const z=Math.min(.6,P*.12),V=[...Ne,...de].map(re=>I0(re.resource)),F=V.length>0?`${V.join("")}`:"";r.push({type:"unaffordable_luxury",icon:"Sparkles",label:"",detail:F,contribution:z,severity:P>=3?"warning":"info",resources:V})}if($e.length>0){const z=Math.min(2,$e.length*.6);r.push({type:"outOfStock_basic",icon:"Package",label:"",detail:`${$e.length}`,contribution:z,severity:$e.length>=2?"danger":"warning",resources:$e.map(V=>I0(V.resource))})}if(de.length>=4){const z=Math.min(.3,de.length*.05);r.push({type:"outOfStock_luxury",icon:"ShoppingBag",label:"",detail:`${de.length}`,contribution:z,severity:"info",resources:de.slice(0,3).map(V=>I0(V.resource))})}if(m<.7){const z=Math.min(1,(1-m)*1.5);r.push({type:"livingStandard",icon:"TrendingDown",label:"",detail:` ${Math.round(m*100)}%`,contribution:z,severity:m<.5?"danger":"warning"})}if(console.log(`[Demands] ${t}: influenceShare=${g.toFixed(3)}, approval=${c}, totalInfluence=${x}, influence=${h}`),g>.1&&c<40){const z=Math.min(1,g*2);r.push({type:"political",icon:"Flag",label:"",detail:` ${Math.round(g*100)}% ${Math.round(c)}`,contribution:z,severity:"warning"})}return r.sort((z,V)=>V.contribution-z.contribution),{sources:r,totalContribution:r.reduce((z,V)=>z+V.contribution,0),hasIssues:r.length>0}}function X5(t,s){return t?Math.max(0,(t.deadline||0)-s):0}const Ga={PEACEFUL:"peaceful",GRUMBLING:"grumbling",MOBILIZING:"mobilizing",RADICALIZING:"radicalizing",UPRISING:"uprising"},Z5={[Ga.PEACEFUL]:ii.NONE,[Ga.GRUMBLING]:ii.BREWING,[Ga.MOBILIZING]:ii.PLOTTING,[Ga.RADICALIZING]:ii.PLOTTING,[Ga.UPRISING]:ii.ACTIVE},wl=t=>Z5[t]||ii.NONE,Gr={GRUMBLING:30,MOBILIZING:50,RADICALIZING:70,UPRISING:90},Q5={landowner:1.5,capitalist:2,knight:1.3,official:1.2,merchant:1.1,engineer:1,navigator:1,cleric:.9,scribe:.9,artisan:.8,worker:1,miner:.9,lumberjack:.8,soldier:1.2,peasant:.8,serf:.6,slave:.3,unemployed:.2},J5={peasant:"landowner",serf:"landowner",worker:"capitalist",miner:"capitalist",lumberjack:"landowner",merchant:"official",artisan:"merchant",cleric:"scribe",soldier:"official",knight:"official",engineer:"capitalist",navigator:"merchant",scribe:"cleric",official:"merchant",landowner:"peasant",capitalist:"worker"},Ip=.1,Oy={MIN_ORGANIZATION_TO_JOIN:70,COALITION_BONUS:.1};function K5(t,s,r,o,c){const u=[t];let p=r[t]||0;Object.keys(s).forEach(x=>{if(x===t||x==="slave")return;const b=s[x]?.organization||0;(c[x]||0)>0&&b>=Oy.MIN_ORGANIZATION_TO_JOIN&&(u.push(x),p+=r[x]||0,console.log(`[COALITION] ${x} qualifies for coalition (org: ${b.toFixed(1)}%)`))});const m=o>0?p/o:0,h=u.length>1;return h&&(console.log(`[COALITION] Found ${u.length} strata eligible for coalition rebellion:`,u),console.log(`[COALITION] Total influence share: ${(m*100).toFixed(1)}%`)),{isCoalition:h,coalitionStrata:u,totalInfluenceShare:m}}const pc={tax:.7,basicShortage:1,luxuryShortage:.35,lowIncome:.8,livingStandard:.35},fc=60,e3=.65,t3=(t=50)=>{if(!Number.isFinite(t))return 1;const r=1+Math.max(-1,Math.min(1,(50-t)/50))*.6;return Math.max(.35,Math.min(1.75,r))},A1=(t,s={})=>{const r=s?.[t];return Number.isFinite(r)&&r>0?r:Re[t]?.basePrice||1},a3=t=>{if(t&&typeof t=="object"){if(Number.isFinite(t.satisfactionRate))return t.satisfactionRate;if(Number.isFinite(t.value))return t.value}return Number.isFinite(t)?t:1},P1=(t=[],s=3)=>!Array.isArray(t)||t.length===0?"":t.slice(0,s).map(r=>{const o=typeof r=="string"?r:r.resource;return Re[o]?.name||o}).join(""),q0=(t=[],s)=>t.filter(r=>r?r.reason==="both"?!0:r.reason===s:!1).length,n3=(t,{shortages:s=[],taxPolicies:r={},classIncome:o={},classExpense:c={},popStructure:u={},market:p={},classLivingStandard:m={},livingStandardStreaks:h={},currentDay:x=0}={})=>{const g=Ke[t]||{},b=g.needs||{},j=Object.keys(b),_=new Set(j),N=new Set;g.luxuryNeeds&&Object.values(g.luxuryNeeds).forEach(ot=>{ot&&Object.keys(ot).forEach(B=>N.add(B))});const M=p?.prices||{},R=[],E=[];s.forEach(ot=>{if(!ot||!ot.resource)return;const B=ot.resource;if(N.has(B)){E.push(ot);return}if(_.has(B)){R.push(ot);return}E.push(ot)});const T=Math.max(0,u[t]||0);if(T<=0)return{driverScore:0,hasBasicShortage:!1,demands:[]};const D=(o[t]||0)/T,O=c[t]||0,q=O>0?O/T:0,I=g.headTaxBase??0,Z=r?.headTaxRates?.[t]??1,Y=I*Z,U=r?.resourceTaxRates||{};let S=0;j.forEach(ot=>{const B=b[ot];if(!B)return;const Ue=U[ot]||0;if(Ue<=0)return;const ht=A1(ot,M);S+=B*ht*Ue});const Q=Y+S,ne=D>0?Q/D:Q>0?1:0,Ne=.35,$e=Math.max(0,(ne-Ne)/.4),de=Math.min(1.8,$e),P=q0(R,"outOfStock"),z=q0(R,"unaffordable"),V=Math.min(2,P*.6+z*.45),F=q0(E,"outOfStock"),re=q0(E,"unaffordable"),C=Math.min(1,F*.2+re*.15);let L=0;j.forEach(ot=>{const B=b[ot];B&&(L+=B*A1(ot,M))});const ie=a3(m[t]),H=m[t];let me=(q>0?q:L)*(ie<.6?1.25:1.08);me<=0&&(me=.01);let X=0;if(D<me*.97){const ot=Math.max(0,(me-D)/me);X=Math.min(1.2,ot*1.2)}const qe=[];if(de>.05){const ot=Math.round(ne*100);qe.push({id:`${t}_tax_${x}`,type:Xi.TAX_PRESSURE,createdDay:x,deadline:x+fc,requirement:` ${Math.round(Ne*100)}%  ${ot}%`,failurePenalty:{description:""},currentProgress:Math.max(0,Math.min(1,1-Math.max(0,ne-Ne)))})}if(V>0){const ot=Array.from(new Set(R.map(Ue=>Re[Ue.resource]?.name||Ue.resource))),B=P1(R,4);qe.push({id:`${t}_basic_${x}`,type:Xi.BASIC_SHORTAGE,createdDay:x,deadline:x+fc,requirement:B?`${B}`:"",missingResources:ot,failurePenalty:{description:""},currentProgress:0})}if(C>.05){const ot=Array.from(new Set(E.map(Ue=>Re[Ue.resource]?.name||Ue.resource))),B=P1(E,4);qe.push({id:`${t}_luxury_${x}`,type:Xi.LUXURY_SHORTAGE,createdDay:x,deadline:x+fc,requirement:B?`${B}`:"",missingResources:ot,failurePenalty:{description:""},currentProgress:0})}X>.05&&qe.push({id:`${t}_income_${x}`,type:Xi.INCOME_CRISIS,createdDay:x,deadline:x+fc,requirement:` ${me.toFixed(1)} ${D.toFixed(1)}`,failurePenalty:{description:""},currentProgress:Math.min(1,D/me)});const fe=h?.[t]||{},Je=fe.level||H?.level,tt=fe.streak||0;let Mt=0;if(Je===""||Je===""){const ot=H?.score??40,B=Math.min(1.2,tt/5*.5),Ue=Math.max(0,(60-ot)/80);if(Mt=Math.min(.6,B*.6+Ue*.6),tt>=3){const ht=`${Je}${tt}`;qe.push({id:`${t}_living_${x}`,type:Xi.LIVING_STANDARD,createdDay:x,deadline:x+fc,requirement:ht,failurePenalty:{description:""},currentProgress:Math.min(1,Math.max(0,(ot-30)/40))})}}return{driverScore:de*pc.tax+V*pc.basicShortage+C*pc.luxuryShortage+X*pc.lowIncome+Mt*pc.livingStandard,hasBasicShortage:R.length>0,demands:qe}};function Fr(t){return t>=Gr.UPRISING?Ga.UPRISING:t>=Gr.RADICALIZING?Ga.RADICALIZING:t>=Gr.MOBILIZING?Ga.MOBILIZING:t>=Gr.GRUMBLING?Ga.GRUMBLING:Ga.PEACEFUL}function s3(t,s,r,o){const c=Q5[o]||1,u=1-r/100*.8;if(t<45){const p=(45-t)/45*1,m=1+s*.3;return p*c*m*u}if(t>50){let p=-.3;return t>80&&(p=-.6),p}return 0}function i3(t,s,r,o,c,u,p={}){const{hasActivePromise:m=!1,driverContext:h={},hasBasicShortage:x=!0}=p||{},g={organization:t?.organization??0,stage:t?.stage??Ga.PEACEFUL,growthRate:t?.growthRate??0,lastStageChange:t?.lastStageChange??0,activeDemands:t?.activeDemands??[],actionCooldowns:t?.actionCooldowns??{},organizationPaused:t?.organizationPaused??0,resistance:t?.resistance??0};g.resistance>0&&(g.resistance=Math.max(0,g.resistance-.5)),g.organizationPaused>0&&(g.organizationPaused=Math.max(0,g.organizationPaused-1));let b=s3(s,r,o,c);const j=Number.isFinite(h.driverScore)?h.driverScore:0;j!==0&&(b+=j),m&&b>0&&(b=b*.5),g.organizationPaused>0&&b>0&&(b=0),b>0&&(b*=t3(o),b*=e3),g.activeDemands=h.demands||[],g.growthRate=b;let _=Math.max(0,Math.min(100,g.organization+b));!x&&s<45&&_>50&&(_=50,g.growthRate>0&&(g.growthRate=0)),r<Ip&&_>75&&(_=75,g.growthRate>0&&(g.growthRate=0));const N=g.stage;return g.organization=_,g.stage=Fr(_),g.phase=wl(g.stage),g.stage!==N&&(g.lastStageChange=u),g}function r3(t,s,r,o,c,u,p=[],m={},h={}){const{classIncome:x={},classExpense:g={},popStructure:b={},taxPolicies:j={},market:_={},classLivingStandard:N={},livingStandardStreaks:M={},epoch:R=0}=h||{},E=Number.isFinite(R)?R:0,T={};return Object.keys(Ke).forEach(D=>{if(D==="slave")return;if(D==="unemployed"&&E<=0){const ne=t[D];T[D]={organization:0,stage:Ga.PEACEFUL,phase:ii.NONE,growthRate:0,lastStageChange:u,activeDemands:[],actionCooldowns:ne?.actionCooldowns||{},organizationPaused:0,resistance:0};return}const O=s[D]??50,q=r[D]||0,I=o>0?q/o:0;if((b[D]||0)<=0){const ne=t[D]||{};T[D]={organization:0,stage:Ga.PEACEFUL,phase:ii.NONE,growthRate:0,lastStageChange:u,activeDemands:[],actionCooldowns:ne?.actionCooldowns||{},organizationPaused:Math.max(0,(ne?.organizationPaused||0)-1),resistance:Math.max(0,(ne?.resistance||0)-.5)};return}const Y=p.some(ne=>ne.stratumKey===D&&!ne.completed&&!ne.failed),U=m[D]||[],S=n3(D,{shortages:U,taxPolicies:j,classIncome:x,classExpense:g,popStructure:b,market:_,classLivingStandard:N,livingStandardStreaks:M,currentDay:u}),Q=t[D];T[D]=i3(Q,O,I,c,D,u,{hasActivePromise:Y,driverContext:S,hasBasicShortage:!!S.hasBasicShortage})}),T}function o3(t,s){const r=[];return Object.keys(s).forEach(o=>{const c=t[o],u=s[o];if(!c||!u)return;const p=c.organization||0,m=u.organization||0;p<Gr.GRUMBLING&&m>=Gr.GRUMBLING&&r.push({type:"brewing",stratumKey:o,organization:m,stage:u.stage}),p<Gr.RADICALIZING&&m>=Gr.RADICALIZING&&r.push({type:"plotting",stratumKey:o,organization:m,stage:u.stage}),p<100&&m>=100&&r.push({type:"uprising",stratumKey:o,organization:m,stage:u.stage})}),r}function Nf(t){return J5[t]||"official"}function zy(t){switch(t){case Ga.PEACEFUL:return"Coffee";case Ga.GRUMBLING:return"AlertTriangle";case Ga.MOBILIZING:return"Eye";case Ga.RADICALIZING:return"AlertCircle";case Ga.UPRISING:return"Flame";default:return"Coffee"}}function By(t){switch(t){case Ga.PEACEFUL:return"";case Ga.GRUMBLING:return"";case Ga.MOBILIZING:return"";case Ga.RADICALIZING:return"";case Ga.UPRISING:return"";default:return""}}function Ly(t,s){if(s<=0)return null;if(t>=100)return 0;const r=100-t;return Math.ceil(r/s)}function fp(t){return Re[t]?.name||t}const Nn={DECLARE_WAR:"declare_war",ESTABLISH_TRADE:"establish_trade",TAX_RELIEF:"tax_relief",LOWER_PRICE:"lower_price",RAISE_PRICE:"raise_price",WEALTH_BOOST:"wealth_boost",LIVING_STANDARD:"living_standard",APPROVAL:"approval"},l3={[Nn.DECLARE_WAR]:{name:"",icon:"Swords",achieveDeadline:180,maintainDuration:0,description:t=>` ${t.targetNationName||""} `},[Nn.ESTABLISH_TRADE]:{name:"",icon:"Ship",achieveDeadline:180,maintainDuration:0,description:t=>` ${fp(t.targetResource)} `},[Nn.TAX_RELIEF]:{name:"",icon:"Percent",achieveDeadline:180,maintainDuration:360,description:t=>` ${Math.round((t.targetTaxRatio||.5)*100)}%1`},[Nn.LOWER_PRICE]:{name:"",icon:"TrendingDown",achieveDeadline:180,maintainDuration:180,description:t=>` ${fp(t.targetResource)}  ${t.targetPrice?.toFixed(2)||""}`},[Nn.RAISE_PRICE]:{name:"",icon:"TrendingUp",achieveDeadline:180,maintainDuration:180,description:t=>` ${fp(t.targetResource)}  ${t.targetPrice?.toFixed(2)||""}`},[Nn.WEALTH_BOOST]:{name:"",icon:"Coins",achieveDeadline:360,maintainDuration:0,description:t=>` ${Math.round((t.targetWealthIncrease||.2)*100)}%`},[Nn.LIVING_STANDARD]:{name:"",icon:"Heart",achieveDeadline:180,maintainDuration:180,description:t=>` ${Math.round((t.targetSatisfaction||.7)*100)}%`},[Nn.APPROVAL]:{name:"",icon:"ThumbsUp",achieveDeadline:180,maintainDuration:180,description:t=>` ${t.targetApproval||60}%`}},Yi={ACHIEVING:"achieving",MAINTAINING:"maintaining",COMPLETED:"completed",FAILED:"failed"};function c3(t,s){const r=[],{nations:o,taxPolicies:c,market:u,classWealth:p,needsReport:m,tradeRoutes:h}=s||{};if(["soldier","knight"].includes(t)){const R=(o||[]).filter(E=>(E.relation||50)<30&&!E.isAtWar);R.length>0&&r.push({type:Nn.DECLARE_WAR,weight:3,params:{targetNation:R[0],targetNationName:R[0].name}})}if(["merchant","navigator"].includes(t)){const R=d3(t,s);R&&r.push({type:Nn.ESTABLISH_TRADE,weight:3,params:{targetResource:R}})}const x=Vy(t,s);if(x>.3){const R=.2+Math.random()*.4;r.push({type:Nn.TAX_RELIEF,weight:4,params:{currentTaxBurden:x,targetTaxRatio:R}})}const g=u3(t,s);if(g){const R=u?.prices?.[g.resource]||1,E=R*(.5+Math.random()*.3);r.push({type:Nn.LOWER_PRICE,weight:3,params:{targetResource:g.resource,targetPrice:E,currentPrice:R}})}const b=p3(t);if(b){const R=u?.prices?.[b]||1,E=u?.basePrices?.[b]||1;if(R<E*.8){const T=E*(1+Math.random()*.3);r.push({type:Nn.RAISE_PRICE,weight:2,params:{targetResource:b,targetPrice:T,currentPrice:R}})}}const j=f3(s),_=p?.[t]||0;_<j*.5&&r.push({type:Nn.WEALTH_BOOST,weight:2,params:{currentWealth:_,targetWealthIncrease:.2+Math.random()*.3}});const N=m?.[t]?.satisfactionRatio||1;N<.6&&r.push({type:Nn.LIVING_STANDARD,weight:3,params:{currentSatisfaction:N,targetSatisfaction:Math.min(.9,N+.2)}});const M=s.classApproval?.[t]||50;return r.push({type:Nn.APPROVAL,weight:1,params:{currentApproval:M,targetApproval:Math.min(80,Math.max(50,Math.round(M+10)))}}),m3(r)}function d3(t,s){const r=s?.classShortages?.[t]||[],o=r.find(m=>m.reason==="unaffordable");if(o)return o.resource;const c=r.find(m=>m.reason==="outOfStock");if(c)return c.resource;const{needsReport:u}=s||{},p=u?.[t]?.details||[];for(const m of p)if(m.shortage&&m.shortage>0)return m.resource;return null}function Vy(t,s){const{classIncome:r,taxPolicies:o}=s||{},c=r?.[t]||1,u=Ke[t],p=u?.headTaxBase??0,m=o?.headTaxRates?.[t]??1,h=p*m;let x=0;const g=o?.resourceTaxRates||{},b=u?.needs||{};for(const[M,R]of Object.entries(b))if(R>0){const E=g[M]||0;x+=R*E}const j=h+x,_=s?.popStructure?.[t]||1,N=c/Math.max(_,1);return N<=0?j>0?1:0:Math.min(1,j/N)}function u3(t,s){const{market:r,classShortages:o}=s||{},c=r?.prices||{},u=r?.basePrices||{},p=j=>{const _=c[j]||1,N=u[j]||1,M=_/N;return{resource:j,price:_,basePrice:N,ratio:M}},h=(o?.[t]||[]).filter(j=>j.reason==="unaffordable").map(j=>p(j.resource)).sort((j,_)=>_.ratio-j.ratio);if(h.length>0)return h[0];const x=Ke[t];if(!x?.needs)return null;const g=[],b=new Set;return Object.keys(x.needs).forEach(j=>{if(b.has(j))return;const _=p(j);_.price>_.basePrice*1.3&&(g.push(_),b.add(j))}),x.luxuryNeeds&&Object.values(x.luxuryNeeds).forEach(j=>{j&&Object.keys(j).forEach(_=>{if(b.has(_))return;const N=p(_);N.price>N.basePrice*1.3&&(g.push(N),b.add(_))})}),g.length>0?(g.sort((j,_)=>_.ratio-j.ratio),g[0]):null}function p3(t){return{peasant:"food",serf:"food",lumberjack:"lumber",miner:"ore",worker:"stock",artisan:"tools"}[t]||null}function f3(t){const{classWealth:s,popStructure:r}=t||{};if(!s||!r)return 100;let o=0,c=0;for(const[u,p]of Object.entries(r))p>0&&(o+=s[u]||0,c+=p);return c>0?o/Object.keys(r).length:100}function m3(t){if(t.length===0)return null;const s=t.reduce((o,c)=>o+(c.weight||1),0);let r=Math.random()*s;for(const o of t)if(r-=o.weight||1,r<=0)return o;return t[t.length-1]}function h3({stratumKey:t,stratumName:s,currentDay:r=0,failurePenalty:o={organization:50},context:c={}}){const u=c3(t,c);if(!u)return null;const{type:p,params:m}=u,h=l3[p],x={id:`promise_${t}_${Date.now()}`,type:p,stratumKey:t,stratumName:s,phase:Yi.ACHIEVING,createdDay:r,achieveDeadline:r+h.achieveDeadline,maintainDuration:h.maintainDuration,maintainEndDay:null,failurePenalty:o,...m};return x.description=h.description(x),x}function x3(t,s){const{classApproval:r={},market:o={},nations:c=[],taxPolicies:u={},classWealth:p={},needsReport:m={},tradeRoutes:h={}}=s;switch(t.type){case Nn.DECLARE_WAR:return c.find(g=>g.id===t.targetNation?.id||g.name===t.targetNationName)?.isAtWar===!0;case Nn.ESTABLISH_TRADE:return(h?.routes||[]).some(g=>g.resource===t.targetResource&&g.active);case Nn.TAX_RELIEF:{const x=Vy(t.stratumKey,s),g=t.currentTaxBurden||.5;return x<=g*(t.targetTaxRatio||.5)}case Nn.LOWER_PRICE:return(o.prices?.[t.targetResource]||1/0)<=(t.targetPrice||1/0);case Nn.RAISE_PRICE:return(o.prices?.[t.targetResource]||0)>=(t.targetPrice||0);case Nn.WEALTH_BOOST:{const x=p[t.stratumKey]||0,g=t.currentWealth||1,b=t.targetWealthIncrease||.2;return x>=g*(1+b)}case Nn.LIVING_STANDARD:return(m[t.stratumKey]?.satisfactionRatio||0)>=(t.targetSatisfaction||.7);case Nn.APPROVAL:return(r[t.stratumKey]||0)>=(t.targetApproval||60);default:return!1}}function g3(t,s){return t?t.phase===Yi.ACHIEVING?Math.max(0,(t.achieveDeadline||0)-s):t.phase===Yi.MAINTAINING?Math.max(0,(t.maintainEndDay||0)-s):0:0}function y3(t=[],s={}){const{currentDay:r=0}=s,o=[],c=[],u=[],p=[];return t.forEach(m=>{if(!m)return;const h=x3(m,s);if(m.phase===Yi.ACHIEVING)if(h)if(m.maintainDuration>0){const x={...m,phase:Yi.MAINTAINING,maintainEndDay:r+m.maintainDuration,achievedDay:r};p.push(x),u.push(x)}else o.push({...m,phase:Yi.COMPLETED});else r>=(m.achieveDeadline||0)?c.push({...m,phase:Yi.FAILED}):u.push(m);else m.phase===Yi.MAINTAINING&&(h?r>=(m.maintainEndDay||0)?o.push({...m,phase:Yi.COMPLETED}):u.push(m):c.push({...m,phase:Yi.FAILED,failReason:"maintain_broken"}))}),{completed:o,failed:c,remaining:u,updated:p}}function D1(t,s,r){return!(Object.values(t||{}).reduce((c,u)=>c+(u||0),0)===0||r==="soldier"||r==="knight")}function R1(t){const s=t.soldier,r=t.knight;return s&&s.phase===ii.ACTIVE||r&&r.phase===ii.ACTIVE}function b3(t,s,r={},o,c){const u=b=>Math.max(0,Math.min(100,b)),p=u(r.organization||0),m=r.stage||Fr(p),h={success:!1,newPhase:wl(m),playerLosses:0,rebelLosses:0,message:"",updatedOrganization:void 0,pauseDays:0,approvalChange:0},x=b=>{const j=u(b);h.updatedOrganization=j;const _=Fr(j);h.newPhase=wl(_)},g=Math.min(.3,(c||0)*.1);switch(t){case"investigate":{const b=ko.INVESTIGATE_SUCCESS_BASE+g;h.success=Math.random()<b,h.success?(x(p-20),h.pauseDays=5,h.message=""):h.message="";break}case"arrest":{const b=ko.ARREST_SUCCESS_BASE+g;h.success=Math.random()<b,h.success?(x(p-35),h.pauseDays=7,h.message=""):(h.playerLosses=Math.floor(Math.random()*5)+1,h.message="");break}case"suppress":{const b=ko.SUPPRESS_SUCCESS_BASE+g;h.success=Math.random()<b;const j=Object.values(o||{}).reduce((N,M)=>N+(M||0),0),_=(r.influenceShare||0)*100;if(h.success){h.playerLosses=Math.floor(j*.1*Math.random()),h.rebelLosses=Math.floor(_*(.5+Math.random()*.5));const N=m===Ga.UPRISING?30:p-60;x(N),h.message=""}else h.playerLosses=Math.floor(j*.2*Math.random()),h.rebelLosses=Math.floor(_*.3*Math.random()),x(p+10),h.message="";break}case"appease":{h.success=!0;const b=m===Ga.GRUMBLING?15:8;x(p-b),h.approvalChange=10,h.message=`+10-${b}%`;break}case"negotiate":{h.success=!0;const b=m===Ga.RADICALIZING?10:15;x(p-b),h.approvalChange=15,h.message=`+15-${b}%`;break}case"bribe":{h.success=!0,x(p-12),h.pauseDays=10,h.message="-12%10";break}}return h}const $1=(t=0)=>!Number.isFinite(t)||t<=0?0:Math.min(t,Math.max(1,Math.floor(t*.8))),v3=(t,s,r,o,c,u)=>{const{tradeRoutes:p,nations:m,resources:h,daysElapsed:x,market:g,popStructure:b,taxPolicies:j}=t,_=p.routes||[],N=.05,M=.1,R=b?.merchant||0,E=[],T=[];let D=0;return _.forEach((O,q)=>{const{nationId:I,resource:Z,type:Y}=O,U=m.find(Ne=>Ne.id===I);if(!U){E.push(O);return}if(q>=R||U.isAtWar)return;const S=gl(Z,U,x),Q=g?.prices?.[Z]??(Re[Z]?.basePrice||1),ne=jl(Z,U,x);if(Y==="export"){if(!S.isShortage||S.shortageAmount<=0)return;const Ne=h[Z]||0,de=Math.max(0,Ne-500);if(de<=M)return;const P=Math.min(de,S.shortageAmount)*N;if(P<M)return;const z=Q*P,V=j?.resourceTaxRates?.[Z]||0,F=Math.max(0,j?.resourceTariffMultipliers?.[Z]??1),re=V*F,C=z*re,L=ne*P;if(L-z-C<=0)return;o(H=>({...H,silver:(H.silver||0)+C,[Z]:Math.max(0,(H[Z]||0)-P)})),D+=C,c(H=>H.map(ve=>ve.id===I?{...ve,budget:Math.max(0,(ve.budget||0)-L),inventory:{...ve.inventory,[Z]:((ve.inventory||{})[Z]||0)+P},relation:Math.min(100,(ve.relation||0)+.2)}:ve))}else if(Y==="import"){if(!S.isSurplus||S.surplusAmount<=0)return;const Ne=S.surplusAmount*N;if(Ne<M)return;const $e=ne*Ne,de=Q*Ne,P=j?.resourceTaxRates?.[Z]||0,z=Math.max(0,j?.resourceTariffMultipliers?.[Z]??1),V=P*z,F=de*V,re=de-$e-F;if(re<=0)return;o(C=>({...C,silver:(C.silver||0)+F,[Z]:(C[Z]||0)+Ne})),D+=F,c(C=>C.map(L=>L.id===I?{...L,budget:(L.budget||0)+$e,inventory:{...L.inventory,[Z]:Math.max(0,((L.inventory||{})[Z]||0)-Ne)},relation:Math.min(100,(L.relation||0)+.2)}:L)),Ne>=1&&T.push(`  ${Ne.toFixed(1)} ${Re[Z]?.name||Z}  ${U.name} ${$e.toFixed(1)}  ${de.toFixed(1)}  ${F.toFixed(1)} ${re.toFixed(1)} `)}}),E.length>0&&u(O=>({...O,routes:O.routes.filter(q=>!E.some(I=>I.nationId===q.nationId&&I.resource===q.resource&&I.type===q.type))})),T.forEach(O=>r(O)),{tradeTax:D}},mp=t=>un[t]?.populationCost||1,O1=(t={})=>Object.entries(t).map(([s,r])=>`${un[s]?.name||s} x${r}`).join(""),j3=(t={},s=[],r=0)=>{const o=t||{},c=Array.isArray(s)?s:[],u=Number.isFinite(r)?Math.max(0,r):0;let p=null;const m=()=>(p||(p=c.map(D=>D&&{...D})),p),h=[];let x=0;c.forEach((D,O)=>{if(!D||D.status!=="training")return;const q=mp(D.unitId);x+=q,h.push({index:O,unitId:D.unitId,popCost:q,remainingTime:D.remainingTime||0})});let g=null;const b=3,j=u+b;if(console.log("[TRAINING SYNC] trainingPop:",x,"available:",u,"tolerance:",b,"effectiveAvailable:",j),x>j){let D=x-j;console.log("[TRAINING SYNC] INTERRUPTING! manpowerToFree:",D),h.sort((q,I)=>(I.remainingTime||0)-(q.remainingTime||0)).forEach(q=>{if(D<=0)return;D-=q.popCost,x-=q.popCost;const I=m(),Z=I[q.index]||{};I[q.index]={...Z,status:"waiting",remainingTime:Z.totalTime??Z.remainingTime??0},g||(g={}),g[q.unitId]=(g[q.unitId]||0)+1})}const _=Math.max(0,u-x),N=wf(o);let M=null,R=null,E=3;c.forEach(D=>{if(D&&D.status==="training"&&D.remainingTime<=1){const O=mp(D.unitId);E+=O}});const T=_+E;if(console.log("[ARMY SYNC] available:",u,"trainingPop:",x,"availableForArmy:",_,"tolerance:",E,"effectiveAvailable:",T,"currentArmyPop:",N),N>T){let D=N-T;console.log("[ARMY SYNC] DISBANDING! manpowerToRemove:",D),M={...o},R={};const O=Object.entries(M).filter(([,q])=>q>0).map(([q,I])=>({unitId:q,count:I,popCost:mp(q),epoch:un[q]?.epoch??0})).sort((q,I)=>q.popCost===I.popCost?q.epoch-I.epoch:I.popCost-q.popCost);for(const q of O){if(D<=0)break;const{unitId:I,popCost:Z}=q,Y=Math.min(q.count,Math.ceil(D/Z));Y<=0||(M[I]-=Y,D-=Y*Z,M[I]<=0&&delete M[I],R[I]=(R[I]||0)+Y)}Object.keys(R).length===0&&(R=null,M=null)}return{updatedArmy:M,updatedQueue:p,removedUnits:R,cancelledTraining:g}},w3=(t={},s={})=>{const r=Array.isArray(t.approval)?t.approval:[],o=Array.isArray(t.stability)?t.stability:[],c=Array.isArray(t.resourceDemand)?t.resourceDemand:[],u=Array.isArray(t.stratumDemand)?t.stratumDemand:[],p=Array.isArray(t.buildingProduction)?t.buildingProduction:[],m={};let h=0;const x={},g={},b={},j=[],_=[],N=[],M=[],R=[],E=(ne,Ne)=>typeof ne!="number"||Number.isNaN(ne)?Ne:Math.min(.95,Math.max(0,ne)),T=Math.max(1,s?.approval?.duration||30),D=E(s?.approval?.decayRate??.04,.04),O=Math.max(1,s?.stability?.duration||30),q=E(s?.stability?.decayRate??.04,.04),I=Math.max(1,s?.resourceDemand?.duration||60),Z=E(s?.resourceDemand?.decayRate??.02,.02),Y=Math.max(1,s?.stratumDemand?.duration||60),U=E(s?.stratumDemand?.decayRate??.02,.02),S=Math.max(1,s?.buildingProduction?.duration||45),Q=E(s?.buildingProduction?.decayRate??.025,.025);return r.forEach(ne=>{const Ne=typeof ne.currentValue=="number"?ne.currentValue:0,$e=ne.remainingDays??T;if($e<=0||Math.abs(Ne)<.001)return;const de=ne.stratum;if(!de)return;m[de]=(m[de]||0)+Ne;const P=E(ne.decayRate,D),z=Ne*(1-P),V=$e-1;V>0&&Math.abs(z)>=.001&&j.push({...ne,currentValue:z,remainingDays:V})}),o.forEach(ne=>{const Ne=typeof ne.currentValue=="number"?ne.currentValue:0,$e=ne.remainingDays??O;if($e<=0||Math.abs(Ne)<.001)return;h+=Ne;const de=E(ne.decayRate,q),P=Ne*(1-de),z=$e-1;z>0&&Math.abs(P)>=.001&&_.push({...ne,currentValue:P,remainingDays:z})}),c.forEach(ne=>{const Ne=typeof ne.currentValue=="number"?ne.currentValue:0,$e=ne.remainingDays??I;if($e<=0||Math.abs(Ne)<.001)return;const de=ne.target;if(!de)return;x[de]=(x[de]||0)+Ne;const P=E(ne.decayRate,Z),z=Ne*(1-P),V=$e-1;V>0&&Math.abs(z)>=.001&&N.push({...ne,currentValue:z,remainingDays:V})}),u.forEach(ne=>{const Ne=typeof ne.currentValue=="number"?ne.currentValue:0,$e=ne.remainingDays??Y;if($e<=0||Math.abs(Ne)<.001)return;const de=ne.target;if(!de)return;g[de]=(g[de]||0)+Ne;const P=E(ne.decayRate,U),z=Ne*(1-P),V=$e-1;V>0&&Math.abs(z)>=.001&&M.push({...ne,currentValue:z,remainingDays:V})}),p.forEach(ne=>{const Ne=typeof ne.currentValue=="number"?ne.currentValue:0,$e=ne.remainingDays??S;if($e<=0||Math.abs(Ne)<.001)return;const de=ne.target;if(!de)return;b[de]=(b[de]||0)+Ne;const P=E(ne.decayRate,Q),z=Ne*(1-P),V=$e-1;V>0&&Math.abs(z)>=.001&&R.push({...ne,currentValue:z,remainingDays:V})}),{approvalModifiers:m,stabilityModifier:h,resourceDemandModifiers:x,stratumDemandModifiers:g,buildingProductionModifiers:b,nextEffects:{approval:j,stability:_,resourceDemand:N,stratumDemand:M,buildingProduction:R}}},N3=(t,s,r)=>{const{resources:o,setResources:c,market:u,setMarket:p,buildings:m,population:h,popStructure:x,setPopulation:g,birthAccumulator:b,setBirthAccumulator:j,epoch:_,techsUnlocked:N,decrees:M,gameSpeed:R,isPaused:E,setIsPaused:T,nations:D,setNations:O,setPopStructure:q,setMaxPop:I,maxPopBonus:Z,setRates:Y,setTaxes:U,setClassApproval:S,classApproval:Q,setClassInfluence:ne,setClassWealth:Ne,setClassWealthDelta:$e,setClassIncome:de,setClassExpense:P,classWealthHistory:z,setClassWealthHistory:V,classNeedsHistory:F,setClassNeedsHistory:re,setTotalInfluence:C,setTotalWealth:L,setActiveBuffs:ie,setActiveDebuffs:H,stability:ve,setStability:me,setLogs:X,taxPolicies:qe,classWealth:fe,setClassShortages:Je,setClassLivingStandard:tt,livingStandardStreaks:Mt,setLivingStandardStreaks:jt,activeBuffs:ot,activeDebuffs:B,army:Ue,setArmy:ht,militaryQueue:ft,setMilitaryQueue:$t,jobFill:It,setJobFill:oe,jobsAvailable:Ye,setJobsAvailable:bt,setDaysElapsed:Pe,daysElapsed:lt,militaryWageRatio:Vt,classInfluenceShift:oa,setClassInfluenceShift:Ka,setFestivalModal:gn,activeFestivalEffects:Zt,setActiveFestivalEffects:la,lastFestivalYear:qt,setLastFestivalYear:Gt,setHistory:kt,autoSaveInterval:ta,isAutoSaveEnabled:Ht,lastAutoSaveTime:se,saveGame:pe,merchantState:he,setMerchantState:K,tradeRoutes:je,setTradeRoutes:J,tradeStats:le,setTradeStats:ue,actionCooldowns:Me,setActionCooldowns:Ie,actionUsage:at,setActionUsage:Ze,promiseTasks:Ce,setPromiseTasks:rt,activeEventEffects:zt,setActiveEventEffects:Ve,eventEffectSettings:ca,rebellionStates:ha,setRebellionStates:Ra,classInfluence:xe,totalInfluence:Tt}=t,et=$.useRef({resources:o,market:u,buildings:m,population:h,popStructure:x,birthAccumulator:b,maxPopBonus:Z,epoch:_,techsUnlocked:N,decrees:M,gameSpeed:R,nations:D,classWealth:fe,army:Ue,militaryQueue:ft,jobFill:It,jobsAvailable:Ye,activeBuffs:ot,activeDebuffs:B,taxPolicies:qe,classWealthHistory:z,classNeedsHistory:F,militaryWageRatio:Vt,classApproval:Q,daysElapsed:lt,activeFestivalEffects:Zt,lastFestivalYear:qt,isPaused:E,autoSaveInterval:ta,isAutoSaveEnabled:Ht,lastAutoSaveTime:se,merchantState:he,tradeRoutes:je,actions:r,tradeStats:le,actionCooldowns:Me,actionUsage:at,promiseTasks:Ce,activeEventEffects:zt,eventEffectSettings:ca,rebellionStates:ha,classInfluence:xe,totalInfluence:Tt,birthAccumulator:b,stability:ve}),Ae=$.useRef(t.saveGame);$.useEffect(()=>{Ae.current=t.saveGame},[t.saveGame]),$.useEffect(()=>{et.current={resources:o,market:u,buildings:m,population:h,epoch:_,popStructure:x,maxPopBonus:Z,techsUnlocked:N,decrees:M,gameSpeed:R,nations:D,classWealth:fe,livingStandardStreaks:Mt,army:Ue,militaryQueue:ft,jobFill:It,activeBuffs:ot,activeDebuffs:B,taxPolicies:qe,classWealthHistory:z,classNeedsHistory:F,militaryWageRatio:Vt,classApproval:Q,daysElapsed:lt,activeFestivalEffects:Zt,lastFestivalYear:qt,isPaused:E,autoSaveInterval:ta,isAutoSaveEnabled:Ht,lastAutoSaveTime:se,merchantState:he,tradeRoutes:je,actions:r,tradeStats:le,actionCooldowns:Me,actionUsage:at,promiseTasks:Ce,activeEventEffects:zt,eventEffectSettings:ca,rebellionStates:ha,classInfluence:xe,totalInfluence:Tt,birthAccumulator:b,stability:ve}},[o,u,m,h,x,Z,_,N,M,R,D,fe,Mt,Ue,ft,It,Ye,ot,B,qe,z,F,Vt,Q,lt,Zt,qt,E,ta,Ht,se,he,je,le,r,Me,at,Ce,zt,ca,ha,xe,Tt,b,ve]),$.useEffect(()=>{if(!je?.routes?.length||!D)return;const it=new Set(D.map(be=>be.id)),Xe=je.routes.filter(be=>it.has(be.nationId));Xe.length!==je.routes.length&&J(be=>({...be,routes:Xe}))},[D,je,J]),$.useEffect(()=>{if(E){const be=setInterval(()=>{const Qt=et.current;if(Qt.isAutoSaveEnabled){const gt=Math.max(5,Qt.autoSaveInterval||60);Date.now()-(Qt.lastAutoSaveTime||0)>=gt*1e3&&Ae.current&&(Ae.current({source:"auto"}),et.current.lastAutoSaveTime=Date.now())}},1e3);return()=>clearInterval(be)}const it=1e3/Math.max(1,R),Xe=setInterval(()=>{const be=et.current;if(be.isAutoSaveEnabled){const Oe=Math.max(5,be.autoSaveInterval||60);Date.now()-(be.lastAutoSaveTime||0)>=Oe*1e3&&Ae.current&&(Ae.current({source:"auto"}),et.current.lastAutoSaveTime=Date.now())}const Qt=id(be.daysElapsed||0);if(id((be.daysElapsed||0)+1),Qt.year>(be.lastFestivalYear||0)){const Oe=T5(be.epoch);Oe.length>0&&(gn({options:Oe,year:Qt.year}),Gt(Qt.year),T(!0))}const{approvalModifiers:gt,stabilityModifier:Rt,resourceDemandModifiers:ua,stratumDemandModifiers:An,buildingProductionModifiers:wa,nextEffects:Na}=w3(be.activeEventEffects,be.eventEffectSettings),ze=G5({...be,tick:be.daysElapsed||0,gameSpeed:1,activeFestivalEffects:be.activeFestivalEffects||[],eventApprovalModifiers:gt,eventStabilityModifier:Rt,currentStability:be.stability??50,eventResourceDemandModifiers:ua,eventStratumDemandModifiers:An,eventBuildingProductionModifiers:wa}),Pn=Number.isFinite(ze.popStructure?.soldier)?ze.popStructure.soldier:null;let ja=be.army||{},vs=null;if(Pn!==null){const Oe=j3(ja,be.militaryQueue||[],Pn);if(Oe.updatedArmy&&(ja=Oe.updatedArmy,ht(Oe.updatedArmy)),Oe.updatedQueue&&(vs=Oe.updatedQueue),Oe.removedUnits){const Ge=O1(Oe.removedUnits);Ge&&s(` ${Ge}`)}if(Oe.cancelledTraining){const Ge=O1(Oe.cancelledTraining);Ge&&s(` ${Ge}`)}}const Vn=(be.activeEventEffects?.approval?.length||0)>0||(be.activeEventEffects?.stability?.length||0)>0||(be.activeEventEffects?.resourceDemand?.length||0)>0||(be.activeEventEffects?.stratumDemand?.length||0)>0||(be.activeEventEffects?.buildingProduction?.length||0)>0,ns=Py(Ue),us={...ze.resources};Object.entries(ns).forEach(([Oe,Ge])=>{const dt=Ge;dt<=0||(us[Oe]=Math.max(0,(us[Oe]||0)-dt))}),c(us),Vn&&Ve(Na);const ps={...ze.classWealth},Ti=Object.values(ps).reduce((Oe,Ge)=>Oe+Ge,0),js={...be.market?.priceHistory||{}},Wn={...be.market?.supplyHistory||{}},xa={...be.market?.demandHistory||{}},qs=60;Object.keys(ze.market?.prices||{}).forEach(Oe=>{const Ge=ze.market?.prices?.[Oe];js[Oe]||(js[Oe]=[]),js[Oe]=[...js[Oe],Ge],js[Oe].length>qs&&js[Oe].shift(),Wn[Oe]||(Wn[Oe]=[]),Wn[Oe]=[...Wn[Oe],ze.market?.supply?.[Oe]||0],Wn[Oe].length>qs&&Wn[Oe].shift(),xa[Oe]||(xa[Oe]=[]),xa[Oe]=[...xa[Oe],ze.market?.demand?.[Oe]||0],xa[Oe].length>qs&&xa[Oe].shift()});const Un={...be.classWealthHistory||{}},Vi=120;Object.entries(ze.classWealth||{}).forEach(([Oe,Ge])=>{const dt=Un[Oe]?[...Un[Oe]]:[];dt.push(Ge),dt.length>Vi&&dt.shift(),Un[Oe]=dt});const oi={...be.classNeedsHistory||{}},Dn=120;Object.entries(ze.needsReport||{}).forEach(([Oe,Ge])=>{const dt=oi[Oe]?[...oi[Oe]]:[];dt.push(Ge.satisfactionRatio),dt.length>Dn&&dt.shift(),oi[Oe]=dt});const xi={...ze.market||{},priceHistory:js,supplyHistory:Wn,demandHistory:xa,modifiers:ze.modifiers||{}},Wi=90;kt(Oe=>{const Ge=(He=[],_e)=>{const Te=[...He,_e];return Te.length>Wi&&Te.shift(),Te},dt=Oe||{},Nt={...dt,treasury:Ge(dt.treasury,ze.resources?.silver||0),tax:Ge(dt.tax,ze.taxes?.total||0),population:Ge(dt.population,ze.population||0)},st=dt.class||{},Ct={...st};return Object.keys(Ke).forEach(He=>{const _e=st[He]||{pop:[],income:[],expense:[]};Ct[He]={pop:Ge(_e.pop,ze.popStructure?.[He]||0),income:Ge(_e.income,ze.classIncome?.[He]||0),expense:Ge(_e.expense,ze.classExpense?.[He]||0)}}),Nt.class=Ct,Nt}),q(ze.popStructure),I(ze.maxPop),Y(ze.rates),Y(ze.rates||{}),S(ze.classApproval);const li={...ze.classInfluence||{}};Object.entries(oa||{}).forEach(([Oe,Ge])=>{Ge&&(li[Oe]=(li[Oe]||0)+Ge)}),ne(li);const ws={};Object.keys(ps).forEach(Oe=>{const Ge=be.classWealth?.[Oe]||0;ws[Oe]=ps[Oe]-Ge}),Ne(ps),$e(ws),de(ze.classIncome||{}),P(ze.classExpense||{}),V(Un),re(oi),C(ze.totalInfluence),L(Ti),ie(ze.activeBuffs),H(ze.activeDebuffs),me(ze.stability),U(ze.taxes||{total:0,breakdown:{headTax:0,industryTax:0,subsidy:0,policyIncome:0,policyExpense:0},efficiency:1}),p(xi),Je(ze.needsShortages||{}),tt(ze.classLivingStandard||{}),jt(ze.livingStandardStreaks||be.livingStandardStreaks||{}),K(Oe=>{const Ge=ze.merchantState||be.merchantState||{pendingTrades:[],lastTradeTime:0};return Oe===Ge?Oe:Ge}),ze.nations&&O(ze.nations),ze.jobFill&&oe(ze.jobFill),ze.jobsAvailable&&bt(ze.jobsAvailable),Pe(Oe=>Oe+1);const Ui=be.rebellionStates||{},Gs=r3(Ui,ze.classApproval||{},ze.classInfluence||{},ze.totalInfluence||0,ze.stability||50,be.daysElapsed||0,be.promiseTasks||[],ze.needsShortages||{},{classIncome:ze.classIncome||{},classExpense:ze.classExpense||be.classExpense||{},popStructure:ze.popStructure||be.popStructure||{},taxPolicies:be.taxPolicies||{},market:ze.market||be.market||{},classLivingStandard:ze.classLivingStandard||{},livingStandardStreaks:ze.livingStandardStreaks||be.livingStandardStreaks||{},epoch:be.epoch||0}),Ds=o3(Ui,Gs),Jr=be.epoch||0;if(Ds.length>0&&be.actions?.triggerDiplomaticEvent)for(const Oe of Ds){const Ge=Oe.stratumKey,dt=Ge==="unemployed"&&Jr<=0,Nt=D1(be.army,be.popStructure,Ge),st=R1(Gs),Ct={...Gs[Ge],dissatisfactionDays:Math.floor(Gs[Ge]?.organization||0),influenceShare:(ze.classInfluence?.[Ge]||0)/(ze.totalInfluence||1)};if((Ct.influenceShare||0)<.01&&Oe.type!=="uprising")continue;let _e=null;const Te=(ut,vt,Ee)=>{console.log("[ORGANIZATION] Action:",ut,"Stratum:",vt,"Data:",Ee),be.actions?.handleRebellionAction&&be.actions.handleRebellionAction(ut,vt,Ee)};switch(Oe.type){case"brewing":_e=g5(Ge,Ct),s(` ${Ke[Ge]?.name||Ge}30%`);break;case"plotting":_e=y5(Ge,Ct,Nt,st),s(` ${Ke[Ge]?.name||Ge}70%`);break;case"uprising":{const ut=Ct.influenceShare;if(dt){s(` ${Ke[Ge]?.name||Ge}`),Ra(Ee=>({...Ee,[Ge]:{...Ee[Ge],organization:25,stage:Ga.GRUMBLING}}));break}if(ut<Ip){s(` ${Ke[Ge]?.name||Ge}100%${Math.round(ut*100)}%`),Ra(Ee=>({...Ee,[Ge]:{...Ee[Ge],organization:99}}));break}const vt=K5(Ge,Gs,ze.classInfluence||{},ze.totalInfluence||0,be.popStructure||{});if(vt.isCoalition){const Ee=vt.coalitionStrata,{details:We,totalLoss:xt}=M5(Ee,be.popStructure),Fa=(be.nations||[]).find(na=>na.isRebelNation&&na.isAtWar&&na.isCoalitionRebellion),nt=(be.nations||[]).find(na=>na.isRebelNation&&na.isAtWar&&Ee.includes(na.rebellionStratum)),Jt=Fa||nt;if(Jt)O(na=>na.map(St=>{if(St.id===Jt.id){const pa=(St.population||0)+xt,$a=We.reduce((Mn,Rn)=>Mn+Math.floor((be.classWealth?.[Rn.stratumKey]||0)*.3),0);return{...St,population:pa,wealth:(St.wealth||0)+$a,economyTraits:{...St.economyTraits,basePopulation:pa,baseWealth:(St.economyTraits?.baseWealth||St.wealth||0)+$a}}}return St})),q(na=>{const St={...na};return We.forEach(({stratumKey:pa,loss:$a})=>{St[pa]=Math.max(0,(na[pa]||0)-$a)}),St}),g(na=>Math.max(0,na-xt)),s(` ${xt}${Jt.name}`);else{const na=w5(Ee,be.popStructure,be.classWealth||{},ze.classInfluence||{},ze.totalInfluence||0,Oy.COALITION_BONUS);na.isCoalitionRebellion=!0,na.warStartDay=be.daysElapsed||0,O(pa=>[...pa,na]),q(pa=>{const $a={...pa};return We.forEach(({stratumKey:Mn,loss:Rn})=>{$a[Mn]=Math.max(0,(pa[Mn]||0)-Rn)}),$a}),g(pa=>Math.max(0,pa-xt)),_e=N5(Ee,na,Nt,st,We,Te);const St=Ee.map(pa=>Ke[pa]?.name||pa).join("");s(` ${St}`)}Ra(na=>{const St={...na};return Ee.forEach(pa=>{St[pa]={...na[pa],organization:50,stage:Ga.MOBILIZING}}),St})}else{const Ee=be.popStructure?.[Ge]||0,We=be.classWealth?.[Ge]||0,xt=$1(Ee),Fa=(be.nations||[]).find(nt=>nt.isRebelNation&&nt.rebellionStratum===Ge&&nt.isAtWar);if(Fa)O(nt=>nt.map(Jt=>{if(Jt.id===Fa.id){const na=(Jt.population||0)+xt,St=(Jt.wealth||0)+Math.floor(We*.3);return{...Jt,population:na,wealth:St,economyTraits:{...Jt.economyTraits,basePopulation:na,baseWealth:St}}}return Jt})),q(nt=>({...nt,[Ge]:Math.max(0,(nt[Ge]||0)-xt)})),g(nt=>Math.max(0,nt-xt)),s(` ${Ke[Ge]?.name||Ge}${xt}${Fa.name}`);else{const nt={resources:be.resources||{},marketPrices:be.market?.prices||{}},Jt=f1(Ge,Ee,We,ut,xt,nt),na=Jt.nation;if(Jt.lootedResources&&Object.keys(Jt.lootedResources).length>0){c(pa=>{const $a={...pa};return Object.entries(Jt.lootedResources).forEach(([Mn,Rn])=>{$a[Mn]=Math.max(0,($a[Mn]||0)-Rn)}),$a});const St=Object.entries(Jt.lootedResources).map(([pa,$a])=>`${Re[pa]?.name||pa}: ${$a}`).join("");s(` ${St}${Math.floor(Jt.lootedValue)}`)}na.warStartDay=be.daysElapsed||0,O(St=>[...St,na]),q(St=>({...St,[Ge]:Math.max(0,(St[Ge]||0)-xt)})),g(St=>Math.max(0,St-xt)),_e=p1(Ge,Ct,Nt,st,na,Te),s(` ${Ke[Ge]?.name||Ge}100%`)}Ra(nt=>({...nt,[Ge]:{...nt[Ge],organization:50,stage:Ga.MOBILIZING}}))}break}}_e&&be.actions.triggerDiplomaticEvent(_e)}Ra(Gs);const gi=(be.nations||[]).filter(Oe=>Oe.isRebelNation&&Oe.isAtWar);for(const Oe of gi){const Ge=Oe.rebellionStratum;if(!Ge||(Oe.warDuration||0)<60||!Oe.isAtWar)continue;const st=Gs[Ge]?.organization??50,Ct=Oe.warScore||0;if(st<30&&Ct>=-20){const He=Ke[Ge]?.name||Ge;s(` ${Oe.name}${Math.round(st)}%`);const _e=Math.floor((Oe.population||0)*.5);_e>0&&(q(vt=>({...vt,[Ge]:(vt[Ge]||0)+_e})),g(vt=>vt+_e),s(` ${_e}${He}`));const ut=Vp(Oe,!0,(vt,Ee)=>{console.log("[REBELLION END]",vt,Ee?.name)});ut&&be.actions?.triggerDiplomaticEvent&&be.actions.triggerDiplomaticEvent(ut),O(vt=>vt.map(Ee=>Ee.id===Oe.id?{...Ee,isAtWar:!1,warScore:0,warDuration:0}:Ee)),setTimeout(()=>{O(vt=>vt.filter(Ee=>Ee.id!==Oe.id))},500),Ra(vt=>({...vt,[Ge]:{...vt[Ge],organization:Math.max(0,st-30)}}))}}if(Me&&Object.keys(Me).length>0&&Ie(Oe=>{if(!Oe)return Oe;let Ge=!1;const dt={};return Object.entries(Oe).forEach(([Nt,st])=>{st>1?(dt[Nt]=st-1,Ge=!0):st>1e-6&&(Ge=!0)}),Ge?dt:Oe}),Ce&&Ce.length>0){const Oe=(be.daysElapsed||0)+1,Ge=y3(Ce,{currentDay:Oe,classApproval:ze.classApproval||{},market:ze.market||be.market||{},nations:ze.nations||be.nations||[],taxPolicies:be.taxPolicies||{},classWealth:ze.classWealth||be.classWealth||{},needsReport:ze.needsReport||{},tradeRoutes:be.tradeRoutes||{},classIncome:ze.classIncome||{},popStructure:ze.popStructure||be.popStructure||{}});Ge.completed.length>0&&Ge.completed.forEach(Nt=>{Nt.type,s(` ${Nt.stratumName} ${Nt.description||""}`)}),Ge.updated&&Ge.updated.length>0&&Ge.updated.forEach(Nt=>{s(` ${Nt.stratumName}  ${Nt.maintainDuration} `)}),Ge.failed.length>0&&Ge.failed.forEach(Nt=>{const st=Nt.stratumKey,Ct=Nt.failReason==="maintain_broken"?"":"";s(` ${Nt.stratumName}${Ct}`);const He=be.rebellionStates?.[st]||{},_e=Nt.failurePenalty||{organization:50};let Te=He.organization||0;_e.forcedUprising?Te=100:typeof _e.organization=="number"&&(Te=Math.min(100,Math.max(0,Te+_e.organization)));const ut=(ze.classInfluence?.[st]||0)/(ze.totalInfluence||1),vt=st==="unemployed"&&(be.epoch||0)<=0,Ee=Te>=100,We=Ee&&ut>=Ip&&!vt;if(Ee&&!We){Te=99;const xt=vt?"":`${Math.round(ut*100)}%`;s(` ${Ke[st]?.name||st}100%${xt}`)}if(Ra(xt=>({...xt,[st]:{...xt[st],organization:Te}})),We&&be.actions?.triggerDiplomaticEvent){const xt=D1(be.army,be.popStructure,st),Fa=R1(be.rebellionStates||{}),nt={},Jt=be.popStructure?.[st]||0,na=be.classWealth?.[st]||0,St=$1(Jt),pa={resources:be.resources||{},marketPrices:be.market?.prices||{}},$a=f1(st,Jt,na,ut,St,pa),Mn=$a.nation;if($a.lootedResources&&Object.keys($a.lootedResources).length>0){c(Rs=>{const Vs={...Rs};return Object.entries($a.lootedResources).forEach(([Oo,Kr])=>{Vs[Oo]=Math.max(0,(Vs[Oo]||0)-Kr)}),Vs});const In=Object.entries($a.lootedResources).map(([Rs,Vs])=>`${Re[Rs]?.name||Rs}: ${Vs}`).join("");s(` ${In}${Math.floor($a.lootedValue)}`)}Mn.warStartDay=be.daysElapsed||0,O(In=>[...In,Mn]),q(In=>({...In,[st]:Math.max(0,(In[st]||0)-St)})),g(In=>Math.max(0,In-St));const ms=p1(st,nt,xt,Fa,Mn,(In,Rs,Vs)=>{be.actions?.handleRebellionAction&&be.actions.handleRebellionAction(In,Rs,Vs)});s(` ${Ke[st]?.name||st}100%`),be.actions.triggerDiplomaticEvent(ms),T(!0)}});const dt=[...Ge.remaining];rt(dt)}let Fs=0;if(be.tradeRoutes&&be.tradeRoutes.routes&&be.tradeRoutes.routes.length>0){const Oe=v3(be,ze,s,c,O,J);Oe&&(Fs=Oe.tradeTax||0)}if(ue({tradeTax:Fs}),t.playerInstallmentPayment&&t.playerInstallmentPayment.remainingDays>0){const Oe=t.playerInstallmentPayment,Ge=Oe.amount;(be.resources.silver||0)>=Ge?(c(dt=>({...dt,silver:(dt.silver||0)-Ge})),t.setPlayerInstallmentPayment(dt=>({...dt,paidAmount:dt.paidAmount+Ge,remainingDays:dt.remainingDays-1})),Oe.remainingDays===1&&(s(` ${Oe.totalAmount} `),t.setPlayerInstallmentPayment(null))):(s(" "),O(dt=>dt.map(Nt=>Nt.id===Oe.nationId?{...Nt,isAtWar:!0,warStartDay:be.daysElapsed||0,warDuration:0,relation:Math.max(0,(Nt.relation||0)-50),peaceTreatyUntil:void 0}:Nt)),t.setPlayerInstallmentPayment(null))}if(Zt.length>0){const Oe=Zt.filter(Ge=>Ge.type==="permanent"?!0:(be.daysElapsed||0)-(Ge.activatedAt||0)<(Ge.duration||360));Oe.length!==Zt.length&&la(Oe)}if(Ka(Oe=>{if(!Oe||Object.keys(Oe).length===0)return Oe||{};const Ge={};return Object.entries(Oe).forEach(([dt,Nt])=>{const st=Nt*.9;Math.abs(st)>=.1&&(Ge[dt]=st)}),Object.keys(Ge).length>0?Ge:{}}),ze.population!==be.population&&g(ze.population),typeof ze.birthAccumulator=="number"&&j(ze.birthAccumulator),ze.logs.length){const Oe=new Set,Ge=ze.logs.map(Nt=>{if(typeof Nt!="string")return Nt;if(Nt.includes("RAID_EVENT"))try{const st=Nt.replace("RAID_EVENT",""),Ct=JSON.parse(st);if(Oe.has(Ct.nationName))return null;Oe.add(Ct.nationName);const He=Ct.actionName||"";if(Ct.victory)return`  ${Ct.nationName} ${He}`;{const _e=[];Ct.foodLoss>0&&_e.push(` -${Ct.foodLoss}`),Ct.silverLoss>0&&_e.push(` -${Ct.silverLoss}`),Ct.woodLoss>0&&_e.push(` -${Ct.woodLoss}`),Ct.popLoss>0&&_e.push(` -${Ct.popLoss}`);const Te=_e.length>0?`${_e.join("")}`:"";return`  ${Ct.nationName} ${He}${Te}`}}catch{return" "}if(Nt.includes("WAR_DECLARATION_EVENT:"))try{const st=Nt.replace("WAR_DECLARATION_EVENT:","");return` ${JSON.parse(st).nationName} `}catch{return" "}return Nt.includes("AI_GIFT_EVENT:")?" ":Nt.includes("AI_REQUEST_EVENT:")?" ":Nt.includes("AI_TRADE_EVENT:")?null:Nt});X(Nt=>[...Ge.filter(st=>st!==null),...Nt].slice(0,128));const dt=be.actions;if(console.log("[EVENT DEBUG] actions:",!!dt,"triggerDiplomaticEvent:",!!dt?.triggerDiplomaticEvent),dt&&dt.triggerDiplomaticEvent){console.log("[EVENT DEBUG] Checking logs:",ze.logs),console.log("[EVENT DEBUG] Total logs count:",ze.logs.length);const Nt=Array.isArray(ze.logs)?ze.logs.find(st=>typeof st=="string"&&st.includes("RAID_EVENT")):null;if(Nt&&dt.addBattleNotification)try{const st=Nt.indexOf("{");if(st!==-1){const Ct=Nt.slice(st),He=JSON.parse(Ct),_e=He.actionName||"";let Te=`${He.nationName} ${_e}

`;He.victory?(Te+=`${_e}

`,Te+=`
`,Te+=`${He.ourPower||0} 
`,Te+=`${He.enemyPower||0} 
`,He.battleReport&&He.battleReport.length>0&&(Te+=`
`+He.battleReport.join(`
`))):(He.ourPower?(Te+=`${_e}

`,Te+=`
`,Te+=`${He.ourPower||0} 
`,Te+=`${He.enemyPower||0} 
`,He.battleReport&&He.battleReport.length>0&&(Te+=`
`+He.battleReport.join(`
`))):Te+=`${_e}

`,Te+=`
${_e}
`,He.foodLoss>0&&(Te+=`${He.foodLoss} 
`),He.silverLoss>0&&(Te+=`${He.silverLoss} 
`),He.woodLoss>0&&(Te+=`${He.woodLoss} 
`),He.popLoss>0&&(Te+=`${He.popLoss} 
`));const ut={victory:!!He.victory,missionName:`${He.nationName} ${_e}`,missionDesc:He.victory?`${_e}`:`${_e}`,nationName:He.nationName,ourPower:He.ourPower||0,enemyPower:He.enemyPower||0,powerRatio:(He.enemyPower||0)>0?(He.ourPower||0)/He.enemyPower:0,score:0,losses:He.defenderLosses||{},attackerLosses:He.attackerLosses||{},enemyLosses:He.attackerLosses||{},defenderLosses:He.defenderLosses||{},resourcesGained:{},description:Te,foodLoss:He.foodLoss||0,silverLoss:He.silverLoss||0,popLoss:He.popLoss||0,isRaid:!0};console.log("[EVENT DEBUG] Raid battle result created (pre-loop):",ut),dt.addBattleNotification(ut)}}catch(st){console.error("[EVENT DEBUG] Failed to parse raid event log:",st)}ze.logs.forEach((st,Ct)=>{if(console.log(`[EVENT DEBUG] Log ${Ct}: `,st),console.log(`[EVENT DEBUG] Log ${Ct} includes RAID_EVENT: `,st.includes("RAID_EVENT")),st.includes("WAR_DECLARATION_EVENT:")){console.log("[EVENT DEBUG] War declaration detected:",st);try{const He=st.replace("WAR_DECLARATION_EVENT:",""),_e=JSON.parse(He),Te=_e.nationId,ut=_e.nationName,vt=ze.nations?.find(Ee=>Ee.id===Te);if(vt){const Ee=Lp(vt,()=>{console.log("[EVENT DEBUG] War declaration acknowledged")});dt.triggerDiplomaticEvent(Ee)}O(Ee=>{const We=[...Ee],xt=We.findIndex(St=>St.id===Te);if(xt===-1)return We;const Fa=We.filter(St=>St.id===Te?!1:(We[xt].foreignRelations?.[St.id]??50)>=80&&!St.isAtWar),nt=We.filter(St=>St.id===Te?!1:St.alliedWithPlayer===!0&&!St.isAtWar),Jt=3;let na=We.filter(St=>St.isAtWar===!0&&!St.isRebelNation).length;return Fa.forEach(St=>{if(St.alliedWithPlayer===!0){s(` ${St.name}  ${ut} `);return}if(na>=Jt){s(` ${St.name}  ${ut} `);return}const pa=We.findIndex($a=>$a.id===St.id);pa!==-1&&(We[pa]={...We[pa],isAtWar:!0,warStartDay:lt,warDuration:0,relation:0},na++,s(` ${St.name}  ${ut} `))}),nt.forEach(St=>{if((We[xt].allies||[]).includes(St.id)||(St.allies||[]).includes(Te))return;const Mn=We.findIndex(Rn=>Rn.id===St.id);if(Mn!==-1){const Rn={...We[Mn]};Rn.foreignWars||(Rn.foreignWars={}),Rn.foreignWars[Te]={isAtWar:!0,warStartDay:lt,warScore:0},We[xt].foreignWars||(We[xt].foreignWars={}),We[xt].foreignWars[St.id]={isAtWar:!0,warStartDay:lt,warScore:0},We[Mn]=Rn,s(`  ${St.name}  ${ut} `)}}),We})}catch(He){console.error("[EVENT DEBUG] Failed to parse war declaration event:",He)}}else if(st.includes("")&&!st.includes("WAR_DECLARATION_EVENT")){const He=st.match(/ (.+) /);if(He){const _e=He[1],Te=ze.nations?.find(ut=>ut.name===_e);if(Te){const ut=Lp(Te,()=>{});dt.triggerDiplomaticEvent(ut)}}}if(st.includes("")){console.log("[EVENT DEBUG] Peace request detected in log:",st);const He=st.match(/ (.+)  (\d+) /);if(console.log("[EVENT DEBUG] Regex match result:",He),He){const _e=He[1],Te=parseInt(He[2],10);console.log("[EVENT DEBUG] Looking for nation:",_e),console.log("[EVENT DEBUG] result.nations:",ze.nations?.map(vt=>({name:vt.name,isPeaceRequesting:vt.isPeaceRequesting})));const ut=ze.nations?.find(vt=>vt.name===_e);if(console.log("[EVENT DEBUG] Found nation:",ut?.name,"isPeaceRequesting:",ut?.isPeaceRequesting),ut&&ut.isPeaceRequesting){console.log("[EVENT DEBUG] Creating peace request event..."),console.log("[EVENT DEBUG] Parameters:",{nation:ut.name,nationId:ut.id,tribute:Te,warScore:ut.warScore||0,population:ut.population});try{const vt=c5(ut,Te,ut.warScore||0,(Ee,We,xt)=>{Ee?dt.handleEnemyPeaceAccept(ut.id,We,xt||Te):dt.handleEnemyPeaceReject(ut.id)});console.log("[EVENT DEBUG] Event created:",vt),console.log("[EVENT DEBUG] Calling triggerDiplomaticEvent..."),dt.triggerDiplomaticEvent(vt),console.log("[EVENT DEBUG] triggerDiplomaticEvent called")}catch(vt){console.error("[EVENT DEBUG] Error creating or triggering event:",vt)}O(vt=>vt.map(Ee=>Ee.id===ut.id?{...Ee,isPeaceRequesting:!1}:Ee))}}}if(st.includes("")){const He=st.match(/ (.+) (?:|)(?:|)/);if(He){const _e=He[1],Te=ze.nations?.find(ut=>ut.name===_e&&ut.isRebelNation);if(Te&&Te.isPeaceRequesting){console.log("[EVENT DEBUG] Rebel surrender detected:",_e);const ut=Vp(Te,!0,Ee=>{console.log("[REBELLION SURRENDER]",Ee,Te?.name)});dt.triggerDiplomaticEvent(ut);const vt=Te.rebellionStratum;if(vt){const Ee=Math.floor((Te.population||0)*.5);Ee>0&&q(We=>({...We,[vt]:(We[vt]||0)+Ee})),Ra(We=>({...We,[vt]:{...We?.[vt],organization:15,dissatisfactionDays:0,organizationPaused:0}}))}O(Ee=>Ee.filter(We=>We.id!==Te.id))}}}if(st.includes("AI_GIFT_EVENT:"))try{const He=st.replace("AI_GIFT_EVENT:",""),_e=JSON.parse(He),Te=ze.nations?.find(ut=>ut.id===_e.nationId);if(Te&&dt&&dt.triggerDiplomaticEvent){const ut=l5(Te,_e.amount,()=>{c(vt=>({...vt,silver:(vt.silver||0)+_e.amount})),O(vt=>vt.map(Ee=>Ee.id===Te.id?{...Ee,relation:Math.min(100,(Ee.relation||0)+15)}:Ee)),s(`  ${Te.name}  ${_e.amount} `)});dt.triggerDiplomaticEvent(ut),console.log("[EVENT DEBUG] AI Gift event triggered:",Te.name,_e.amount)}}catch(He){console.error("[EVENT DEBUG] Failed to parse AI gift event:",He)}if(st.includes("AI_REQUEST_EVENT:"))try{const He=st.replace("AI_REQUEST_EVENT:",""),_e=JSON.parse(He),Te=ze.nations?.find(ut=>ut.id===_e.nationId);if(Te&&dt&&dt.triggerDiplomaticEvent){const ut=u5(Te,_e.resourceKey,_e.resourceName,_e.amount,vt=>{if(vt){if((be.resources?.silver||0)<_e.amount){s(`  ${Te.name} `);return}c(We=>({...We,silver:(We.silver||0)-_e.amount})),O(We=>We.map(xt=>xt.id===Te.id?{...xt,relation:Math.min(100,(xt.relation||0)+10)}:xt)),s(`  ${Te.name} `)}else O(Ee=>Ee.map(We=>We.id===Te.id?{...We,relation:Math.max(0,(We.relation||0)-15)}:We)),s(`  ${Te.name} `)});dt.triggerDiplomaticEvent(ut),console.log("[EVENT DEBUG] AI Request event triggered:",Te.name,_e.amount)}}catch(He){console.error("[EVENT DEBUG] Failed to parse AI request event:",He)}if(st.includes("AI_ALLIANCE_REQUEST:"))try{const He=st.replace("AI_ALLIANCE_REQUEST:",""),_e=JSON.parse(He),Te=ze.nations?.find(ut=>ut.id===_e.nationId);if(Te&&dt&&dt.triggerDiplomaticEvent){const ut=p5(Te,vt=>{vt?(O(Ee=>Ee.map(We=>We.id===Te.id?{...We,alliedWithPlayer:!0,relation:Math.min(100,(We.relation||0)+20)}:We)),s(`  ${Te.name} `)):(O(Ee=>Ee.map(We=>We.id===Te.id?{...We,relation:Math.max(0,(We.relation||0)-10)}:We)),s(` ${Te.name} `))});dt.triggerDiplomaticEvent(ut),console.log("[EVENT DEBUG] AI Alliance Request event triggered:",Te.name)}}catch(He){console.error("[EVENT DEBUG] Failed to parse AI alliance request event:",He)}if(st.includes("ALLY_COLD_EVENT:"))try{const He=st.replace("ALLY_COLD_EVENT:",""),_e=JSON.parse(He),Te=ze.nations?.find(ut=>ut.id===_e.nationId);if(Te&&dt&&dt.triggerDiplomaticEvent){const ut=m5(Te,_e.relation,(vt,Ee)=>{if(vt==="gift"){if((be.resources?.silver||0)<Ee){s(`  ${Te.name} `);return}c(xt=>({...xt,silver:(xt.silver||0)-Ee})),O(xt=>xt.map(Fa=>Fa.id===Te.id?{...Fa,relation:Math.min(100,(Fa.relation||0)+15)}:Fa)),s(`  ${Te.name} +15`)}else O(We=>We.map(xt=>xt.id===Te.id?{...xt,relation:Math.max(0,(xt.relation||0)-5),allianceStrain:(xt.allianceStrain||0)+1}:xt)),s(`  ${Te.name} `)});dt.triggerDiplomaticEvent(ut),console.log("[EVENT DEBUG] Ally Cold event triggered:",Te.name)}}catch(He){console.error("[EVENT DEBUG] Failed to parse Ally Cold event:",He)}if(st.includes("AI_TRADE_EVENT:"))try{const He=st.replace("AI_TRADE_EVENT:",""),_e=JSON.parse(He),Te=Re[_e.resourceKey]?.name||_e.resourceKey;_e.tariff>0&&ue(ut=>({...ut,tradeTax:(ut.tradeTax||0)+_e.tariff})),_e.tradeType==="export"?_e.tariff>0?s(` ${_e.nationName}  ${_e.quantity} ${Te} ${_e.tariff} `):s(` ${_e.nationName}  ${_e.quantity} ${Te}`):_e.tradeType==="import"?_e.tariff>0?s(` ${_e.nationName}  ${_e.quantity} ${Te} ${_e.tariff} `):s(` ${_e.nationName}  ${_e.quantity} ${Te}`):_e.tariff>0&&s(` ${_e.nationName}  ${_e.tariff} `)}catch(He){console.error("[EVENT DEBUG] Failed to parse AI Trade event:",He)}if(st.includes("AI_DEMAND_SURRENDER:"))try{const He=st.replace("AI_DEMAND_SURRENDER:",""),_e=JSON.parse(He),Te=ze.nations?.find(ut=>ut.id===_e.nationId);if(Te&&dt&&dt.triggerDiplomaticEvent){const ut=x5(Te,_e.warScore,{type:_e.demandType,amount:_e.demandAmount},vt=>{if(vt){if(_e.demandType==="tribute"){const Ee=be.resources?.silver||0;if(Ee<_e.demandAmount){s(`  ${_e.demandAmount} ${Math.floor(Ee)}`);return}c(We=>({...We,silver:Math.max(0,(We.silver||0)-_e.demandAmount)})),s(`  ${Te.name}  ${_e.demandAmount} `)}else if(_e.demandType==="territory"){const Ee=be.population||0;if(Ee<_e.demandAmount+10){s(`  ${_e.demandAmount} ${Math.floor(Ee)}`);return}g(We=>Math.max(10,We-_e.demandAmount)),setMaxPopulation(We=>Math.max(10,We-_e.demandAmount)),s(`  ${Te.name}  ${_e.demandAmount} `)}else _e.demandType==="open_market"&&s(`  ${Te.name}  ${Math.round(_e.demandAmount/365)} `);O(Ee=>Ee.map(We=>We.id===Te.id?{...We,isAtWar:!1,warScore:0,warDuration:0,peaceTreatyUntil:be.daysElapsed+365}:We))}else s(`  ${Te.name} `)});dt.triggerDiplomaticEvent(ut),console.log("[EVENT DEBUG] AI Demand Surrender event triggered:",Te.name)}}catch(He){console.error("[EVENT DEBUG] Failed to parse AI Demand Surrender event:",He)}if(st.includes("AI_BREAK_ALLIANCE:"))try{const He=st.replace("AI_BREAK_ALLIANCE:",""),_e=JSON.parse(He),Te=_e.reason==="relation_low"?"":"";s(` ${Te}${_e.nationName} `)}catch(He){console.error("[EVENT DEBUG] Failed to parse AI Break Alliance event:",He)}if(st.includes("ALLY_ATTACKED_EVENT:"))try{const He=st.replace("ALLY_ATTACKED_EVENT:",""),_e=JSON.parse(He),Te=ze.nations?.find(vt=>vt.id===_e.allyId),ut=ze.nations?.find(vt=>vt.id===_e.attackerId);if(Te&&ut&&dt&&dt.triggerDiplomaticEvent){const vt=h5(Te,ut,Ee=>{Ee?(O(We=>We.map(xt=>xt.id===ut.id?{...xt,isAtWar:!0,warStartDay:be.daysElapsed,warDuration:0,relation:Math.max(0,(xt.relation||50)-40)}:xt)),s(`  ${Te.name} ${ut.name} `)):(O(We=>We.map(xt=>xt.id===Te.id?{...xt,relation:Math.max(0,(xt.relation||50)-30),alliedWithPlayer:!1}:{...xt,relation:Math.max(0,(xt.relation||50)-5)})),s(`  ${Te.name}${Te.name} `))});dt.triggerDiplomaticEvent(vt),console.log("[EVENT DEBUG] Ally Attacked event triggered:",Te.name)}}catch(He){console.error("[EVENT DEBUG] Failed to parse Ally Attacked event:",He)}if(st.includes("REBEL_DEMAND_SURRENDER:"))try{const He=st.replace("REBEL_DEMAND_SURRENDER:",""),_e=JSON.parse(He),Te=ze.nations?.find(ut=>ut.id===_e.nationId);if(Te&&dt&&dt.triggerDiplomaticEvent){const ut={reform:`${Ke[_e.rebellionStratum]?.name||""}`,concession:`${Ke[_e.rebellionStratum]?.name||""}`,massacre:`-${_e.demandAmount}`},vt={id:`rebel_demand_${Te.id}_${Date.now()}`,title:`${Te.name} `,description:`${Te.name} 

${ut[_e.demandType]||""}`,nation:Te,options:[{text:_e.demandType==="massacre"?`-${_e.demandAmount}`:"",action:()=>{if(_e.demandType==="massacre"){const Ee=_e.demandAmount;g(We=>Math.max(10,We-Ee)),setMaxPopulation(We=>Math.max(20,We-Ee)),s(`  ${Ee} `)}else _e.demandType==="reform"?(c(Ee=>({...Ee,silver:Math.max(0,(Ee.silver||0)-_e.demandAmount)})),s(`  ${_e.demandAmount} `)):_e.demandType==="concession"&&(c(Ee=>({...Ee,silver:Math.max(0,(Ee.silver||0)-_e.demandAmount)})),s(`  ${_e.demandAmount} `));O(Ee=>Ee.filter(We=>We.id!==Te.id))}},{text:"",action:()=>{s(`  ${Te.name} `)}}]};dt.triggerDiplomaticEvent(vt),console.log("[EVENT DEBUG] Rebel Demand Surrender event triggered:",Te.name)}}catch(He){console.error("[EVENT DEBUG] Failed to parse Rebel Demand Surrender event:",He)}})}}$t(Oe=>{const Ge=vs||Oe,dt=(Pn??ze.popStructure?.soldier)||0,Nt=Object.values(ja||{}).reduce((Ee,We)=>Ee+We,0),st=Ge.filter(Ee=>Ee.status==="waiting").length,Ct=Ge.filter(Ee=>Ee.status==="training").length,He=Nt+Ct,_e=Math.max(0,dt-He);console.log("[TRAINING QUEUE] currentSoldierPop:",dt,"currentArmyCount:",Nt,"waitingCount:",st,"trainingCount:",Ct,"occupiedJobs:",He,"availableJobsForNewTraining:",_e);let Te=_e;const ut=Ge.map(Ee=>Ee.status==="waiting"&&Te>0?(Te--,s(` ${un[Ee.unitId].name}  ${Ee.totalTime} `),{...Ee,status:"training",remainingTime:Ee.totalTime}):Ee.status==="training"?{...Ee,remainingTime:Ee.remainingTime-1}:Ee),vt=ut.filter(Ee=>Ee.status==="training"&&Ee.remainingTime<=0);return vt.length>0&&(ht(Ee=>{const We={...Ee};return vt.forEach(xt=>{We[xt.unitId]=(We[xt.unitId]||0)+1}),We}),vt.forEach(Ee=>{s(` ${un[Ee.unitId].name} `)})),ut.filter(Ee=>!(Ee.status==="training"&&Ee.remainingTime<=0))})},it);return()=>clearInterval(Xe)},[R,E,Ue,Zt,gn,la,Gt,qt,T])},z1=typeof window<"u"?window.AudioContext||window.webkitAudioContext:null;let mc=null;const M3=()=>z1?(mc||(mc=new z1),mc.state==="suspended"&&mc.resume().catch(()=>{}),mc):null,vo=t=>{const s=M3();if(!s)return()=>{};const r={click:()=>{const o=s.createGain(),c=s.createBiquadFilter();c.type="highpass",c.frequency.value=1e3;const u=s.sampleRate*.1,p=s.createBuffer(1,u,s.sampleRate),m=p.getChannelData(0);for(let g=0;g<u;g++)m[g]=Math.random()*2-1;const h=s.createBufferSource();h.buffer=p,h.connect(c),c.connect(o),o.connect(s.destination);const x=s.currentTime;o.gain.setValueAtTime(.05,x),o.gain.exponentialRampToValueAtTime(.001,x+.05),h.start(x),h.stop(x+.05)},success:()=>{const o=s.currentTime;[523.25,659.25,783.99,987.77].forEach((u,p)=>{const m=s.createOscillator(),h=s.createGain();m.frequency.value=u,m.type="sine",m.connect(h),h.connect(s.destination);const x=o+p*.05;h.gain.setValueAtTime(0,x),h.gain.linearRampToValueAtTime(.1,x+.05),h.gain.exponentialRampToValueAtTime(.001,x+.8),m.start(x),m.stop(x+.8)})},error:()=>{const o=s.currentTime,c=s.createOscillator(),u=s.createGain(),p=s.createBiquadFilter();c.type="triangle",c.frequency.setValueAtTime(150,o),c.frequency.linearRampToValueAtTime(100,o+.15),p.type="lowpass",p.frequency.setValueAtTime(400,o),c.connect(p),p.connect(u),u.connect(s.destination),u.gain.setValueAtTime(.2,o),u.gain.exponentialRampToValueAtTime(.001,o+.2),c.start(o),c.stop(o+.2)},coin:()=>{const o=s.currentTime,c=s.createOscillator(),u=s.createGain();[1,2.5].forEach(m=>{const h=s.createOscillator(),x=s.createGain();h.frequency.value=1200*m,h.type="sine",h.connect(x),x.connect(s.destination),x.gain.setValueAtTime(.05/m,o),x.gain.exponentialRampToValueAtTime(.001,o+.3),h.start(o),h.stop(o+.3)}),c.frequency.setValueAtTime(1200,o),c.type="sine",c.connect(u),u.connect(s.destination),u.gain.setValueAtTime(0,o),u.gain.linearRampToValueAtTime(.1,o+.01),u.gain.exponentialRampToValueAtTime(.001,o+.4),c.start(o),c.stop(o+.4)},build:()=>{const o=s.currentTime;[0,.2].forEach(c=>{const u=s.createOscillator(),p=s.createGain(),m=s.createBiquadFilter();u.type="square",u.frequency.value=100,m.type="lowpass",m.frequency.setValueAtTime(800,o+c),m.frequency.exponentialRampToValueAtTime(100,o+c+.1),m.Q.value=5,u.connect(m),m.connect(p),p.connect(s.destination),p.gain.setValueAtTime(.15,o+c),p.gain.exponentialRampToValueAtTime(.001,o+c+.15),u.start(o+c),u.stop(o+c+.15)})},research:()=>{const o=s.currentTime;[440,554,659,880,1108].forEach((u,p)=>{const m=s.createOscillator(),h=s.createGain();m.type="sine",m.frequency.value=u,m.connect(h),h.connect(s.destination);const x=o+p*.04;h.gain.setValueAtTime(.05,x),h.gain.exponentialRampToValueAtTime(.001,x+.2),m.start(x),m.stop(x+.2)})},battle:()=>{const o=s.currentTime,c=s.createOscillator(),u=s.createGain();c.frequency.setValueAtTime(150,o),c.frequency.exponentialRampToValueAtTime(40,o+.15),c.type="triangle",c.connect(u),u.connect(s.destination),u.gain.setValueAtTime(.3,o),u.gain.exponentialRampToValueAtTime(.001,o+.2),c.start(o),c.stop(o+.2);const p=s.createGain(),m=s.createBiquadFilter();m.type="bandpass",m.frequency.value=2e3;const h=s.sampleRate*.2,x=s.createBuffer(1,h,s.sampleRate),g=x.getChannelData(0);for(let j=0;j<h;j++)g[j]=Math.random()*2-1;const b=s.createBufferSource();b.buffer=x,b.connect(m),m.connect(p),p.connect(s.destination),p.gain.setValueAtTime(.1,o),p.gain.exponentialRampToValueAtTime(.001,o+.1),b.start(o),b.stop(o+.1)},victory:()=>{const o=s.currentTime;[261.63,329.63,392,523.25].forEach((u,p)=>{const m=s.createOscillator(),h=s.createGain();m.type=p===0?"triangle":"sine",m.frequency.value=u,m.connect(h),h.connect(s.destination),h.gain.setValueAtTime(0,o),h.gain.linearRampToValueAtTime(.15,o+.1),h.gain.exponentialRampToValueAtTime(.001,o+2),m.start(o),m.stop(o+2)})},levelup:()=>{const o=s.currentTime;[523,659,784,1046].forEach((u,p)=>{const m=s.createOscillator(),h=s.createGain();m.frequency.value=u,m.type="sine",m.connect(h),h.connect(s.destination);const x=o+p*.08;h.gain.setValueAtTime(.1,x),h.gain.exponentialRampToValueAtTime(.001,x+.3),m.start(x),m.stop(x+.3)})},notification:()=>{const o=s.currentTime,c=s.createOscillator(),u=s.createGain();c.frequency.setValueAtTime(600,o),c.frequency.exponentialRampToValueAtTime(1200,o+.1),c.type="sine",c.connect(u),u.connect(s.destination),u.gain.setValueAtTime(.1,o),u.gain.exponentialRampToValueAtTime(.001,o+.1),c.start(o),c.stop(o+.1)}};return r[t]||r.click},Hr={CLICK:"click",SUCCESS:"success",ERROR:"error",COIN:"coin",BUILD:"build",RESEARCH:"research",BATTLE:"battle",VICTORY:"victory",LEVEL_UP:"levelup",NOTIFICATION:"notification",EVENT:"event"},_3=(t,s)=>{const{resources:r,setResources:o,market:c,buildings:u,setBuildings:p,epoch:m,setEpoch:h,population:x,techsUnlocked:g,setTechsUnlocked:b,setDecrees:j,setClicks:_,army:N,setArmy:M,militaryQueue:R,setMilitaryQueue:E,setBattleResult:T,battleNotifications:D,setBattleNotifications:O,nations:q,setNations:I,setClassInfluenceShift:Z,daysElapsed:Y,currentEvent:U,setCurrentEvent:S,eventHistory:Q,setEventHistory:ne,classApproval:Ne,setClassApproval:$e,stability:de,setStability:P,setPopulation:z,setMaxPop:V,setMaxPopBonus:F,tradeRoutes:re,setTradeRoutes:C,jobsAvailable:L,eventEffectSettings:ie,setActiveEventEffects:H,rebellionStates:ve,setRebellionStates:me,popStructure:X,setPopStructure:qe,classWealth:fe}=t,[Je,tt]=$.useState([]),Mt=se=>{if(!se)return 1;const pe=Re[se]?.basePrice||1;return c?.prices?.[se]??pe},jt=se=>se&&(Re[se]?.name||se),ot=se=>se&&(typeof Ke<"u"&&Ke[se]?.name?Ke[se].name:se),B=()=>{if(m>=wn.length-1)return!1;const se=wn[m+1];if(se.req.science&&r.science<se.req.science||se.req.population&&x<se.req.population||se.req.culture&&r.culture<se.req.culture)return!1;for(let he in se.cost)if((r[he]||0)<se.cost[he])return!1;const pe=Object.entries(se.cost).reduce((he,[K,je])=>he+je*Mt(K),0);return!((r.silver||0)<pe)},Ue=()=>{if(!B())return;const se=wn[m+1],pe={...r},he=Object.entries(se.cost).reduce((K,[je,J])=>K+J*Mt(je),0);for(let K in se.cost)pe[K]-=se.cost[K];pe.silver=Math.max(0,(pe.silver||0)-he),o(pe),h(m+1),s(`  ${se.name}`);try{const K=vo(Hr.LEVEL_UP);K&&K()}catch(K){console.warn("Failed to play level up sound:",K)}},ht=se=>{const pe=Ln.find(ue=>ue.id===se),he=u[se]||0,K={};for(let ue in pe.baseCost)K[ue]=pe.baseCost[ue]*Math.pow(1.15,he);if(!Object.entries(K).every(([ue,Me])=>(r[ue]||0)>=Me)){s(` ${pe.name}`);return}const J=Object.entries(K).reduce((ue,[Me,Ie])=>ue+Ie*Mt(Me),0);if((r.silver||0)<J){s("");return}const le={...r};Object.entries(K).forEach(([ue,Me])=>{le[ue]=Math.max(0,(le[ue]||0)-Me)}),le.silver=Math.max(0,(le.silver||0)-J),o(le),p(ue=>({...ue,[se]:(ue[se]||0)+1})),s(` ${pe.name}`);try{const ue=vo(Hr.BUILD);ue&&ue()}catch(ue){console.warn("Failed to play build sound:",ue)}},ft=se=>{(u[se]||0)>0&&(p(pe=>({...pe,[se]:pe[se]-1})),s(` ${Ln.find(pe=>pe.id===se).name}`))},$t=se=>{const pe=_l.find(J=>J.id===se);if(!pe)return;if(g.includes(se)){s(` ${pe.name}`);return}if(pe.epoch>m){s(` ${wn[pe.epoch].name}  ${pe.name}`);return}let he=!0;for(let J in pe.cost)if((r[J]||0)<pe.cost[J]){he=!1;break}if(!he){s(` ${pe.name}`);return}const K=Object.entries(pe.cost).reduce((J,[le,ue])=>J+ue*Mt(le),0);if((r.silver||0)<K){s("");return}const je={...r};for(let J in pe.cost)je[J]-=pe.cost[J];je.silver=Math.max(0,(je.silver||0)-K),o(je),b(J=>[...J,se]),s(` ${pe.name}`);try{const J=vo(Hr.RESEARCH);J&&J()}catch(J){console.warn("Failed to play research sound:",J)}},It=se=>{let pe=null,he="";if(j(K=>K.map(je=>{if(je.id!==se)return je;const J=je.unlockEpoch??0;return J>m?(pe=J,he=je.name||"",je):{...je,active:!je.active}})),pe!==null&&s){const K=wn[pe]?.name||` ${pe+1} `;s(`${K}${he||""}`)}},oe=se=>{_(pe=>[...pe,{id:Date.now(),x:se.clientX,y:se.clientY,text:"+1",color:"text-white"}]),o(pe=>({...pe,food:pe.food+1,wood:pe.wood+1}))},Ye=se=>{const pe=un[se];if(!pe)return;if(pe.epoch>m){s(` ${wn[pe.epoch].name}  ${pe.name}`);return}let he=!0;for(let J in pe.recruitCost)if((r[J]||0)<pe.recruitCost[J]){he=!1;break}if(!he){s(` ${pe.name}`);return}const K=Object.entries(pe.recruitCost).reduce((J,[le,ue])=>J+ue*Mt(le),0);if((r.silver||0)<K){s("");return}const je={...r};for(let J in pe.recruitCost)je[J]-=pe.recruitCost[J];je.silver=Math.max(0,(je.silver||0)-K),o(je),E(J=>[...J,{unitId:se,status:"waiting",remainingTime:pe.trainingTime,totalTime:pe.trainingTime}]),s(` ${pe.name}...`)},bt=se=>{(N[se]||0)>0&&(M(pe=>({...pe,[se]:pe[se]-1})),s(` ${un[se].name}`))},Pe=se=>{E(pe=>{if(se<0||se>=pe.length)return pe;const he=pe[se],K=un[he.unitId],je=pe.filter((J,le)=>le!==se);if(he.status==="waiting"||he.status==="training"){const J={};for(let Me in K.recruitCost)J[Me]=Math.floor(K.recruitCost[Me]*.5);const le=Object.entries(K.recruitCost).reduce((Me,[Ie,at])=>Me+at*Mt(Ie),0),ue=Math.floor(le*.5);o(Me=>{const Ie={...Me};for(let at in J)Ie[at]=(Ie[at]||0)+J[at];return Ie.silver=(Ie.silver||0)+ue,Ie}),s(` ${K.name}50%`)}return je})},lt=(se,pe)=>{const he=ky.find(Rt=>Rt.id===se);if(!he){s("");return}const K=q.find(Rt=>Rt.id===pe);if(!K){s("");return}if(!K.isAtWar){s(`${K.name} `);return}if(Object.values(N).reduce((Rt,ua)=>Rt+ua,0)===0){s("");return}const J={army:N,epoch:m,militaryBuffs:0},le=Math.max(K.appearEpoch||0,Math.min(m,K.expireEpoch??m)),ue=K.militaryStrength??1,Me=Math.max(.3,Math.min(1.5,(K.wealth||500)/800)),Ie=1+(K.aggression||.2),at=1+Math.max(-.5,(K.warScore||0)/120),Ze=ue*Me*Ie*at,Ce=he.unitScale||"medium",rt=Bp(le,Ce),zt={},Ve=he.baseUnitCount||{min:10,max:15},ca=Ve.min+Math.random()*(Ve.max-Ve.min),ha=Math.floor(ca*Ze);rt.forEach((Rt,ua)=>{if(un[Rt]){const An=.5+Math.random()*.8,wa=Math.floor(ha/rt.length*An);wa>0&&(zt[Rt]=wa)}});const Ra={army:zt,epoch:le,militaryBuffs:he.enemyBuff||0,wealth:K.wealth||500},xe=Wp(J,Ra);let Tt={};if(xe.victory){const Rt={};if((wa=>{Object.entries(wa||{}).forEach(([Na,ze])=>{ze>0&&(Rt[Na]=(Rt[Na]||0)+Math.floor(ze))})})(xe.loot||{}),he.lootConfig){const wa=K.wealth||500;Object.entries(he.lootConfig).forEach(([Na,ze])=>{const Pn=r?.[Na]||0,ja=Math.floor(wa*ze.enemyPercent),vs=Math.floor(Pn*ze.playerPercent),Vn=ze.baseMin||10,ns=Math.max(Vn,Math.min(ja,Math.max(ja*.5,vs))),us=.8+Math.random()*.4,ps=Math.floor(ns*us);ps>0&&(Rt[Na]=(Rt[Na]||0)+ps)})}else Object.entries(he.loot||{}).forEach(([wa,Na])=>{if(!Array.isArray(Na)||Na.length<2)return;const[ze,Pn]=Na,ja=Math.floor(ze+Math.random()*(Pn-ze+1));ja>0&&(Rt[wa]=(Rt[wa]||0)+ja)});const An={};Object.entries(Rt).forEach(([wa,Na])=>{Na>0&&si(wa,m,g)&&(An[wa]=Na)}),Tt=An,Object.keys(An).length>0&&o(wa=>{const Na={...wa};return Object.entries(An).forEach(([ze,Pn])=>{Na[ze]=(Na[ze]||0)+Pn}),Na})}M(Rt=>{const ua={...Rt};return Object.entries(xe.attackerLosses||{}).forEach(([An,wa])=>{ua[An]=Math.max(0,(ua[An]||0)-wa)}),ua});const et=xe.victory?he.influence?.win||0:he.influence?.lose||0;et!==0&&Z(Rt=>({...Rt,soldier:(Rt?.soldier||0)+et}));const Ae=Object.values(xe.defenderLosses||{}).reduce((Rt,ua)=>Rt+ua,0),it=he.wealthDamage||20,Xe=xe.victory?Math.min(K.wealth||0,Math.max(50,Ae*it)):0,be=xe.victory?he.winScore||10:-(he.loseScore||8),Qt=xe.victory?Math.min(.15,Ae*.005+Xe/1e4):0,gt=xe.victory?Math.floor(Ae*.8):0;I(Rt=>Rt.map(ua=>{if(ua.id!==pe)return ua;const An=ua.militaryStrength??1,wa=Math.max(.2,An-Qt),Na=ua.population??1e3,ze=Math.max(100,Na-gt);return{...ua,wealth:Math.max(0,(ua.wealth||0)-Xe),warScore:(ua.warScore||0)+be,enemyLosses:(ua.enemyLosses||0)+Ae,militaryStrength:wa,population:ze}})),T({victory:xe.victory,actionType:he.id,missionName:he.name,missionDesc:he.desc,missionDifficulty:he.difficulty,ourPower:xe.attackerPower,enemyPower:xe.defenderPower,powerRatio:xe.defenderPower>0?xe.attackerPower/xe.defenderPower:xe.attackerPower,score:Number(xe.attackerAdvantage||0),losses:xe.attackerLosses||{},enemyLosses:xe.defenderLosses||{},resourcesGained:Tt,nationName:K.name,description:(xe.battleReport||[]).join(`
`)}),s(xe.victory?`  ${K.name} `:`  ${K.name} `);try{const Rt=vo(xe.victory?Hr.VICTORY:Hr.BATTLE);Rt&&Rt()}catch(Rt){console.warn("Failed to play battle sound:",Rt)}},Vt=(se,pe,he={})=>{const K=q.find(J=>J.id===se);if(!K)return;const je=J=>Math.max(0,Math.min(100,J));if(K.isAtWar&&(pe==="gift"||pe==="trade"||pe==="import"||pe==="demand")){s(`${K.name} `);return}switch(pe){case"gift":{const J=he.amount||500;if((r.silver||0)<J){s("");return}o(le=>({...le,silver:le.silver-J})),I(le=>le.map(ue=>ue.id===se?{...ue,relation:je((ue.relation||0)+10),wealth:(ue.wealth||0)+J}:ue)),s(` ${K.name} `);break}case"trade":{const J=he.resource,le=Math.max(1,Math.floor(he.amount||5));if(!J||!Re[J]||Re[J].type==="virtual"||J==="silver"){s("");return}if((r[J]||0)<le){s("");return}const ue=gl(J,K,Y),Me=Math.floor(ue.shortageAmount);if(!ue.isShortage||Me<=0){s(`${K.name}  ${Re[J].name} `);return}if(le>Me)return s(`${K.name}  ${Re[J].name}  ${Me}  ${le}`),he.amount=Me,Vt(se,pe,he);const Ie=Mt(J),at=jl(J,K,Y),Ce=at*le,rt=at-Ie;o(zt=>({...zt,silver:zt.silver+Ce,[J]:Math.max(0,(zt[J]||0)-le)})),I(zt=>zt.map(Ve=>Ve.id===se?{...Ve,budget:Math.max(0,(Ve.budget||0)-Ce),inventory:{...Ve.inventory,[J]:((Ve.inventory||{})[J]||0)+le},relation:je((Ve.relation||0)+(rt>0?2:0))}:Ve)),s(` ${K.name}  ${le}${Re[J].name} ${Ce.toFixed(1)}  ${rt>=0?"+":""}${rt.toFixed(2)}`);break}case"import":{const J=he.resource,le=Math.max(1,Math.floor(he.amount||5));if(!J||!Re[J]||Re[J].type==="virtual"||J==="silver"){s("");return}const ue=gl(J,K,Y),Me=Math.floor(ue.surplusAmount);if(!ue.isSurplus||Me<=0){s(`${K.name}  ${Re[J].name} `);return}if(le>Me)return s(`${K.name}  ${Re[J].name}  ${Me}  ${le}`),he.amount=Me,Vt(se,pe,he);const Ie=Mt(J),at=jl(J,K,Y),Ze=at*le;if((r.silver||0)<Ze){s("");return}const Ce=Ie-at;o(rt=>({...rt,silver:rt.silver-Ze,[J]:(rt[J]||0)+le})),I(rt=>rt.map(zt=>zt.id===se?{...zt,budget:(zt.budget||0)+Ze,inventory:{...zt.inventory,[J]:Math.max(0,((zt.inventory||{})[J]||0)-le)},relation:je((zt.relation||0)+(Ce>0?2:0))}:zt)),s(` ${K.name}  ${le}${Re[J].name} ${Ze.toFixed(1)}  ${Ce>=0?"+":""}${Ce.toFixed(2)}`);break}case"demand":{const J=sd(N,m),le=Math.max(.1,J/(J+200)*.6+(K.relation||0)/300);if(Math.random()<le){const ue=Math.min(K.wealth||0,Math.ceil(150+J*.25));o(Me=>({...Me,silver:Me.silver+ue})),I(Me=>Me.map(Ie=>Ie.id===se?{...Ie,wealth:Math.max(0,(Ie.wealth||0)-ue),relation:je((Ie.relation||0)-30)}:Ie)),s(`${K.name}  ${ue} `)}else{const ue=Math.random()<.4+(K.aggression||0)*.4;I(Me=>Me.map(Ie=>Ie.id===se?{...Ie,relation:je((Ie.relation||0)-40),isAtWar:ue?!0:Ie.isAtWar,warStartDay:ue?Y:Ie.warStartDay,warDuration:ue?0:Ie.warDuration}:Ie)),s(`${K.name} ${ue?"":""}`)}break}case"provoke":{if((r.silver||0)<300){s("300");return}let le;if(he.targetNationId){if(le=q.find(Ie=>Ie.id===he.targetNationId),!le){s("");return}}else{const Ie=q.filter(at=>at.id!==se&&m>=(at.appearEpoch??0)&&(at.expireEpoch==null||m<=at.expireEpoch));if(Ie.length===0){s("");return}le=Ie[Math.floor(Math.random()*Ie.length)]}const ue=K.relation||50,Me=Math.min(.8,.3+ue/200);if(o(Ie=>({...Ie,silver:Ie.silver-300})),Math.random()<Me){const Ie=Math.floor(15+Math.random()*15);I(at=>at.map(Ze=>{if(Ze.id===se){const Ce={...Ze.foreignRelations||{}};return Ce[le.id]=Math.max(0,(Ce[le.id]||50)-Ie),{...Ze,foreignRelations:Ce}}if(Ze.id===le.id){const Ce={...Ze.foreignRelations||{}};return Ce[se]=Math.max(0,(Ce[se]||50)-Ie),{...Ze,foreignRelations:Ce}}return Ze})),s(`  ${K.name}  ${le.name} -${Ie}`)}else I(Ie=>Ie.map(at=>at.id===se?{...at,relation:je((at.relation||0)-15)}:at)),s(`  ${K.name} `);break}case"declare_war":{if(K.peaceTreatyUntil&&Y<K.peaceTreatyUntil){const ue=K.peaceTreatyUntil-Y;s(` ${K.name}  ${ue} `);return}if(K.alliedWithPlayer===!0){s(`${K.name} `);return}const J=q.filter(ue=>!(ue.id===se||ue.id===K.id||!((K.allies||[]).includes(ue.id)||(ue.allies||[]).includes(K.id))||ue.alliedWithPlayer===!0)),le=q.filter(ue=>ue.id===se||ue.id===K.id?!1:((K.allies||[]).includes(ue.id)||(ue.allies||[]).includes(K.id))&&ue.alliedWithPlayer===!0);if(I(ue=>{let Me=ue.map(Ie=>Ie.id===se?{...Ie,relation:0,isAtWar:!0,warScore:0,warStartDay:Y,warDuration:0,enemyLosses:0,peaceTreatyUntil:void 0}:Ie);return J.length>0&&(Me=Me.map(Ie=>J.some(at=>at.id===Ie.id)?{...Ie,relation:Math.max(0,(Ie.relation||50)-40),isAtWar:!0,warScore:0,warStartDay:Y,warDuration:0,enemyLosses:0}:Ie)),Me}),s(` ${K.name} `),J.length>0){const ue=J.map(Me=>Me.name).join("");s(` ${K.name}  ${ue} `)}le.length>0&&le.forEach(ue=>{s(` ${ue.name}  ${K.name} `)});break}case"peace":{if(!K.isAtWar){s("");return}const J=K.warScore||0,le=K.warDuration||0,ue=K.enemyLosses||0,Me=d5(K,J,le,ue,{population:x,wealth:r?.silver||0},(Ie,at)=>{gn(se,Ie,at)});Gt(Me);break}case"propose_alliance":{if(K.isAtWar){s(`${K.name} `);return}if(K.alliedWithPlayer===!0){s(`${K.name} `);return}const J=K.relation||0;if(J<60){s(` ${K.name} 60${Math.round(J)}`);return}const le=.3+(J-60)*.015,ue=K.aggression??.3,Me=le*(1-ue*.5);if(Math.random()<Me){I(Ze=>Ze.map(Ce=>Ce.id===se?{...Ce,alliedWithPlayer:!0,relation:Math.min(100,(Ce.relation||0)+15)}:Ce));const at=u1(K,!0,()=>{});Gt(at),s(` ${K.name} `)}else{I(Ze=>Ze.map(Ce=>Ce.id===se?{...Ce,relation:Math.max(0,(Ce.relation||0)-5)}:Ce));const at=u1(K,!1,()=>{});Gt(at),s(`${K.name} `)}break}case"break_alliance":{if(K.alliedWithPlayer!==!0){s(`${K.name} `);return}I(le=>le.map(ue=>ue.id===se?{...ue,alliedWithPlayer:!1,relation:Math.max(0,(ue.relation||0)-25)}:ue));const J=f5(K,"player_break",()=>{});Gt(J),s(` ${K.name} `);break}}},oa=(se,pe,he)=>{const K=q.find(J=>J.id===se);if(!K)return;if(K.isRebelNation){Ht(se,!0);return}const je=Y+730;if(pe==="annex"){if(K.isRebelNation){Ht(se,!0);return}const J=K.population||he||0,le=Math.max(0,J),ue=le;le>0&&(z(Ie=>Ie+le),F(Ie=>Ie+ue)),I(Ie=>Ie.filter(at=>at.id!==se));const Me=B0(K,le,ue,"war_annex",()=>{});Gt(Me),s(` ${K.name}`)}else if(pe==="installment")I(J=>J.map(le=>le.id===se?{...le,isAtWar:!1,warScore:0,warDuration:0,enemyLosses:0,isPeaceRequesting:!1,relation:Math.max(35,le.relation||0),peaceTreatyUntil:je,installmentPayment:{amount:he,remainingDays:365,totalAmount:he*365,paidAmount:0}}:le)),s(`${K.name} ${he} ${he*365}`);else if(pe==="population"){F(le=>le+he),z(le=>le+he);const J=Math.max(0,(K.population||0)-he);if(!K.isRebelNation&&J<=0){I(ue=>ue.filter(Me=>Me.id!==se));const le=B0(K,0,0,"population_zero",()=>{});Gt(le),s(`${K.name}`)}else I(le=>le.map(ue=>ue.id===se?{...ue,isAtWar:!1,warScore:0,warDuration:0,enemyLosses:0,isPeaceRequesting:!1,population:J,relation:Math.max(35,ue.relation||0),peaceTreatyUntil:je}:ue)),s(`${K.name} ${he} `)}else if(pe==="open_market"){const J=Y+he,le=Math.round(he/365);I(ue=>ue.map(Me=>Me.id===se?{...Me,isAtWar:!1,warScore:0,warDuration:0,enemyLosses:0,isPeaceRequesting:!1,relation:Math.max(35,Me.relation||0),peaceTreatyUntil:je,openMarketUntil:J}:Me)),s(`${K.name}${le}`)}else o(J=>({...J,silver:(J.silver||0)+he})),I(J=>J.map(le=>le.id===se?{...le,isAtWar:!1,warScore:0,warDuration:0,enemyLosses:0,isPeaceRequesting:!1,wealth:Math.max(0,(le.wealth||0)-he),relation:Math.max(35,le.relation||0),peaceTreatyUntil:je}:le)),s(`${K.name} ${he} `)},Ka=se=>{I(pe=>pe.map(he=>he.id===se?{...he,isPeaceRequesting:!1}:he)),s(`${q.find(pe=>pe.id===se)?.name||""}`)},gn=(se,pe,he)=>{if(pe==="cancel"){s("");return}const K=q.find(Ze=>Ze.id===se);if(!K)return;const je=K.isRebelNation===!0,J=je?" ":"",le=Ze=>Math.max(0,Math.min(100,Ze)),ue=K.warScore||0,Me=K.warDuration||0,Ie=K.enemyLosses||0,at=Y+730;if(pe==="demand_annex"){if(je){Ht(se,!0);return}const Ze=K.population||he||0,Ce=Math.max(0,Ze),rt=Ce;Ce>0&&(z(Ve=>Ve+Ce),F(Ve=>Ve+rt)),I(Ve=>Ve.filter(ca=>ca.id!==se));const zt=B0(K,Ce,rt,"war_annex",()=>{});Gt(zt),s(` ${K.name}${J}`)}else if(pe==="demand_high")ue/100+Math.min(.4,Ie/250)+Math.min(.2,Me/250)>.7||(K.wealth||0)<=0?(o(Ce=>({...Ce,silver:(Ce.silver||0)+he})),je?Ht(se,!0):I(Ce=>Ce.map(rt=>rt.id===se?{...rt,wealth:Math.max(0,(rt.wealth||0)-he),isAtWar:!1,warScore:0,warDuration:0,enemyLosses:0,relation:le((rt.relation||0)+5),peaceTreatyUntil:at}:rt)),s(`${K.name}  ${he} ${J}`)):s(`${K.name} `);else if(pe==="demand_installment")ue/90+Math.min(.45,Ie/220)+Math.min(.25,Me/220)>.65?(je?Ht(se,!0):I(Ce=>Ce.map(rt=>rt.id===se?{...rt,isAtWar:!1,warScore:0,warDuration:0,enemyLosses:0,relation:le((rt.relation||0)+8),peaceTreatyUntil:at,installmentPayment:{amount:he,remainingDays:365,totalAmount:he*365,paidAmount:0}}:rt)),s(`${K.name}  ${he} ${he*365}${J}`)):s(`${K.name} `);else if(pe==="demand_population")if(ue/95+Math.min(.42,Ie/230)+Math.min(.23,Me/230)>.68)if(F(Ce=>Ce+he),z(Ce=>Ce+he),je)Ht(se,!0);else{const Ce=Math.max(0,(K.population||0)-he);if(Ce<=0){I(zt=>zt.filter(Ve=>Ve.id!==se));const rt=B0(K,0,0,"population_zero",()=>{});Gt(rt),s(`${K.name}${J}`)}else I(rt=>rt.map(zt=>zt.id===se?{...zt,isAtWar:!1,warScore:0,warDuration:0,enemyLosses:0,population:Ce,relation:le((zt.relation||0)+7),peaceTreatyUntil:at}:zt)),s(`${K.name}  ${he} ${J}`)}else s(`${K.name} `);else if(pe==="demand_standard"||pe==="demand_tribute")ue/80+Math.min(.5,Ie/200)+Math.min(.3,Me/200)>.6||(K.wealth||0)<=0?(o(Ce=>({...Ce,silver:(Ce.silver||0)+he})),je?Ht(se,!0):I(Ce=>Ce.map(rt=>rt.id===se?{...rt,wealth:Math.max(0,(rt.wealth||0)-he),isAtWar:!1,warScore:0,warDuration:0,enemyLosses:0,relation:le((rt.relation||0)+10),peaceTreatyUntil:at}:rt)),s(`${K.name}  ${he} ${J}`)):s(`${K.name} `);else if(pe==="peace_only")Math.max(.3,ue/60+Math.min(.4,Ie/150))>.5?(je?Ht(se,!0):I(Ce=>Ce.map(rt=>rt.id===se?{...rt,isAtWar:!1,warScore:0,warDuration:0,enemyLosses:0,relation:le((rt.relation||0)+15),peaceTreatyUntil:at}:rt)),s(`${K.name} ${J}`)):s(`${K.name} `);else if(pe==="demand_open_market")if(ue/85+Math.min(.45,Ie/210)+Math.min(.25,Me/210)>.6){const Ce=Y+he,rt=Math.round(he/365);je?Ht(se,!0):I(zt=>zt.map(Ve=>Ve.id===se?{...Ve,isAtWar:!1,warScore:0,warDuration:0,enemyLosses:0,relation:le((Ve.relation||0)+10),peaceTreatyUntil:at,openMarketUntil:Ce}:Ve)),s(`${K.name} ${rt}${J}`)}else s(`${K.name} `);else if(pe==="pay_installment"||pe==="pay_installment_moderate")je?Ht(se,!1):I(Ze=>Ze.map(Ce=>Ce.id===se?{...Ce,isAtWar:!1,warScore:0,warDuration:0,enemyLosses:0,relation:le(28),peaceTreatyUntil:at}:Ce)),t.setPlayerInstallmentPayment({nationId:se,amount:he,remainingDays:365,totalAmount:he*365,paidAmount:0}),s(` ${K.name}  ${he} ${he*365}${J}`);else if(pe==="offer_population"){if(x<he){s("");return}F(Ze=>Math.max(-x+1,Ze-he)),z(Ze=>Math.max(1,Ze-he)),je?Ht(se,!1):I(Ze=>Ze.map(Ce=>Ce.id===se?{...Ce,isAtWar:!1,warScore:0,warDuration:0,enemyLosses:0,population:(Ce.population||1e3)+he,relation:le(27),peaceTreatyUntil:at}:Ce)),s(` ${he}  ${K.name} ${J}`)}else if(pe==="pay_standard"||pe==="pay_high"||pe==="pay_moderate"){if((r.silver||0)<he){s("");return}o(Ze=>({...Ze,silver:(Ze.silver||0)-he})),je?Ht(se,!1):I(Ze=>Ze.map(Ce=>Ce.id===se?{...Ce,isAtWar:!1,warScore:0,warDuration:0,enemyLosses:0,wealth:(Ce.wealth||0)+he,relation:le(pe==="pay_high"?25:30),peaceTreatyUntil:at}:Ce)),s(` ${he}  ${K.name} ${J}`)}},Zt=(se,pe,he={})=>{const K=q.find(ue=>ue.id===se);if(!K)return;const{resource:je,type:J}=he;if(!je||!J)return;if(!Re[je]||Re[je].type==="virtual"||je==="silver"){s("");return}const le=Re[je];if((le.unlockEpoch??0)>m){s(`${le.name} `);return}if(pe==="create"){const ue=L?.merchant||0,Me=re.routes.length;if(ue>0&&Me>=ue){s(`${ue}`);return}if(K.isAtWar){s(` ${K.name} `);return}if(!(K.openMarketUntil&&Y<K.openMarketUntil)){const rt=K.relation||0,Ve=(ha=>ha>=80?4:ha>=60?3:ha>=40?2:ha>=20?1:0)(rt),ca=re.routes.filter(ha=>ha.nationId===se).length;if(Ve===0){s(` ${K.name} ${rt}20`);return}if(ca>=Ve){const ha={0:"",1:"",2:"",3:"",4:""};s(` ${K.name} ${ca}/${Ve}${ha[Ve]}`);return}}if(re.routes.some(rt=>rt.nationId===se&&rt.resource===je&&rt.type===J)){s("");return}const Ze=gl(je,K,Y);if(J==="export"){if(!Ze.isShortage||Ze.shortageAmount<=0){s(`${K.name}  ${le.name} `);return}}else if(J==="import"&&(!Ze.isSurplus||Ze.surplusAmount<=0)){s(`${K.name}  ${le.name} `);return}C(rt=>({...rt,routes:[...rt.routes,{nationId:se,resource:je,type:J,createdAt:Y}]}));const Ce=J==="export"?"":"";s(`  ${le.name} ${Ce} ${K.name}`)}else if(pe==="cancel"){if(!re.routes.some(Ie=>Ie.nationId===se&&Ie.resource===je&&Ie.type===J)){s("");return}C(Ie=>({...Ie,routes:Ie.routes.filter(at=>!(at.nationId===se&&at.resource===je&&at.type===J))}));const Me=J==="export"?"":"";s(`  ${le.name} ${Me} ${K.name}`)}},la=()=>{if(U)return;const se=_5(t);se&&(S(se),s(` ${se.name}`),vo(Hr.EVENT),t.setPausedBeforeEvent(t.isPaused),t.setIsPaused(!0))},qt=se=>{se&&(S(se),s(` ${se.name}`),vo(Hr.EVENT),t.setPausedBeforeEvent(t.isPaused),t.setIsPaused(!0))},Gt=se=>{if(se){if(U){tt(pe=>[...pe,se]);return}qt(se)}};$.useEffect(()=>{if(U||!Je||Je.length===0)return;const se=setTimeout(()=>{tt(pe=>{if(!pe||pe.length===0)return pe;const[he,...K]=pe;return setTimeout(()=>qt(he),0),K})},100);return()=>clearTimeout(se)},[U,Je]);const kt=(se,pe)=>{let he=vf.find(xe=>xe.id===se);if(!he&&U&&U.id===se&&(he=U),!he)return;const K=ie?.approval||{},je=ie?.stability||{},J=(xe,Tt)=>typeof xe!="number"||Number.isNaN(xe)?Tt:Math.min(.95,Math.max(0,xe)),le=(xe={})=>({approval:Array.isArray(xe.approval)?[...xe.approval]:[],stability:Array.isArray(xe.stability)?[...xe.stability]:[],resourceDemand:Array.isArray(xe.resourceDemand)?[...xe.resourceDemand]:[],stratumDemand:Array.isArray(xe.stratumDemand)?[...xe.stratumDemand]:[],buildingProduction:Array.isArray(xe.buildingProduction)?[...xe.buildingProduction]:[]}),ue=(xe={})=>{if(!xe||typeof H!="function")return;const Tt=Object.entries(xe).filter(([,Xe])=>typeof Xe=="number"&&Xe!==0);if(!Tt.length)return;const et=Math.max(1,K.duration||30),Ae=J(K.decayRate??.04,.04),it=Date.now();H(Xe=>{const be=le(Xe);return Tt.forEach(([Qt,gt])=>{be.approval.push({id:`approval_${it}_${Qt}_${Math.random()}`,stratum:Qt,currentValue:gt,remainingDays:et,decayRate:Ae})}),be})},Me=xe=>{if(typeof xe!="number"||xe===0||typeof H!="function")return;const Tt=Math.max(1,je.duration||30),et=J(je.decayRate??.04,.04),Ae=Date.now();H(it=>{const Xe=le(it);return Xe.stability.push({id:`stability_${Ae}_${Math.random()}`,currentValue:xe,remainingDays:Tt,decayRate:et}),Xe})},Ie=ie?.resourceDemand||{duration:60,decayRate:.02},at=ie?.stratumDemand||{duration:60,decayRate:.02},Ze=ie?.buildingProduction||{duration:45,decayRate:.025},Ce=(xe={})=>{if(!xe||typeof H!="function")return;const Tt=Object.entries(xe).filter(([,Xe])=>typeof Xe=="number"&&Xe!==0);if(!Tt.length)return;const et=Math.max(1,Ie.duration||60),Ae=J(Ie.decayRate??.02,.02),it=Date.now();H(Xe=>({...Xe,resourceDemand:[...Xe?.resourceDemand||[],...Tt.map(([be,Qt])=>({id:`resourceDemand_${it}_${be}_${Math.random()}`,target:be,currentValue:Qt,remainingDays:et,decayRate:Ae}))]}))},rt=(xe={})=>{if(!xe||typeof H!="function")return;const Tt=Object.entries(xe).filter(([,Xe])=>typeof Xe=="number"&&Xe!==0);if(!Tt.length)return;const et=Math.max(1,at.duration||60),Ae=J(at.decayRate??.02,.02),it=Date.now();H(Xe=>({...Xe,stratumDemand:[...Xe?.stratumDemand||[],...Tt.map(([be,Qt])=>({id:`stratumDemand_${it}_${be}_${Math.random()}`,target:be,currentValue:Qt,remainingDays:et,decayRate:Ae}))]}))},zt=(xe={})=>{if(!xe||typeof H!="function")return;const Tt=Object.entries(xe).filter(([,Xe])=>typeof Xe=="number"&&Xe!==0);if(!Tt.length)return;const et=Math.max(1,Ze.duration||45),Ae=J(Ze.decayRate??.025,.025),it=Date.now();H(Xe=>({...Xe,buildingProduction:[...Xe?.buildingProduction||[],...Tt.map(([be,Qt])=>({id:`buildingProduction_${it}_${be}_${Math.random()}`,target:be,currentValue:Qt,remainingDays:et,decayRate:Ae}))]}))},Ve=(xe={})=>{xe.resources&&o(et=>{const Ae={...et};return Object.entries(xe.resources).forEach(([it,Xe])=>{Ae[it]=Math.max(0,(Ae[it]||0)+Xe)}),Ae}),xe.resourcePercent&&o(et=>{const Ae={...et};return Object.entries(xe.resourcePercent).forEach(([it,Xe])=>{const be=Ae[it]||0,Qt=Math.floor(be*Xe);Ae[it]=Math.max(0,be+Qt)}),Ae}),xe.population&&z(et=>Math.max(1,et+xe.population)),xe.populationPercent&&z(et=>{const Ae=Math.floor(et*xe.populationPercent);return Math.max(1,et+Ae)}),xe.stability&&(P(et=>Math.max(0,Math.min(100,et+xe.stability))),Me(xe.stability)),xe.science&&o(et=>({...et,science:Math.max(0,(et.science||0)+xe.science)})),xe.approval&&($e(et=>{const Ae={...et};return Object.entries(xe.approval).forEach(([it,Xe])=>{Ae[it]=Math.max(0,Math.min(100,(Ae[it]||50)+Xe))}),Ae}),ue(xe.approval)),xe.resourceDemandMod&&Ce(xe.resourceDemandMod),xe.stratumDemandMod&&rt(xe.stratumDemandMod),xe.buildingProductionMod&&zt(xe.buildingProductionMod);const Tt=et=>{const Ae=q.filter(it=>it.visible!==!1);if(!Ae.length)return[];switch(et){case"random":return[Ae[Math.floor(Math.random()*Ae.length)]];case"all":return Ae;case"hostile":return Ae.filter(Xe=>(Xe.relation||50)<30);case"friendly":return Ae.filter(Xe=>(Xe.relation||50)>=60);case"strongest":return[Ae.reduce((Xe,be)=>(Xe.wealth||0)>(be.wealth||0)?Xe:be)];case"weakest":return[Ae.reduce((Xe,be)=>(Xe.wealth||0)<(be.wealth||0)?Xe:be)];default:const it=Ae.find(Xe=>Xe.id===et);return it?[it]:[]}};if(xe.nationRelation){const et=xe.nationRelation.exclude||[];I(Ae=>{const it=[...Ae];return Object.entries(xe.nationRelation).forEach(([Xe,be])=>{if(Xe==="exclude")return;Tt(Xe).forEach(gt=>{if(et.includes(gt.id))return;const Rt=it.findIndex(ua=>ua.id===gt.id);if(Rt>=0){const ua=it[Rt].relation||50;it[Rt]={...it[Rt],relation:Math.max(0,Math.min(100,ua+be))},s(` ${it[Rt].name} ${be>0?"":""} ${Math.abs(be)} `)}})}),it})}if(xe.nationAggression&&I(et=>{const Ae=[...et];return Object.entries(xe.nationAggression).forEach(([it,Xe])=>{Tt(it).forEach(Qt=>{const gt=Ae.findIndex(Rt=>Rt.id===Qt.id);if(gt>=0){const Rt=Ae[gt].aggression||.5;Ae[gt]={...Ae[gt],aggression:Math.max(0,Math.min(1,Rt+Xe))}}})}),Ae}),xe.nationWealth&&I(et=>{const Ae=[...et];return Object.entries(xe.nationWealth).forEach(([it,Xe])=>{Tt(it).forEach(Qt=>{const gt=Ae.findIndex(Rt=>Rt.id===Qt.id);if(gt>=0){const Rt=Ae[gt].wealth||1e3;Ae[gt]={...Ae[gt],wealth:Math.max(0,Rt+Xe)}}})}),Ae}),xe.nationMarketVolatility&&I(et=>{const Ae=[...et];return Object.entries(xe.nationMarketVolatility).forEach(([it,Xe])=>{Tt(it).forEach(Qt=>{const gt=Ae.findIndex(Rt=>Rt.id===Qt.id);if(gt>=0){const Rt=Ae[gt].marketVolatility||.3;Ae[gt]={...Ae[gt],marketVolatility:Math.max(.1,Math.min(.8,Rt+Xe))}}})}),Ae}),xe.triggerWar){const et=Tt(xe.triggerWar);if(et.length>0){const Ae=et[0];if(Ae.peaceTreatyUntil&&Y<Ae.peaceTreatyUntil){const it=Ae.peaceTreatyUntil-Y;s(`  ${Ae.name}  ${it} `)}else if(Ae.isAtWar)s(`  ${Ae.name} `);else if(I(it=>it.map(Xe=>Xe.id===Ae.id?{...Xe,relation:0,isAtWar:!0,warScore:0,warStartDay:Y,warDuration:0,enemyLosses:0,peaceTreatyUntil:void 0}:Xe)),s(` ${Ae.name} `),Gt){const it=Lp(Ae,()=>{});Gt(it)}}else{const it={random:"",all:"",hostile:"",friendly:"",strongest:"",weakest:""}[xe.triggerWar]||xe.triggerWar;s(` ${it}`)}}if(xe.triggerPeace){const et=Tt(xe.triggerPeace);if(et.length>0){const Ae=et[0];I(it=>it.map(Xe=>Xe.id===Ae.id&&Xe.isAtWar?{...Xe,isAtWar:!1,warScore:0,warDuration:0,enemyLosses:0,peaceTreatyUntil:Y+365}:Xe)),s(`  ${Ae.name} `)}}},ca=pe.effects||{},ha=Array.isArray(pe.randomEffects)?pe.randomEffects:[],Ra=xe=>{if(!xe)return"";const Tt=[];if(xe.resources&&Object.entries(xe.resources).forEach(([et,Ae])=>{const it=jt(et);Tt.push(`${it}${Ae>0?"+":""}${Ae}`)}),xe.resourcePercent&&Object.entries(xe.resourcePercent).forEach(([et,Ae])=>{const it=jt(et),Xe=Math.round(Ae*100);Tt.push(`${it}${Xe>0?"+":""}${Xe}%`)}),xe.population&&Tt.push(`${xe.population>0?"+":""}${xe.population}`),xe.populationPercent){const et=Math.round(xe.populationPercent*100);Tt.push(`${et>0?"+":""}${et}%`)}if(xe.stability&&Tt.push(`${xe.stability>0?"+":""}${xe.stability}`),xe.science&&Tt.push(`${xe.science>0?"+":""}${xe.science}`),xe.approval&&Object.entries(xe.approval).forEach(([et,Ae])=>{const it=ot(et);Tt.push(`${it}${Ae>0?"+":""}${Ae}`)}),xe.nationRelation&&Tt.push(""),xe.nationAggression){const et=Object.values(xe.nationAggression).filter(Ae=>Ae!=="exclude");if(et.length>0){const Ae=et.reduce((Xe,be)=>Xe+be,0)/et.length,it=Math.round(Ae*100);Tt.push(`${it>0?"+":""}${it}%`)}}if(xe.nationWealth){const et=Object.values(xe.nationWealth).filter(Ae=>Ae!=="exclude");if(et.length>0){const Ae=et.reduce((it,Xe)=>it+Math.abs(Xe),0);Tt.push(`${Ae>0?"":""}${Ae}`)}}if(xe.nationMarketVolatility){const et=Object.values(xe.nationMarketVolatility).filter(Ae=>Ae!=="exclude");if(et.length>0){const Ae=et.reduce((Xe,be)=>Xe+be,0)/et.length,it=Math.round(Ae*100);Tt.push(`${it>0?"+":""}${it}%`)}}return xe.resourceDemandMod&&Object.entries(xe.resourceDemandMod).forEach(([et,Ae])=>{const it=jt(et),Xe=Math.round(Ae*100);Tt.push(`${it}${Xe>0?"+":""}${Xe}%`)}),xe.stratumDemandMod&&Object.entries(xe.stratumDemandMod).forEach(([et,Ae])=>{const it=ot(et),Xe=Math.round(Ae*100);Tt.push(`${it}${Xe>0?"+":""}${Xe}%`)}),xe.buildingProductionMod&&Object.entries(xe.buildingProductionMod).forEach(([et,Ae])=>{const it=Ln.find(gt=>gt.id===et),Xe={gather:"",industry:"",civic:"",all:""},be=it?.name||Xe[et]||et,Qt=Math.round(Ae*100);Tt.push(`${be}${Qt>0?"+":""}${Qt}%`)}),xe.triggerWar&&Tt.push(""),xe.triggerPeace&&Tt.push(""),Tt.length>0?`${Tt.join("")}`:""};Ve(ca),ha.forEach(xe=>{const Tt=typeof xe.chance=="number"?xe.chance:0;if(Tt>0&&Math.random()<Tt){Ve(xe.effects||{});const et=Math.round(Tt*100),Ae=Ra(xe.effects);xe.description?s(` ${et}%${xe.description}${Ae}`):s(` ${et}%${Ae}`),xe.effects?.triggerWar&&s(" "),xe.effects?.triggerPeace&&s(" ")}else if(Tt>0){const et=Math.round(Tt*100);xe.description?s(` ${et}%${xe.description}`):s(` ${et}%`)}}),pe.callback&&typeof pe.callback=="function"&&pe.callback(),ne(xe=>[{eventId:se,eventName:he.name,optionId:pe.id,optionText:pe.text,timestamp:Date.now(),day:Y},...xe].slice(0,50)),s(`${pe.text}`),S(null)},ta=(se,pe,he)=>{const K=ve?.[pe];if(!K){console.warn("[REBELLION] No rebellion state for stratum:",pe);return}const je=Ke[pe]?.name||pe,J=Object.values(N||{}).reduce((at,Ze)=>at+(Ze||0),0),le=J*.01,ue=b3(se,pe,K,N,le);(ue.updatedOrganization!==void 0||ue.pauseDays>0)&&me(at=>{const Ze=at?.[pe]||{},Ce=ue.updatedOrganization!==void 0?ue.updatedOrganization:Ze.organization||0,rt=Fr(Ce),zt=wl(rt),Ve=zt!==Ze.phase;return{...at,[pe]:{...Ze,organization:Ce,stage:rt,phase:zt,lastPhaseChange:Ve?Y:Ze.lastPhaseChange||0,organizationPaused:ue.pauseDays?Math.max(ue.pauseDays,Ze.organizationPaused||0):Ze.organizationPaused||0}}});let Me=null;const Ie=(at,Ze)=>{at.startsWith("arrest_")?s(""):at.startsWith("suppress_")&&(at==="suppress_mercy"?$e(Ce=>({...Ce,[Ze]:Math.min(100,(Ce[Ze]||50)+10)})):at==="suppress_strict"&&(P(Ce=>Math.min(100,(Ce||50)+10)),$e(Ce=>({...Ce,[Ze]:Math.max(0,(Ce[Ze]||50)-20)}))))};switch(se){case"investigate":Me=b5(pe,ue.success,ue.success?"":null,Ie);break;case"arrest":if(Me=v5(pe,ue.success,Ie),!ue.success&&ue.playerLosses>0){const at=ue.playerLosses/Math.max(1,J);M(Ze=>{const Ce={...Ze};return Object.keys(Ce).forEach(rt=>{const zt=Math.ceil((Ce[rt]||0)*at);Ce[rt]=Math.max(0,(Ce[rt]||0)-zt)}),Ce})}break;case"suppress":if(Me=j5(pe,ue.success,ue.playerLosses,ue.rebelLosses,Ie),ue.playerLosses>0){const at=ue.playerLosses/Math.max(1,J);M(Ze=>{const Ce={...Ze};return Object.keys(Ce).forEach(rt=>{const zt=Math.ceil((Ce[rt]||0)*at);Ce[rt]=Math.max(0,(Ce[rt]||0)-zt)}),Ce})}ue.success&&he?.id&&I(at=>at.filter(Ze=>Ze.id!==he.id));break;case"appease":case"negotiate":case"bribe":ue.approvalChange&&ue.approvalChange>0&&$e(at=>({...at,[pe]:Math.min(100,(at[pe]||50)+ue.approvalChange)})),s(`${ue.message}`);break;case"accept_war":s(`${je}`);break;default:console.warn("[REBELLION] Unknown action:",se)}Me&&Gt(Me)},Ht=(se,pe)=>{const he=q.find(le=>le.id===se&&le.isRebelNation);if(!he)return;const K=he.rebellionStratum,je=Ke[K]?.name||K,J=Vp(he,pe,(le,ue)=>{le==="end_celebrate"?(P(Me=>Math.min(100,(Me||50)+15)),o(Me=>({...Me,culture:(Me.culture||0)+50}))):le==="end_rebuild"?P(Me=>Math.min(100,(Me||50)+5)):le==="end_defeat"&&P(Me=>Math.max(0,(Me||50)-20))});if(I(le=>le.filter(ue=>ue.id!==se)),me(le=>{const ue=le?.[K]||{},Me=pe?15:40,Ie=Fr(Me);return{...le,[K]:{...ue,organization:Me,stage:Ie,phase:wl(Ie),dissatisfactionDays:0,organizationPaused:0}}}),pe&&he.population>0){const le=Math.floor(he.population*.5);qe(ue=>({...ue,[K]:(ue[K]||0)+le})),s(`${le}${je}`)}setTimeout(()=>{qt(J)},200)};return{canUpgradeEpoch:B,upgradeEpoch:Ue,buyBuilding:ht,sellBuilding:ft,researchTech:$t,toggleDecree:It,manualGather:oe,recruitUnit:Ye,disbandUnit:bt,cancelTraining:Pe,launchBattle:lt,handleDiplomaticAction:Vt,handleEnemyPeaceAccept:oa,handleEnemyPeaceReject:Ka,handlePlayerPeaceProposal:gn,handleTradeRouteAction:Zt,triggerRandomEvent:la,triggerDiplomaticEvent:Gt,handleEventOption:kt,setBattleResult:T,setBattleNotifications:O,addBattleNotification:se=>{const pe={id:`battle_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,result:se,timestamp:Date.now()};O(he=>[...he,pe])},dismissBattleNotification:se=>{O(pe=>pe.filter(he=>he.id!==se))},dismissAllBattleNotifications:()=>{O([])},handleRebellionAction:ta,handleRebellionWarEnd:Ht}};function Mf(){const[t,s]=$.useState(!0),[r,o]=$.useState(.5);$.useEffect(()=>{try{const h=localStorage.getItem("sound_settings");if(h){const x=JSON.parse(h);s(x.enabled!==!1),o(x.volume??.5)}}catch(h){console.warn("Failed to load sound settings:",h)}},[]);const c=$.useCallback((h,x)=>{try{localStorage.setItem("sound_settings",JSON.stringify({enabled:h,volume:x}))}catch(g){console.warn("Failed to save sound settings:",g)}},[]),u=$.useCallback(h=>{if(t)try{const x=vo(h);x&&x()}catch(x){console.warn(`Failed to play sound ${h}:`,x)}},[t]),p=$.useCallback(()=>{const h=!t;s(h),c(h,r)},[t,r,c]),m=$.useCallback(h=>{const x=Math.max(0,Math.min(1,h));o(x),c(t,x)},[t,c]);return{enabled:t,volume:r,playSound:u,toggleSound:p,setVolume:m,SOUND_TYPES:Hr}}const B1={0:{name:"",primaryColor:"#d97706",secondaryColor:"#92400e",accentColor:"#fbbf24",bgGradient:"linear-gradient(135deg, #1a1410 0%, #2c1810 50%, #1a1410 100%)",bgColor:"#1a1410",surfaceColor:"rgba(34, 24, 14, 0.92)",surfaceAltColor:"rgba(61, 36, 21, 0.85)",surfaceMutedColor:"rgba(32, 22, 14, 0.7)",surfaceTranslucent:"rgba(32, 22, 14, 0.55)",textMutedColor:"rgba(254, 243, 199, 0.7)",bgPattern:"stone",textColor:"#fef3c7",borderColor:"rgba(217, 119, 6, 0.4)",glowColor:"rgba(217, 119, 6, 0.5)",metalHighlight:"rgba(251, 191, 36, 0.3)",shadowDepth:"0 4px 12px rgba(0, 0, 0, 0.5), 0 2px 6px rgba(217, 119, 6, 0.3)",atmosphere:"primitive",icon:""},1:{name:"",primaryColor:"#ea580c",secondaryColor:"#9a3412",accentColor:"#fb923c",bgGradient:"linear-gradient(135deg, #1c1410 0%, #2d1c10 50%, #1c1410 100%)",bgColor:"#1c1410",surfaceColor:"rgba(40, 22, 12, 0.92)",surfaceAltColor:"rgba(70, 30, 12, 0.85)",surfaceMutedColor:"rgba(38, 21, 12, 0.68)",surfaceTranslucent:"rgba(38, 21, 12, 0.52)",textMutedColor:"rgba(254, 215, 170, 0.7)",bgPattern:"bronze",textColor:"#fed7aa",borderColor:"rgba(234, 88, 12, 0.4)",glowColor:"rgba(234, 88, 12, 0.5)",metalHighlight:"rgba(251, 146, 60, 0.35)",shadowDepth:"0 4px 12px rgba(0, 0, 0, 0.5), 0 2px 6px rgba(205, 127, 50, 0.4)",atmosphere:"ancient",icon:""},2:{name:"",primaryColor:"#dc2626",secondaryColor:"#991b1b",accentColor:"#f87171",bgGradient:"linear-gradient(135deg, #1a1010 0%, #2c1010 50%, #1a1010 100%)",bgColor:"#1a1010",surfaceColor:"rgba(36, 14, 14, 0.92)",surfaceAltColor:"rgba(58, 18, 18, 0.85)",surfaceMutedColor:"rgba(34, 12, 12, 0.68)",surfaceTranslucent:"rgba(34, 12, 12, 0.52)",textMutedColor:"rgba(254, 202, 202, 0.75)",bgPattern:"marble",textColor:"#fecaca",borderColor:"rgba(220, 38, 38, 0.4)",glowColor:"rgba(220, 38, 38, 0.5)",metalHighlight:"rgba(248, 113, 113, 0.3)",shadowDepth:"0 6px 16px rgba(0, 0, 0, 0.6), 0 3px 8px rgba(220, 38, 38, 0.4)",atmosphere:"classical",icon:""},3:{name:"",primaryColor:"#6b21a8",secondaryColor:"#581c87",accentColor:"#a855f7",bgGradient:"linear-gradient(135deg, #14101a 0%, #1e1028 50%, #14101a 100%)",bgColor:"#14101a",surfaceColor:"rgba(24, 16, 34, 0.92)",surfaceAltColor:"rgba(36, 22, 50, 0.85)",surfaceMutedColor:"rgba(20, 14, 28, 0.68)",surfaceTranslucent:"rgba(20, 14, 28, 0.52)",textMutedColor:"rgba(243, 232, 255, 0.75)",bgPattern:"castle",textColor:"#f3e8ff",borderColor:"rgba(107, 33, 168, 0.4)",glowColor:"rgba(107, 33, 168, 0.5)",metalHighlight:"rgba(168, 85, 247, 0.35)",shadowDepth:"0 6px 16px rgba(0, 0, 0, 0.6), 0 3px 8px rgba(107, 33, 168, 0.4)",atmosphere:"medieval",icon:""},4:{name:"",primaryColor:"#1e3a5f",secondaryColor:"#0c2340",accentColor:"#d4a574",bgGradient:"linear-gradient(135deg, #0c1420 0%, #152238 50%, #0c1420 100%)",bgColor:"#0c1420",surfaceColor:"rgba(16, 28, 44, 0.92)",surfaceAltColor:"rgba(22, 40, 60, 0.85)",surfaceMutedColor:"rgba(14, 24, 38, 0.68)",surfaceTranslucent:"rgba(14, 24, 38, 0.52)",textMutedColor:"rgba(226, 232, 240, 0.75)",bgPattern:"compass",textColor:"#e2e8f0",borderColor:"rgba(30, 58, 95, 0.5)",glowColor:"rgba(212, 165, 116, 0.4)",metalHighlight:"rgba(212, 165, 116, 0.35)",shadowDepth:"0 6px 16px rgba(0, 0, 0, 0.6), 0 3px 8px rgba(30, 58, 95, 0.4)",atmosphere:"exploration",icon:""},5:{name:"",primaryColor:"#b8860b",secondaryColor:"#8b6914",accentColor:"#f0c14b",bgGradient:"linear-gradient(135deg, #1a1612 0%, #2c2418 50%, #1a1612 100%)",bgColor:"#1a1612",surfaceColor:"rgba(32, 26, 18, 0.92)",surfaceAltColor:"rgba(48, 38, 24, 0.85)",surfaceMutedColor:"rgba(28, 22, 16, 0.68)",surfaceTranslucent:"rgba(28, 22, 16, 0.52)",textMutedColor:"rgba(253, 246, 227, 0.78)",bgPattern:"book",textColor:"#fdf6e3",borderColor:"rgba(184, 134, 11, 0.45)",glowColor:"rgba(184, 134, 11, 0.5)",metalHighlight:"rgba(240, 193, 75, 0.35)",shadowDepth:"0 6px 16px rgba(0, 0, 0, 0.6), 0 3px 8px rgba(184, 134, 11, 0.4)",atmosphere:"enlightenment",icon:""},6:{name:"",primaryColor:"#52525b",secondaryColor:"#3f3f46",accentColor:"#a1a1aa",bgGradient:"linear-gradient(135deg, #18181b 0%, #27272a 50%, #18181b 100%)",bgColor:"#18181b",surfaceColor:"rgba(28, 28, 32, 0.92)",surfaceAltColor:"rgba(42, 42, 48, 0.85)",surfaceMutedColor:"rgba(24, 24, 28, 0.68)",surfaceTranslucent:"rgba(24, 24, 28, 0.52)",textMutedColor:"rgba(228, 228, 231, 0.8)",bgPattern:"gear",textColor:"#e4e4e7",borderColor:"rgba(82, 82, 91, 0.5)",glowColor:"rgba(161, 161, 170, 0.4)",metalHighlight:"rgba(161, 161, 170, 0.35)",shadowDepth:"0 8px 20px rgba(0, 0, 0, 0.7), 0 4px 10px rgba(82, 82, 91, 0.4)",atmosphere:"industrial",icon:""},7:{name:"",primaryColor:"#0891b2",secondaryColor:"#0e7490",accentColor:"#22d3ee",bgGradient:"linear-gradient(135deg, #0f1419 0%, #0c1a20 50%, #0f1419 100%)",bgColor:"#0f1419",surfaceColor:"rgba(16, 26, 32, 0.92)",surfaceAltColor:"rgba(20, 36, 44, 0.85)",surfaceMutedColor:"rgba(14, 22, 28, 0.68)",surfaceTranslucent:"rgba(14, 22, 28, 0.52)",textMutedColor:"rgba(207, 250, 254, 0.8)",bgPattern:"circuit",textColor:"#cffafe",borderColor:"rgba(8, 145, 178, 0.4)",glowColor:"rgba(34, 211, 238, 0.4)",metalHighlight:"rgba(34, 211, 238, 0.35)",atmosphere:"modern",icon:""}},rd=t=>B1[t]||B1[0],E3=t=>{const s=rd(t),r=document.documentElement;r.style.setProperty("--theme-primary",s.primaryColor),r.style.setProperty("--theme-secondary",s.secondaryColor),r.style.setProperty("--theme-accent",s.accentColor),r.style.setProperty("--theme-text",s.textColor),r.style.setProperty("--theme-text-muted",s.textMutedColor||"rgba(255, 255, 255, 0.75)"),r.style.setProperty("--theme-border",s.borderColor),r.style.setProperty("--theme-highlight",s.metalHighlight||s.accentColor),r.style.setProperty("--theme-glow",s.glowColor),r.style.setProperty("--theme-bg-gradient",s.bgGradient),r.style.setProperty("--theme-bg",s.bgColor||"#0f0a08"),r.style.setProperty("--theme-surface",s.surfaceColor||"rgba(34, 24, 14, 0.92)"),r.style.setProperty("--theme-surface-alt",s.surfaceAltColor||s.surfaceColor||"rgba(34, 24, 14, 0.85)"),r.style.setProperty("--theme-surface-muted",s.surfaceMutedColor||"rgba(34, 24, 14, 0.65)"),r.style.setProperty("--theme-surface-trans",s.surfaceTranslucent||"rgba(34, 24, 14, 0.5)"),r.style.setProperty("--theme-shadow",s.shadowDepth||"0 4px 12px rgba(0, 0, 0, 0.5)")},L1={stone:`
    <svg width="100" height="100" xmlns="http://www.w3.org/2000/svg">
      <defs>
        <pattern id="stone-pattern" x="0" y="0" width="50" height="50" patternUnits="userSpaceOnUse">
          <circle cx="10" cy="10" r="2" fill="rgba(217, 119, 6, 0.1)" />
          <circle cx="30" cy="25" r="3" fill="rgba(217, 119, 6, 0.08)" />
          <circle cx="45" cy="15" r="2.5" fill="rgba(217, 119, 6, 0.09)" />
          <path d="M0 0 L10 10 M40 40 L50 50" stroke="rgba(217, 119, 6, 0.05)" stroke-width="1" />
        </pattern>
      </defs>
      <rect width="100" height="100" fill="url(#stone-pattern)" />
    </svg>
  `,bronze:`
    <svg width="100" height="100" xmlns="http://www.w3.org/2000/svg">
      <defs>
        <pattern id="bronze-pattern" x="0" y="0" width="60" height="60" patternUnits="userSpaceOnUse">
          <path d="M10 10 L20 10 L20 0 M40 0 L40 10 L50 10" stroke="rgba(234, 88, 12, 0.1)" stroke-width="1.5" fill="none" />
          <circle cx="30" cy="30" r="1.5" fill="rgba(234, 88, 12, 0.12)" />
        </pattern>
      </defs>
      <rect width="100" height="100" fill="url(#bronze-pattern)" />
    </svg>
  `,marble:`
    <svg width="100" height="100" xmlns="http://www.w3.org/2000/svg">
      <defs>
        <pattern id="marble-pattern" x="0" y="0" width="80" height="80" patternUnits="userSpaceOnUse">
          <path d="M0 20 L80 20 M0 40 L80 40 M0 60 L80 60" stroke="rgba(220, 38, 38, 0.05)" stroke-width="1" />
          <path d="M20 0 L20 80 M40 0 L40 80 M60 0 L60 80" stroke="rgba(220, 38, 38, 0.05)" stroke-width="1" />
          <circle cx="40" cy="40" r="15" stroke="rgba(220, 38, 38, 0.08)" stroke-width="1" fill="none" />
        </pattern>
      </defs>
      <rect width="100" height="100" fill="url(#marble-pattern)" />
    </svg>
  `,castle:`
    <svg width="100" height="100" xmlns="http://www.w3.org/2000/svg">
      <defs>
        <pattern id="castle-pattern" x="0" y="0" width="40" height="40" patternUnits="userSpaceOnUse">
          <rect x="0" y="30" width="10" height="10" fill="rgba(107, 33, 168, 0.08)" />
          <rect x="15" y="30" width="10" height="10" fill="rgba(107, 33, 168, 0.08)" />
          <rect x="30" y="30" width="10" height="10" fill="rgba(107, 33, 168, 0.08)" />
          <path d="M5 30 L5 20 M20 30 L20 20 M35 30 L35 20" stroke="rgba(107, 33, 168, 0.1)" stroke-width="1" />
        </pattern>
      </defs>
      <rect width="100" height="100" fill="url(#castle-pattern)" />
    </svg>
  `,compass:`
    <svg width="100" height="100" xmlns="http://www.w3.org/2000/svg">
      <defs>
        <pattern id="compass-pattern" x="0" y="0" width="60" height="60" patternUnits="userSpaceOnUse">
          <circle cx="30" cy="30" r="20" stroke="rgba(30, 58, 95, 0.1)" stroke-width="1" fill="none" />
          <path d="M30 10 L30 50 M10 30 L50 30" stroke="rgba(30, 58, 95, 0.12)" stroke-width="1" />
          <path d="M30 30 L35 20 L30 25 L25 20 Z" fill="rgba(212, 165, 116, 0.15)" />
        </pattern>
      </defs>
      <rect width="100" height="100" fill="url(#compass-pattern)" />
    </svg>
  `,book:`
    <svg width="100" height="100" xmlns="http://www.w3.org/2000/svg">
      <defs>
        <pattern id="book-pattern" x="0" y="0" width="50" height="50" patternUnits="userSpaceOnUse">
          <rect x="10" y="10" width="20" height="30" stroke="rgba(184, 134, 11, 0.12)" stroke-width="1" fill="none" />
          <path d="M15 15 L25 15 M15 20 L25 20 M15 25 L25 25" stroke="rgba(184, 134, 11, 0.1)" stroke-width="0.5" />
        </pattern>
      </defs>
      <rect width="100" height="100" fill="url(#book-pattern)" />
    </svg>
  `,gear:`
    <svg width="100" height="100" xmlns="http://www.w3.org/2000/svg">
      <defs>
        <pattern id="gear-pattern" x="0" y="0" width="60" height="60" patternUnits="userSpaceOnUse">
          <circle cx="30" cy="30" r="12" stroke="rgba(82, 82, 91, 0.15)" stroke-width="2" fill="none" />
          <circle cx="30" cy="30" r="6" fill="rgba(82, 82, 91, 0.1)" />
          <rect x="28" y="18" width="4" height="6" fill="rgba(161, 161, 170, 0.12)" />
          <rect x="28" y="36" width="4" height="6" fill="rgba(161, 161, 170, 0.12)" />
          <rect x="18" y="28" width="6" height="4" fill="rgba(161, 161, 170, 0.12)" />
          <rect x="36" y="28" width="6" height="4" fill="rgba(161, 161, 170, 0.12)" />
        </pattern>
      </defs>
      <rect width="100" height="100" fill="url(#gear-pattern)" />
    </svg>
  `,circuit:`
    <svg width="100" height="100" xmlns="http://www.w3.org/2000/svg">
      <defs>
        <pattern id="circuit-pattern" x="0" y="0" width="50" height="50" patternUnits="userSpaceOnUse">
          <path d="M0 25 L15 25 M35 25 L50 25 M25 0 L25 15 M25 35 L25 50" stroke="rgba(8, 145, 178, 0.12)" stroke-width="1" />
          <circle cx="25" cy="25" r="3" fill="rgba(34, 211, 238, 0.15)" />
          <rect x="13" y="23" width="4" height="4" fill="rgba(8, 145, 178, 0.12)" />
          <rect x="33" y="23" width="4" height="4" fill="rgba(8, 145, 178, 0.12)" />
        </pattern>
      </defs>
      <rect width="100" height="100" fill="url(#circuit-pattern)" />
    </svg>
  `},k3=t=>{const s=L1[t]||L1.stone;return`data:image/svg+xml,${encodeURIComponent(s.trim())}`};window.matchMedia("(prefers-reduced-motion: reduce)").matches;const C3=t=>($.useEffect(()=>{E3(t);const s=rd(t),r=k3(s.bgPattern);document.body.style.backgroundImage=`${s.bgGradient}, url("${r}")`,document.body.style.backgroundColor=s.bgColor||"#0f0a08",document.body.style.color=s.textColor||"",document.body.style.backgroundAttachment="fixed",document.body.style.backgroundSize="cover, 100px 100px";const o=document.querySelector('meta[name="theme-color"]');return o&&o.setAttribute("content",s.primaryColor),()=>{}},[t]),rd(t)),_f=$.createContext({});function Cc(t){const s=$.useRef(null);return s.current===null&&(s.current=t()),s.current}const Ef=typeof window<"u",kf=Ef?$.useLayoutEffect:$.useEffect,md=$.createContext(null);function Cf(t,s){t.indexOf(s)===-1&&t.push(s)}function Tf(t,s){const r=t.indexOf(s);r>-1&&t.splice(r,1)}const gr=(t,s,r)=>r>s?s:r<t?t:r;let Sf=()=>{};const yr={},Wy=t=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(t);function Uy(t){return typeof t=="object"&&t!==null}const Iy=t=>/^0[^.\s]+$/u.test(t);function Af(t){let s;return()=>(s===void 0&&(s=t()),s)}const ki=t=>t,T3=(t,s)=>r=>s(t(r)),Tc=(...t)=>t.reduce(T3),Nc=(t,s,r)=>{const o=s-t;return o===0?1:(r-t)/o};class Pf{constructor(){this.subscriptions=[]}add(s){return Cf(this.subscriptions,s),()=>Tf(this.subscriptions,s)}notify(s,r,o){const c=this.subscriptions.length;if(c)if(c===1)this.subscriptions[0](s,r,o);else for(let u=0;u<c;u++){const p=this.subscriptions[u];p&&p(s,r,o)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const Zi=t=>t*1e3,Ei=t=>t/1e3;function Hy(t,s){return s?t*(1e3/s):0}const qy=(t,s,r)=>(((1-3*r+3*s)*t+(3*r-6*s))*t+3*s)*t,S3=1e-7,A3=12;function P3(t,s,r,o,c){let u,p,m=0;do p=s+(r-s)/2,u=qy(p,o,c)-t,u>0?r=p:s=p;while(Math.abs(u)>S3&&++m<A3);return p}function Sc(t,s,r,o){if(t===s&&r===o)return ki;const c=u=>P3(u,0,1,t,r);return u=>u===0||u===1?u:qy(c(u),s,o)}const Gy=t=>s=>s<=.5?t(2*s)/2:(2-t(2*(1-s)))/2,Fy=t=>s=>1-t(1-s),Yy=Sc(.33,1.53,.69,.99),Df=Fy(Yy),Xy=Gy(Df),Zy=t=>(t*=2)<1?.5*Df(t):.5*(2-Math.pow(2,-10*(t-1))),Rf=t=>1-Math.sin(Math.acos(t)),Qy=Fy(Rf),Jy=Gy(Rf),D3=Sc(.42,0,1,1),R3=Sc(0,0,.58,1),Ky=Sc(.42,0,.58,1),$3=t=>Array.isArray(t)&&typeof t[0]!="number",eb=t=>Array.isArray(t)&&typeof t[0]=="number",O3={linear:ki,easeIn:D3,easeInOut:Ky,easeOut:R3,circIn:Rf,circInOut:Jy,circOut:Qy,backIn:Df,backInOut:Xy,backOut:Yy,anticipate:Zy},z3=t=>typeof t=="string",V1=t=>{if(eb(t)){Sf(t.length===4);const[s,r,o,c]=t;return Sc(s,r,o,c)}else if(z3(t))return O3[t];return t},G0=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"];function B3(t,s){let r=new Set,o=new Set,c=!1,u=!1;const p=new WeakSet;let m={delta:0,timestamp:0,isProcessing:!1};function h(g){p.has(g)&&(x.schedule(g),t()),g(m)}const x={schedule:(g,b=!1,j=!1)=>{const N=j&&c?r:o;return b&&p.add(g),N.has(g)||N.add(g),g},cancel:g=>{o.delete(g),p.delete(g)},process:g=>{if(m=g,c){u=!0;return}c=!0,[r,o]=[o,r],r.forEach(h),r.clear(),c=!1,u&&(u=!1,x.process(g))}};return x}const L3=40;function tb(t,s){let r=!1,o=!0;const c={delta:0,timestamp:0,isProcessing:!1},u=()=>r=!0,p=G0.reduce((D,O)=>(D[O]=B3(u),D),{}),{setup:m,read:h,resolveKeyframes:x,preUpdate:g,update:b,preRender:j,render:_,postRender:N}=p,M=()=>{const D=yr.useManualTiming?c.timestamp:performance.now();r=!1,yr.useManualTiming||(c.delta=o?1e3/60:Math.max(Math.min(D-c.timestamp,L3),1)),c.timestamp=D,c.isProcessing=!0,m.process(c),h.process(c),x.process(c),g.process(c),b.process(c),j.process(c),_.process(c),N.process(c),c.isProcessing=!1,r&&s&&(o=!1,t(M))},R=()=>{r=!0,o=!0,c.isProcessing||t(M)};return{schedule:G0.reduce((D,O)=>{const q=p[O];return D[O]=(I,Z=!1,Y=!1)=>(r||R(),q.schedule(I,Z,Y)),D},{}),cancel:D=>{for(let O=0;O<G0.length;O++)p[G0[O]].cancel(D)},state:c,steps:p}}const{schedule:pn,cancel:br,state:Ss,steps:hp}=tb(typeof requestAnimationFrame<"u"?requestAnimationFrame:ki,!0);let J0;function V3(){J0=void 0}const ri={now:()=>(J0===void 0&&ri.set(Ss.isProcessing||yr.useManualTiming?Ss.timestamp:performance.now()),J0),set:t=>{J0=t,queueMicrotask(V3)}},ab=t=>s=>typeof s=="string"&&s.startsWith(t),nb=ab("--"),W3=ab("var(--"),$f=t=>W3(t)?U3.test(t.split("/*")[0].trim()):!1,U3=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,El={test:t=>typeof t=="number",parse:parseFloat,transform:t=>t},Mc={...El,transform:t=>gr(0,1,t)},F0={...El,default:1},yc=t=>Math.round(t*1e5)/1e5,Of=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function I3(t){return t==null}const H3=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,zf=(t,s)=>r=>!!(typeof r=="string"&&H3.test(r)&&r.startsWith(t)||s&&!I3(r)&&Object.prototype.hasOwnProperty.call(r,s)),sb=(t,s,r)=>o=>{if(typeof o!="string")return o;const[c,u,p,m]=o.match(Of);return{[t]:parseFloat(c),[s]:parseFloat(u),[r]:parseFloat(p),alpha:m!==void 0?parseFloat(m):1}},q3=t=>gr(0,255,t),xp={...El,transform:t=>Math.round(q3(t))},_o={test:zf("rgb","red"),parse:sb("red","green","blue"),transform:({red:t,green:s,blue:r,alpha:o=1})=>"rgba("+xp.transform(t)+", "+xp.transform(s)+", "+xp.transform(r)+", "+yc(Mc.transform(o))+")"};function G3(t){let s="",r="",o="",c="";return t.length>5?(s=t.substring(1,3),r=t.substring(3,5),o=t.substring(5,7),c=t.substring(7,9)):(s=t.substring(1,2),r=t.substring(2,3),o=t.substring(3,4),c=t.substring(4,5),s+=s,r+=r,o+=o,c+=c),{red:parseInt(s,16),green:parseInt(r,16),blue:parseInt(o,16),alpha:c?parseInt(c,16)/255:1}}const Hp={test:zf("#"),parse:G3,transform:_o.transform},Ac=t=>({test:s=>typeof s=="string"&&s.endsWith(t)&&s.split(" ").length===1,parse:parseFloat,transform:s=>`${s}${t}`}),qr=Ac("deg"),Qi=Ac("%"),Xt=Ac("px"),F3=Ac("vh"),Y3=Ac("vw"),W1={...Qi,parse:t=>Qi.parse(t)/100,transform:t=>Qi.transform(t*100)},pl={test:zf("hsl","hue"),parse:sb("hue","saturation","lightness"),transform:({hue:t,saturation:s,lightness:r,alpha:o=1})=>"hsla("+Math.round(t)+", "+Qi.transform(yc(s))+", "+Qi.transform(yc(r))+", "+yc(Mc.transform(o))+")"},as={test:t=>_o.test(t)||Hp.test(t)||pl.test(t),parse:t=>_o.test(t)?_o.parse(t):pl.test(t)?pl.parse(t):Hp.parse(t),transform:t=>typeof t=="string"?t:t.hasOwnProperty("red")?_o.transform(t):pl.transform(t),getAnimatableNone:t=>{const s=as.parse(t);return s.alpha=0,as.transform(s)}},X3=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function Z3(t){return isNaN(t)&&typeof t=="string"&&(t.match(Of)?.length||0)+(t.match(X3)?.length||0)>0}const ib="number",rb="color",Q3="var",J3="var(",U1="${}",K3=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function _c(t){const s=t.toString(),r=[],o={color:[],number:[],var:[]},c=[];let u=0;const m=s.replace(K3,h=>(as.test(h)?(o.color.push(u),c.push(rb),r.push(as.parse(h))):h.startsWith(J3)?(o.var.push(u),c.push(Q3),r.push(h)):(o.number.push(u),c.push(ib),r.push(parseFloat(h))),++u,U1)).split(U1);return{values:r,split:m,indexes:o,types:c}}function ob(t){return _c(t).values}function lb(t){const{split:s,types:r}=_c(t),o=s.length;return c=>{let u="";for(let p=0;p<o;p++)if(u+=s[p],c[p]!==void 0){const m=r[p];m===ib?u+=yc(c[p]):m===rb?u+=as.transform(c[p]):u+=c[p]}return u}}const ej=t=>typeof t=="number"?0:as.test(t)?as.getAnimatableNone(t):t;function tj(t){const s=ob(t);return lb(t)(s.map(ej))}const Yr={test:Z3,parse:ob,createTransformer:lb,getAnimatableNone:tj};function gp(t,s,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?t+(s-t)*6*r:r<1/2?s:r<2/3?t+(s-t)*(2/3-r)*6:t}function aj({hue:t,saturation:s,lightness:r,alpha:o}){t/=360,s/=100,r/=100;let c=0,u=0,p=0;if(!s)c=u=p=r;else{const m=r<.5?r*(1+s):r+s-r*s,h=2*r-m;c=gp(h,m,t+1/3),u=gp(h,m,t),p=gp(h,m,t-1/3)}return{red:Math.round(c*255),green:Math.round(u*255),blue:Math.round(p*255),alpha:o}}function od(t,s){return r=>r>0?s:t}const _n=(t,s,r)=>t+(s-t)*r,yp=(t,s,r)=>{const o=t*t,c=r*(s*s-o)+o;return c<0?0:Math.sqrt(c)},nj=[Hp,_o,pl],sj=t=>nj.find(s=>s.test(t));function I1(t){const s=sj(t);if(!s)return!1;let r=s.parse(t);return s===pl&&(r=aj(r)),r}const H1=(t,s)=>{const r=I1(t),o=I1(s);if(!r||!o)return od(t,s);const c={...r};return u=>(c.red=yp(r.red,o.red,u),c.green=yp(r.green,o.green,u),c.blue=yp(r.blue,o.blue,u),c.alpha=_n(r.alpha,o.alpha,u),_o.transform(c))},qp=new Set(["none","hidden"]);function ij(t,s){return qp.has(t)?r=>r<=0?t:s:r=>r>=1?s:t}function rj(t,s){return r=>_n(t,s,r)}function Bf(t){return typeof t=="number"?rj:typeof t=="string"?$f(t)?od:as.test(t)?H1:cj:Array.isArray(t)?cb:typeof t=="object"?as.test(t)?H1:oj:od}function cb(t,s){const r=[...t],o=r.length,c=t.map((u,p)=>Bf(u)(u,s[p]));return u=>{for(let p=0;p<o;p++)r[p]=c[p](u);return r}}function oj(t,s){const r={...t,...s},o={};for(const c in r)t[c]!==void 0&&s[c]!==void 0&&(o[c]=Bf(t[c])(t[c],s[c]));return c=>{for(const u in o)r[u]=o[u](c);return r}}function lj(t,s){const r=[],o={color:0,var:0,number:0};for(let c=0;c<s.values.length;c++){const u=s.types[c],p=t.indexes[u][o[u]],m=t.values[p]??0;r[c]=m,o[u]++}return r}const cj=(t,s)=>{const r=Yr.createTransformer(s),o=_c(t),c=_c(s);return o.indexes.var.length===c.indexes.var.length&&o.indexes.color.length===c.indexes.color.length&&o.indexes.number.length>=c.indexes.number.length?qp.has(t)&&!c.values.length||qp.has(s)&&!o.values.length?ij(t,s):Tc(cb(lj(o,c),c.values),r):od(t,s)};function db(t,s,r){return typeof t=="number"&&typeof s=="number"&&typeof r=="number"?_n(t,s,r):Bf(t)(t,s)}const dj=t=>{const s=({timestamp:r})=>t(r);return{start:(r=!0)=>pn.update(s,r),stop:()=>br(s),now:()=>Ss.isProcessing?Ss.timestamp:ri.now()}},ub=(t,s,r=10)=>{let o="";const c=Math.max(Math.round(s/r),2);for(let u=0;u<c;u++)o+=Math.round(t(u/(c-1))*1e4)/1e4+", ";return`linear(${o.substring(0,o.length-2)})`},ld=2e4;function Lf(t){let s=0;const r=50;let o=t.next(s);for(;!o.done&&s<ld;)s+=r,o=t.next(s);return s>=ld?1/0:s}function uj(t,s=100,r){const o=r({...t,keyframes:[0,s]}),c=Math.min(Lf(o),ld);return{type:"keyframes",ease:u=>o.next(c*u).value/s,duration:Ei(c)}}const pj=5;function pb(t,s,r){const o=Math.max(s-pj,0);return Hy(r-t(o),s-o)}const Sn={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},bp=.001;function fj({duration:t=Sn.duration,bounce:s=Sn.bounce,velocity:r=Sn.velocity,mass:o=Sn.mass}){let c,u,p=1-s;p=gr(Sn.minDamping,Sn.maxDamping,p),t=gr(Sn.minDuration,Sn.maxDuration,Ei(t)),p<1?(c=x=>{const g=x*p,b=g*t,j=g-r,_=Gp(x,p),N=Math.exp(-b);return bp-j/_*N},u=x=>{const b=x*p*t,j=b*r+r,_=Math.pow(p,2)*Math.pow(x,2)*t,N=Math.exp(-b),M=Gp(Math.pow(x,2),p);return(-c(x)+bp>0?-1:1)*((j-_)*N)/M}):(c=x=>{const g=Math.exp(-x*t),b=(x-r)*t+1;return-bp+g*b},u=x=>{const g=Math.exp(-x*t),b=(r-x)*(t*t);return g*b});const m=5/t,h=hj(c,u,m);if(t=Zi(t),isNaN(h))return{stiffness:Sn.stiffness,damping:Sn.damping,duration:t};{const x=Math.pow(h,2)*o;return{stiffness:x,damping:p*2*Math.sqrt(o*x),duration:t}}}const mj=12;function hj(t,s,r){let o=r;for(let c=1;c<mj;c++)o=o-t(o)/s(o);return o}function Gp(t,s){return t*Math.sqrt(1-s*s)}const xj=["duration","bounce"],gj=["stiffness","damping","mass"];function q1(t,s){return s.some(r=>t[r]!==void 0)}function yj(t){let s={velocity:Sn.velocity,stiffness:Sn.stiffness,damping:Sn.damping,mass:Sn.mass,isResolvedFromDuration:!1,...t};if(!q1(t,gj)&&q1(t,xj))if(t.visualDuration){const r=t.visualDuration,o=2*Math.PI/(r*1.2),c=o*o,u=2*gr(.05,1,1-(t.bounce||0))*Math.sqrt(c);s={...s,mass:Sn.mass,stiffness:c,damping:u}}else{const r=fj(t);s={...s,...r,mass:Sn.mass},s.isResolvedFromDuration=!0}return s}function cd(t=Sn.visualDuration,s=Sn.bounce){const r=typeof t!="object"?{visualDuration:t,keyframes:[0,1],bounce:s}:t;let{restSpeed:o,restDelta:c}=r;const u=r.keyframes[0],p=r.keyframes[r.keyframes.length-1],m={done:!1,value:u},{stiffness:h,damping:x,mass:g,duration:b,velocity:j,isResolvedFromDuration:_}=yj({...r,velocity:-Ei(r.velocity||0)}),N=j||0,M=x/(2*Math.sqrt(h*g)),R=p-u,E=Ei(Math.sqrt(h/g)),T=Math.abs(R)<5;o||(o=T?Sn.restSpeed.granular:Sn.restSpeed.default),c||(c=T?Sn.restDelta.granular:Sn.restDelta.default);let D;if(M<1){const q=Gp(E,M);D=I=>{const Z=Math.exp(-M*E*I);return p-Z*((N+M*E*R)/q*Math.sin(q*I)+R*Math.cos(q*I))}}else if(M===1)D=q=>p-Math.exp(-E*q)*(R+(N+E*R)*q);else{const q=E*Math.sqrt(M*M-1);D=I=>{const Z=Math.exp(-M*E*I),Y=Math.min(q*I,300);return p-Z*((N+M*E*R)*Math.sinh(Y)+q*R*Math.cosh(Y))/q}}const O={calculatedDuration:_&&b||null,next:q=>{const I=D(q);if(_)m.done=q>=b;else{let Z=q===0?N:0;M<1&&(Z=q===0?Zi(N):pb(D,q,I));const Y=Math.abs(Z)<=o,U=Math.abs(p-I)<=c;m.done=Y&&U}return m.value=m.done?p:I,m},toString:()=>{const q=Math.min(Lf(O),ld),I=ub(Z=>O.next(q*Z).value,q,30);return q+"ms "+I},toTransition:()=>{}};return O}cd.applyToOptions=t=>{const s=uj(t,100,cd);return t.ease=s.ease,t.duration=Zi(s.duration),t.type="keyframes",t};function Fp({keyframes:t,velocity:s=0,power:r=.8,timeConstant:o=325,bounceDamping:c=10,bounceStiffness:u=500,modifyTarget:p,min:m,max:h,restDelta:x=.5,restSpeed:g}){const b=t[0],j={done:!1,value:b},_=Y=>m!==void 0&&Y<m||h!==void 0&&Y>h,N=Y=>m===void 0?h:h===void 0||Math.abs(m-Y)<Math.abs(h-Y)?m:h;let M=r*s;const R=b+M,E=p===void 0?R:p(R);E!==R&&(M=E-b);const T=Y=>-M*Math.exp(-Y/o),D=Y=>E+T(Y),O=Y=>{const U=T(Y),S=D(Y);j.done=Math.abs(U)<=x,j.value=j.done?E:S};let q,I;const Z=Y=>{_(j.value)&&(q=Y,I=cd({keyframes:[j.value,N(j.value)],velocity:pb(D,Y,j.value),damping:c,stiffness:u,restDelta:x,restSpeed:g}))};return Z(0),{calculatedDuration:null,next:Y=>{let U=!1;return!I&&q===void 0&&(U=!0,O(Y),Z(Y)),q!==void 0&&Y>=q?I.next(Y-q):(!U&&O(Y),j)}}}function bj(t,s,r){const o=[],c=r||yr.mix||db,u=t.length-1;for(let p=0;p<u;p++){let m=c(t[p],t[p+1]);if(s){const h=Array.isArray(s)?s[p]||ki:s;m=Tc(h,m)}o.push(m)}return o}function fb(t,s,{clamp:r=!0,ease:o,mixer:c}={}){const u=t.length;if(Sf(u===s.length),u===1)return()=>s[0];if(u===2&&s[0]===s[1])return()=>s[1];const p=t[0]===t[1];t[0]>t[u-1]&&(t=[...t].reverse(),s=[...s].reverse());const m=bj(s,o,c),h=m.length,x=g=>{if(p&&g<t[0])return s[0];let b=0;if(h>1)for(;b<t.length-2&&!(g<t[b+1]);b++);const j=Nc(t[b],t[b+1],g);return m[b](j)};return r?g=>x(gr(t[0],t[u-1],g)):x}function vj(t,s){const r=t[t.length-1];for(let o=1;o<=s;o++){const c=Nc(0,s,o);t.push(_n(r,1,c))}}function jj(t){const s=[0];return vj(s,t.length-1),s}function wj(t,s){return t.map(r=>r*s)}function Nj(t,s){return t.map(()=>s||Ky).splice(0,t.length-1)}function bc({duration:t=300,keyframes:s,times:r,ease:o="easeInOut"}){const c=$3(o)?o.map(V1):V1(o),u={done:!1,value:s[0]},p=wj(r&&r.length===s.length?r:jj(s),t),m=fb(p,s,{ease:Array.isArray(c)?c:Nj(s,c)});return{calculatedDuration:t,next:h=>(u.value=m(h),u.done=h>=t,u)}}const Mj=t=>t!==null;function Vf(t,{repeat:s,repeatType:r="loop"},o,c=1){const u=t.filter(Mj),m=c<0||s&&r!=="loop"&&s%2===1?0:u.length-1;return!m||o===void 0?u[m]:o}const _j={decay:Fp,inertia:Fp,tween:bc,keyframes:bc,spring:cd};function mb(t){typeof t.type=="string"&&(t.type=_j[t.type])}class Wf{constructor(){this.updateFinished()}get finished(){return this._finished}updateFinished(){this._finished=new Promise(s=>{this.resolve=s})}notifyFinished(){this.resolve()}then(s,r){return this.finished.then(s,r)}}const Ej=t=>t/100;class hd extends Wf{constructor(s){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{const{motionValue:r}=this.options;r&&r.updatedAt!==ri.now()&&this.tick(ri.now()),this.isStopped=!0,this.state!=="idle"&&(this.teardown(),this.options.onStop?.())},this.options=s,this.initAnimation(),this.play(),s.autoplay===!1&&this.pause()}initAnimation(){const{options:s}=this;mb(s);const{type:r=bc,repeat:o=0,repeatDelay:c=0,repeatType:u,velocity:p=0}=s;let{keyframes:m}=s;const h=r||bc;h!==bc&&typeof m[0]!="number"&&(this.mixKeyframes=Tc(Ej,db(m[0],m[1])),m=[0,100]);const x=h({...s,keyframes:m});u==="mirror"&&(this.mirroredGenerator=h({...s,keyframes:[...m].reverse(),velocity:-p})),x.calculatedDuration===null&&(x.calculatedDuration=Lf(x));const{calculatedDuration:g}=x;this.calculatedDuration=g,this.resolvedDuration=g+c,this.totalDuration=this.resolvedDuration*(o+1)-c,this.generator=x}updateTime(s){const r=Math.round(s-this.startTime)*this.playbackSpeed;this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=r}tick(s,r=!1){const{generator:o,totalDuration:c,mixKeyframes:u,mirroredGenerator:p,resolvedDuration:m,calculatedDuration:h}=this;if(this.startTime===null)return o.next(0);const{delay:x=0,keyframes:g,repeat:b,repeatType:j,repeatDelay:_,type:N,onUpdate:M,finalKeyframe:R}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,s):this.speed<0&&(this.startTime=Math.min(s-c/this.speed,this.startTime)),r?this.currentTime=s:this.updateTime(s);const E=this.currentTime-x*(this.playbackSpeed>=0?1:-1),T=this.playbackSpeed>=0?E<0:E>c;this.currentTime=Math.max(E,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=c);let D=this.currentTime,O=o;if(b){const Y=Math.min(this.currentTime,c)/m;let U=Math.floor(Y),S=Y%1;!S&&Y>=1&&(S=1),S===1&&U--,U=Math.min(U,b+1),!!(U%2)&&(j==="reverse"?(S=1-S,_&&(S-=_/m)):j==="mirror"&&(O=p)),D=gr(0,1,S)*m}const q=T?{done:!1,value:g[0]}:O.next(D);u&&(q.value=u(q.value));let{done:I}=q;!T&&h!==null&&(I=this.playbackSpeed>=0?this.currentTime>=c:this.currentTime<=0);const Z=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&I);return Z&&N!==Fp&&(q.value=Vf(g,this.options,R,this.speed)),M&&M(q.value),Z&&this.finish(),q}then(s,r){return this.finished.then(s,r)}get duration(){return Ei(this.calculatedDuration)}get iterationDuration(){const{delay:s=0}=this.options||{};return this.duration+Ei(s)}get time(){return Ei(this.currentTime)}set time(s){s=Zi(s),this.currentTime=s,this.startTime===null||this.holdTime!==null||this.playbackSpeed===0?this.holdTime=s:this.driver&&(this.startTime=this.driver.now()-s/this.playbackSpeed),this.driver?.start(!1)}get speed(){return this.playbackSpeed}set speed(s){this.updateTime(ri.now());const r=this.playbackSpeed!==s;this.playbackSpeed=s,r&&(this.time=Ei(this.currentTime))}play(){if(this.isStopped)return;const{driver:s=dj,startTime:r}=this.options;this.driver||(this.driver=s(c=>this.tick(c))),this.options.onPlay?.();const o=this.driver.now();this.state==="finished"?(this.updateFinished(),this.startTime=o):this.holdTime!==null?this.startTime=o-this.holdTime:this.startTime||(this.startTime=r??o),this.state==="finished"&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(ri.now()),this.holdTime=this.currentTime}complete(){this.state!=="running"&&this.play(),this.state="finished",this.holdTime=null}finish(){this.notifyFinished(),this.teardown(),this.state="finished",this.options.onComplete?.()}cancel(){this.holdTime=null,this.startTime=0,this.tick(0),this.teardown(),this.options.onCancel?.()}teardown(){this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(s){return this.startTime=0,this.tick(s,!0)}attachTimeline(s){return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),this.driver?.stop(),s.observe(this)}}function kj(t){for(let s=1;s<t.length;s++)t[s]??(t[s]=t[s-1])}const Eo=t=>t*180/Math.PI,Yp=t=>{const s=Eo(Math.atan2(t[1],t[0]));return Xp(s)},Cj={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:t=>(Math.abs(t[0])+Math.abs(t[3]))/2,rotate:Yp,rotateZ:Yp,skewX:t=>Eo(Math.atan(t[1])),skewY:t=>Eo(Math.atan(t[2])),skew:t=>(Math.abs(t[1])+Math.abs(t[2]))/2},Xp=t=>(t=t%360,t<0&&(t+=360),t),G1=Yp,F1=t=>Math.sqrt(t[0]*t[0]+t[1]*t[1]),Y1=t=>Math.sqrt(t[4]*t[4]+t[5]*t[5]),Tj={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:F1,scaleY:Y1,scale:t=>(F1(t)+Y1(t))/2,rotateX:t=>Xp(Eo(Math.atan2(t[6],t[5]))),rotateY:t=>Xp(Eo(Math.atan2(-t[2],t[0]))),rotateZ:G1,rotate:G1,skewX:t=>Eo(Math.atan(t[4])),skewY:t=>Eo(Math.atan(t[1])),skew:t=>(Math.abs(t[1])+Math.abs(t[4]))/2};function Zp(t){return t.includes("scale")?1:0}function Qp(t,s){if(!t||t==="none")return Zp(s);const r=t.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let o,c;if(r)o=Tj,c=r;else{const m=t.match(/^matrix\(([-\d.e\s,]+)\)$/u);o=Cj,c=m}if(!c)return Zp(s);const u=o[s],p=c[1].split(",").map(Aj);return typeof u=="function"?u(p):p[u]}const Sj=(t,s)=>{const{transform:r="none"}=getComputedStyle(t);return Qp(r,s)};function Aj(t){return parseFloat(t.trim())}const kl=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],Cl=new Set(kl),X1=t=>t===El||t===Xt,Pj=new Set(["x","y","z"]),Dj=kl.filter(t=>!Pj.has(t));function Rj(t){const s=[];return Dj.forEach(r=>{const o=t.getValue(r);o!==void 0&&(s.push([r,o.get()]),o.set(r.startsWith("scale")?1:0))}),s}const Co={width:({x:t},{paddingLeft:s="0",paddingRight:r="0"})=>t.max-t.min-parseFloat(s)-parseFloat(r),height:({y:t},{paddingTop:s="0",paddingBottom:r="0"})=>t.max-t.min-parseFloat(s)-parseFloat(r),top:(t,{top:s})=>parseFloat(s),left:(t,{left:s})=>parseFloat(s),bottom:({y:t},{top:s})=>parseFloat(s)+(t.max-t.min),right:({x:t},{left:s})=>parseFloat(s)+(t.max-t.min),x:(t,{transform:s})=>Qp(s,"x"),y:(t,{transform:s})=>Qp(s,"y")};Co.translateX=Co.x;Co.translateY=Co.y;const To=new Set;let Jp=!1,Kp=!1,ef=!1;function hb(){if(Kp){const t=Array.from(To).filter(o=>o.needsMeasurement),s=new Set(t.map(o=>o.element)),r=new Map;s.forEach(o=>{const c=Rj(o);c.length&&(r.set(o,c),o.render())}),t.forEach(o=>o.measureInitialState()),s.forEach(o=>{o.render();const c=r.get(o);c&&c.forEach(([u,p])=>{o.getValue(u)?.set(p)})}),t.forEach(o=>o.measureEndState()),t.forEach(o=>{o.suspendedScrollY!==void 0&&window.scrollTo(0,o.suspendedScrollY)})}Kp=!1,Jp=!1,To.forEach(t=>t.complete(ef)),To.clear()}function xb(){To.forEach(t=>{t.readKeyframes(),t.needsMeasurement&&(Kp=!0)})}function $j(){ef=!0,xb(),hb(),ef=!1}class Uf{constructor(s,r,o,c,u,p=!1){this.state="pending",this.isAsync=!1,this.needsMeasurement=!1,this.unresolvedKeyframes=[...s],this.onComplete=r,this.name=o,this.motionValue=c,this.element=u,this.isAsync=p}scheduleResolve(){this.state="scheduled",this.isAsync?(To.add(this),Jp||(Jp=!0,pn.read(xb),pn.resolveKeyframes(hb))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:s,name:r,element:o,motionValue:c}=this;if(s[0]===null){const u=c?.get(),p=s[s.length-1];if(u!==void 0)s[0]=u;else if(o&&r){const m=o.readValue(r,p);m!=null&&(s[0]=m)}s[0]===void 0&&(s[0]=p),c&&u===void 0&&c.set(s[0])}kj(s)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(s=!1){this.state="complete",this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,s),To.delete(this)}cancel(){this.state==="scheduled"&&(To.delete(this),this.state="pending")}resume(){this.state==="pending"&&this.scheduleResolve()}}const Oj=t=>t.startsWith("--");function zj(t,s,r){Oj(s)?t.style.setProperty(s,r):t.style[s]=r}const Bj=Af(()=>window.ScrollTimeline!==void 0),Lj={};function Vj(t,s){const r=Af(t);return()=>Lj[s]??r()}const gb=Vj(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),gc=([t,s,r,o])=>`cubic-bezier(${t}, ${s}, ${r}, ${o})`,Z1={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:gc([0,.65,.55,1]),circOut:gc([.55,0,1,.45]),backIn:gc([.31,.01,.66,-.59]),backOut:gc([.33,1.53,.69,.99])};function yb(t,s){if(t)return typeof t=="function"?gb()?ub(t,s):"ease-out":eb(t)?gc(t):Array.isArray(t)?t.map(r=>yb(r,s)||Z1.easeOut):Z1[t]}function Wj(t,s,r,{delay:o=0,duration:c=300,repeat:u=0,repeatType:p="loop",ease:m="easeOut",times:h}={},x=void 0){const g={[s]:r};h&&(g.offset=h);const b=yb(m,c);Array.isArray(b)&&(g.easing=b);const j={delay:o,duration:c,easing:Array.isArray(b)?"linear":b,fill:"both",iterations:u+1,direction:p==="reverse"?"alternate":"normal"};return x&&(j.pseudoElement=x),t.animate(g,j)}function bb(t){return typeof t=="function"&&"applyToOptions"in t}function Uj({type:t,...s}){return bb(t)&&gb()?t.applyToOptions(s):(s.duration??(s.duration=300),s.ease??(s.ease="easeOut"),s)}class Ij extends Wf{constructor(s){if(super(),this.finishedTime=null,this.isStopped=!1,!s)return;const{element:r,name:o,keyframes:c,pseudoElement:u,allowFlatten:p=!1,finalKeyframe:m,onComplete:h}=s;this.isPseudoElement=!!u,this.allowFlatten=p,this.options=s,Sf(typeof s.type!="string");const x=Uj(s);this.animation=Wj(r,o,c,x,u),x.autoplay===!1&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!u){const g=Vf(c,this.options,m,this.speed);this.updateMotionValue?this.updateMotionValue(g):zj(r,o,g),this.animation.cancel()}h?.(),this.notifyFinished()}}play(){this.isStopped||(this.animation.play(),this.state==="finished"&&this.updateFinished())}pause(){this.animation.pause()}complete(){this.animation.finish?.()}cancel(){try{this.animation.cancel()}catch{}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:s}=this;s==="idle"||s==="finished"||(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){this.isPseudoElement||this.animation.commitStyles?.()}get duration(){const s=this.animation.effect?.getComputedTiming?.().duration||0;return Ei(Number(s))}get iterationDuration(){const{delay:s=0}=this.options||{};return this.duration+Ei(s)}get time(){return Ei(Number(this.animation.currentTime)||0)}set time(s){this.finishedTime=null,this.animation.currentTime=Zi(s)}get speed(){return this.animation.playbackRate}set speed(s){s<0&&(this.finishedTime=null),this.animation.playbackRate=s}get state(){return this.finishedTime!==null?"finished":this.animation.playState}get startTime(){return Number(this.animation.startTime)}set startTime(s){this.animation.startTime=s}attachTimeline({timeline:s,observe:r}){return this.allowFlatten&&this.animation.effect?.updateTiming({easing:"linear"}),this.animation.onfinish=null,s&&Bj()?(this.animation.timeline=s,ki):r(this)}}const vb={anticipate:Zy,backInOut:Xy,circInOut:Jy};function Hj(t){return t in vb}function qj(t){typeof t.ease=="string"&&Hj(t.ease)&&(t.ease=vb[t.ease])}const Q1=10;class Gj extends Ij{constructor(s){qj(s),mb(s),super(s),s.startTime&&(this.startTime=s.startTime),this.options=s}updateMotionValue(s){const{motionValue:r,onUpdate:o,onComplete:c,element:u,...p}=this.options;if(!r)return;if(s!==void 0){r.set(s);return}const m=new hd({...p,autoplay:!1}),h=Zi(this.finishedTime??this.time);r.setWithVelocity(m.sample(h-Q1).value,m.sample(h).value,Q1),m.stop()}}const J1=(t,s)=>s==="zIndex"?!1:!!(typeof t=="number"||Array.isArray(t)||typeof t=="string"&&(Yr.test(t)||t==="0")&&!t.startsWith("url("));function Fj(t){const s=t[0];if(t.length===1)return!0;for(let r=0;r<t.length;r++)if(t[r]!==s)return!0}function Yj(t,s,r,o){const c=t[0];if(c===null)return!1;if(s==="display"||s==="visibility")return!0;const u=t[t.length-1],p=J1(c,s),m=J1(u,s);return!p||!m?!1:Fj(t)||(r==="spring"||bb(r))&&o}function tf(t){t.duration=0,t.type="keyframes"}const Xj=new Set(["opacity","clipPath","filter","transform"]),Zj=Af(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));function Qj(t){const{motionValue:s,name:r,repeatDelay:o,repeatType:c,damping:u,type:p}=t;if(!(s?.owner?.current instanceof HTMLElement))return!1;const{onUpdate:h,transformTemplate:x}=s.owner.getProps();return Zj()&&r&&Xj.has(r)&&(r!=="transform"||!x)&&!h&&!o&&c!=="mirror"&&u!==0&&p!=="inertia"}const Jj=40;class Kj extends Wf{constructor({autoplay:s=!0,delay:r=0,type:o="keyframes",repeat:c=0,repeatDelay:u=0,repeatType:p="loop",keyframes:m,name:h,motionValue:x,element:g,...b}){super(),this.stop=()=>{this._animation&&(this._animation.stop(),this.stopTimeline?.()),this.keyframeResolver?.cancel()},this.createdAt=ri.now();const j={autoplay:s,delay:r,type:o,repeat:c,repeatDelay:u,repeatType:p,name:h,motionValue:x,element:g,...b},_=g?.KeyframeResolver||Uf;this.keyframeResolver=new _(m,(N,M,R)=>this.onKeyframesResolved(N,M,j,!R),h,x,g),this.keyframeResolver?.scheduleResolve()}onKeyframesResolved(s,r,o,c){this.keyframeResolver=void 0;const{name:u,type:p,velocity:m,delay:h,isHandoff:x,onUpdate:g}=o;this.resolvedAt=ri.now(),Yj(s,u,p,m)||((yr.instantAnimations||!h)&&g?.(Vf(s,o,r)),s[0]=s[s.length-1],tf(o),o.repeat=0);const j={startTime:c?this.resolvedAt?this.resolvedAt-this.createdAt>Jj?this.resolvedAt:this.createdAt:this.createdAt:void 0,finalKeyframe:r,...o,keyframes:s},_=!x&&Qj(j)?new Gj({...j,element:j.motionValue.owner.current}):new hd(j);_.finished.then(()=>this.notifyFinished()).catch(ki),this.pendingTimeline&&(this.stopTimeline=_.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=_}get finished(){return this._animation?this.animation.finished:this._finished}then(s,r){return this.finished.finally(s).then(()=>{})}get animation(){return this._animation||(this.keyframeResolver?.resume(),$j()),this._animation}get duration(){return this.animation.duration}get iterationDuration(){return this.animation.iterationDuration}get time(){return this.animation.time}set time(s){this.animation.time=s}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(s){this.animation.speed=s}get startTime(){return this.animation.startTime}attachTimeline(s){return this._animation?this.stopTimeline=this.animation.attachTimeline(s):this.pendingTimeline=s,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){this._animation&&this.animation.cancel(),this.keyframeResolver?.cancel()}}const ew=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function tw(t){const s=ew.exec(t);if(!s)return[,];const[,r,o,c]=s;return[`--${r??o}`,c]}function jb(t,s,r=1){const[o,c]=tw(t);if(!o)return;const u=window.getComputedStyle(s).getPropertyValue(o);if(u){const p=u.trim();return Wy(p)?parseFloat(p):p}return $f(c)?jb(c,s,r+1):c}function If(t,s){return t?.[s]??t?.default??t}const wb=new Set(["width","height","top","left","right","bottom",...kl]),aw={test:t=>t==="auto",parse:t=>t},Nb=t=>s=>s.test(t),Mb=[El,Xt,Qi,qr,Y3,F3,aw],K1=t=>Mb.find(Nb(t));function nw(t){return typeof t=="number"?t===0:t!==null?t==="none"||t==="0"||Iy(t):!0}const sw=new Set(["brightness","contrast","saturate","opacity"]);function iw(t){const[s,r]=t.slice(0,-1).split("(");if(s==="drop-shadow")return t;const[o]=r.match(Of)||[];if(!o)return t;const c=r.replace(o,"");let u=sw.has(s)?1:0;return o!==r&&(u*=100),s+"("+u+c+")"}const rw=/\b([a-z-]*)\(.*?\)/gu,af={...Yr,getAnimatableNone:t=>{const s=t.match(rw);return s?s.map(iw).join(" "):t}},eg={...El,transform:Math.round},ow={rotate:qr,rotateX:qr,rotateY:qr,rotateZ:qr,scale:F0,scaleX:F0,scaleY:F0,scaleZ:F0,skew:qr,skewX:qr,skewY:qr,distance:Xt,translateX:Xt,translateY:Xt,translateZ:Xt,x:Xt,y:Xt,z:Xt,perspective:Xt,transformPerspective:Xt,opacity:Mc,originX:W1,originY:W1,originZ:Xt},Hf={borderWidth:Xt,borderTopWidth:Xt,borderRightWidth:Xt,borderBottomWidth:Xt,borderLeftWidth:Xt,borderRadius:Xt,radius:Xt,borderTopLeftRadius:Xt,borderTopRightRadius:Xt,borderBottomRightRadius:Xt,borderBottomLeftRadius:Xt,width:Xt,maxWidth:Xt,height:Xt,maxHeight:Xt,top:Xt,right:Xt,bottom:Xt,left:Xt,padding:Xt,paddingTop:Xt,paddingRight:Xt,paddingBottom:Xt,paddingLeft:Xt,margin:Xt,marginTop:Xt,marginRight:Xt,marginBottom:Xt,marginLeft:Xt,backgroundPositionX:Xt,backgroundPositionY:Xt,...ow,zIndex:eg,fillOpacity:Mc,strokeOpacity:Mc,numOctaves:eg},lw={...Hf,color:as,backgroundColor:as,outlineColor:as,fill:as,stroke:as,borderColor:as,borderTopColor:as,borderRightColor:as,borderBottomColor:as,borderLeftColor:as,filter:af,WebkitFilter:af},_b=t=>lw[t];function Eb(t,s){let r=_b(t);return r!==af&&(r=Yr),r.getAnimatableNone?r.getAnimatableNone(s):void 0}const cw=new Set(["auto","none","0"]);function dw(t,s,r){let o=0,c;for(;o<t.length&&!c;){const u=t[o];typeof u=="string"&&!cw.has(u)&&_c(u).values.length&&(c=t[o]),o++}if(c&&r)for(const u of s)t[u]=Eb(r,c)}class uw extends Uf{constructor(s,r,o,c,u){super(s,r,o,c,u,!0)}readKeyframes(){const{unresolvedKeyframes:s,element:r,name:o}=this;if(!r||!r.current)return;super.readKeyframes();for(let h=0;h<s.length;h++){let x=s[h];if(typeof x=="string"&&(x=x.trim(),$f(x))){const g=jb(x,r.current);g!==void 0&&(s[h]=g),h===s.length-1&&(this.finalKeyframe=x)}}if(this.resolveNoneKeyframes(),!wb.has(o)||s.length!==2)return;const[c,u]=s,p=K1(c),m=K1(u);if(p!==m)if(X1(p)&&X1(m))for(let h=0;h<s.length;h++){const x=s[h];typeof x=="string"&&(s[h]=parseFloat(x))}else Co[o]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){const{unresolvedKeyframes:s,name:r}=this,o=[];for(let c=0;c<s.length;c++)(s[c]===null||nw(s[c]))&&o.push(c);o.length&&dw(s,o,r)}measureInitialState(){const{element:s,unresolvedKeyframes:r,name:o}=this;if(!s||!s.current)return;o==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=Co[o](s.measureViewportBox(),window.getComputedStyle(s.current)),r[0]=this.measuredOrigin;const c=r[r.length-1];c!==void 0&&s.getValue(o,c).jump(c,!1)}measureEndState(){const{element:s,name:r,unresolvedKeyframes:o}=this;if(!s||!s.current)return;const c=s.getValue(r);c&&c.jump(this.measuredOrigin,!1);const u=o.length-1,p=o[u];o[u]=Co[r](s.measureViewportBox(),window.getComputedStyle(s.current)),p!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=p),this.removedTransforms?.length&&this.removedTransforms.forEach(([m,h])=>{s.getValue(m).set(h)}),this.resolveNoneKeyframes()}}function pw(t,s,r){if(t instanceof EventTarget)return[t];if(typeof t=="string"){let o=document;const c=r?.[t]??o.querySelectorAll(t);return c?Array.from(c):[]}return Array.from(t)}const kb=(t,s)=>s&&typeof t=="number"?s.transform(t):t;function Cb(t){return Uy(t)&&"offsetHeight"in t}const tg=30,fw=t=>!isNaN(parseFloat(t)),vc={current:void 0};class mw{constructor(s,r={}){this.canTrackVelocity=null,this.events={},this.updateAndNotify=o=>{const c=ri.now();if(this.updatedAt!==c&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(o),this.current!==this.prev&&(this.events.change?.notify(this.current),this.dependents))for(const u of this.dependents)u.dirty()},this.hasAnimated=!1,this.setCurrent(s),this.owner=r.owner}setCurrent(s){this.current=s,this.updatedAt=ri.now(),this.canTrackVelocity===null&&s!==void 0&&(this.canTrackVelocity=fw(this.current))}setPrevFrameValue(s=this.current){this.prevFrameValue=s,this.prevUpdatedAt=this.updatedAt}onChange(s){return this.on("change",s)}on(s,r){this.events[s]||(this.events[s]=new Pf);const o=this.events[s].add(r);return s==="change"?()=>{o(),pn.read(()=>{this.events.change.getSize()||this.stop()})}:o}clearListeners(){for(const s in this.events)this.events[s].clear()}attach(s,r){this.passiveEffect=s,this.stopPassiveEffect=r}set(s){this.passiveEffect?this.passiveEffect(s,this.updateAndNotify):this.updateAndNotify(s)}setWithVelocity(s,r,o){this.set(r),this.prev=void 0,this.prevFrameValue=s,this.prevUpdatedAt=this.updatedAt-o}jump(s,r=!0){this.updateAndNotify(s),this.prev=s,this.prevUpdatedAt=this.prevFrameValue=void 0,r&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}dirty(){this.events.change?.notify(this.current)}addDependent(s){this.dependents||(this.dependents=new Set),this.dependents.add(s)}removeDependent(s){this.dependents&&this.dependents.delete(s)}get(){return vc.current&&vc.current.push(this),this.current}getPrevious(){return this.prev}getVelocity(){const s=ri.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||s-this.updatedAt>tg)return 0;const r=Math.min(this.updatedAt-this.prevUpdatedAt,tg);return Hy(parseFloat(this.current)-parseFloat(this.prevFrameValue),r)}start(s){return this.stop(),new Promise(r=>{this.hasAnimated=!0,this.animation=s(r),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.dependents?.clear(),this.events.destroy?.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function Po(t,s){return new mw(t,s)}const{schedule:qf}=tb(queueMicrotask,!1),Li={x:!1,y:!1};function Tb(){return Li.x||Li.y}function hw(t){return t==="x"||t==="y"?Li[t]?null:(Li[t]=!0,()=>{Li[t]=!1}):Li.x||Li.y?null:(Li.x=Li.y=!0,()=>{Li.x=Li.y=!1})}function Sb(t,s){const r=pw(t),o=new AbortController,c={passive:!0,...s,signal:o.signal};return[r,c,()=>o.abort()]}function ag(t){return!(t.pointerType==="touch"||Tb())}function xw(t,s,r={}){const[o,c,u]=Sb(t,r),p=m=>{if(!ag(m))return;const{target:h}=m,x=s(h,m);if(typeof x!="function"||!h)return;const g=b=>{ag(b)&&(x(b),h.removeEventListener("pointerleave",g))};h.addEventListener("pointerleave",g,c)};return o.forEach(m=>{m.addEventListener("pointerenter",p,c)}),u}const Ab=(t,s)=>s?t===s?!0:Ab(t,s.parentElement):!1,Gf=t=>t.pointerType==="mouse"?typeof t.button!="number"||t.button<=0:t.isPrimary!==!1,gw=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function yw(t){return gw.has(t.tagName)||t.tabIndex!==-1}const K0=new WeakSet;function ng(t){return s=>{s.key==="Enter"&&t(s)}}function vp(t,s){t.dispatchEvent(new PointerEvent("pointer"+s,{isPrimary:!0,bubbles:!0}))}const bw=(t,s)=>{const r=t.currentTarget;if(!r)return;const o=ng(()=>{if(K0.has(r))return;vp(r,"down");const c=ng(()=>{vp(r,"up")}),u=()=>vp(r,"cancel");r.addEventListener("keyup",c,s),r.addEventListener("blur",u,s)});r.addEventListener("keydown",o,s),r.addEventListener("blur",()=>r.removeEventListener("keydown",o),s)};function sg(t){return Gf(t)&&!Tb()}function vw(t,s,r={}){const[o,c,u]=Sb(t,r),p=m=>{const h=m.currentTarget;if(!sg(m))return;K0.add(h);const x=s(h,m),g=(_,N)=>{window.removeEventListener("pointerup",b),window.removeEventListener("pointercancel",j),K0.has(h)&&K0.delete(h),sg(_)&&typeof x=="function"&&x(_,{success:N})},b=_=>{g(_,h===window||h===document||r.useGlobalTarget||Ab(h,_.target))},j=_=>{g(_,!1)};window.addEventListener("pointerup",b,c),window.addEventListener("pointercancel",j,c)};return o.forEach(m=>{(r.useGlobalTarget?window:m).addEventListener("pointerdown",p,c),Cb(m)&&(m.addEventListener("focus",x=>bw(x,c)),!yw(m)&&!m.hasAttribute("tabindex")&&(m.tabIndex=0))}),u}function Pb(t){return Uy(t)&&"ownerSVGElement"in t}function jw(t){return Pb(t)&&t.tagName==="svg"}function ww(...t){const s=!Array.isArray(t[0]),r=s?0:-1,o=t[0+r],c=t[1+r],u=t[2+r],p=t[3+r],m=fb(c,u,p);return s?m(o):m}const bs=t=>!!(t&&t.getVelocity);function Nw(t,s,r){const o=t.get();let c=null,u=o,p;const m=typeof o=="string"?o.replace(/[\d.-]/g,""):void 0,h=()=>{c&&(c.stop(),c=null)},x=()=>{h(),c=new hd({keyframes:[rg(t.get()),rg(u)],velocity:t.getVelocity(),type:"spring",restDelta:.001,restSpeed:.01,...r,onUpdate:p})};if(t.attach((g,b)=>{u=g,p=j=>b(ig(j,m)),pn.postRender(x)},h),bs(s)){const g=s.on("change",j=>t.set(ig(j,m))),b=t.on("destroy",g);return()=>{g(),b()}}return h}function ig(t,s){return s?t+s:t}function rg(t){return typeof t=="number"?t:parseFloat(t)}const Mw=[...Mb,as,Yr],_w=t=>Mw.find(Nb(t)),Pc=$.createContext({transformPagePoint:t=>t,isStatic:!1,reducedMotion:"never"});function og(t,s){if(typeof t=="function")return t(s);t!=null&&(t.current=s)}function Ew(...t){return s=>{let r=!1;const o=t.map(c=>{const u=og(c,s);return!r&&typeof u=="function"&&(r=!0),u});if(r)return()=>{for(let c=0;c<o.length;c++){const u=o[c];typeof u=="function"?u():og(t[c],null)}}}}function kw(...t){return $.useCallback(Ew(...t),t)}class Cw extends $.Component{getSnapshotBeforeUpdate(s){const r=this.props.childRef.current;if(r&&s.isPresent&&!this.props.isPresent){const o=r.offsetParent,c=Cb(o)&&o.offsetWidth||0,u=this.props.sizeRef.current;u.height=r.offsetHeight||0,u.width=r.offsetWidth||0,u.top=r.offsetTop,u.left=r.offsetLeft,u.right=c-u.width-u.left}return null}componentDidUpdate(){}render(){return this.props.children}}function Tw({children:t,isPresent:s,anchorX:r,root:o}){const c=$.useId(),u=$.useRef(null),p=$.useRef({width:0,height:0,top:0,left:0,right:0}),{nonce:m}=$.useContext(Pc),h=kw(u,t?.ref);return $.useInsertionEffect(()=>{const{width:x,height:g,top:b,left:j,right:_}=p.current;if(s||!u.current||!x||!g)return;const N=r==="left"?`left: ${j}`:`right: ${_}`;u.current.dataset.motionPopId=c;const M=document.createElement("style");m&&(M.nonce=m);const R=o??document.head;return R.appendChild(M),M.sheet&&M.sheet.insertRule(`
          [data-motion-pop-id="${c}"] {
            position: absolute !important;
            width: ${x}px !important;
            height: ${g}px !important;
            ${N}px !important;
            top: ${b}px !important;
          }
        `),()=>{R.contains(M)&&R.removeChild(M)}},[s]),a.jsx(Cw,{isPresent:s,childRef:u,sizeRef:p,children:$.cloneElement(t,{ref:h})})}const Sw=({children:t,initial:s,isPresent:r,onExitComplete:o,custom:c,presenceAffectsLayout:u,mode:p,anchorX:m,root:h})=>{const x=Cc(Aw),g=$.useId();let b=!0,j=$.useMemo(()=>(b=!1,{id:g,initial:s,isPresent:r,custom:c,onExitComplete:_=>{x.set(_,!0);for(const N of x.values())if(!N)return;o&&o()},register:_=>(x.set(_,!1),()=>x.delete(_))}),[r,x,o]);return u&&b&&(j={...j}),$.useMemo(()=>{x.forEach((_,N)=>x.set(N,!1))},[r]),$.useEffect(()=>{!r&&!x.size&&o&&o()},[r]),p==="popLayout"&&(t=a.jsx(Tw,{isPresent:r,anchorX:m,root:h,children:t})),a.jsx(md.Provider,{value:j,children:t})};function Aw(){return new Map}function Db(t=!0){const s=$.useContext(md);if(s===null)return[!0,null];const{isPresent:r,onExitComplete:o,register:c}=s,u=$.useId();$.useEffect(()=>{if(t)return c(u)},[t]);const p=$.useCallback(()=>t&&o&&o(u),[u,o,t]);return!r&&o?[!1,p]:[!0]}const Y0=t=>t.key||"";function lg(t){const s=[];return $.Children.forEach(t,r=>{$.isValidElement(r)&&s.push(r)}),s}const Ro=({children:t,custom:s,initial:r=!0,onExitComplete:o,presenceAffectsLayout:c=!0,mode:u="sync",propagate:p=!1,anchorX:m="left",root:h})=>{const[x,g]=Db(p),b=$.useMemo(()=>lg(t),[t]),j=p&&!x?[]:b.map(Y0),_=$.useRef(!0),N=$.useRef(b),M=Cc(()=>new Map),[R,E]=$.useState(b),[T,D]=$.useState(b);kf(()=>{_.current=!1,N.current=b;for(let I=0;I<T.length;I++){const Z=Y0(T[I]);j.includes(Z)?M.delete(Z):M.get(Z)!==!0&&M.set(Z,!1)}},[T,j.length,j.join("-")]);const O=[];if(b!==R){let I=[...b];for(let Z=0;Z<T.length;Z++){const Y=T[Z],U=Y0(Y);j.includes(U)||(I.splice(Z,0,Y),O.push(Y))}return u==="wait"&&O.length&&(I=O),D(lg(I)),E(b),null}const{forceRender:q}=$.useContext(_f);return a.jsx(a.Fragment,{children:T.map(I=>{const Z=Y0(I),Y=p&&!x?!1:b===T||j.includes(Z),U=()=>{if(M.has(Z))M.set(Z,!0);else return;let S=!0;M.forEach(Q=>{Q||(S=!1)}),S&&(q?.(),D(N.current),p&&g?.(),o&&o())};return a.jsx(Sw,{isPresent:Y,initial:!_.current||r?void 0:!1,custom:s,presenceAffectsLayout:c,mode:u,root:h,onExitComplete:Y?void 0:U,anchorX:m,children:I},Z)})})},Rb=$.createContext({strict:!1}),cg={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},Nl={};for(const t in cg)Nl[t]={isEnabled:s=>cg[t].some(r=>!!s[r])};function Pw(t){for(const s in t)Nl[s]={...Nl[s],...t[s]}}const Dw=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function dd(t){return t.startsWith("while")||t.startsWith("drag")&&t!=="draggable"||t.startsWith("layout")||t.startsWith("onTap")||t.startsWith("onPan")||t.startsWith("onLayout")||Dw.has(t)}let $b=t=>!dd(t);function Rw(t){typeof t=="function"&&($b=s=>s.startsWith("on")?!dd(s):t(s))}try{Rw(require("@emotion/is-prop-valid").default)}catch{}function $w(t,s,r){const o={};for(const c in t)c==="values"&&typeof t.values=="object"||($b(c)||r===!0&&dd(c)||!s&&!dd(c)||t.draggable&&c.startsWith("onDrag"))&&(o[c]=t[c]);return o}const xd=$.createContext({});function gd(t){return t!==null&&typeof t=="object"&&typeof t.start=="function"}function Ec(t){return typeof t=="string"||Array.isArray(t)}const Ff=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],Yf=["initial",...Ff];function yd(t){return gd(t.animate)||Yf.some(s=>Ec(t[s]))}function Ob(t){return!!(yd(t)||t.variants)}function Ow(t,s){if(yd(t)){const{initial:r,animate:o}=t;return{initial:r===!1||Ec(r)?r:void 0,animate:Ec(o)?o:void 0}}return t.inherit!==!1?s:{}}function zw(t){const{initial:s,animate:r}=Ow(t,$.useContext(xd));return $.useMemo(()=>({initial:s,animate:r}),[dg(s),dg(r)])}function dg(t){return Array.isArray(t)?t.join(" "):t}function ug(t,s){return s.max===s.min?0:t/(s.max-s.min)*100}const hc={correct:(t,s)=>{if(!s.target)return t;if(typeof t=="string")if(Xt.test(t))t=parseFloat(t);else return t;const r=ug(t,s.target.x),o=ug(t,s.target.y);return`${r}% ${o}%`}},Bw={correct:(t,{treeScale:s,projectionDelta:r})=>{const o=t,c=Yr.parse(t);if(c.length>5)return o;const u=Yr.createTransformer(t),p=typeof c[0]!="number"?1:0,m=r.x.scale*s.x,h=r.y.scale*s.y;c[0+p]/=m,c[1+p]/=h;const x=_n(m,h,.5);return typeof c[2+p]=="number"&&(c[2+p]/=x),typeof c[3+p]=="number"&&(c[3+p]/=x),u(c)}},nf={borderRadius:{...hc,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:hc,borderTopRightRadius:hc,borderBottomLeftRadius:hc,borderBottomRightRadius:hc,boxShadow:Bw};function zb(t,{layout:s,layoutId:r}){return Cl.has(t)||t.startsWith("origin")||(s||r!==void 0)&&(!!nf[t]||t==="opacity")}const Lw={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},Vw=kl.length;function Ww(t,s,r){let o="",c=!0;for(let u=0;u<Vw;u++){const p=kl[u],m=t[p];if(m===void 0)continue;let h=!0;if(typeof m=="number"?h=m===(p.startsWith("scale")?1:0):h=parseFloat(m)===0,!h||r){const x=kb(m,Hf[p]);if(!h){c=!1;const g=Lw[p]||p;o+=`${g}(${x}) `}r&&(s[p]=x)}}return o=o.trim(),r?o=r(s,c?"":o):c&&(o="none"),o}function Xf(t,s,r){const{style:o,vars:c,transformOrigin:u}=t;let p=!1,m=!1;for(const h in s){const x=s[h];if(Cl.has(h)){p=!0;continue}else if(nb(h)){c[h]=x;continue}else{const g=kb(x,Hf[h]);h.startsWith("origin")?(m=!0,u[h]=g):o[h]=g}}if(s.transform||(p||r?o.transform=Ww(s,t.transform,r):o.transform&&(o.transform="none")),m){const{originX:h="50%",originY:x="50%",originZ:g=0}=u;o.transformOrigin=`${h} ${x} ${g}`}}const Zf=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function Bb(t,s,r){for(const o in s)!bs(s[o])&&!zb(o,r)&&(t[o]=s[o])}function Uw({transformTemplate:t},s){return $.useMemo(()=>{const r=Zf();return Xf(r,s,t),Object.assign({},r.vars,r.style)},[s])}function Iw(t,s){const r=t.style||{},o={};return Bb(o,r,t),Object.assign(o,Uw(t,s)),o}function Hw(t,s){const r={},o=Iw(t,s);return t.drag&&t.dragListener!==!1&&(r.draggable=!1,o.userSelect=o.WebkitUserSelect=o.WebkitTouchCallout="none",o.touchAction=t.drag===!0?"none":`pan-${t.drag==="x"?"y":"x"}`),t.tabIndex===void 0&&(t.onTap||t.onTapStart||t.whileTap)&&(r.tabIndex=0),r.style=o,r}const qw={offset:"stroke-dashoffset",array:"stroke-dasharray"},Gw={offset:"strokeDashoffset",array:"strokeDasharray"};function Fw(t,s,r=1,o=0,c=!0){t.pathLength=1;const u=c?qw:Gw;t[u.offset]=Xt.transform(-o);const p=Xt.transform(s),m=Xt.transform(r);t[u.array]=`${p} ${m}`}function Lb(t,{attrX:s,attrY:r,attrScale:o,pathLength:c,pathSpacing:u=1,pathOffset:p=0,...m},h,x,g){if(Xf(t,m,x),h){t.style.viewBox&&(t.attrs.viewBox=t.style.viewBox);return}t.attrs=t.style,t.style={};const{attrs:b,style:j}=t;b.transform&&(j.transform=b.transform,delete b.transform),(j.transform||b.transformOrigin)&&(j.transformOrigin=b.transformOrigin??"50% 50%",delete b.transformOrigin),j.transform&&(j.transformBox=g?.transformBox??"fill-box",delete b.transformBox),s!==void 0&&(b.x=s),r!==void 0&&(b.y=r),o!==void 0&&(b.scale=o),c!==void 0&&Fw(b,c,u,p,!1)}const Vb=()=>({...Zf(),attrs:{}}),Wb=t=>typeof t=="string"&&t.toLowerCase()==="svg";function Yw(t,s,r,o){const c=$.useMemo(()=>{const u=Vb();return Lb(u,s,Wb(o),t.transformTemplate,t.style),{...u.attrs,style:{...u.style}}},[s]);if(t.style){const u={};Bb(u,t.style,t),c.style={...u,...c.style}}return c}const Xw=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function Qf(t){return typeof t!="string"||t.includes("-")?!1:!!(Xw.indexOf(t)>-1||/[A-Z]/u.test(t))}function Zw(t,s,r,{latestValues:o},c,u=!1){const m=(Qf(t)?Yw:Hw)(s,o,c,t),h=$w(s,typeof t=="string",u),x=t!==$.Fragment?{...h,...m,ref:r}:{},{children:g}=s,b=$.useMemo(()=>bs(g)?g.get():g,[g]);return $.createElement(t,{...x,children:b})}function pg(t){const s=[{},{}];return t?.values.forEach((r,o)=>{s[0][o]=r.get(),s[1][o]=r.getVelocity()}),s}function Jf(t,s,r,o){if(typeof s=="function"){const[c,u]=pg(o);s=s(r!==void 0?r:t.custom,c,u)}if(typeof s=="string"&&(s=t.variants&&t.variants[s]),typeof s=="function"){const[c,u]=pg(o);s=s(r!==void 0?r:t.custom,c,u)}return s}function ed(t){return bs(t)?t.get():t}function Qw({scrapeMotionValuesFromProps:t,createRenderState:s},r,o,c){return{latestValues:Jw(r,o,c,t),renderState:s()}}function Jw(t,s,r,o){const c={},u=o(t,{});for(const j in u)c[j]=ed(u[j]);let{initial:p,animate:m}=t;const h=yd(t),x=Ob(t);s&&x&&!h&&t.inherit!==!1&&(p===void 0&&(p=s.initial),m===void 0&&(m=s.animate));let g=r?r.initial===!1:!1;g=g||p===!1;const b=g?m:p;if(b&&typeof b!="boolean"&&!gd(b)){const j=Array.isArray(b)?b:[b];for(let _=0;_<j.length;_++){const N=Jf(t,j[_]);if(N){const{transitionEnd:M,transition:R,...E}=N;for(const T in E){let D=E[T];if(Array.isArray(D)){const O=g?D.length-1:0;D=D[O]}D!==null&&(c[T]=D)}for(const T in M)c[T]=M[T]}}}return c}const Ub=t=>(s,r)=>{const o=$.useContext(xd),c=$.useContext(md),u=()=>Qw(t,s,o,c);return r?u():Cc(u)};function Kf(t,s,r){const{style:o}=t,c={};for(const u in o)(bs(o[u])||s.style&&bs(s.style[u])||zb(u,t)||r?.getValue(u)?.liveStyle!==void 0)&&(c[u]=o[u]);return c}const Kw=Ub({scrapeMotionValuesFromProps:Kf,createRenderState:Zf});function Ib(t,s,r){const o=Kf(t,s,r);for(const c in t)if(bs(t[c])||bs(s[c])){const u=kl.indexOf(c)!==-1?"attr"+c.charAt(0).toUpperCase()+c.substring(1):c;o[u]=t[c]}return o}const e4=Ub({scrapeMotionValuesFromProps:Ib,createRenderState:Vb}),t4=Symbol.for("motionComponentSymbol");function fl(t){return t&&typeof t=="object"&&Object.prototype.hasOwnProperty.call(t,"current")}function a4(t,s,r){return $.useCallback(o=>{o&&t.onMount&&t.onMount(o),s&&(o?s.mount(o):s.unmount()),r&&(typeof r=="function"?r(o):fl(r)&&(r.current=o))},[s])}const em=t=>t.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),n4="framerAppearId",Hb="data-"+em(n4),qb=$.createContext({});function s4(t,s,r,o,c){const{visualElement:u}=$.useContext(xd),p=$.useContext(Rb),m=$.useContext(md),h=$.useContext(Pc).reducedMotion,x=$.useRef(null);o=o||p.renderer,!x.current&&o&&(x.current=o(t,{visualState:s,parent:u,props:r,presenceContext:m,blockInitialAnimation:m?m.initial===!1:!1,reducedMotionConfig:h}));const g=x.current,b=$.useContext(qb);g&&!g.projection&&c&&(g.type==="html"||g.type==="svg")&&i4(x.current,r,c,b);const j=$.useRef(!1);$.useInsertionEffect(()=>{g&&j.current&&g.update(r,m)});const _=r[Hb],N=$.useRef(!!_&&!window.MotionHandoffIsComplete?.(_)&&window.MotionHasOptimisedAnimation?.(_));return kf(()=>{g&&(j.current=!0,window.MotionIsMounted=!0,g.updateFeatures(),g.scheduleRenderMicrotask(),N.current&&g.animationState&&g.animationState.animateChanges())}),$.useEffect(()=>{g&&(!N.current&&g.animationState&&g.animationState.animateChanges(),N.current&&(queueMicrotask(()=>{window.MotionHandoffMarkAsComplete?.(_)}),N.current=!1),g.enteringChildren=void 0)}),g}function i4(t,s,r,o){const{layoutId:c,layout:u,drag:p,dragConstraints:m,layoutScroll:h,layoutRoot:x,layoutCrossfade:g}=s;t.projection=new r(t.latestValues,s["data-framer-portal-id"]?void 0:Gb(t.parent)),t.projection.setOptions({layoutId:c,layout:u,alwaysMeasureLayout:!!p||m&&fl(m),visualElement:t,animationType:typeof u=="string"?u:"both",initialPromotionConfig:o,crossfade:g,layoutScroll:h,layoutRoot:x})}function Gb(t){if(t)return t.options.allowProjection!==!1?t.projection:Gb(t.parent)}function jp(t,{forwardMotionProps:s=!1}={},r,o){r&&Pw(r);const c=Qf(t)?e4:Kw;function u(m,h){let x;const g={...$.useContext(Pc),...m,layoutId:r4(m)},{isStatic:b}=g,j=zw(m),_=c(m,b);if(!b&&Ef){o4();const N=l4(g);x=N.MeasureLayout,j.visualElement=s4(t,_,g,o,N.ProjectionNode)}return a.jsxs(xd.Provider,{value:j,children:[x&&j.visualElement?a.jsx(x,{visualElement:j.visualElement,...g}):null,Zw(t,m,a4(_,j.visualElement,h),_,b,s)]})}u.displayName=`motion.${typeof t=="string"?t:`create(${t.displayName??t.name??""})`}`;const p=$.forwardRef(u);return p[t4]=t,p}function r4({layoutId:t}){const s=$.useContext(_f).id;return s&&t!==void 0?s+"-"+t:t}function o4(t,s){$.useContext(Rb).strict}function l4(t){const{drag:s,layout:r}=Nl;if(!s&&!r)return{};const o={...s,...r};return{MeasureLayout:s?.isEnabled(t)||r?.isEnabled(t)?o.MeasureLayout:void 0,ProjectionNode:o.ProjectionNode}}function c4(t,s){if(typeof Proxy>"u")return jp;const r=new Map,o=(u,p)=>jp(u,p,t,s),c=(u,p)=>o(u,p);return new Proxy(c,{get:(u,p)=>p==="create"?o:(r.has(p)||r.set(p,jp(p,void 0,t,s)),r.get(p))})}function Fb({top:t,left:s,right:r,bottom:o}){return{x:{min:s,max:r},y:{min:t,max:o}}}function d4({x:t,y:s}){return{top:s.min,right:t.max,bottom:s.max,left:t.min}}function u4(t,s){if(!s)return t;const r=s({x:t.left,y:t.top}),o=s({x:t.right,y:t.bottom});return{top:r.y,left:r.x,bottom:o.y,right:o.x}}function wp(t){return t===void 0||t===1}function sf({scale:t,scaleX:s,scaleY:r}){return!wp(t)||!wp(s)||!wp(r)}function jo(t){return sf(t)||Yb(t)||t.z||t.rotate||t.rotateX||t.rotateY||t.skewX||t.skewY}function Yb(t){return fg(t.x)||fg(t.y)}function fg(t){return t&&t!=="0%"}function ud(t,s,r){const o=t-r,c=s*o;return r+c}function mg(t,s,r,o,c){return c!==void 0&&(t=ud(t,c,o)),ud(t,r,o)+s}function rf(t,s=0,r=1,o,c){t.min=mg(t.min,s,r,o,c),t.max=mg(t.max,s,r,o,c)}function Xb(t,{x:s,y:r}){rf(t.x,s.translate,s.scale,s.originPoint),rf(t.y,r.translate,r.scale,r.originPoint)}const hg=.999999999999,xg=1.0000000000001;function p4(t,s,r,o=!1){const c=r.length;if(!c)return;s.x=s.y=1;let u,p;for(let m=0;m<c;m++){u=r[m],p=u.projectionDelta;const{visualElement:h}=u.options;h&&h.props.style&&h.props.style.display==="contents"||(o&&u.options.layoutScroll&&u.scroll&&u!==u.root&&hl(t,{x:-u.scroll.offset.x,y:-u.scroll.offset.y}),p&&(s.x*=p.x.scale,s.y*=p.y.scale,Xb(t,p)),o&&jo(u.latestValues)&&hl(t,u.latestValues))}s.x<xg&&s.x>hg&&(s.x=1),s.y<xg&&s.y>hg&&(s.y=1)}function ml(t,s){t.min=t.min+s,t.max=t.max+s}function gg(t,s,r,o,c=.5){const u=_n(t.min,t.max,c);rf(t,s,r,u,o)}function hl(t,s){gg(t.x,s.x,s.scaleX,s.scale,s.originX),gg(t.y,s.y,s.scaleY,s.scale,s.originY)}function Zb(t,s){return Fb(u4(t.getBoundingClientRect(),s))}function f4(t,s,r){const o=Zb(t,r),{scroll:c}=s;return c&&(ml(o.x,c.offset.x),ml(o.y,c.offset.y)),o}const yg=()=>({translate:0,scale:1,origin:0,originPoint:0}),xl=()=>({x:yg(),y:yg()}),bg=()=>({min:0,max:0}),ds=()=>({x:bg(),y:bg()}),of={current:null},Qb={current:!1};function m4(){if(Qb.current=!0,!!Ef)if(window.matchMedia){const t=window.matchMedia("(prefers-reduced-motion)"),s=()=>of.current=t.matches;t.addEventListener("change",s),s()}else of.current=!1}const h4=new WeakMap;function x4(t,s,r){for(const o in s){const c=s[o],u=r[o];if(bs(c))t.addValue(o,c);else if(bs(u))t.addValue(o,Po(c,{owner:t}));else if(u!==c)if(t.hasValue(o)){const p=t.getValue(o);p.liveStyle===!0?p.jump(c):p.hasAnimated||p.set(c)}else{const p=t.getStaticValue(o);t.addValue(o,Po(p!==void 0?p:c,{owner:t}))}}for(const o in r)s[o]===void 0&&t.removeValue(o);return s}const vg=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class g4{scrapeMotionValuesFromProps(s,r,o){return{}}constructor({parent:s,props:r,presenceContext:o,reducedMotionConfig:c,blockInitialAnimation:u,visualState:p},m={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=Uf,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const j=ri.now();this.renderScheduledAt<j&&(this.renderScheduledAt=j,pn.render(this.render,!1,!0))};const{latestValues:h,renderState:x}=p;this.latestValues=h,this.baseTarget={...h},this.initialValues=r.initial?{...h}:{},this.renderState=x,this.parent=s,this.props=r,this.presenceContext=o,this.depth=s?s.depth+1:0,this.reducedMotionConfig=c,this.options=m,this.blockInitialAnimation=!!u,this.isControllingVariants=yd(r),this.isVariantNode=Ob(r),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(s&&s.current);const{willChange:g,...b}=this.scrapeMotionValuesFromProps(r,{},this);for(const j in b){const _=b[j];h[j]!==void 0&&bs(_)&&_.set(h[j])}}mount(s){this.current=s,h4.set(s,this),this.projection&&!this.projection.instance&&this.projection.mount(s),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((r,o)=>this.bindToMotionValue(o,r)),Qb.current||m4(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:of.current,this.parent?.addChild(this),this.update(this.props,this.presenceContext)}unmount(){this.projection&&this.projection.unmount(),br(this.notifyUpdate),br(this.render),this.valueSubscriptions.forEach(s=>s()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent?.removeChild(this);for(const s in this.events)this.events[s].clear();for(const s in this.features){const r=this.features[s];r&&(r.unmount(),r.isMounted=!1)}this.current=null}addChild(s){this.children.add(s),this.enteringChildren??(this.enteringChildren=new Set),this.enteringChildren.add(s)}removeChild(s){this.children.delete(s),this.enteringChildren&&this.enteringChildren.delete(s)}bindToMotionValue(s,r){this.valueSubscriptions.has(s)&&this.valueSubscriptions.get(s)();const o=Cl.has(s);o&&this.onBindTransform&&this.onBindTransform();const c=r.on("change",p=>{this.latestValues[s]=p,this.props.onUpdate&&pn.preRender(this.notifyUpdate),o&&this.projection&&(this.projection.isTransformDirty=!0),this.scheduleRender()});let u;window.MotionCheckAppearSync&&(u=window.MotionCheckAppearSync(this,s,r)),this.valueSubscriptions.set(s,()=>{c(),u&&u(),r.owner&&r.stop()})}sortNodePosition(s){return!this.current||!this.sortInstanceNodePosition||this.type!==s.type?0:this.sortInstanceNodePosition(this.current,s.current)}updateFeatures(){let s="animation";for(s in Nl){const r=Nl[s];if(!r)continue;const{isEnabled:o,Feature:c}=r;if(!this.features[s]&&c&&o(this.props)&&(this.features[s]=new c(this)),this.features[s]){const u=this.features[s];u.isMounted?u.update():(u.mount(),u.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):ds()}getStaticValue(s){return this.latestValues[s]}setStaticValue(s,r){this.latestValues[s]=r}update(s,r){(s.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=s,this.prevPresenceContext=this.presenceContext,this.presenceContext=r;for(let o=0;o<vg.length;o++){const c=vg[o];this.propEventSubscriptions[c]&&(this.propEventSubscriptions[c](),delete this.propEventSubscriptions[c]);const u="on"+c,p=s[u];p&&(this.propEventSubscriptions[c]=this.on(c,p))}this.prevMotionValues=x4(this,this.scrapeMotionValuesFromProps(s,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(s){return this.props.variants?this.props.variants[s]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(s){const r=this.getClosestVariantNode();if(r)return r.variantChildren&&r.variantChildren.add(s),()=>r.variantChildren.delete(s)}addValue(s,r){const o=this.values.get(s);r!==o&&(o&&this.removeValue(s),this.bindToMotionValue(s,r),this.values.set(s,r),this.latestValues[s]=r.get())}removeValue(s){this.values.delete(s);const r=this.valueSubscriptions.get(s);r&&(r(),this.valueSubscriptions.delete(s)),delete this.latestValues[s],this.removeValueFromRenderState(s,this.renderState)}hasValue(s){return this.values.has(s)}getValue(s,r){if(this.props.values&&this.props.values[s])return this.props.values[s];let o=this.values.get(s);return o===void 0&&r!==void 0&&(o=Po(r===null?void 0:r,{owner:this}),this.addValue(s,o)),o}readValue(s,r){let o=this.latestValues[s]!==void 0||!this.current?this.latestValues[s]:this.getBaseTargetFromProps(this.props,s)??this.readValueFromInstance(this.current,s,this.options);return o!=null&&(typeof o=="string"&&(Wy(o)||Iy(o))?o=parseFloat(o):!_w(o)&&Yr.test(r)&&(o=Eb(s,r)),this.setBaseTarget(s,bs(o)?o.get():o)),bs(o)?o.get():o}setBaseTarget(s,r){this.baseTarget[s]=r}getBaseTarget(s){const{initial:r}=this.props;let o;if(typeof r=="string"||typeof r=="object"){const u=Jf(this.props,r,this.presenceContext?.custom);u&&(o=u[s])}if(r&&o!==void 0)return o;const c=this.getBaseTargetFromProps(this.props,s);return c!==void 0&&!bs(c)?c:this.initialValues[s]!==void 0&&o===void 0?void 0:this.baseTarget[s]}on(s,r){return this.events[s]||(this.events[s]=new Pf),this.events[s].add(r)}notify(s,...r){this.events[s]&&this.events[s].notify(...r)}scheduleRenderMicrotask(){qf.render(this.render)}}class Jb extends g4{constructor(){super(...arguments),this.KeyframeResolver=uw}sortInstanceNodePosition(s,r){return s.compareDocumentPosition(r)&2?1:-1}getBaseTargetFromProps(s,r){return s.style?s.style[r]:void 0}removeValueFromRenderState(s,{vars:r,style:o}){delete r[s],delete o[s]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:s}=this.props;bs(s)&&(this.childSubscription=s.on("change",r=>{this.current&&(this.current.textContent=`${r}`)}))}}function Kb(t,{style:s,vars:r},o,c){const u=t.style;let p;for(p in s)u[p]=s[p];c?.applyProjectionStyles(u,o);for(p in r)u.setProperty(p,r[p])}function y4(t){return window.getComputedStyle(t)}class b4 extends Jb{constructor(){super(...arguments),this.type="html",this.renderInstance=Kb}readValueFromInstance(s,r){if(Cl.has(r))return this.projection?.isProjecting?Zp(r):Sj(s,r);{const o=y4(s),c=(nb(r)?o.getPropertyValue(r):o[r])||0;return typeof c=="string"?c.trim():c}}measureInstanceViewportBox(s,{transformPagePoint:r}){return Zb(s,r)}build(s,r,o){Xf(s,r,o.transformTemplate)}scrapeMotionValuesFromProps(s,r,o){return Kf(s,r,o)}}const e2=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function v4(t,s,r,o){Kb(t,s,void 0,o);for(const c in s.attrs)t.setAttribute(e2.has(c)?c:em(c),s.attrs[c])}class j4 extends Jb{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=ds}getBaseTargetFromProps(s,r){return s[r]}readValueFromInstance(s,r){if(Cl.has(r)){const o=_b(r);return o&&o.default||0}return r=e2.has(r)?r:em(r),s.getAttribute(r)}scrapeMotionValuesFromProps(s,r,o){return Ib(s,r,o)}build(s,r,o){Lb(s,r,this.isSVGTag,o.transformTemplate,o.style)}renderInstance(s,r,o,c){v4(s,r,o,c)}mount(s){this.isSVGTag=Wb(s.tagName),super.mount(s)}}const w4=(t,s)=>Qf(t)?new j4(s):new b4(s,{allowProjection:t!==$.Fragment});function yl(t,s,r){const o=t.getProps();return Jf(o,s,r!==void 0?r:o.custom,t)}const lf=t=>Array.isArray(t);function N4(t,s,r){t.hasValue(s)?t.getValue(s).set(r):t.addValue(s,Po(r))}function M4(t){return lf(t)?t[t.length-1]||0:t}function _4(t,s){const r=yl(t,s);let{transitionEnd:o={},transition:c={},...u}=r||{};u={...u,...o};for(const p in u){const m=M4(u[p]);N4(t,p,m)}}function E4(t){return!!(bs(t)&&t.add)}function cf(t,s){const r=t.getValue("willChange");if(E4(r))return r.add(s);if(!r&&yr.WillChange){const o=new yr.WillChange("auto");t.addValue("willChange",o),o.add(s)}}function t2(t){return t.props[Hb]}const k4=t=>t!==null;function C4(t,{repeat:s,repeatType:r="loop"},o){const c=t.filter(k4),u=s&&r!=="loop"&&s%2===1?0:c.length-1;return c[u]}const T4={type:"spring",stiffness:500,damping:25,restSpeed:10},S4=t=>({type:"spring",stiffness:550,damping:t===0?2*Math.sqrt(550):30,restSpeed:10}),A4={type:"keyframes",duration:.8},P4={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},D4=(t,{keyframes:s})=>s.length>2?A4:Cl.has(t)?t.startsWith("scale")?S4(s[1]):T4:P4;function R4({when:t,delay:s,delayChildren:r,staggerChildren:o,staggerDirection:c,repeat:u,repeatType:p,repeatDelay:m,from:h,elapsed:x,...g}){return!!Object.keys(g).length}const tm=(t,s,r,o={},c,u)=>p=>{const m=If(o,t)||{},h=m.delay||o.delay||0;let{elapsed:x=0}=o;x=x-Zi(h);const g={keyframes:Array.isArray(r)?r:[null,r],ease:"easeOut",velocity:s.getVelocity(),...m,delay:-x,onUpdate:j=>{s.set(j),m.onUpdate&&m.onUpdate(j)},onComplete:()=>{p(),m.onComplete&&m.onComplete()},name:t,motionValue:s,element:u?void 0:c};R4(m)||Object.assign(g,D4(t,g)),g.duration&&(g.duration=Zi(g.duration)),g.repeatDelay&&(g.repeatDelay=Zi(g.repeatDelay)),g.from!==void 0&&(g.keyframes[0]=g.from);let b=!1;if((g.type===!1||g.duration===0&&!g.repeatDelay)&&(tf(g),g.delay===0&&(b=!0)),(yr.instantAnimations||yr.skipAnimations)&&(b=!0,tf(g),g.delay=0),g.allowFlatten=!m.type&&!m.ease,b&&!u&&s.get()!==void 0){const j=C4(g.keyframes,m);if(j!==void 0){pn.update(()=>{g.onUpdate(j),g.onComplete()});return}}return m.isSync?new hd(g):new Kj(g)};function $4({protectedKeys:t,needsAnimating:s},r){const o=t.hasOwnProperty(r)&&s[r]!==!0;return s[r]=!1,o}function a2(t,s,{delay:r=0,transitionOverride:o,type:c}={}){let{transition:u=t.getDefaultTransition(),transitionEnd:p,...m}=s;o&&(u=o);const h=[],x=c&&t.animationState&&t.animationState.getState()[c];for(const g in m){const b=t.getValue(g,t.latestValues[g]??null),j=m[g];if(j===void 0||x&&$4(x,g))continue;const _={delay:r,...If(u||{},g)},N=b.get();if(N!==void 0&&!b.isAnimating&&!Array.isArray(j)&&j===N&&!_.velocity)continue;let M=!1;if(window.MotionHandoffAnimation){const E=t2(t);if(E){const T=window.MotionHandoffAnimation(E,g,pn);T!==null&&(_.startTime=T,M=!0)}}cf(t,g),b.start(tm(g,b,j,t.shouldReduceMotion&&wb.has(g)?{type:!1}:_,t,M));const R=b.animation;R&&h.push(R)}return p&&Promise.all(h).then(()=>{pn.update(()=>{p&&_4(t,p)})}),h}function n2(t,s,r,o=0,c=1){const u=Array.from(t).sort((x,g)=>x.sortNodePosition(g)).indexOf(s),p=t.size,m=(p-1)*o;return typeof r=="function"?r(u,p):c===1?u*o:m-u*o}function df(t,s,r={}){const o=yl(t,s,r.type==="exit"?t.presenceContext?.custom:void 0);let{transition:c=t.getDefaultTransition()||{}}=o||{};r.transitionOverride&&(c=r.transitionOverride);const u=o?()=>Promise.all(a2(t,o,r)):()=>Promise.resolve(),p=t.variantChildren&&t.variantChildren.size?(h=0)=>{const{delayChildren:x=0,staggerChildren:g,staggerDirection:b}=c;return O4(t,s,h,x,g,b,r)}:()=>Promise.resolve(),{when:m}=c;if(m){const[h,x]=m==="beforeChildren"?[u,p]:[p,u];return h().then(()=>x())}else return Promise.all([u(),p(r.delay)])}function O4(t,s,r=0,o=0,c=0,u=1,p){const m=[];for(const h of t.variantChildren)h.notify("AnimationStart",s),m.push(df(h,s,{...p,delay:r+(typeof o=="function"?0:o)+n2(t.variantChildren,h,o,c,u)}).then(()=>h.notify("AnimationComplete",s)));return Promise.all(m)}function z4(t,s,r={}){t.notify("AnimationStart",s);let o;if(Array.isArray(s)){const c=s.map(u=>df(t,u,r));o=Promise.all(c)}else if(typeof s=="string")o=df(t,s,r);else{const c=typeof s=="function"?yl(t,s,r.custom):s;o=Promise.all(a2(t,c,r))}return o.then(()=>{t.notify("AnimationComplete",s)})}function s2(t,s){if(!Array.isArray(s))return!1;const r=s.length;if(r!==t.length)return!1;for(let o=0;o<r;o++)if(s[o]!==t[o])return!1;return!0}const B4=Yf.length;function i2(t){if(!t)return;if(!t.isControllingVariants){const r=t.parent?i2(t.parent)||{}:{};return t.props.initial!==void 0&&(r.initial=t.props.initial),r}const s={};for(let r=0;r<B4;r++){const o=Yf[r],c=t.props[o];(Ec(c)||c===!1)&&(s[o]=c)}return s}const L4=[...Ff].reverse(),V4=Ff.length;function W4(t){return s=>Promise.all(s.map(({animation:r,options:o})=>z4(t,r,o)))}function U4(t){let s=W4(t),r=jg(),o=!0;const c=h=>(x,g)=>{const b=yl(t,g,h==="exit"?t.presenceContext?.custom:void 0);if(b){const{transition:j,transitionEnd:_,...N}=b;x={...x,...N,..._}}return x};function u(h){s=h(t)}function p(h){const{props:x}=t,g=i2(t.parent)||{},b=[],j=new Set;let _={},N=1/0;for(let R=0;R<V4;R++){const E=L4[R],T=r[E],D=x[E]!==void 0?x[E]:g[E],O=Ec(D),q=E===h?T.isActive:null;q===!1&&(N=R);let I=D===g[E]&&D!==x[E]&&O;if(I&&o&&t.manuallyAnimateOnMount&&(I=!1),T.protectedKeys={..._},!T.isActive&&q===null||!D&&!T.prevProp||gd(D)||typeof D=="boolean")continue;const Z=I4(T.prevProp,D);let Y=Z||E===h&&T.isActive&&!I&&O||R>N&&O,U=!1;const S=Array.isArray(D)?D:[D];let Q=S.reduce(c(E),{});q===!1&&(Q={});const{prevResolvedValues:ne={}}=T,Ne={...ne,...Q},$e=z=>{Y=!0,j.has(z)&&(U=!0,j.delete(z)),T.needsAnimating[z]=!0;const V=t.getValue(z);V&&(V.liveStyle=!1)};for(const z in Ne){const V=Q[z],F=ne[z];if(_.hasOwnProperty(z))continue;let re=!1;lf(V)&&lf(F)?re=!s2(V,F):re=V!==F,re?V!=null?$e(z):j.add(z):V!==void 0&&j.has(z)?$e(z):T.protectedKeys[z]=!0}T.prevProp=D,T.prevResolvedValues=Q,T.isActive&&(_={..._,...Q}),o&&t.blockInitialAnimation&&(Y=!1);const de=I&&Z;Y&&(!de||U)&&b.push(...S.map(z=>{const V={type:E};if(typeof z=="string"&&o&&!de&&t.manuallyAnimateOnMount&&t.parent){const{parent:F}=t,re=yl(F,z);if(F.enteringChildren&&re){const{delayChildren:C}=re.transition||{};V.delay=n2(F.enteringChildren,t,C)}}return{animation:z,options:V}}))}if(j.size){const R={};if(typeof x.initial!="boolean"){const E=yl(t,Array.isArray(x.initial)?x.initial[0]:x.initial);E&&E.transition&&(R.transition=E.transition)}j.forEach(E=>{const T=t.getBaseTarget(E),D=t.getValue(E);D&&(D.liveStyle=!0),R[E]=T??null}),b.push({animation:R})}let M=!!b.length;return o&&(x.initial===!1||x.initial===x.animate)&&!t.manuallyAnimateOnMount&&(M=!1),o=!1,M?s(b):Promise.resolve()}function m(h,x){if(r[h].isActive===x)return Promise.resolve();t.variantChildren?.forEach(b=>b.animationState?.setActive(h,x)),r[h].isActive=x;const g=p(h);for(const b in r)r[b].protectedKeys={};return g}return{animateChanges:p,setActive:m,setAnimateFunction:u,getState:()=>r,reset:()=>{r=jg()}}}function I4(t,s){return typeof s=="string"?s!==t:Array.isArray(s)?!s2(s,t):!1}function yo(t=!1){return{isActive:t,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function jg(){return{animate:yo(!0),whileInView:yo(),whileHover:yo(),whileTap:yo(),whileDrag:yo(),whileFocus:yo(),exit:yo()}}class Zr{constructor(s){this.isMounted=!1,this.node=s}update(){}}class H4 extends Zr{constructor(s){super(s),s.animationState||(s.animationState=U4(s))}updateAnimationControlsSubscription(){const{animate:s}=this.node.getProps();gd(s)&&(this.unmountControls=s.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:s}=this.node.getProps(),{animate:r}=this.node.prevProps||{};s!==r&&this.updateAnimationControlsSubscription()}unmount(){this.node.animationState.reset(),this.unmountControls?.()}}let q4=0;class G4 extends Zr{constructor(){super(...arguments),this.id=q4++}update(){if(!this.node.presenceContext)return;const{isPresent:s,onExitComplete:r}=this.node.presenceContext,{isPresent:o}=this.node.prevPresenceContext||{};if(!this.node.animationState||s===o)return;const c=this.node.animationState.setActive("exit",!s);r&&!s&&c.then(()=>{r(this.id)})}mount(){const{register:s,onExitComplete:r}=this.node.presenceContext||{};r&&r(this.id),s&&(this.unmount=s(this.id))}unmount(){}}const F4={animation:{Feature:H4},exit:{Feature:G4}};function kc(t,s,r,o={passive:!0}){return t.addEventListener(s,r,o),()=>t.removeEventListener(s,r)}function Dc(t){return{point:{x:t.pageX,y:t.pageY}}}const Y4=t=>s=>Gf(s)&&t(s,Dc(s));function jc(t,s,r,o){return kc(t,s,Y4(r),o)}const r2=1e-4,X4=1-r2,Z4=1+r2,o2=.01,Q4=0-o2,J4=0+o2;function Hs(t){return t.max-t.min}function K4(t,s,r){return Math.abs(t-s)<=r}function wg(t,s,r,o=.5){t.origin=o,t.originPoint=_n(s.min,s.max,t.origin),t.scale=Hs(r)/Hs(s),t.translate=_n(r.min,r.max,t.origin)-t.originPoint,(t.scale>=X4&&t.scale<=Z4||isNaN(t.scale))&&(t.scale=1),(t.translate>=Q4&&t.translate<=J4||isNaN(t.translate))&&(t.translate=0)}function wc(t,s,r,o){wg(t.x,s.x,r.x,o?o.originX:void 0),wg(t.y,s.y,r.y,o?o.originY:void 0)}function Ng(t,s,r){t.min=r.min+s.min,t.max=t.min+Hs(s)}function eN(t,s,r){Ng(t.x,s.x,r.x),Ng(t.y,s.y,r.y)}function Mg(t,s,r){t.min=s.min-r.min,t.max=t.min+Hs(s)}function pd(t,s,r){Mg(t.x,s.x,r.x),Mg(t.y,s.y,r.y)}function _i(t){return[t("x"),t("y")]}const l2=({current:t})=>t?t.ownerDocument.defaultView:null,_g=(t,s)=>Math.abs(t-s);function tN(t,s){const r=_g(t.x,s.x),o=_g(t.y,s.y);return Math.sqrt(r**2+o**2)}class c2{constructor(s,r,{transformPagePoint:o,contextWindow:c=window,dragSnapToOrigin:u=!1,distanceThreshold:p=3}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const j=Mp(this.lastMoveEventInfo,this.history),_=this.startEvent!==null,N=tN(j.offset,{x:0,y:0})>=this.distanceThreshold;if(!_&&!N)return;const{point:M}=j,{timestamp:R}=Ss;this.history.push({...M,timestamp:R});const{onStart:E,onMove:T}=this.handlers;_||(E&&E(this.lastMoveEvent,j),this.startEvent=this.lastMoveEvent),T&&T(this.lastMoveEvent,j)},this.handlePointerMove=(j,_)=>{this.lastMoveEvent=j,this.lastMoveEventInfo=Np(_,this.transformPagePoint),pn.update(this.updatePoint,!0)},this.handlePointerUp=(j,_)=>{this.end();const{onEnd:N,onSessionEnd:M,resumeAnimation:R}=this.handlers;if(this.dragSnapToOrigin&&R&&R(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const E=Mp(j.type==="pointercancel"?this.lastMoveEventInfo:Np(_,this.transformPagePoint),this.history);this.startEvent&&N&&N(j,E),M&&M(j,E)},!Gf(s))return;this.dragSnapToOrigin=u,this.handlers=r,this.transformPagePoint=o,this.distanceThreshold=p,this.contextWindow=c||window;const m=Dc(s),h=Np(m,this.transformPagePoint),{point:x}=h,{timestamp:g}=Ss;this.history=[{...x,timestamp:g}];const{onSessionStart:b}=r;b&&b(s,Mp(h,this.history)),this.removeListeners=Tc(jc(this.contextWindow,"pointermove",this.handlePointerMove),jc(this.contextWindow,"pointerup",this.handlePointerUp),jc(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(s){this.handlers=s}end(){this.removeListeners&&this.removeListeners(),br(this.updatePoint)}}function Np(t,s){return s?{point:s(t.point)}:t}function Eg(t,s){return{x:t.x-s.x,y:t.y-s.y}}function Mp({point:t},s){return{point:t,delta:Eg(t,d2(s)),offset:Eg(t,aN(s)),velocity:nN(s,.1)}}function aN(t){return t[0]}function d2(t){return t[t.length-1]}function nN(t,s){if(t.length<2)return{x:0,y:0};let r=t.length-1,o=null;const c=d2(t);for(;r>=0&&(o=t[r],!(c.timestamp-o.timestamp>Zi(s)));)r--;if(!o)return{x:0,y:0};const u=Ei(c.timestamp-o.timestamp);if(u===0)return{x:0,y:0};const p={x:(c.x-o.x)/u,y:(c.y-o.y)/u};return p.x===1/0&&(p.x=0),p.y===1/0&&(p.y=0),p}function sN(t,{min:s,max:r},o){return s!==void 0&&t<s?t=o?_n(s,t,o.min):Math.max(t,s):r!==void 0&&t>r&&(t=o?_n(r,t,o.max):Math.min(t,r)),t}function kg(t,s,r){return{min:s!==void 0?t.min+s:void 0,max:r!==void 0?t.max+r-(t.max-t.min):void 0}}function iN(t,{top:s,left:r,bottom:o,right:c}){return{x:kg(t.x,r,c),y:kg(t.y,s,o)}}function Cg(t,s){let r=s.min-t.min,o=s.max-t.max;return s.max-s.min<t.max-t.min&&([r,o]=[o,r]),{min:r,max:o}}function rN(t,s){return{x:Cg(t.x,s.x),y:Cg(t.y,s.y)}}function oN(t,s){let r=.5;const o=Hs(t),c=Hs(s);return c>o?r=Nc(s.min,s.max-o,t.min):o>c&&(r=Nc(t.min,t.max-c,s.min)),gr(0,1,r)}function lN(t,s){const r={};return s.min!==void 0&&(r.min=s.min-t.min),s.max!==void 0&&(r.max=s.max-t.min),r}const uf=.35;function cN(t=uf){return t===!1?t=0:t===!0&&(t=uf),{x:Tg(t,"left","right"),y:Tg(t,"top","bottom")}}function Tg(t,s,r){return{min:Sg(t,s),max:Sg(t,r)}}function Sg(t,s){return typeof t=="number"?t:t[s]||0}const dN=new WeakMap;class uN{constructor(s){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=ds(),this.latestPointerEvent=null,this.latestPanInfo=null,this.visualElement=s}start(s,{snapToCursor:r=!1,distanceThreshold:o}={}){const{presenceContext:c}=this.visualElement;if(c&&c.isPresent===!1)return;const u=b=>{const{dragSnapToOrigin:j}=this.getProps();j?this.pauseAnimation():this.stopAnimation(),r&&this.snapToCursor(Dc(b).point)},p=(b,j)=>{const{drag:_,dragPropagation:N,onDragStart:M}=this.getProps();if(_&&!N&&(this.openDragLock&&this.openDragLock(),this.openDragLock=hw(_),!this.openDragLock))return;this.latestPointerEvent=b,this.latestPanInfo=j,this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),_i(E=>{let T=this.getAxisMotionValue(E).get()||0;if(Qi.test(T)){const{projection:D}=this.visualElement;if(D&&D.layout){const O=D.layout.layoutBox[E];O&&(T=Hs(O)*(parseFloat(T)/100))}}this.originPoint[E]=T}),M&&pn.postRender(()=>M(b,j)),cf(this.visualElement,"transform");const{animationState:R}=this.visualElement;R&&R.setActive("whileDrag",!0)},m=(b,j)=>{this.latestPointerEvent=b,this.latestPanInfo=j;const{dragPropagation:_,dragDirectionLock:N,onDirectionLock:M,onDrag:R}=this.getProps();if(!_&&!this.openDragLock)return;const{offset:E}=j;if(N&&this.currentDirection===null){this.currentDirection=pN(E),this.currentDirection!==null&&M&&M(this.currentDirection);return}this.updateAxis("x",j.point,E),this.updateAxis("y",j.point,E),this.visualElement.render(),R&&R(b,j)},h=(b,j)=>{this.latestPointerEvent=b,this.latestPanInfo=j,this.stop(b,j),this.latestPointerEvent=null,this.latestPanInfo=null},x=()=>_i(b=>this.getAnimationState(b)==="paused"&&this.getAxisMotionValue(b).animation?.play()),{dragSnapToOrigin:g}=this.getProps();this.panSession=new c2(s,{onSessionStart:u,onStart:p,onMove:m,onSessionEnd:h,resumeAnimation:x},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:g,distanceThreshold:o,contextWindow:l2(this.visualElement)})}stop(s,r){const o=s||this.latestPointerEvent,c=r||this.latestPanInfo,u=this.isDragging;if(this.cancel(),!u||!c||!o)return;const{velocity:p}=c;this.startAnimation(p);const{onDragEnd:m}=this.getProps();m&&pn.postRender(()=>m(o,c))}cancel(){this.isDragging=!1;const{projection:s,animationState:r}=this.visualElement;s&&(s.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:o}=this.getProps();!o&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),r&&r.setActive("whileDrag",!1)}updateAxis(s,r,o){const{drag:c}=this.getProps();if(!o||!X0(s,c,this.currentDirection))return;const u=this.getAxisMotionValue(s);let p=this.originPoint[s]+o[s];this.constraints&&this.constraints[s]&&(p=sN(p,this.constraints[s],this.elastic[s])),u.set(p)}resolveConstraints(){const{dragConstraints:s,dragElastic:r}=this.getProps(),o=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):this.visualElement.projection?.layout,c=this.constraints;s&&fl(s)?this.constraints||(this.constraints=this.resolveRefConstraints()):s&&o?this.constraints=iN(o.layoutBox,s):this.constraints=!1,this.elastic=cN(r),c!==this.constraints&&o&&this.constraints&&!this.hasMutatedConstraints&&_i(u=>{this.constraints!==!1&&this.getAxisMotionValue(u)&&(this.constraints[u]=lN(o.layoutBox[u],this.constraints[u]))})}resolveRefConstraints(){const{dragConstraints:s,onMeasureDragConstraints:r}=this.getProps();if(!s||!fl(s))return!1;const o=s.current,{projection:c}=this.visualElement;if(!c||!c.layout)return!1;const u=f4(o,c.root,this.visualElement.getTransformPagePoint());let p=rN(c.layout.layoutBox,u);if(r){const m=r(d4(p));this.hasMutatedConstraints=!!m,m&&(p=Fb(m))}return p}startAnimation(s){const{drag:r,dragMomentum:o,dragElastic:c,dragTransition:u,dragSnapToOrigin:p,onDragTransitionEnd:m}=this.getProps(),h=this.constraints||{},x=_i(g=>{if(!X0(g,r,this.currentDirection))return;let b=h&&h[g]||{};p&&(b={min:0,max:0});const j=c?200:1e6,_=c?40:1e7,N={type:"inertia",velocity:o?s[g]:0,bounceStiffness:j,bounceDamping:_,timeConstant:750,restDelta:1,restSpeed:10,...u,...b};return this.startAxisValueAnimation(g,N)});return Promise.all(x).then(m)}startAxisValueAnimation(s,r){const o=this.getAxisMotionValue(s);return cf(this.visualElement,s),o.start(tm(s,o,0,r,this.visualElement,!1))}stopAnimation(){_i(s=>this.getAxisMotionValue(s).stop())}pauseAnimation(){_i(s=>this.getAxisMotionValue(s).animation?.pause())}getAnimationState(s){return this.getAxisMotionValue(s).animation?.state}getAxisMotionValue(s){const r=`_drag${s.toUpperCase()}`,o=this.visualElement.getProps(),c=o[r];return c||this.visualElement.getValue(s,(o.initial?o.initial[s]:void 0)||0)}snapToCursor(s){_i(r=>{const{drag:o}=this.getProps();if(!X0(r,o,this.currentDirection))return;const{projection:c}=this.visualElement,u=this.getAxisMotionValue(r);if(c&&c.layout){const{min:p,max:m}=c.layout.layoutBox[r];u.set(s[r]-_n(p,m,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:s,dragConstraints:r}=this.getProps(),{projection:o}=this.visualElement;if(!fl(r)||!o||!this.constraints)return;this.stopAnimation();const c={x:0,y:0};_i(p=>{const m=this.getAxisMotionValue(p);if(m&&this.constraints!==!1){const h=m.get();c[p]=oN({min:h,max:h},this.constraints[p])}});const{transformTemplate:u}=this.visualElement.getProps();this.visualElement.current.style.transform=u?u({},""):"none",o.root&&o.root.updateScroll(),o.updateLayout(),this.resolveConstraints(),_i(p=>{if(!X0(p,s,null))return;const m=this.getAxisMotionValue(p),{min:h,max:x}=this.constraints[p];m.set(_n(h,x,c[p]))})}addListeners(){if(!this.visualElement.current)return;dN.set(this.visualElement,this);const s=this.visualElement.current,r=jc(s,"pointerdown",h=>{const{drag:x,dragListener:g=!0}=this.getProps();x&&g&&this.start(h)}),o=()=>{const{dragConstraints:h}=this.getProps();fl(h)&&h.current&&(this.constraints=this.resolveRefConstraints())},{projection:c}=this.visualElement,u=c.addEventListener("measure",o);c&&!c.layout&&(c.root&&c.root.updateScroll(),c.updateLayout()),pn.read(o);const p=kc(window,"resize",()=>this.scalePositionWithinConstraints()),m=c.addEventListener("didUpdate",(({delta:h,hasLayoutChanged:x})=>{this.isDragging&&x&&(_i(g=>{const b=this.getAxisMotionValue(g);b&&(this.originPoint[g]+=h[g].translate,b.set(b.get()+h[g].translate))}),this.visualElement.render())}));return()=>{p(),r(),u(),m&&m()}}getProps(){const s=this.visualElement.getProps(),{drag:r=!1,dragDirectionLock:o=!1,dragPropagation:c=!1,dragConstraints:u=!1,dragElastic:p=uf,dragMomentum:m=!0}=s;return{...s,drag:r,dragDirectionLock:o,dragPropagation:c,dragConstraints:u,dragElastic:p,dragMomentum:m}}}function X0(t,s,r){return(s===!0||s===t)&&(r===null||r===t)}function pN(t,s=10){let r=null;return Math.abs(t.y)>s?r="y":Math.abs(t.x)>s&&(r="x"),r}class fN extends Zr{constructor(s){super(s),this.removeGroupControls=ki,this.removeListeners=ki,this.controls=new uN(s)}mount(){const{dragControls:s}=this.node.getProps();s&&(this.removeGroupControls=s.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||ki}unmount(){this.removeGroupControls(),this.removeListeners()}}const Ag=t=>(s,r)=>{t&&pn.postRender(()=>t(s,r))};class mN extends Zr{constructor(){super(...arguments),this.removePointerDownListener=ki}onPointerDown(s){this.session=new c2(s,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:l2(this.node)})}createPanHandlers(){const{onPanSessionStart:s,onPanStart:r,onPan:o,onPanEnd:c}=this.node.getProps();return{onSessionStart:Ag(s),onStart:Ag(r),onMove:o,onEnd:(u,p)=>{delete this.session,c&&pn.postRender(()=>c(u,p))}}}mount(){this.removePointerDownListener=jc(this.node.current,"pointerdown",s=>this.onPointerDown(s))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const td={hasAnimatedSinceResize:!0,hasEverUpdated:!1};let _p=!1;class hN extends $.Component{componentDidMount(){const{visualElement:s,layoutGroup:r,switchLayoutGroup:o,layoutId:c}=this.props,{projection:u}=s;u&&(r.group&&r.group.add(u),o&&o.register&&c&&o.register(u),_p&&u.root.didUpdate(),u.addEventListener("animationComplete",()=>{this.safeToRemove()}),u.setOptions({...u.options,onExitComplete:()=>this.safeToRemove()})),td.hasEverUpdated=!0}getSnapshotBeforeUpdate(s){const{layoutDependency:r,visualElement:o,drag:c,isPresent:u}=this.props,{projection:p}=o;return p&&(p.isPresent=u,_p=!0,c||s.layoutDependency!==r||r===void 0||s.isPresent!==u?p.willUpdate():this.safeToRemove(),s.isPresent!==u&&(u?p.promote():p.relegate()||pn.postRender(()=>{const m=p.getStack();(!m||!m.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:s}=this.props.visualElement;s&&(s.root.didUpdate(),qf.postRender(()=>{!s.currentAnimation&&s.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:s,layoutGroup:r,switchLayoutGroup:o}=this.props,{projection:c}=s;_p=!0,c&&(c.scheduleCheckAfterUnmount(),r&&r.group&&r.group.remove(c),o&&o.deregister&&o.deregister(c))}safeToRemove(){const{safeToRemove:s}=this.props;s&&s()}render(){return null}}function u2(t){const[s,r]=Db(),o=$.useContext(_f);return a.jsx(hN,{...t,layoutGroup:o,switchLayoutGroup:$.useContext(qb),isPresent:s,safeToRemove:r})}function xN(t,s,r){const o=bs(t)?t:Po(t);return o.start(tm("",o,s,r)),o.animation}const gN=(t,s)=>t.depth-s.depth;class yN{constructor(){this.children=[],this.isDirty=!1}add(s){Cf(this.children,s),this.isDirty=!0}remove(s){Tf(this.children,s),this.isDirty=!0}forEach(s){this.isDirty&&this.children.sort(gN),this.isDirty=!1,this.children.forEach(s)}}function bN(t,s){const r=ri.now(),o=({timestamp:c})=>{const u=c-r;u>=s&&(br(o),t(u-s))};return pn.setup(o,!0),()=>br(o)}const p2=["TopLeft","TopRight","BottomLeft","BottomRight"],vN=p2.length,Pg=t=>typeof t=="string"?parseFloat(t):t,Dg=t=>typeof t=="number"||Xt.test(t);function jN(t,s,r,o,c,u){c?(t.opacity=_n(0,r.opacity??1,wN(o)),t.opacityExit=_n(s.opacity??1,0,NN(o))):u&&(t.opacity=_n(s.opacity??1,r.opacity??1,o));for(let p=0;p<vN;p++){const m=`border${p2[p]}Radius`;let h=Rg(s,m),x=Rg(r,m);if(h===void 0&&x===void 0)continue;h||(h=0),x||(x=0),h===0||x===0||Dg(h)===Dg(x)?(t[m]=Math.max(_n(Pg(h),Pg(x),o),0),(Qi.test(x)||Qi.test(h))&&(t[m]+="%")):t[m]=x}(s.rotate||r.rotate)&&(t.rotate=_n(s.rotate||0,r.rotate||0,o))}function Rg(t,s){return t[s]!==void 0?t[s]:t.borderRadius}const wN=f2(0,.5,Qy),NN=f2(.5,.95,ki);function f2(t,s,r){return o=>o<t?0:o>s?1:r(Nc(t,s,o))}function $g(t,s){t.min=s.min,t.max=s.max}function Bi(t,s){$g(t.x,s.x),$g(t.y,s.y)}function Og(t,s){t.translate=s.translate,t.scale=s.scale,t.originPoint=s.originPoint,t.origin=s.origin}function zg(t,s,r,o,c){return t-=s,t=ud(t,1/r,o),c!==void 0&&(t=ud(t,1/c,o)),t}function MN(t,s=0,r=1,o=.5,c,u=t,p=t){if(Qi.test(s)&&(s=parseFloat(s),s=_n(p.min,p.max,s/100)-p.min),typeof s!="number")return;let m=_n(u.min,u.max,o);t===u&&(m-=s),t.min=zg(t.min,s,r,m,c),t.max=zg(t.max,s,r,m,c)}function Bg(t,s,[r,o,c],u,p){MN(t,s[r],s[o],s[c],s.scale,u,p)}const _N=["x","scaleX","originX"],EN=["y","scaleY","originY"];function Lg(t,s,r,o){Bg(t.x,s,_N,r?r.x:void 0,o?o.x:void 0),Bg(t.y,s,EN,r?r.y:void 0,o?o.y:void 0)}function Vg(t){return t.translate===0&&t.scale===1}function m2(t){return Vg(t.x)&&Vg(t.y)}function Wg(t,s){return t.min===s.min&&t.max===s.max}function kN(t,s){return Wg(t.x,s.x)&&Wg(t.y,s.y)}function Ug(t,s){return Math.round(t.min)===Math.round(s.min)&&Math.round(t.max)===Math.round(s.max)}function h2(t,s){return Ug(t.x,s.x)&&Ug(t.y,s.y)}function Ig(t){return Hs(t.x)/Hs(t.y)}function Hg(t,s){return t.translate===s.translate&&t.scale===s.scale&&t.originPoint===s.originPoint}class CN{constructor(){this.members=[]}add(s){Cf(this.members,s),s.scheduleRender()}remove(s){if(Tf(this.members,s),s===this.prevLead&&(this.prevLead=void 0),s===this.lead){const r=this.members[this.members.length-1];r&&this.promote(r)}}relegate(s){const r=this.members.findIndex(c=>s===c);if(r===0)return!1;let o;for(let c=r;c>=0;c--){const u=this.members[c];if(u.isPresent!==!1){o=u;break}}return o?(this.promote(o),!0):!1}promote(s,r){const o=this.lead;if(s!==o&&(this.prevLead=o,this.lead=s,s.show(),o)){o.instance&&o.scheduleRender(),s.scheduleRender(),s.resumeFrom=o,r&&(s.resumeFrom.preserveOpacity=!0),o.snapshot&&(s.snapshot=o.snapshot,s.snapshot.latestValues=o.animationValues||o.latestValues),s.root&&s.root.isUpdating&&(s.isLayoutDirty=!0);const{crossfade:c}=s.options;c===!1&&o.hide()}}exitAnimationComplete(){this.members.forEach(s=>{const{options:r,resumingFrom:o}=s;r.onExitComplete&&r.onExitComplete(),o&&o.options.onExitComplete&&o.options.onExitComplete()})}scheduleRender(){this.members.forEach(s=>{s.instance&&s.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function TN(t,s,r){let o="";const c=t.x.translate/s.x,u=t.y.translate/s.y,p=r?.z||0;if((c||u||p)&&(o=`translate3d(${c}px, ${u}px, ${p}px) `),(s.x!==1||s.y!==1)&&(o+=`scale(${1/s.x}, ${1/s.y}) `),r){const{transformPerspective:x,rotate:g,rotateX:b,rotateY:j,skewX:_,skewY:N}=r;x&&(o=`perspective(${x}px) ${o}`),g&&(o+=`rotate(${g}deg) `),b&&(o+=`rotateX(${b}deg) `),j&&(o+=`rotateY(${j}deg) `),_&&(o+=`skewX(${_}deg) `),N&&(o+=`skewY(${N}deg) `)}const m=t.x.scale*s.x,h=t.y.scale*s.y;return(m!==1||h!==1)&&(o+=`scale(${m}, ${h})`),o||"none"}const Ep=["","X","Y","Z"],SN=1e3;let AN=0;function kp(t,s,r,o){const{latestValues:c}=s;c[t]&&(r[t]=c[t],s.setStaticValue(t,0),o&&(o[t]=0))}function x2(t){if(t.hasCheckedOptimisedAppear=!0,t.root===t)return;const{visualElement:s}=t.options;if(!s)return;const r=t2(s);if(window.MotionHasOptimisedAnimation(r,"transform")){const{layout:c,layoutId:u}=t.options;window.MotionCancelOptimisedAnimation(r,"transform",pn,!(c||u))}const{parent:o}=t;o&&!o.hasCheckedOptimisedAppear&&x2(o)}function g2({attachResizeListener:t,defaultParent:s,measureScroll:r,checkIsScrollRoot:o,resetTransform:c}){return class{constructor(p={},m=s?.()){this.id=AN++,this.animationId=0,this.animationCommitId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.layoutVersion=0,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,this.nodes.forEach(RN),this.nodes.forEach(BN),this.nodes.forEach(LN),this.nodes.forEach($N)},this.resolvedRelativeTargetAt=0,this.linkedParentVersion=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=p,this.root=m?m.root||m:this,this.path=m?[...m.path,m]:[],this.parent=m,this.depth=m?m.depth+1:0;for(let h=0;h<this.path.length;h++)this.path[h].shouldResetTransform=!0;this.root===this&&(this.nodes=new yN)}addEventListener(p,m){return this.eventHandlers.has(p)||this.eventHandlers.set(p,new Pf),this.eventHandlers.get(p).add(m)}notifyListeners(p,...m){const h=this.eventHandlers.get(p);h&&h.notify(...m)}hasListeners(p){return this.eventHandlers.has(p)}mount(p){if(this.instance)return;this.isSVG=Pb(p)&&!jw(p),this.instance=p;const{layoutId:m,layout:h,visualElement:x}=this.options;if(x&&!x.current&&x.mount(p),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),this.root.hasTreeAnimated&&(h||m)&&(this.isLayoutDirty=!0),t){let g,b=0;const j=()=>this.root.updateBlockedByResize=!1;pn.read(()=>{b=window.innerWidth}),t(p,()=>{const _=window.innerWidth;_!==b&&(b=_,this.root.updateBlockedByResize=!0,g&&g(),g=bN(j,250),td.hasAnimatedSinceResize&&(td.hasAnimatedSinceResize=!1,this.nodes.forEach(Fg)))})}m&&this.root.registerSharedNode(m,this),this.options.animate!==!1&&x&&(m||h)&&this.addEventListener("didUpdate",({delta:g,hasLayoutChanged:b,hasRelativeLayoutChanged:j,layout:_})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const N=this.options.transition||x.getDefaultTransition()||HN,{onLayoutAnimationStart:M,onLayoutAnimationComplete:R}=x.getProps(),E=!this.targetLayout||!h2(this.targetLayout,_),T=!b&&j;if(this.options.layoutRoot||this.resumeFrom||T||b&&(E||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0);const D={...If(N,"layout"),onPlay:M,onComplete:R};(x.shouldReduceMotion||this.options.layoutRoot)&&(D.delay=0,D.type=!1),this.startAnimation(D),this.setAnimationOrigin(g,T)}else b||Fg(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=_})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const p=this.getStack();p&&p.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,this.eventHandlers.clear(),br(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(VN),this.animationId++)}getTransformTemplate(){const{visualElement:p}=this.options;return p&&p.getProps().transformTemplate}willUpdate(p=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&x2(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let g=0;g<this.path.length;g++){const b=this.path[g];b.shouldResetTransform=!0,b.updateScroll("snapshot"),b.options.layoutRoot&&b.willUpdate(!1)}const{layoutId:m,layout:h}=this.options;if(m===void 0&&!h)return;const x=this.getTransformTemplate();this.prevTransformTemplateValue=x?x(this.latestValues,""):void 0,this.updateSnapshot(),p&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(qg);return}if(this.animationId<=this.animationCommitId){this.nodes.forEach(Gg);return}this.animationCommitId=this.animationId,this.isUpdating?(this.isUpdating=!1,this.nodes.forEach(zN),this.nodes.forEach(PN),this.nodes.forEach(DN)):this.nodes.forEach(Gg),this.clearAllSnapshots();const m=ri.now();Ss.delta=gr(0,1e3/60,m-Ss.timestamp),Ss.timestamp=m,Ss.isProcessing=!0,hp.update.process(Ss),hp.preRender.process(Ss),hp.render.process(Ss),Ss.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,qf.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(ON),this.sharedNodes.forEach(WN)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,pn.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){pn.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure(),this.snapshot&&!Hs(this.snapshot.measuredBox.x)&&!Hs(this.snapshot.measuredBox.y)&&(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let h=0;h<this.path.length;h++)this.path[h].updateScroll();const p=this.layout;this.layout=this.measure(!1),this.layoutVersion++,this.layoutCorrected=ds(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:m}=this.options;m&&m.notify("LayoutMeasure",this.layout.layoutBox,p?p.layoutBox:void 0)}updateScroll(p="measure"){let m=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===p&&(m=!1),m&&this.instance){const h=o(this.instance);this.scroll={animationId:this.root.animationId,phase:p,isRoot:h,offset:r(this.instance),wasRoot:this.scroll?this.scroll.isRoot:h}}}resetTransform(){if(!c)return;const p=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,m=this.projectionDelta&&!m2(this.projectionDelta),h=this.getTransformTemplate(),x=h?h(this.latestValues,""):void 0,g=x!==this.prevTransformTemplateValue;p&&this.instance&&(m||jo(this.latestValues)||g)&&(c(this.instance,x),this.shouldResetTransform=!1,this.scheduleRender())}measure(p=!0){const m=this.measurePageBox();let h=this.removeElementScroll(m);return p&&(h=this.removeTransform(h)),qN(h),{animationId:this.root.animationId,measuredBox:m,layoutBox:h,latestValues:{},source:this.id}}measurePageBox(){const{visualElement:p}=this.options;if(!p)return ds();const m=p.measureViewportBox();if(!(this.scroll?.wasRoot||this.path.some(GN))){const{scroll:x}=this.root;x&&(ml(m.x,x.offset.x),ml(m.y,x.offset.y))}return m}removeElementScroll(p){const m=ds();if(Bi(m,p),this.scroll?.wasRoot)return m;for(let h=0;h<this.path.length;h++){const x=this.path[h],{scroll:g,options:b}=x;x!==this.root&&g&&b.layoutScroll&&(g.wasRoot&&Bi(m,p),ml(m.x,g.offset.x),ml(m.y,g.offset.y))}return m}applyTransform(p,m=!1){const h=ds();Bi(h,p);for(let x=0;x<this.path.length;x++){const g=this.path[x];!m&&g.options.layoutScroll&&g.scroll&&g!==g.root&&hl(h,{x:-g.scroll.offset.x,y:-g.scroll.offset.y}),jo(g.latestValues)&&hl(h,g.latestValues)}return jo(this.latestValues)&&hl(h,this.latestValues),h}removeTransform(p){const m=ds();Bi(m,p);for(let h=0;h<this.path.length;h++){const x=this.path[h];if(!x.instance||!jo(x.latestValues))continue;sf(x.latestValues)&&x.updateSnapshot();const g=ds(),b=x.measurePageBox();Bi(g,b),Lg(m,x.latestValues,x.snapshot?x.snapshot.layoutBox:void 0,g)}return jo(this.latestValues)&&Lg(m,this.latestValues),m}setTargetDelta(p){this.targetDelta=p,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(p){this.options={...this.options,...p,crossfade:p.crossfade!==void 0?p.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==Ss.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(p=!1){const m=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=m.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=m.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=m.isSharedProjectionDirty);const h=!!this.resumingFrom||this!==m;if(!(p||h&&this.isSharedProjectionDirty||this.isProjectionDirty||this.parent?.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:g,layoutId:b}=this.options;if(!this.layout||!(g||b))return;this.resolvedRelativeTargetAt=Ss.timestamp;const j=this.getClosestProjectingParent();j&&this.linkedParentVersion!==j.layoutVersion&&!j.options.layoutRoot&&this.removeRelativeTarget(),!this.targetDelta&&!this.relativeTarget&&(j&&j.layout?this.createRelativeTarget(j,this.layout.layoutBox,j.layout.layoutBox):this.removeRelativeTarget()),!(!this.relativeTarget&&!this.targetDelta)&&(this.target||(this.target=ds(),this.targetWithTransforms=ds()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),eN(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):Bi(this.target,this.layout.layoutBox),Xb(this.target,this.targetDelta)):Bi(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget&&(this.attemptToResolveRelativeTarget=!1,j&&!!j.resumingFrom==!!this.resumingFrom&&!j.options.layoutScroll&&j.target&&this.animationProgress!==1?this.createRelativeTarget(j,this.target,j.target):this.relativeParent=this.relativeTarget=void 0))}getClosestProjectingParent(){if(!(!this.parent||sf(this.parent.latestValues)||Yb(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}createRelativeTarget(p,m,h){this.relativeParent=p,this.linkedParentVersion=p.layoutVersion,this.forceRelativeParentToResolveTarget(),this.relativeTarget=ds(),this.relativeTargetOrigin=ds(),pd(this.relativeTargetOrigin,m,h),Bi(this.relativeTarget,this.relativeTargetOrigin)}removeRelativeTarget(){this.relativeParent=this.relativeTarget=void 0}calcProjection(){const p=this.getLead(),m=!!this.resumingFrom||this!==p;let h=!0;if((this.isProjectionDirty||this.parent?.isProjectionDirty)&&(h=!1),m&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(h=!1),this.resolvedRelativeTargetAt===Ss.timestamp&&(h=!1),h)return;const{layout:x,layoutId:g}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(x||g))return;Bi(this.layoutCorrected,this.layout.layoutBox);const b=this.treeScale.x,j=this.treeScale.y;p4(this.layoutCorrected,this.treeScale,this.path,m),p.layout&&!p.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(p.target=p.layout.layoutBox,p.targetWithTransforms=ds());const{target:_}=p;if(!_){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(Og(this.prevProjectionDelta.x,this.projectionDelta.x),Og(this.prevProjectionDelta.y,this.projectionDelta.y)),wc(this.projectionDelta,this.layoutCorrected,_,this.latestValues),(this.treeScale.x!==b||this.treeScale.y!==j||!Hg(this.projectionDelta.x,this.prevProjectionDelta.x)||!Hg(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",_))}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(p=!0){if(this.options.visualElement?.scheduleRender(),p){const m=this.getStack();m&&m.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=xl(),this.projectionDelta=xl(),this.projectionDeltaWithTransform=xl()}setAnimationOrigin(p,m=!1){const h=this.snapshot,x=h?h.latestValues:{},g={...this.latestValues},b=xl();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!m;const j=ds(),_=h?h.source:void 0,N=this.layout?this.layout.source:void 0,M=_!==N,R=this.getStack(),E=!R||R.members.length<=1,T=!!(M&&!E&&this.options.crossfade===!0&&!this.path.some(IN));this.animationProgress=0;let D;this.mixTargetDelta=O=>{const q=O/1e3;Yg(b.x,p.x,q),Yg(b.y,p.y,q),this.setTargetDelta(b),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(pd(j,this.layout.layoutBox,this.relativeParent.layout.layoutBox),UN(this.relativeTarget,this.relativeTargetOrigin,j,q),D&&kN(this.relativeTarget,D)&&(this.isProjectionDirty=!1),D||(D=ds()),Bi(D,this.relativeTarget)),M&&(this.animationValues=g,jN(g,x,this.latestValues,q,T,E)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=q},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(p){this.notifyListeners("animationStart"),this.currentAnimation?.stop(),this.resumingFrom?.currentAnimation?.stop(),this.pendingAnimation&&(br(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=pn.update(()=>{td.hasAnimatedSinceResize=!0,this.motionValue||(this.motionValue=Po(0)),this.currentAnimation=xN(this.motionValue,[0,1e3],{...p,velocity:0,isSync:!0,onUpdate:m=>{this.mixTargetDelta(m),p.onUpdate&&p.onUpdate(m)},onStop:()=>{},onComplete:()=>{p.onComplete&&p.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const p=this.getStack();p&&p.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(SN),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const p=this.getLead();let{targetWithTransforms:m,target:h,layout:x,latestValues:g}=p;if(!(!m||!h||!x)){if(this!==p&&this.layout&&x&&y2(this.options.animationType,this.layout.layoutBox,x.layoutBox)){h=this.target||ds();const b=Hs(this.layout.layoutBox.x);h.x.min=p.target.x.min,h.x.max=h.x.min+b;const j=Hs(this.layout.layoutBox.y);h.y.min=p.target.y.min,h.y.max=h.y.min+j}Bi(m,h),hl(m,g),wc(this.projectionDeltaWithTransform,this.layoutCorrected,m,g)}}registerSharedNode(p,m){this.sharedNodes.has(p)||this.sharedNodes.set(p,new CN),this.sharedNodes.get(p).add(m);const x=m.options.initialPromotionConfig;m.promote({transition:x?x.transition:void 0,preserveFollowOpacity:x&&x.shouldPreserveFollowOpacity?x.shouldPreserveFollowOpacity(m):void 0})}isLead(){const p=this.getStack();return p?p.lead===this:!0}getLead(){const{layoutId:p}=this.options;return p?this.getStack()?.lead||this:this}getPrevLead(){const{layoutId:p}=this.options;return p?this.getStack()?.prevLead:void 0}getStack(){const{layoutId:p}=this.options;if(p)return this.root.sharedNodes.get(p)}promote({needsReset:p,transition:m,preserveFollowOpacity:h}={}){const x=this.getStack();x&&x.promote(this,h),p&&(this.projectionDelta=void 0,this.needsReset=!0),m&&this.setOptions({transition:m})}relegate(){const p=this.getStack();return p?p.relegate(this):!1}resetSkewAndRotation(){const{visualElement:p}=this.options;if(!p)return;let m=!1;const{latestValues:h}=p;if((h.z||h.rotate||h.rotateX||h.rotateY||h.rotateZ||h.skewX||h.skewY)&&(m=!0),!m)return;const x={};h.z&&kp("z",p,x,this.animationValues);for(let g=0;g<Ep.length;g++)kp(`rotate${Ep[g]}`,p,x,this.animationValues),kp(`skew${Ep[g]}`,p,x,this.animationValues);p.render();for(const g in x)p.setStaticValue(g,x[g]),this.animationValues&&(this.animationValues[g]=x[g]);p.scheduleRender()}applyProjectionStyles(p,m){if(!this.instance||this.isSVG)return;if(!this.isVisible){p.visibility="hidden";return}const h=this.getTransformTemplate();if(this.needsReset){this.needsReset=!1,p.visibility="",p.opacity="",p.pointerEvents=ed(m?.pointerEvents)||"",p.transform=h?h(this.latestValues,""):"none";return}const x=this.getLead();if(!this.projectionDelta||!this.layout||!x.target){this.options.layoutId&&(p.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,p.pointerEvents=ed(m?.pointerEvents)||""),this.hasProjected&&!jo(this.latestValues)&&(p.transform=h?h({},""):"none",this.hasProjected=!1);return}p.visibility="";const g=x.animationValues||x.latestValues;this.applyTransformsToTarget();let b=TN(this.projectionDeltaWithTransform,this.treeScale,g);h&&(b=h(g,b)),p.transform=b;const{x:j,y:_}=this.projectionDelta;p.transformOrigin=`${j.origin*100}% ${_.origin*100}% 0`,x.animationValues?p.opacity=x===this?g.opacity??this.latestValues.opacity??1:this.preserveOpacity?this.latestValues.opacity:g.opacityExit:p.opacity=x===this?g.opacity!==void 0?g.opacity:"":g.opacityExit!==void 0?g.opacityExit:0;for(const N in nf){if(g[N]===void 0)continue;const{correct:M,applyTo:R,isCSSVariable:E}=nf[N],T=b==="none"?g[N]:M(g[N],x);if(R){const D=R.length;for(let O=0;O<D;O++)p[R[O]]=T}else E?this.options.visualElement.renderState.vars[N]=T:p[N]=T}this.options.layoutId&&(p.pointerEvents=x===this?ed(m?.pointerEvents)||"":"none")}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(p=>p.currentAnimation?.stop()),this.root.nodes.forEach(qg),this.root.sharedNodes.clear()}}}function PN(t){t.updateLayout()}function DN(t){const s=t.resumeFrom?.snapshot||t.snapshot;if(t.isLead()&&t.layout&&s&&t.hasListeners("didUpdate")){const{layoutBox:r,measuredBox:o}=t.layout,{animationType:c}=t.options,u=s.source!==t.layout.source;c==="size"?_i(g=>{const b=u?s.measuredBox[g]:s.layoutBox[g],j=Hs(b);b.min=r[g].min,b.max=b.min+j}):y2(c,s.layoutBox,r)&&_i(g=>{const b=u?s.measuredBox[g]:s.layoutBox[g],j=Hs(r[g]);b.max=b.min+j,t.relativeTarget&&!t.currentAnimation&&(t.isProjectionDirty=!0,t.relativeTarget[g].max=t.relativeTarget[g].min+j)});const p=xl();wc(p,r,s.layoutBox);const m=xl();u?wc(m,t.applyTransform(o,!0),s.measuredBox):wc(m,r,s.layoutBox);const h=!m2(p);let x=!1;if(!t.resumeFrom){const g=t.getClosestProjectingParent();if(g&&!g.resumeFrom){const{snapshot:b,layout:j}=g;if(b&&j){const _=ds();pd(_,s.layoutBox,b.layoutBox);const N=ds();pd(N,r,j.layoutBox),h2(_,N)||(x=!0),g.options.layoutRoot&&(t.relativeTarget=N,t.relativeTargetOrigin=_,t.relativeParent=g)}}}t.notifyListeners("didUpdate",{layout:r,snapshot:s,delta:m,layoutDelta:p,hasLayoutChanged:h,hasRelativeLayoutChanged:x})}else if(t.isLead()){const{onExitComplete:r}=t.options;r&&r()}t.options.transition=void 0}function RN(t){t.parent&&(t.isProjecting()||(t.isProjectionDirty=t.parent.isProjectionDirty),t.isSharedProjectionDirty||(t.isSharedProjectionDirty=!!(t.isProjectionDirty||t.parent.isProjectionDirty||t.parent.isSharedProjectionDirty)),t.isTransformDirty||(t.isTransformDirty=t.parent.isTransformDirty))}function $N(t){t.isProjectionDirty=t.isSharedProjectionDirty=t.isTransformDirty=!1}function ON(t){t.clearSnapshot()}function qg(t){t.clearMeasurements()}function Gg(t){t.isLayoutDirty=!1}function zN(t){const{visualElement:s}=t.options;s&&s.getProps().onBeforeLayoutMeasure&&s.notify("BeforeLayoutMeasure"),t.resetTransform()}function Fg(t){t.finishAnimation(),t.targetDelta=t.relativeTarget=t.target=void 0,t.isProjectionDirty=!0}function BN(t){t.resolveTargetDelta()}function LN(t){t.calcProjection()}function VN(t){t.resetSkewAndRotation()}function WN(t){t.removeLeadSnapshot()}function Yg(t,s,r){t.translate=_n(s.translate,0,r),t.scale=_n(s.scale,1,r),t.origin=s.origin,t.originPoint=s.originPoint}function Xg(t,s,r,o){t.min=_n(s.min,r.min,o),t.max=_n(s.max,r.max,o)}function UN(t,s,r,o){Xg(t.x,s.x,r.x,o),Xg(t.y,s.y,r.y,o)}function IN(t){return t.animationValues&&t.animationValues.opacityExit!==void 0}const HN={duration:.45,ease:[.4,0,.1,1]},Zg=t=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(t),Qg=Zg("applewebkit/")&&!Zg("chrome/")?Math.round:ki;function Jg(t){t.min=Qg(t.min),t.max=Qg(t.max)}function qN(t){Jg(t.x),Jg(t.y)}function y2(t,s,r){return t==="position"||t==="preserve-aspect"&&!K4(Ig(s),Ig(r),.2)}function GN(t){return t!==t.root&&t.scroll?.wasRoot}const FN=g2({attachResizeListener:(t,s)=>kc(t,"resize",s),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),Cp={current:void 0},b2=g2({measureScroll:t=>({x:t.scrollLeft,y:t.scrollTop}),defaultParent:()=>{if(!Cp.current){const t=new FN({});t.mount(window),t.setOptions({layoutScroll:!0}),Cp.current=t}return Cp.current},resetTransform:(t,s)=>{t.style.transform=s!==void 0?s:"none"},checkIsScrollRoot:t=>window.getComputedStyle(t).position==="fixed"}),YN={pan:{Feature:mN},drag:{Feature:fN,ProjectionNode:b2,MeasureLayout:u2}};function Kg(t,s,r){const{props:o}=t;t.animationState&&o.whileHover&&t.animationState.setActive("whileHover",r==="Start");const c="onHover"+r,u=o[c];u&&pn.postRender(()=>u(s,Dc(s)))}class XN extends Zr{mount(){const{current:s}=this.node;s&&(this.unmount=xw(s,(r,o)=>(Kg(this.node,o,"Start"),c=>Kg(this.node,c,"End"))))}unmount(){}}class ZN extends Zr{constructor(){super(...arguments),this.isActive=!1}onFocus(){let s=!1;try{s=this.node.current.matches(":focus-visible")}catch{s=!0}!s||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=Tc(kc(this.node.current,"focus",()=>this.onFocus()),kc(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function ey(t,s,r){const{props:o}=t;if(t.current instanceof HTMLButtonElement&&t.current.disabled)return;t.animationState&&o.whileTap&&t.animationState.setActive("whileTap",r==="Start");const c="onTap"+(r==="End"?"":r),u=o[c];u&&pn.postRender(()=>u(s,Dc(s)))}class QN extends Zr{mount(){const{current:s}=this.node;s&&(this.unmount=vw(s,(r,o)=>(ey(this.node,o,"Start"),(c,{success:u})=>ey(this.node,c,u?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const pf=new WeakMap,Tp=new WeakMap,JN=t=>{const s=pf.get(t.target);s&&s(t)},KN=t=>{t.forEach(JN)};function eM({root:t,...s}){const r=t||document;Tp.has(r)||Tp.set(r,{});const o=Tp.get(r),c=JSON.stringify(s);return o[c]||(o[c]=new IntersectionObserver(KN,{root:t,...s})),o[c]}function tM(t,s,r){const o=eM(s);return pf.set(t,r),o.observe(t),()=>{pf.delete(t),o.unobserve(t)}}const aM={some:0,all:1};class nM extends Zr{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:s={}}=this.node.getProps(),{root:r,margin:o,amount:c="some",once:u}=s,p={root:r?r.current:void 0,rootMargin:o,threshold:typeof c=="number"?c:aM[c]},m=h=>{const{isIntersecting:x}=h;if(this.isInView===x||(this.isInView=x,u&&!x&&this.hasEnteredView))return;x&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",x);const{onViewportEnter:g,onViewportLeave:b}=this.node.getProps(),j=x?g:b;j&&j(h)};return tM(this.node.current,p,m)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:s,prevProps:r}=this.node;["amount","margin","root"].some(sM(s,r))&&this.startObserver()}unmount(){}}function sM({viewport:t={}},{viewport:s={}}={}){return r=>t[r]!==s[r]}const iM={inView:{Feature:nM},tap:{Feature:QN},focus:{Feature:ZN},hover:{Feature:XN}},rM={layout:{ProjectionNode:b2,MeasureLayout:u2}},oM={...F4,...iM,...YN,...rM},As=c4(oM,w4);function v2(t){const s=Cc(()=>Po(t)),{isStatic:r}=$.useContext(Pc);if(r){const[,o]=$.useState(t);$.useEffect(()=>s.on("change",o),[])}return s}function j2(t,s){const r=v2(s()),o=()=>r.set(s());return o(),kf(()=>{const c=()=>pn.preRender(o,!1,!0),u=t.map(p=>p.on("change",c));return()=>{u.forEach(p=>p()),br(o)}}),r}function lM(t){vc.current=[],t();const s=j2(vc.current,t);return vc.current=void 0,s}function w2(t,s,r,o){if(typeof t=="function")return lM(t);const c=typeof s=="function"?s:ww(s,r,o);return Array.isArray(t)?ty(t,c):ty([t],([u])=>c(u))}function ty(t,s){const r=Cc(()=>[]);return j2(t,()=>{r.length=0;const o=t.length;for(let c=0;c<o;c++)r[c]=t[c].get();return s(r)})}function cM(t,s={}){const{isStatic:r}=$.useContext(Pc),o=()=>bs(t)?t.get():t;if(r)return w2(o);const c=v2(o());return $.useInsertionEffect(()=>Nw(c,t,s),[c,JSON.stringify(s)]),c}const dM=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),uM=t=>t.replace(/^([A-Z])|[\s-_]+(\w)/g,(s,r,o)=>o?o.toUpperCase():r.toLowerCase()),ay=t=>{const s=uM(t);return s.charAt(0).toUpperCase()+s.slice(1)},N2=(...t)=>t.filter((s,r,o)=>!!s&&s.trim()!==""&&o.indexOf(s)===r).join(" ").trim(),pM=t=>{for(const s in t)if(s.startsWith("aria-")||s==="role"||s==="title")return!0};var fM={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const mM=$.forwardRef(({color:t="currentColor",size:s=24,strokeWidth:r=2,absoluteStrokeWidth:o,className:c="",children:u,iconNode:p,...m},h)=>$.createElement("svg",{ref:h,...fM,width:s,height:s,stroke:t,strokeWidth:o?Number(r)*24/Number(s):r,className:N2("lucide",c),...!u&&!pM(m)&&{"aria-hidden":"true"},...m},[...p.map(([x,g])=>$.createElement(x,g)),...Array.isArray(u)?u:[u]]));const ae=(t,s)=>{const r=$.forwardRef(({className:o,...c},u)=>$.createElement(mM,{ref:u,iconNode:s,className:N2(`lucide-${dM(ay(t))}`,`lucide-${t}`,o),...c}));return r.displayName=ay(t),r};const hM=[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]],xM=ae("activity",hM);const gM=[["path",{d:"M12 6v16",key:"nqf5sj"}],["path",{d:"m19 13 2-1a9 9 0 0 1-18 0l2 1",key:"y7qv08"}],["path",{d:"M9 11h6",key:"1fldmi"}],["circle",{cx:"12",cy:"4",r:"2",key:"muu5ef"}]],yM=ae("anchor",gM);const bM=[["path",{d:"M7 10H6a4 4 0 0 1-4-4 1 1 0 0 1 1-1h4",key:"1hjpb6"}],["path",{d:"M7 5a1 1 0 0 1 1-1h13a1 1 0 0 1 1 1 7 7 0 0 1-7 7H8a1 1 0 0 1-1-1z",key:"1qn45f"}],["path",{d:"M9 12v5",key:"3anwtq"}],["path",{d:"M15 12v5",key:"5xh3zn"}],["path",{d:"M5 20a3 3 0 0 1 3-3h8a3 3 0 0 1 3 3 1 1 0 0 1-1 1H6a1 1 0 0 1-1-1",key:"1fi4x8"}]],vM=ae("anvil",bM);const jM=[["path",{d:"M19 9V6a2 2 0 0 0-2-2H7a2 2 0 0 0-2 2v3",key:"irtipd"}],["path",{d:"M3 16a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-5a2 2 0 0 0-4 0v1.5a.5.5 0 0 1-.5.5h-9a.5.5 0 0 1-.5-.5V11a2 2 0 0 0-4 0z",key:"1qyhux"}],["path",{d:"M5 18v2",key:"ppbyun"}],["path",{d:"M19 18v2",key:"gy7782"}]],wM=ae("armchair",jM);const NM=[["path",{d:"M17 7 7 17",key:"15tmo1"}],["path",{d:"M17 17H7V7",key:"1org7z"}]],MM=ae("arrow-down-left",NM);const _M=[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]],EM=ae("arrow-down",_M);const kM=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],CM=ae("arrow-right",kM);const TM=[["path",{d:"M7 7h10v10",key:"1tivn9"}],["path",{d:"M7 17 17 7",key:"1vkiza"}]],SM=ae("arrow-up-right",TM);const AM=[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]],PM=ae("arrow-up",AM);const DM=[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["path",{d:"M20.2 20.2c2.04-2.03.02-7.36-4.5-11.9-4.54-4.52-9.87-6.54-11.9-4.5-2.04 2.03-.02 7.36 4.5 11.9 4.54 4.52 9.87 6.54 11.9 4.5Z",key:"1l2ple"}],["path",{d:"M15.7 15.7c4.52-4.54 6.54-9.87 4.5-11.9-2.03-2.04-7.36-.02-11.9 4.5-4.52 4.54-6.54 9.87-4.5 11.9 2.03 2.04 7.36.02 11.9-4.5Z",key:"1wam0m"}]],RM=ae("atom",DM);const $M=[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]],OM=ae("award",$M);const zM=[["path",{d:"m14 12-8.381 8.38a1 1 0 0 1-3.001-3L11 9",key:"5z9253"}],["path",{d:"M15 15.5a.5.5 0 0 0 .5.5A6.5 6.5 0 0 0 22 9.5a.5.5 0 0 0-.5-.5h-1.672a2 2 0 0 1-1.414-.586l-5.062-5.062a1.205 1.205 0 0 0-1.704 0L9.352 5.648a1.205 1.205 0 0 0 0 1.704l5.062 5.062A2 2 0 0 1 15 13.828z",key:"19zklq"}]],BM=ae("axe",zM);const LM=[["path",{d:"M 22 14 L 22 10",key:"nqc4tb"}],["rect",{x:"2",y:"6",width:"16",height:"12",rx:"2",key:"13zb55"}]],VM=ae("battery",LM);const WM=[["circle",{cx:"11",cy:"13",r:"9",key:"hd149"}],["path",{d:"M14.35 4.65 16.3 2.7a2.41 2.41 0 0 1 3.4 0l1.6 1.6a2.4 2.4 0 0 1 0 3.4l-1.95 1.95",key:"jp4j1b"}],["path",{d:"m22 2-1.5 1.5",key:"ay92ug"}]],UM=ae("bomb",WM);const IM=[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]],HM=ae("book-open",IM);const qM=[["path",{d:"M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H19a1 1 0 0 1 1 1v18a1 1 0 0 1-1 1H6.5a1 1 0 0 1 0-5H20",key:"k3hazp"}]],GM=ae("book",qM);const FM=[["path",{d:"m19 21-7-4-7 4V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v16z",key:"1fy3hk"}]],YM=ae("bookmark",FM);const XM=[["path",{d:"M2.97 12.92A2 2 0 0 0 2 14.63v3.24a2 2 0 0 0 .97 1.71l3 1.8a2 2 0 0 0 2.06 0L12 19v-5.5l-5-3-4.03 2.42Z",key:"lc1i9w"}],["path",{d:"m7 16.5-4.74-2.85",key:"1o9zyk"}],["path",{d:"m7 16.5 5-3",key:"va8pkn"}],["path",{d:"M7 16.5v5.17",key:"jnp8gn"}],["path",{d:"M12 13.5V19l3.97 2.38a2 2 0 0 0 2.06 0l3-1.8a2 2 0 0 0 .97-1.71v-3.24a2 2 0 0 0-.97-1.71L17 10.5l-5 3Z",key:"8zsnat"}],["path",{d:"m17 16.5-5-3",key:"8arw3v"}],["path",{d:"m17 16.5 4.74-2.85",key:"8rfmw"}],["path",{d:"M17 16.5v5.17",key:"k6z78m"}],["path",{d:"M7.97 4.42A2 2 0 0 0 7 6.13v4.37l5 3 5-3V6.13a2 2 0 0 0-.97-1.71l-3-1.8a2 2 0 0 0-2.06 0l-3 1.8Z",key:"1xygjf"}],["path",{d:"M12 8 7.26 5.15",key:"1vbdud"}],["path",{d:"m12 8 4.74-2.85",key:"3rx089"}],["path",{d:"M12 13.5V8",key:"1io7kd"}]],ZM=ae("boxes",XM);const QM=[["path",{d:"M16 20V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"jecpp"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]],JM=ae("briefcase",QM);const KM=[["path",{d:"M10 12h4",key:"a56b0p"}],["path",{d:"M10 8h4",key:"1sr2af"}],["path",{d:"M14 21v-3a2 2 0 0 0-4 0v3",key:"1rgiei"}],["path",{d:"M6 10H4a2 2 0 0 0-2 2v7a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-2",key:"secmi2"}],["path",{d:"M6 21V5a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v16",key:"16ra0t"}]],e_=ae("building-2",KM);const t_=[["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M9 22v-3a1 1 0 0 1 1-1h4a1 1 0 0 1 1 1v3",key:"cabbwy"}],["rect",{x:"4",y:"2",width:"16",height:"20",rx:"2",key:"1uxh74"}]],a_=ae("building",t_);const n_=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],s_=ae("calendar",n_);const i_=[["path",{d:"M10 5V3",key:"1y54qe"}],["path",{d:"M14 5V3",key:"m6isi"}],["path",{d:"M15 21v-3a3 3 0 0 0-6 0v3",key:"lbp5hj"}],["path",{d:"M18 3v8",key:"2ollhf"}],["path",{d:"M18 5H6",key:"98imr9"}],["path",{d:"M22 11H2",key:"1lmjae"}],["path",{d:"M22 9v10a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9",key:"1rly83"}],["path",{d:"M6 3v8",key:"csox7g"}]],r_=ae("castle",i_);const o_=[["path",{d:"M5 21v-6",key:"1hz6c0"}],["path",{d:"M12 21V9",key:"uvy0l4"}],["path",{d:"M19 21V3",key:"11j9sm"}]],l_=ae("chart-no-axes-column-increasing",o_);const c_=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],d_=ae("check",c_);const u_=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],p_=ae("chevron-down",u_);const f_=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],m_=ae("chevron-left",f_);const h_=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],x_=ae("chevron-right",h_);const g_=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],y_=ae("chevron-up",g_);const b_=[["path",{d:"M10 9h4",key:"u4k05v"}],["path",{d:"M12 7v5",key:"ma6bk"}],["path",{d:"M14 21v-3a2 2 0 0 0-4 0v3",key:"1rgiei"}],["path",{d:"m18 9 3.52 2.147a1 1 0 0 1 .48.854V19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2v-6.999a1 1 0 0 1 .48-.854L6 9",key:"flvdwo"}],["path",{d:"M6 21V7a1 1 0 0 1 .376-.782l5-3.999a1 1 0 0 1 1.249.001l5 4A1 1 0 0 1 18 7v14",key:"a5i0n2"}]],v_=ae("church",b_);const j_=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],w_=ae("circle-alert",j_);const N_=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m16 12-4-4-4 4",key:"177agl"}],["path",{d:"M12 16V8",key:"1sbj14"}]],M_=ae("circle-arrow-up",N_);const __=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],E_=ae("circle-check-big",__);const k_=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]],C_=ae("circle-question-mark",k_);const T_=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}],["path",{d:"M7 20.662V19a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v1.662",key:"154egf"}]],S_=ae("circle-user",T_);const A_=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],P_=ae("circle-x",A_);const D_=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],R_=ae("circle",D_);const $_=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}]],O_=ae("clipboard",$_);const z_=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],B_=ae("clock",z_);const L_=[["path",{d:"M6 16.326A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 .5 8.973",key:"1cez44"}],["path",{d:"m13 12-3 5h4l-3 5",key:"1t22er"}]],V_=ae("cloud-lightning",L_);const W_=[["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"M16 14v6",key:"1j4efv"}],["path",{d:"M8 14v6",key:"17c4r9"}],["path",{d:"M12 16v6",key:"c8a4gj"}]],U_=ae("cloud-rain",W_);const I_=[["path",{d:"M17.5 19H9a7 7 0 1 1 6.71-9h1.79a4.5 4.5 0 1 1 0 9Z",key:"p7xjir"}]],H_=ae("cloud",I_);const q_=[["path",{d:"m16 18 6-6-6-6",key:"eg8j8"}],["path",{d:"m8 6-6 6 6 6",key:"ppft3o"}]],G_=ae("code",q_);const F_=[["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M14 2v2",key:"6buw04"}],["path",{d:"M16 8a1 1 0 0 1 1 1v8a4 4 0 0 1-4 4H7a4 4 0 0 1-4-4V9a1 1 0 0 1 1-1h14a4 4 0 1 1 0 8h-1",key:"pwadti"}],["path",{d:"M6 2v2",key:"colzsn"}]],Y_=ae("coffee",F_);const X_=[["path",{d:"M11 10.27 7 3.34",key:"16pf9h"}],["path",{d:"m11 13.73-4 6.93",key:"794ttg"}],["path",{d:"M12 22v-2",key:"1osdcq"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M14 12h8",key:"4f43i9"}],["path",{d:"m17 20.66-1-1.73",key:"eq3orb"}],["path",{d:"m17 3.34-1 1.73",key:"2wel8s"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"m20.66 17-1.73-1",key:"sg0v6f"}],["path",{d:"m20.66 7-1.73 1",key:"1ow05n"}],["path",{d:"m3.34 17 1.73-1",key:"nuk764"}],["path",{d:"m3.34 7 1.73 1",key:"1ulond"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}],["circle",{cx:"12",cy:"12",r:"8",key:"46899m"}]],Z_=ae("cog",X_);const Q_=[["circle",{cx:"8",cy:"8",r:"6",key:"3yglwk"}],["path",{d:"M18.09 10.37A6 6 0 1 1 10.34 18",key:"t5s6rm"}],["path",{d:"M7 6h1v4",key:"1obek4"}],["path",{d:"m16.71 13.88.7.71-2.82 2.82",key:"1rbuyh"}]],J_=ae("coins",Q_);const K_=[["path",{d:"m16.24 7.76-1.804 5.411a2 2 0 0 1-1.265 1.265L7.76 16.24l1.804-5.411a2 2 0 0 1 1.265-1.265z",key:"9ktpf1"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],eE=ae("compass",K_);const tE=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],aE=ae("copy",tE);const nE=[["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M17 20v2",key:"1rnc9c"}],["path",{d:"M17 2v2",key:"11trls"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M2 17h2",key:"7oei6x"}],["path",{d:"M2 7h2",key:"asdhe0"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"M20 17h2",key:"1fpfkl"}],["path",{d:"M20 7h2",key:"1o8tra"}],["path",{d:"M7 20v2",key:"4gnj0m"}],["path",{d:"M7 2v2",key:"1i4yhu"}],["rect",{x:"4",y:"4",width:"16",height:"16",rx:"2",key:"1vbyd7"}],["rect",{x:"8",y:"8",width:"8",height:"8",rx:"1",key:"z9xiuo"}]],sE=ae("cpu",nE);const iE=[["path",{d:"M4 9a2 2 0 0 0-2 2v2a2 2 0 0 0 2 2h4a1 1 0 0 1 1 1v4a2 2 0 0 0 2 2h2a2 2 0 0 0 2-2v-4a1 1 0 0 1 1-1h4a2 2 0 0 0 2-2v-2a2 2 0 0 0-2-2h-4a1 1 0 0 1-1-1V4a2 2 0 0 0-2-2h-2a2 2 0 0 0-2 2v4a1 1 0 0 1-1 1z",key:"1xbrqy"}]],rE=ae("cross",iE);const oE=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"22",x2:"18",y1:"12",y2:"12",key:"l9bcsi"}],["line",{x1:"6",x2:"2",y1:"12",y2:"12",key:"13hhkx"}],["line",{x1:"12",x2:"12",y1:"6",y2:"2",key:"10w3f3"}],["line",{x1:"12",x2:"12",y1:"22",y2:"18",key:"15g9kq"}]],lE=ae("crosshair",oE);const cE=[["path",{d:"M11.562 3.266a.5.5 0 0 1 .876 0L15.39 8.87a1 1 0 0 0 1.516.294L21.183 5.5a.5.5 0 0 1 .798.519l-2.834 10.246a1 1 0 0 1-.956.734H5.81a1 1 0 0 1-.957-.734L2.02 6.02a.5.5 0 0 1 .798-.519l4.276 3.664a1 1 0 0 0 1.516-.294z",key:"1vdc57"}],["path",{d:"M5 21h14",key:"11awu3"}]],dE=ae("crown",cE);const uE=[["rect",{width:"12",height:"12",x:"2",y:"10",rx:"2",ry:"2",key:"6agr2n"}],["path",{d:"m17.92 14 3.5-3.5a2.24 2.24 0 0 0 0-3l-5-4.92a2.24 2.24 0 0 0-3 0L10 6",key:"1o487t"}],["path",{d:"M6 18h.01",key:"uhywen"}],["path",{d:"M10 14h.01",key:"ssrbsk"}],["path",{d:"M15 6h.01",key:"cblpky"}],["path",{d:"M18 9h.01",key:"2061c0"}]],pE=ae("dices",uE);const fE=[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]],mE=ae("dollar-sign",fE);const hE=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],xE=ae("download",hE);const gE=[["path",{d:"M10 11h.01",key:"d2at3l"}],["path",{d:"M14 6h.01",key:"k028ub"}],["path",{d:"M18 6h.01",key:"1v4wsw"}],["path",{d:"M6.5 13.1h.01",key:"1748ia"}],["path",{d:"M22 5c0 9-4 12-6 12s-6-3-6-12c0-2 2-3 6-3s6 1 6 3",key:"172yzv"}],["path",{d:"M17.4 9.9c-.8.8-2 .8-2.8 0",key:"1obv0w"}],["path",{d:"M10.1 7.1C9 7.2 7.7 7.7 6 8.6c-3.5 2-4.7 3.9-3.7 5.6 4.5 7.8 9.5 8.4 11.2 7.4.9-.5 1.9-2.1 1.9-4.7",key:"rqjl8i"}],["path",{d:"M9.1 16.5c.3-1.1 1.4-1.7 2.4-1.4",key:"1mr6wy"}]],yE=ae("drama",gE);const bE=[["path",{d:"M12 22a7 7 0 0 0 7-7c0-2-1-3.9-3-5.5s-3.5-4-4-6.5c-.5 2.5-2 4.9-4 6.5C6 11.1 5 13 5 15a7 7 0 0 0 7 7z",key:"c7niix"}]],vE=ae("droplet",bE);const jE=[["path",{d:"M7 16.3c2.2 0 4-1.83 4-4.05 0-1.16-.57-2.26-1.71-3.19S7.29 6.75 7 5.3c-.29 1.45-1.14 2.84-2.29 3.76S3 11.1 3 12.25c0 2.22 1.8 4.05 4 4.05z",key:"1ptgy4"}],["path",{d:"M12.56 6.6A10.97 10.97 0 0 0 14 3.02c.5 2.5 2 4.9 4 6.5s3 3.5 3 5.5a6.98 6.98 0 0 1-11.91 4.97",key:"1sl1rz"}]],wE=ae("droplets",jE);const NE=[["path",{d:"M21.54 15H17a2 2 0 0 0-2 2v4.54",key:"1djwo0"}],["path",{d:"M7 3.34V5a3 3 0 0 0 3 3a2 2 0 0 1 2 2c0 1.1.9 2 2 2a2 2 0 0 0 2-2c0-1.1.9-2 2-2h3.17",key:"1tzkfa"}],["path",{d:"M11 21.95V18a2 2 0 0 0-2-2a2 2 0 0 1-2-2v-1a2 2 0 0 0-2-2H2.05",key:"14pb5j"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],ME=ae("earth",NE);const _E=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],EE=ae("external-link",_E);const kE=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],CE=ae("eye-off",kE);const TE=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],SE=ae("eye",TE);const AE=[["path",{d:"M12 16h.01",key:"1drbdi"}],["path",{d:"M16 16h.01",key:"1f9h7w"}],["path",{d:"M3 19a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V8.5a.5.5 0 0 0-.769-.422l-4.462 2.844A.5.5 0 0 1 15 10.5v-2a.5.5 0 0 0-.769-.422L9.77 10.922A.5.5 0 0 1 9 10.5V5a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2z",key:"1iv0i2"}],["path",{d:"M8 16h.01",key:"18s6g9"}]],PE=ae("factory",AE);const DE=[["path",{d:"M10.827 16.379a6.082 6.082 0 0 1-8.618-7.002l5.412 1.45a6.082 6.082 0 0 1 7.002-8.618l-1.45 5.412a6.082 6.082 0 0 1 8.618 7.002l-5.412-1.45a6.082 6.082 0 0 1-7.002 8.618l1.45-5.412Z",key:"484a7f"}],["path",{d:"M12 12v.01",key:"u5ubse"}]],RE=ae("fan",DE);const $E=[["path",{d:"M12 6a2 2 0 0 1 3.414-1.414l6 6a2 2 0 0 1 0 2.828l-6 6A2 2 0 0 1 12 18z",key:"b19h5q"}],["path",{d:"M2 6a2 2 0 0 1 3.414-1.414l6 6a2 2 0 0 1 0 2.828l-6 6A2 2 0 0 1 2 18z",key:"h7h5ge"}]],OE=ae("fast-forward",$E);const zE=[["path",{d:"M12.67 19a2 2 0 0 0 1.416-.588l6.154-6.172a6 6 0 0 0-8.49-8.49L5.586 9.914A2 2 0 0 0 5 11.328V18a1 1 0 0 0 1 1z",key:"18jl4k"}],["path",{d:"M16 8 2 22",key:"vp34q"}],["path",{d:"M17.5 15H9",key:"1oz8nu"}]],BE=ae("feather",zE);const LE=[["path",{d:"M4 3 2 5v15c0 .6.4 1 1 1h2c.6 0 1-.4 1-1V5Z",key:"1n2rgs"}],["path",{d:"M6 8h4",key:"utf9t1"}],["path",{d:"M6 18h4",key:"12yh4b"}],["path",{d:"m12 3-2 2v15c0 .6.4 1 1 1h2c.6 0 1-.4 1-1V5Z",key:"3ha7mj"}],["path",{d:"M14 8h4",key:"1r8wg2"}],["path",{d:"M14 18h4",key:"1t3kbu"}],["path",{d:"m20 3-2 2v15c0 .6.4 1 1 1h2c.6 0 1-.4 1-1V5Z",key:"dfd4e2"}]],VE=ae("fence",LE);const WE=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],UE=ae("file-text",WE);const IE=[["path",{d:"M4 22V4a1 1 0 0 1 .4-.8A6 6 0 0 1 8 2c3 0 5 2 7.333 2q2 0 3.067-.8A1 1 0 0 1 20 4v10a1 1 0 0 1-.4.8A6 6 0 0 1 16 16c-3 0-5-2-8-2a6 6 0 0 0-4 1.528",key:"1jaruq"}]],HE=ae("flag",IE);const qE=[["path",{d:"M12 3q1 4 4 6.5t3 5.5a1 1 0 0 1-14 0 5 5 0 0 1 1-3 1 1 0 0 0 5 0c0-2-1.5-3-1.5-5q0-2 2.5-4",key:"1slcih"}]],GE=ae("flame",qE);const FE=[["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}],["path",{d:"M12 16.5A4.5 4.5 0 1 1 7.5 12 4.5 4.5 0 1 1 12 7.5a4.5 4.5 0 1 1 4.5 4.5 4.5 4.5 0 1 1-4.5 4.5",key:"14wa3c"}],["path",{d:"M12 7.5V9",key:"1oy5b0"}],["path",{d:"M7.5 12H9",key:"eltsq1"}],["path",{d:"M16.5 12H15",key:"vk5kw4"}],["path",{d:"M12 16.5V15",key:"k7eayi"}],["path",{d:"m8 8 1.88 1.88",key:"nxy4qf"}],["path",{d:"M14.12 9.88 16 8",key:"1lst6k"}],["path",{d:"m8 16 1.88-1.88",key:"h2eex1"}],["path",{d:"M14.12 14.12 16 16",key:"uqkrx3"}]],YE=ae("flower",FE);const XE=[["path",{d:"M12 5a3 3 0 1 1 3 3m-3-3a3 3 0 1 0-3 3m3-3v1M9 8a3 3 0 1 0 3 3M9 8h1m5 0a3 3 0 1 1-3 3m3-3h-1m-2 3v-1",key:"3pnvol"}],["circle",{cx:"12",cy:"8",r:"2",key:"1822b1"}],["path",{d:"M12 10v12",key:"6ubwww"}],["path",{d:"M12 22c4.2 0 7-1.667 7-5-4.2 0-7 1.667-7 5Z",key:"9hd38g"}],["path",{d:"M12 22c-4.2 0-7-1.667-7-5 4.2 0 7 1.667 7 5Z",key:"ufn41s"}]],ZE=ae("flower-2",XE);const QE=[["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}],["path",{d:"M3 7V5a2 2 0 0 1 2-2h2",key:"aa7l1z"}],["path",{d:"M17 3h2a2 2 0 0 1 2 2v2",key:"4qcy5o"}],["path",{d:"M21 17v2a2 2 0 0 1-2 2h-2",key:"6vwrx8"}],["path",{d:"M7 21H5a2 2 0 0 1-2-2v-2",key:"ioqczr"}]],JE=ae("focus",QE);const KE=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],ek=ae("funnel",KE);const tk=[["path",{d:"m12 14 4-4",key:"9kzdfg"}],["path",{d:"M3.34 19a10 10 0 1 1 17.32 0",key:"19p75a"}]],ak=ae("gauge",tk);const nk=[["path",{d:"m14 13-8.381 8.38a1 1 0 0 1-3.001-3l8.384-8.381",key:"pgg06f"}],["path",{d:"m16 16 6-6",key:"vzrcl6"}],["path",{d:"m21.5 10.5-8-8",key:"a17d9x"}],["path",{d:"m8 8 6-6",key:"18bi4p"}],["path",{d:"m8.5 7.5 8 8",key:"1oyaui"}]],sk=ae("gavel",nk);const ik=[["path",{d:"M10.5 3 8 9l4 13 4-13-2.5-6",key:"b3dvk1"}],["path",{d:"M17 3a2 2 0 0 1 1.6.8l3 4a2 2 0 0 1 .013 2.382l-7.99 10.986a2 2 0 0 1-3.247 0l-7.99-10.986A2 2 0 0 1 2.4 7.8l2.998-3.997A2 2 0 0 1 7 3z",key:"7w4byz"}],["path",{d:"M2 9h20",key:"16fsjt"}]],rk=ae("gem",ik);const ok=[["rect",{x:"3",y:"8",width:"18",height:"4",rx:"1",key:"bkv52"}],["path",{d:"M12 8v13",key:"1c76mn"}],["path",{d:"M19 12v7a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2v-7",key:"6wjy6b"}],["path",{d:"M7.5 8a2.5 2.5 0 0 1 0-5A4.8 8 0 0 1 12 8a4.8 8 0 0 1 4.5-5 2.5 2.5 0 0 1 0 5",key:"1ihvrl"}]],lk=ae("gift",ok);const ck=[["line",{x1:"6",x2:"6",y1:"3",y2:"15",key:"17qcm7"}],["circle",{cx:"18",cy:"6",r:"3",key:"1h7g24"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["path",{d:"M18 9a9 9 0 0 1-9 9",key:"n2h4wq"}]],dk=ae("git-branch",ck);const uk=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]],pk=ae("globe",uk);const fk=[["path",{d:"M21.42 10.922a1 1 0 0 0-.019-1.838L12.83 5.18a2 2 0 0 0-1.66 0L2.6 9.08a1 1 0 0 0 0 1.832l8.57 3.908a2 2 0 0 0 1.66 0z",key:"j76jl0"}],["path",{d:"M22 10v6",key:"1lu8f3"}],["path",{d:"M6 12.5V16a6 3 0 0 0 12 0v-3.5",key:"1r8lef"}]],mk=ae("graduation-cap",fk);const hk=[["path",{d:"m15 12-9.373 9.373a1 1 0 0 1-3.001-3L12 9",key:"1hayfq"}],["path",{d:"m18 15 4-4",key:"16gjal"}],["path",{d:"m21.5 11.5-1.914-1.914A2 2 0 0 1 19 8.172v-.344a2 2 0 0 0-.586-1.414l-1.657-1.657A6 6 0 0 0 12.516 3H9l1.243 1.243A6 6 0 0 1 12 8.485V10l2 2h1.172a2 2 0 0 1 1.414.586L18.5 14.5",key:"15ts47"}]],xk=ae("hammer",hk);const gk=[["path",{d:"M11 14h2a2 2 0 0 0 0-4h-3c-.6 0-1.1.2-1.4.6L3 16",key:"1v1a37"}],["path",{d:"m14.45 13.39 5.05-4.694C20.196 8 21 6.85 21 5.75a2.75 2.75 0 0 0-4.797-1.837.276.276 0 0 1-.406 0A2.75 2.75 0 0 0 11 5.75c0 1.2.802 2.248 1.5 2.946L16 11.95",key:"fhfbnt"}],["path",{d:"m2 15 6 6",key:"10dquu"}],["path",{d:"m7 20 1.6-1.4c.3-.4.8-.6 1.4-.6h4c1.1 0 2.1-.4 2.8-1.2l4.6-4.4a1 1 0 0 0-2.75-2.91",key:"1x6kdw"}]],yk=ae("hand-heart",gk);const bk=[["path",{d:"M18 11V6a2 2 0 0 0-2-2a2 2 0 0 0-2 2",key:"1fvzgz"}],["path",{d:"M14 10V4a2 2 0 0 0-2-2a2 2 0 0 0-2 2v2",key:"1kc0my"}],["path",{d:"M10 10.5V6a2 2 0 0 0-2-2a2 2 0 0 0-2 2v8",key:"10h0bg"}],["path",{d:"M18 8a2 2 0 1 1 4 0v6a8 8 0 0 1-8 8h-2c-2.8 0-4.5-.86-5.99-2.34l-3.6-3.6a2 2 0 0 1 2.83-2.82L7 15",key:"1s1gnw"}]],vk=ae("hand",bk);const jk=[["path",{d:"m11 17 2 2a1 1 0 1 0 3-3",key:"efffak"}],["path",{d:"m14 14 2.5 2.5a1 1 0 1 0 3-3l-3.88-3.88a3 3 0 0 0-4.24 0l-.88.88a1 1 0 1 1-3-3l2.81-2.81a5.79 5.79 0 0 1 7.06-.87l.47.28a2 2 0 0 0 1.42.25L21 4",key:"9pr0kb"}],["path",{d:"m21 3 1 11h-2",key:"1tisrp"}],["path",{d:"M3 3 2 14l6.5 6.5a1 1 0 1 0 3-3",key:"1uvwmv"}],["path",{d:"M3 4h8",key:"1ep09j"}]],wk=ae("handshake",jk);const Nk=[["path",{d:"M2 9.5a5.5 5.5 0 0 1 9.591-3.676.56.56 0 0 0 .818 0A5.49 5.49 0 0 1 22 9.5c0 2.29-1.5 4-3 5.5l-5.492 5.313a2 2 0 0 1-3 .019L5 15c-1.5-1.5-3-3.2-3-5.5",key:"mvr1a0"}]],Mk=ae("heart",Nk);const _k=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]],Ek=ae("history",_k);const kk=[["path",{d:"M5 22h14",key:"ehvnwv"}],["path",{d:"M5 2h14",key:"pdyrp9"}],["path",{d:"M17 22v-4.172a2 2 0 0 0-.586-1.414L12 12l-4.414 4.414A2 2 0 0 0 7 17.828V22",key:"1d314k"}],["path",{d:"M7 2v4.172a2 2 0 0 0 .586 1.414L12 12l4.414-4.414A2 2 0 0 0 17 6.172V2",key:"1vvvr6"}]],Ck=ae("hourglass",kk);const Tk=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-6a2 2 0 0 1 2.582 0l7 6A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"r6nss1"}]],Sk=ae("house",Tk);const Ak=[["polyline",{points:"22 12 16 12 14 15 10 15 8 12 2 12",key:"o97t9d"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}]],Pk=ae("inbox",Ak);const Dk=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],Rk=ae("info",Dk);const $k=[["path",{d:"M10 18v-7",key:"wt116b"}],["path",{d:"M11.12 2.198a2 2 0 0 1 1.76.006l7.866 3.847c.476.233.31.949-.22.949H3.474c-.53 0-.695-.716-.22-.949z",key:"1m329m"}],["path",{d:"M14 18v-7",key:"vav6t3"}],["path",{d:"M18 18v-7",key:"aexdmj"}],["path",{d:"M3 22h18",key:"8prr45"}],["path",{d:"M6 18v-7",key:"1ivflk"}]],Ok=ae("landmark",$k);const zk=[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]],Bk=ae("layers",zk);const Lk=[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1",key:"6d4xhi"}],["rect",{width:"7",height:"7",x:"14",y:"14",rx:"1",key:"nxv5o0"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}]],Vk=ae("layout-grid",Lk);const Wk=[["path",{d:"M11 20A7 7 0 0 1 9.8 6.1C15.5 5 17 4.48 19 2c1 2 2 4.18 2 8 0 5.5-4.78 10-10 10Z",key:"nnexq3"}],["path",{d:"M2 21c0-3 1.85-5.36 5.08-6C9.5 14.52 12 13 13 12",key:"mt58a7"}]],Uk=ae("leaf",Wk);const Ik=[["path",{d:"m16 6 4 14",key:"ji33uf"}],["path",{d:"M12 6v14",key:"1n7gus"}],["path",{d:"M8 8v12",key:"1gg7y9"}],["path",{d:"M4 4v16",key:"6qkkli"}]],Hk=ae("library",Ik);const qk=[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]],Gk=ae("lightbulb",qk);const Fk=[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]],Yk=ae("link",Fk);const Xk=[["path",{d:"M3 5h.01",key:"18ugdj"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 19h.01",key:"noohij"}],["path",{d:"M8 5h13",key:"1pao27"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 19h13",key:"m83p4d"}]],Zk=ae("list",Xk);const Qk=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],Jk=ae("lock",Qk);const Kk=[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]],eC=ae("mail",Kk);const tC=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],aC=ae("map-pin",tC);const nC=[["path",{d:"M14.106 5.553a2 2 0 0 0 1.788 0l3.659-1.83A1 1 0 0 1 21 4.619v12.764a1 1 0 0 1-.553.894l-4.553 2.277a2 2 0 0 1-1.788 0l-4.212-2.106a2 2 0 0 0-1.788 0l-3.659 1.83A1 1 0 0 1 3 19.381V6.618a1 1 0 0 1 .553-.894l4.553-2.277a2 2 0 0 1 1.788 0z",key:"169xi5"}],["path",{d:"M15 5.764v15",key:"1pn4in"}],["path",{d:"M9 3.236v15",key:"1uimfh"}]],sC=ae("map",nC);const iC=[["path",{d:"M8 3H5a2 2 0 0 0-2 2v3",key:"1dcmit"}],["path",{d:"M21 8V5a2 2 0 0 0-2-2h-3",key:"1e4gt3"}],["path",{d:"M3 16v3a2 2 0 0 0 2 2h3",key:"wsl5sc"}],["path",{d:"M16 21h3a2 2 0 0 0 2-2v-3",key:"18trek"}]],rC=ae("maximize",iC);const oC=[["path",{d:"M4 5h16",key:"1tepv9"}],["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 19h16",key:"1djgab"}]],lC=ae("menu",oC);const cC=[["path",{d:"M2.992 16.342a2 2 0 0 1 .094 1.167l-1.065 3.29a1 1 0 0 0 1.236 1.168l3.413-.998a2 2 0 0 1 1.099.092 10 10 0 1 0-4.777-4.719",key:"1sd12s"}]],dC=ae("message-circle",cC);const uC=[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]],pC=ae("message-square",uC);const fC=[["path",{d:"M6 18h8",key:"1borvv"}],["path",{d:"M3 22h18",key:"8prr45"}],["path",{d:"M14 22a7 7 0 1 0 0-14h-1",key:"1jwaiy"}],["path",{d:"M9 14h2",key:"197e7h"}],["path",{d:"M9 12a2 2 0 0 1-2-2V6h6v4a2 2 0 0 1-2 2Z",key:"1bmzmy"}],["path",{d:"M12 6V3a1 1 0 0 0-1-1H9a1 1 0 0 0-1 1v3",key:"1drr47"}]],mC=ae("microscope",fC);const hC=[["path",{d:"M8 3v3a2 2 0 0 1-2 2H3",key:"hohbtr"}],["path",{d:"M21 8h-3a2 2 0 0 1-2-2V3",key:"5jw1f3"}],["path",{d:"M3 16h3a2 2 0 0 1 2 2v3",key:"198tvr"}],["path",{d:"M16 21v-3a2 2 0 0 1 2-2h3",key:"ph8mxp"}]],xC=ae("minimize",hC);const gC=[["path",{d:"M5 12h14",key:"1ays0h"}]],yC=ae("minus",gC);const bC=[["path",{d:"M20.985 12.486a9 9 0 1 1-9.473-9.472c.405-.022.617.46.402.803a6 6 0 0 0 8.268 8.268c.344-.215.825-.004.803.401",key:"kfwtm"}]],vC=ae("moon",bC);const jC=[["path",{d:"m8 3 4 8 5-5 5 15H2L8 3z",key:"otkl63"}]],wC=ae("mountain",jC);const NC=[["circle",{cx:"8",cy:"18",r:"4",key:"1fc0mg"}],["path",{d:"M12 18V2l7 4",key:"g04rme"}]],MC=ae("music-2",NC);const _C=[["path",{d:"M9 18V5l12-2v13",key:"1jmyc2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["circle",{cx:"18",cy:"16",r:"3",key:"1hluhg"}]],EC=ae("music",_C);const kC=[["polygon",{points:"3 11 22 2 13 21 11 13 3 11",key:"1ltx0t"}]],ny=ae("navigation",kC);const CC=[["path",{d:"M15 18h-5",key:"95g1m2"}],["path",{d:"M18 14h-8",key:"sponae"}],["path",{d:"M4 22h16a2 2 0 0 0 2-2V4a2 2 0 0 0-2-2H8a2 2 0 0 0-2 2v16a2 2 0 0 1-4 0v-9a2 2 0 0 1 2-2h2",key:"39pd36"}],["rect",{width:"8",height:"4",x:"10",y:"6",rx:"1",key:"aywv1n"}]],TC=ae("newspaper",CC);const SC=[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]],AC=ae("package",SC);const PC=[["path",{d:"m14.622 17.897-10.68-2.913",key:"vj2p1u"}],["path",{d:"M18.376 2.622a1 1 0 1 1 3.002 3.002L17.36 9.643a.5.5 0 0 0 0 .707l.944.944a2.41 2.41 0 0 1 0 3.408l-.944.944a.5.5 0 0 1-.707 0L8.354 7.348a.5.5 0 0 1 0-.707l.944-.944a2.41 2.41 0 0 1 3.408 0l.944.944a.5.5 0 0 0 .707 0z",key:"18tc5c"}],["path",{d:"M9 8c-1.804 2.71-3.97 3.46-6.583 3.948a.507.507 0 0 0-.302.819l7.32 8.883a1 1 0 0 0 1.185.204C12.735 20.405 16 16.792 16 15",key:"ytzfxy"}]],DC=ae("paintbrush",PC);const RC=[["path",{d:"M12 22a1 1 0 0 1 0-20 10 9 0 0 1 10 9 5 5 0 0 1-5 5h-2.25a1.75 1.75 0 0 0-1.4 2.8l.3.4a1.75 1.75 0 0 1-1.4 2.8z",key:"e79jfc"}],["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}]],$C=ae("palette",RC);const OC=[["rect",{x:"14",y:"3",width:"5",height:"18",rx:"1",key:"kaeet6"}],["rect",{x:"5",y:"3",width:"5",height:"18",rx:"1",key:"1wsw3u"}]],zC=ae("pause",OC);const BC=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]],LC=ae("pencil",BC);const VC=[["path",{d:"m14 13-8.381 8.38a1 1 0 0 1-3.001-3L11 9.999",key:"1lw9ds"}],["path",{d:"M15.973 4.027A13 13 0 0 0 5.902 2.373c-1.398.342-1.092 2.158.277 2.601a19.9 19.9 0 0 1 5.822 3.024",key:"ffj4ej"}],["path",{d:"M16.001 11.999a19.9 19.9 0 0 1 3.024 5.824c.444 1.369 2.26 1.676 2.603.278A13 13 0 0 0 20 8.069",key:"8tj4zw"}],["path",{d:"M18.352 3.352a1.205 1.205 0 0 0-1.704 0l-5.296 5.296a1.205 1.205 0 0 0 0 1.704l2.296 2.296a1.205 1.205 0 0 0 1.704 0l5.296-5.296a1.205 1.205 0 0 0 0-1.704z",key:"hh6h97"}]],sy=ae("pickaxe",VC);const WC=[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]],UC=ae("play",WC);const IC=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],HC=ae("plus",IC);const qC=[["path",{d:"M12 2v10",key:"mnfbl"}],["path",{d:"M18.4 6.6a9 9 0 1 1-12.77.04",key:"obofu9"}]],GC=ae("power",qC);const FC=[["path",{d:"M21 7v6h-6",key:"3ptur4"}],["path",{d:"M3 17a9 9 0 0 1 9-9 9 9 0 0 1 6 2.3l3 2.7",key:"1kgawr"}]],YC=ae("redo",FC);const XC=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],ZC=ae("refresh-cw",XC);const QC=[["path",{d:"M4.5 16.5c-1.5 1.26-2 5-2 5s3.74-.5 5-2c.71-.84.7-2.13-.09-2.91a2.18 2.18 0 0 0-2.91-.09z",key:"m3kijz"}],["path",{d:"m12 15-3-3a22 22 0 0 1 2-3.95A12.88 12.88 0 0 1 22 2c0 2.72-.78 7.5-6 11a22.35 22.35 0 0 1-4 2z",key:"1fmvmk"}],["path",{d:"M9 12H4s.55-3.03 2-4c1.62-1.08 5 0 5 0",key:"1f8sc4"}],["path",{d:"M12 15v5s3.03-.55 4-2c1.08-1.62 0-5 0-5",key:"qeys4"}]],JC=ae("rocket",QC);const KC=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],e8=ae("rotate-ccw",KC);const t8=[["path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8",key:"1p45f6"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}]],a8=ae("rotate-cw",t8);const n8=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],s8=ae("save",n8);const i8=[["path",{d:"m16 16 3-8 3 8c-.87.65-1.92 1-3 1s-2.13-.35-3-1Z",key:"7g6ntu"}],["path",{d:"m2 16 3-8 3 8c-.87.65-1.92 1-3 1s-2.13-.35-3-1Z",key:"ijws7r"}],["path",{d:"M7 21h10",key:"1b0cd5"}],["path",{d:"M12 3v18",key:"108xh3"}],["path",{d:"M3 7h2c2 0 5-1 7-2 2 1 5 2 7 2h2",key:"3gwbw2"}]],r8=ae("scale",i8);const o8=[["path",{d:"M15 12h-5",key:"r7krc0"}],["path",{d:"M15 8h-5",key:"1khuty"}],["path",{d:"M19 17V5a2 2 0 0 0-2-2H4",key:"zz82l3"}],["path",{d:"M8 21h12a2 2 0 0 0 2-2v-1a1 1 0 0 0-1-1H11a1 1 0 0 0-1 1v1a2 2 0 1 1-4 0V5a2 2 0 1 0-4 0v2a1 1 0 0 0 1 1h3",key:"1ph1d7"}]],l8=ae("scroll-text",o8);const c8=[["path",{d:"M19 17V5a2 2 0 0 0-2-2H4",key:"zz82l3"}],["path",{d:"M8 21h12a2 2 0 0 0 2-2v-1a1 1 0 0 0-1-1H11a1 1 0 0 0-1 1v1a2 2 0 1 1-4 0V5a2 2 0 1 0-4 0v2a1 1 0 0 0 1 1h3",key:"1ph1d7"}]],d8=ae("scroll",c8);const u8=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],p8=ae("search",u8);const f8=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],m8=ae("send",f8);const h8=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],x8=ae("settings",h8);const g8=[["path",{d:"M12 2v13",key:"1km8f5"}],["path",{d:"m16 6-4-4-4 4",key:"13yo43"}],["path",{d:"M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8",key:"1b2hhj"}]],y8=ae("share",g8);const b8=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M12 16h.01",key:"1drbdi"}]],v8=ae("shield-alert",b8);const j8=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],w8=ae("shield",j8);const N8=[["path",{d:"M12 10.189V14",key:"1p8cqu"}],["path",{d:"M12 2v3",key:"qbqxhf"}],["path",{d:"M19 13V7a2 2 0 0 0-2-2H7a2 2 0 0 0-2 2v6",key:"qpkstq"}],["path",{d:"M19.38 20A11.6 11.6 0 0 0 21 14l-8.188-3.639a2 2 0 0 0-1.624 0L3 14a11.6 11.6 0 0 0 2.81 7.76",key:"7tigtc"}],["path",{d:"M2 21c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1s1.2 1 2.5 1c2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"1924j5"}]],M8=ae("ship",N8);const _8=[["path",{d:"M20.38 3.46 16 2a4 4 0 0 1-8 0L3.62 3.46a2 2 0 0 0-1.34 2.23l.58 3.47a1 1 0 0 0 .99.84H6v10c0 1.1.9 2 2 2h8a2 2 0 0 0 2-2V10h2.15a1 1 0 0 0 .99-.84l.58-3.47a2 2 0 0 0-1.34-2.23z",key:"1wgbhj"}]],E8=ae("shirt",_8);const k8=[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]],C8=ae("shopping-cart",k8);const T8=[["path",{d:"m12.5 17-.5-1-.5 1h1z",key:"3me087"}],["path",{d:"M15 22a1 1 0 0 0 1-1v-1a2 2 0 0 0 1.56-3.25 8 8 0 1 0-11.12 0A2 2 0 0 0 8 20v1a1 1 0 0 0 1 1z",key:"1o5pge"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}]],S8=ae("skull",T8);const A8=[["path",{d:"M10 8h4",key:"1sr2af"}],["path",{d:"M12 21v-9",key:"17s77i"}],["path",{d:"M12 8V3",key:"13r4qs"}],["path",{d:"M17 16h4",key:"h1uq16"}],["path",{d:"M19 12V3",key:"o1uvq1"}],["path",{d:"M19 21v-5",key:"qua636"}],["path",{d:"M3 14h4",key:"bcjad9"}],["path",{d:"M5 10V3",key:"cb8scm"}],["path",{d:"M5 21v-7",key:"1w1uti"}]],P8=ae("sliders-vertical",A8);const D8=[["path",{d:"m10 20-1.25-2.5L6 18",key:"18frcb"}],["path",{d:"M10 4 8.75 6.5 6 6",key:"7mghy3"}],["path",{d:"m14 20 1.25-2.5L18 18",key:"1chtki"}],["path",{d:"m14 4 1.25 2.5L18 6",key:"1b4wsy"}],["path",{d:"m17 21-3-6h-4",key:"15hhxa"}],["path",{d:"m17 3-3 6 1.5 3",key:"11697g"}],["path",{d:"M2 12h6.5L10 9",key:"kv9z4n"}],["path",{d:"m20 10-1.5 2 1.5 2",key:"1swlpi"}],["path",{d:"M22 12h-6.5L14 15",key:"1mxi28"}],["path",{d:"m4 10 1.5 2L4 14",key:"k9enpj"}],["path",{d:"m7 21 3-6-1.5-3",key:"j8hb9u"}],["path",{d:"m7 3 3 6h4",key:"1otusx"}]],R8=ae("snowflake",D8);const $8=[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]],O8=ae("sparkles",$8);const z8=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],B8=ae("square-pen",z8);const L8=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]],V8=ae("square",L8);const W8=[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]],U8=ae("star",W8);const I8=[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]],H8=ae("sun",I8);const q8=[["path",{d:"m11 19-6-6",key:"s7kpr"}],["path",{d:"m5 21-2-2",key:"1kw20b"}],["path",{d:"m8 16-4 4",key:"1oqv8h"}],["path",{d:"M9.5 17.5 21 6V3h-3L6.5 14.5",key:"pkxemp"}]],G8=ae("sword",q8);const F8=[["path",{d:"m18 2 4 4",key:"22kx64"}],["path",{d:"m17 7 3-3",key:"1w1zoj"}],["path",{d:"M19 9 8.7 19.3c-1 1-2.5 1-3.4 0l-.6-.6c-1-1-1-2.5 0-3.4L15 5",key:"1exhtz"}],["path",{d:"m9 11 4 4",key:"rovt3i"}],["path",{d:"m5 19-3 3",key:"59f2uf"}],["path",{d:"m14 4 6 6",key:"yqp9t2"}]],Y8=ae("syringe",F8);const X8=[["polyline",{points:"14.5 17.5 3 6 3 3 6 3 17.5 14.5",key:"1hfsw2"}],["line",{x1:"13",x2:"19",y1:"19",y2:"13",key:"1vrmhu"}],["line",{x1:"16",x2:"20",y1:"16",y2:"20",key:"1bron3"}],["line",{x1:"19",x2:"21",y1:"21",y2:"19",key:"13pww6"}],["polyline",{points:"14.5 6.5 18 3 21 3 21 6 17.5 9.5",key:"hbey2j"}],["line",{x1:"5",x2:"9",y1:"14",y2:"18",key:"1hf58s"}],["line",{x1:"7",x2:"4",y1:"17",y2:"20",key:"pidxm4"}],["line",{x1:"3",x2:"5",y1:"19",y2:"21",key:"1pehsh"}]],Z8=ae("swords",X8);const Q8=[["path",{d:"M12 3v18",key:"108xh3"}],["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}]],J8=ae("table",Q8);const K8=[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]],e6=ae("tag",K8);const t6=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]],a6=ae("target",t6);const n6=[["path",{d:"M3.5 21 14 3",key:"1szst5"}],["path",{d:"M20.5 21 10 3",key:"1310c3"}],["path",{d:"M15.5 21 12 15l-3.5 6",key:"1ddtfw"}],["path",{d:"M2 21h20",key:"1nyx9w"}]],s6=ae("tent",n6);const i6=[["path",{d:"M12 19h8",key:"baeox8"}],["path",{d:"m4 17 6-6-6-6",key:"1yngyt"}]],r6=ae("terminal",i6);const o6=[["path",{d:"M2 10s3-3 3-8",key:"3xiif0"}],["path",{d:"M22 10s-3-3-3-8",key:"ioaa5q"}],["path",{d:"M10 2c0 4.4-3.6 8-8 8",key:"16fkpi"}],["path",{d:"M14 2c0 4.4 3.6 8 8 8",key:"b9eulq"}],["path",{d:"M2 10s2 2 2 5",key:"1au1lb"}],["path",{d:"M22 10s-2 2-2 5",key:"qi2y5e"}],["path",{d:"M8 15h8",key:"45n4r"}],["path",{d:"M2 22v-1a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v1",key:"1vsc2m"}],["path",{d:"M14 22v-1a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v1",key:"hrha4u"}]],l6=ae("theater",o6);const c6=[["path",{d:"M17 14V2",key:"8ymqnk"}],["path",{d:"M9 18.12 10 14H4.17a2 2 0 0 1-1.92-2.56l2.33-8A2 2 0 0 1 6.5 2H20a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2h-2.76a2 2 0 0 0-1.79 1.11L12 22a3.13 3.13 0 0 1-3-3.88Z",key:"m61m77"}]],d6=ae("thumbs-down",c6);const u6=[["path",{d:"M7 10v12",key:"1qc93n"}],["path",{d:"M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2a3.13 3.13 0 0 1 3 3.88Z",key:"emmmcr"}]],p6=ae("thumbs-up",u6);const f6=[["line",{x1:"10",x2:"14",y1:"2",y2:"2",key:"14vaq8"}],["line",{x1:"12",x2:"15",y1:"14",y2:"11",key:"17fdiu"}],["circle",{cx:"12",cy:"14",r:"8",key:"1e1u0o"}]],m6=ae("timer",f6);const h6=[["path",{d:"m10 11 11 .9a1 1 0 0 1 .8 1.1l-.665 4.158a1 1 0 0 1-.988.842H20",key:"she1j9"}],["path",{d:"M16 18h-5",key:"bq60fd"}],["path",{d:"M18 5a1 1 0 0 0-1 1v5.573",key:"1kv8ia"}],["path",{d:"M3 4h8.129a1 1 0 0 1 .99.863L13 11.246",key:"1q1ert"}],["path",{d:"M4 11V4",key:"9ft8pt"}],["path",{d:"M7 15h.01",key:"k5ht0j"}],["path",{d:"M8 10.1V4",key:"1jgyzo"}],["circle",{cx:"18",cy:"18",r:"2",key:"1emm8v"}],["circle",{cx:"7",cy:"15",r:"5",key:"ddtuc"}]],x6=ae("tractor",h6);const g6=[["rect",{width:"16",height:"16",x:"4",y:"3",rx:"2",key:"1wxw4b"}],["path",{d:"M4 11h16",key:"mpoxn0"}],["path",{d:"M12 3v8",key:"1h2ygw"}],["path",{d:"m8 19-2 3",key:"13i0xs"}],["path",{d:"m18 22-2-3",key:"1p0ohu"}],["path",{d:"M8 15h.01",key:"a7atzg"}],["path",{d:"M16 15h.01",key:"rnfrdf"}]],y6=ae("tram-front",g6);const b6=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],v6=ae("trash-2",b6);const j6=[["path",{d:"M8 19a4 4 0 0 1-2.24-7.32A3.5 3.5 0 0 1 9 6.03V6a3 3 0 1 1 6 0v.04a3.5 3.5 0 0 1 3.24 5.65A4 4 0 0 1 16 19Z",key:"oadzkq"}],["path",{d:"M12 19v3",key:"npa21l"}]],w6=ae("tree-deciduous",j6);const N6=[["path",{d:"M10 10v.2A3 3 0 0 1 8.9 16H5a3 3 0 0 1-1-5.8V10a3 3 0 0 1 6 0Z",key:"1l6gj6"}],["path",{d:"M7 16v6",key:"1a82de"}],["path",{d:"M13 19v3",key:"13sx9i"}],["path",{d:"M12 19h8.3a1 1 0 0 0 .7-1.7L18 14h.3a1 1 0 0 0 .7-1.7L16 9h.2a1 1 0 0 0 .8-1.7L13 3l-1.4 1.5",key:"1sj9kv"}]],M6=ae("trees",N6);const _6=[["path",{d:"M16 17h6v-6",key:"t6n2it"}],["path",{d:"m22 17-8.5-8.5-5 5L2 7",key:"x473p"}]],E6=ae("trending-down",_6);const k6=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],C6=ae("trending-up",k6);const T6=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],S6=ae("triangle-alert",T6);const A6=[["path",{d:"M10 14.66v1.626a2 2 0 0 1-.976 1.696A5 5 0 0 0 7 21.978",key:"1n3hpd"}],["path",{d:"M14 14.66v1.626a2 2 0 0 0 .976 1.696A5 5 0 0 1 17 21.978",key:"rfe1zi"}],["path",{d:"M18 9h1.5a1 1 0 0 0 0-5H18",key:"7xy6bh"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M6 9a6 6 0 0 0 12 0V3a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1z",key:"1mhfuq"}],["path",{d:"M6 9H4.5a1 1 0 0 1 0-5H6",key:"tex48p"}]],P6=ae("trophy",A6);const D6=[["path",{d:"M14 18V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v11a1 1 0 0 0 1 1h2",key:"wrbu53"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["path",{d:"M19 18h2a1 1 0 0 0 1-1v-3.65a1 1 0 0 0-.22-.624l-3.48-4.35A1 1 0 0 0 17.52 8H14",key:"lysw3i"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}]],R6=ae("truck",D6);const $6=[["path",{d:"M12 4v16",key:"1654pz"}],["path",{d:"M4 7V5a1 1 0 0 1 1-1h14a1 1 0 0 1 1 1v2",key:"e0r10z"}],["path",{d:"M9 20h6",key:"s66wpe"}]],O6=ae("type",$6);const z6=[["path",{d:"M12 13v7a2 2 0 0 0 4 0",key:"rpgb42"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M20.992 13a1 1 0 0 0 .97-1.274 10.284 10.284 0 0 0-19.923 0A1 1 0 0 0 3 13z",key:"124nyo"}]],B6=ae("umbrella",z6);const L6=[["path",{d:"M3 7v6h6",key:"1v2h90"}],["path",{d:"M21 17a9 9 0 0 0-9-9 9 9 0 0 0-6 2.3L3 13",key:"1r6uu6"}]],V6=ae("undo",L6);const W6=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],U6=ae("upload",W6);const I6=[["path",{d:"m16 11 2 2 4-4",key:"9rsbq5"}],["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],H6=ae("user-check",I6);const q6=[["path",{d:"M10 15H6a4 4 0 0 0-4 4v2",key:"1nfge6"}],["path",{d:"m14.305 16.53.923-.382",key:"1itpsq"}],["path",{d:"m15.228 13.852-.923-.383",key:"eplpkm"}],["path",{d:"m16.852 12.228-.383-.923",key:"13v3q0"}],["path",{d:"m16.852 17.772-.383.924",key:"1i8mnm"}],["path",{d:"m19.148 12.228.383-.923",key:"1q8j1v"}],["path",{d:"m19.53 18.696-.382-.924",key:"vk1qj3"}],["path",{d:"m20.772 13.852.924-.383",key:"n880s0"}],["path",{d:"m20.772 16.148.924.383",key:"1g6xey"}],["circle",{cx:"18",cy:"15",r:"3",key:"gjjjvw"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],G6=ae("user-cog",q6);const F6=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],Y6=ae("user-minus",F6);const X6=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],Z6=ae("user-plus",X6);const Q6=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],J6=ae("user",Q6);const K6=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],eT=ae("users",K6);const tT=[["path",{d:"m16 2-2.3 2.3a3 3 0 0 0 0 4.2l1.8 1.8a3 3 0 0 0 4.2 0L22 8",key:"n7qcjb"}],["path",{d:"M15 15 3.3 3.3a4.2 4.2 0 0 0 0 6l7.3 7.3c.7.7 2 .7 2.8 0L15 15Zm0 0 7 7",key:"d0u48b"}],["path",{d:"m2.1 21.8 6.4-6.3",key:"yn04lh"}],["path",{d:"m19 5-7 7",key:"194lzd"}]],aT=ae("utensils-crossed",tT);const nT=[["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}],["path",{d:"M5 7c0-1.1.9-2 2-2h10a2 2 0 0 1 2 2v12H5V7Z",key:"1ezoue"}],["path",{d:"M22 19H2",key:"nuriw5"}]],sT=ae("vote",nT);const iT=[["path",{d:"M2 6c.6.5 1.2 1 2.5 1C7 7 7 5 9.5 5c2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"knzxuh"}],["path",{d:"M2 12c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"2jd2cc"}],["path",{d:"M2 18c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"rd2r6e"}]],rT=ae("waves",iT);const oT=[["path",{d:"M2 22 16 8",key:"60hf96"}],["path",{d:"M3.47 12.53 5 11l1.53 1.53a3.5 3.5 0 0 1 0 4.94L5 19l-1.53-1.53a3.5 3.5 0 0 1 0-4.94Z",key:"1rdhi6"}],["path",{d:"M7.47 8.53 9 7l1.53 1.53a3.5 3.5 0 0 1 0 4.94L9 15l-1.53-1.53a3.5 3.5 0 0 1 0-4.94Z",key:"1sdzmb"}],["path",{d:"M11.47 4.53 13 3l1.53 1.53a3.5 3.5 0 0 1 0 4.94L13 11l-1.53-1.53a3.5 3.5 0 0 1 0-4.94Z",key:"eoatbi"}],["path",{d:"M20 2h2v2a4 4 0 0 1-4 4h-2V6a4 4 0 0 1 4-4Z",key:"19rau1"}],["path",{d:"M11.47 17.47 13 19l-1.53 1.53a3.5 3.5 0 0 1-4.94 0L5 19l1.53-1.53a3.5 3.5 0 0 1 4.94 0Z",key:"tc8ph9"}],["path",{d:"M15.47 13.47 17 15l-1.53 1.53a3.5 3.5 0 0 1-4.94 0L9 15l1.53-1.53a3.5 3.5 0 0 1 4.94 0Z",key:"2m8kc5"}],["path",{d:"M19.47 9.47 21 11l-1.53 1.53a3.5 3.5 0 0 1-4.94 0L13 11l1.53-1.53a3.5 3.5 0 0 1 4.94 0Z",key:"vex3ng"}]],lT=ae("wheat",oT);const cT=[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}],["path",{d:"M5 12.859a10 10 0 0 1 5.17-2.69",key:"1dl1wf"}],["path",{d:"M19 12.859a10 10 0 0 0-2.007-1.523",key:"4k23kn"}],["path",{d:"M2 8.82a15 15 0 0 1 4.177-2.643",key:"1grhjp"}],["path",{d:"M22 8.82a15 15 0 0 0-11.288-3.764",key:"z3jwby"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],dT=ae("wifi-off",cT);const uT=[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M2 8.82a15 15 0 0 1 20 0",key:"dnpr2z"}],["path",{d:"M5 12.859a10 10 0 0 1 14 0",key:"1x1e6c"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}]],pT=ae("wifi",uT);const fT=[["path",{d:"M12.8 19.6A2 2 0 1 0 14 16H2",key:"148xed"}],["path",{d:"M17.5 8a2.5 2.5 0 1 1 2 4H2",key:"1u4tom"}],["path",{d:"M9.8 4.4A2 2 0 1 1 11 8H2",key:"75valh"}]],mT=ae("wind",fT);const hT=[["path",{d:"M8 22h8",key:"rmew8v"}],["path",{d:"M7 10h10",key:"1101jm"}],["path",{d:"M12 15v7",key:"t2xh3l"}],["path",{d:"M12 15a5 5 0 0 0 5-5c0-2-.5-4-2-8H9c-1.5 4-2 6-2 8a5 5 0 0 0 5 5Z",key:"10ffi3"}]],xT=ae("wine",hT);const gT=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],yT=ae("x",gT);const bT=[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]],vT=ae("zap",bT);const jT=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]],wT=ae("zoom-in",jT);const NT=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]],MT=ae("zoom-out",NT),_T={Hammer:xk,Pickaxe:sy,Trees:M6,Wheat:lT,Anvil:vM,ScrollText:l8,Users:eT,Globe:pk,Activity:xM,Crown:dE,Swords:Z8,Handshake:wk,ArrowUpCircle:M_,Cpu:sE,Home:Sk,Settings:x8,Castle:r_,Tent:s6,Landmark:Ok,Factory:PE,Zap:vT,Trash2:v6,Scale:r8,BookOpen:HM,Coins:J_,Gavel:sk,Shield:w8,Cross:rE,Briefcase:JM,UserCog:G6,Play:UC,Pause:zC,FastForward:OE,ArrowRight:CM,TrendingUp:C6,TrendingDown:E6,Package:AC,Sparkles:O8,ThumbsUp:p6,ThumbsDown:d6,X:yT,Target:a6,Bomb:UM,Truck:R6,Plus:HC,Minus:yC,AlertTriangle:S6,Info:Rk,Gift:lk,Lightbulb:Gk,BarChart:l_,MessageSquare:pC,Eye:SE,Flag:HE,Sword:G8,UserCheck:H6,Clock:B_,Check:d_,ArrowUp:PM,ArrowDown:EM,Calendar:s_,Heart:Mk,User:J6,Skull:S8,Star:U8,Leaf:Uk,Coffee:Y_,Flame:GE,Cog:Z_,Gem:rk,Mountain:wC,Boxes:ZM,Music2:MC,Navigation:ny,Train:y6,Anchor:yM,Ship:M8,Book:GM,Sliders:P8,Lock:Jk,FileText:UE,Shirt:E8,ShieldAlert:v8,ShoppingCart:C8,ArrowUpRight:SM,Compass:eE,Feather:BE,UtensilsCrossed:aT,Armchair:wM,Wine:xT,ArrowDownLeft:MM,DollarSign:mE,XCircle:P_,HelpCircle:C_,List:Zk,Paintbrush:DC,Droplets:wE,Save:s8,Download:xE,Table:J8,Building:a_,Building2:e_,Menu:lC,Axe:BM,TreeDeciduous:w6,Music:EC,Tractor:x6,GitBranch:dk,Horse:ny,Crosshair:lE,CloudRain:U_,Globe2:ME,Waves:rT,Palette:$C,Theater:l6,Scroll:d8,Fence:VE,Newspaper:TC,GraduationCap:mk,HandHeart:yk,Vote:sT,Drama:yE,Church:v_,Library:Hk,Microscope:mC,Syringe:Y8,Pitchfork:sy,LayoutGrid:Vk,Sun:H8,Wind:mT,Snowflake:R8,ChevronRight:x_,ChevronDown:p_,ChevronUp:y_,ChevronLeft:m_,Upload:U6,RefreshCw:ZC,Layers:Bk,Moon:vC,Cloud:H_,Umbrella:B6,Map:sC,MapPin:aC,Gauge:ak,Rocket:JC,Atom:RM,Wifi:pT,WifiOff:dT,Battery:VM,Power:GC,Code:G_,Terminal:r6,Share:y8,RotateCcw:e8,RotateCw:a8,Circle:R_,Square:V8,Copy:aE,Clipboard:O_,Pencil:LC,Edit:B8,Type:O6,Link:Yk,ExternalLink:EE,Bookmark:YM,Tag:e6,Award:OM,Trophy:P6,Timer:m6,Hourglass:Ck,History:Ek,Search:p8,Filter:ek,Maximize:rC,Minimize:xC,ZoomIn:wT,ZoomOut:MT,Focus:JE,Hand:vk,EyeOff:CE,Droplet:vE,Fan:RE,CheckCircle:E_,AlertCircle:w_,MessageCircle:dC,Mail:eC,Inbox:Pk,Send:m8,UserPlus:Z6,UserMinus:Y6,UserCircle:S_,Undo:V6,Redo:YC,Dices:pE,Flower:YE,Flower2:ZE,CloudLightning:V_},ET=t=>_T[t],k=({name:t,size:s=16,className:r})=>{const o=ET(t);return o?a.jsx(o,{size:s,className:r}):null},kT=({x:t,y:s,text:r,color:o,onComplete:c})=>a.jsx(As.div,{className:`fixed pointer-events-none font-bold text-lg z-50 ${o}`,style:{left:t,top:s},initial:{opacity:0,y:0,scale:.5},animate:{opacity:1,y:-50,scale:1},exit:{opacity:0},transition:{duration:.8,ease:"easeOut"},onAnimationComplete:c,children:r});var Ps=Ey();const CT=5e3,TT=({notification:t,onView:s,onDismiss:r,autoDismissDelay:o=CT})=>{const[c,u]=$.useState(!1),[p,m]=$.useState(100),h=$.useRef(null),x=$.useRef(Date.now()),g=$.useRef(0),b=$.useRef(r),j=t.result;$.useEffect(()=>{b.current=r},[r]),$.useEffect(()=>{const R=t.id;if(c){g.current=Date.now()-x.current,h.current&&cancelAnimationFrame(h.current);return}x.current=Date.now()-g.current;const E=()=>{const T=Date.now()-x.current,D=Math.max(0,100-T/o*100);m(D),D>0?h.current=requestAnimationFrame(E):b.current(R)};return h.current=requestAnimationFrame(E),()=>{h.current&&cancelAnimationFrame(h.current)}},[c,o,t.id]);const _=j.losses||j.defenderLosses||{},N=Object.values(_).reduce((R,E)=>R+(E||0),0),M=()=>{if(j.isRaid){const R=j.actionName||"";if(j.victory)return` ${j.nationName} ${R}`;{const E=[];return j.foodLoss>0&&E.push(`-${j.foodLoss}`),j.silverLoss>0&&E.push(`-${j.silverLoss}`),j.woodLoss>0&&E.push(`-${j.woodLoss}`),j.popLoss>0&&E.push(`-${j.popLoss}`),` ${j.nationName} ${R}${E.length>0?`${E.join("")}`:""}`}}else return j.victory?` ${j.nationName||""} ${N>0?`${N}`:""}`:` ${j.nationName||""} ${N>0?`${N}`:""}`};return a.jsxs("div",{className:`relative flex items-center gap-2 px-3 py-2 rounded-lg border shadow-lg backdrop-blur-sm cursor-pointer transition-all duration-200 overflow-hidden ${j.victory?"bg-emerald-900/80 border-emerald-500/40 hover:bg-emerald-800/80":"bg-red-900/80 border-red-500/40 hover:bg-red-800/80"} ${c?"scale-[1.02]":""}`,onClick:()=>s(t),onMouseEnter:()=>u(!0),onMouseLeave:()=>u(!1),children:[a.jsx("div",{className:`absolute bottom-0 left-0 h-0.5 transition-all ${j.victory?"bg-emerald-400/60":"bg-red-400/60"}`,style:{width:`${p}%`}}),a.jsx("div",{className:`flex-shrink-0 w-8 h-8 rounded-full flex items-center justify-center ${j.victory?"bg-emerald-700/50":"bg-red-700/50"}`,children:a.jsx(k,{name:j.isRaid?j.victory?"Shield":"Flame":j.victory?"Trophy":"Skull",size:16,className:j.victory?"text-emerald-300":"text-red-300"})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:`text-xs font-bold ${j.victory?"text-emerald-200":"text-red-200"}`,children:j.isRaid?j.victory?`${j.actionName||""}`:`${j.actionName||""}`:j.victory?"":""}),!j.isRaid&&typeof j.score=="number"&&a.jsxs("span",{className:"px-1.5 py-0.5 text-[9px] rounded-full bg-ancient-ink/50 text-ancient-parchment",children:[" ",j.score.toFixed(0)]})]}),a.jsx("p",{className:"text-[11px] text-gray-200 truncate leading-tight mt-0.5",children:M()})]}),a.jsxs("div",{className:"flex items-center gap-1 flex-shrink-0",children:[a.jsx("button",{onClick:R=>{R.stopPropagation(),s(t)},className:"p-1.5 rounded-md hover:bg-white/10 transition-colors text-gray-300 hover:text-white",title:"",children:a.jsx(k,{name:"Eye",size:14})}),a.jsx("button",{onClick:R=>{R.stopPropagation(),r(t.id)},className:"p-1.5 rounded-md hover:bg-white/10 transition-colors text-gray-300 hover:text-white",title:"",children:a.jsx(k,{name:"X",size:14})})]})]})},ST=({notifications:t=[],onViewDetail:s,onDismiss:r,onDismissAll:o})=>{if(!t||t.length===0)return null;const c=t.slice(-3),u=t.length-c.length;return Ps.createPortal(a.jsxs("div",{className:"fixed top-16 left-1/2 transform -translate-x-1/2 z-40 w-full max-w-md px-4 space-y-2 pointer-events-none",children:[u>0&&a.jsx("div",{className:"pointer-events-auto flex justify-center",children:a.jsxs("span",{className:"px-2 py-0.5 text-[10px] text-gray-400 bg-gray-800/60 rounded-full border border-gray-600/30",children:[" ",u," "]})}),c.map((p,m)=>a.jsx("div",{className:"pointer-events-auto animate-slide-down",style:{animationDelay:`${m*50}ms`},children:a.jsx(TT,{notification:p,onView:s,onDismiss:r})},p.id)),t.length>1&&a.jsx("div",{className:"pointer-events-auto flex justify-center pt-1",children:a.jsxs("button",{onClick:o,className:"px-3 py-1 text-[10px] text-gray-400 hover:text-white bg-gray-800/80 hover:bg-gray-700/80 rounded-full border border-gray-600/40 transition-colors",children:[" (",t.length,")"]})})]}),document.body)},Z0=({position:t="top-left",size:s=24,className:r=""})=>{const o={"top-left":"top-0 left-0","top-right":"top-0 right-0 rotate-90","bottom-left":"bottom-0 left-0 -rotate-90","bottom-right":"bottom-0 right-0 rotate-180"};return a.jsxs("svg",{className:`absolute ${o[t]} ${r}`,width:s,height:s,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[a.jsx("path",{d:"M2 2 L8 2 M2 2 L2 8 M2 2 L6 6",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",opacity:"0.6"}),a.jsx("path",{d:"M1 1 L1 10 M1 1 L10 1",stroke:"currentColor",strokeWidth:"0.5",strokeLinecap:"round",opacity:"0.3"})]})},ff=({opacity:t=.03,className:s=""})=>a.jsxs("svg",{className:`absolute inset-0 w-full h-full pointer-events-none ${s}`,style:{opacity:t},children:[a.jsx("defs",{children:a.jsxs("pattern",{id:"ancient-pattern",x:"0",y:"0",width:"100",height:"100",patternUnits:"userSpaceOnUse",children:[a.jsx("path",{d:"M0 20 L20 20 L20 0 M40 0 L40 20 L60 20 M60 40 L40 40 L40 60 M20 60 L20 40 L0 40",stroke:"currentColor",strokeWidth:"1",fill:"none",opacity:"0.5"}),a.jsx("circle",{cx:"10",cy:"10",r:"1",fill:"currentColor",opacity:"0.3"}),a.jsx("circle",{cx:"50",cy:"50",r:"1",fill:"currentColor",opacity:"0.3"}),a.jsx("circle",{cx:"90",cy:"90",r:"1",fill:"currentColor",opacity:"0.3"}),a.jsx("line",{x1:"0",y1:"0",x2:"20",y2:"20",stroke:"currentColor",strokeWidth:"0.5",opacity:"0.2"}),a.jsx("line",{x1:"80",y1:"80",x2:"100",y2:"100",stroke:"currentColor",strokeWidth:"0.5",opacity:"0.2"})]})}),a.jsx("rect",{width:"100%",height:"100%",fill:"url(#ancient-pattern)",className:"text-amber-600"})]}),AT=({children:t,className:s="",variant:r="ancient",delay:o=0})=>{const c={ancient:"glass-ancient",epic:"glass-epic",monument:"glass-monument"};return a.jsxs(As.div,{className:`relative ${c[r]} rounded-xl p-6 ${s}`,initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:o},whileHover:{scale:1.01,boxShadow:"0 10px 30px rgba(0,0,0,0.5)"},children:[a.jsx(Z0,{position:"top-left",className:"text-amber-500/60"}),a.jsx(Z0,{position:"top-right",className:"text-amber-500/60"}),a.jsx(Z0,{position:"bottom-left",className:"text-amber-500/60"}),a.jsx(Z0,{position:"bottom-right",className:"text-amber-500/60"}),a.jsx(ff,{opacity:.02}),a.jsx("div",{className:"relative z-10",children:t})]})},iy=({value:t,format:s=o=>Math.floor(o),className:r=""})=>{const o=cM(t,{stiffness:40,damping:20}),c=w2(o,u=>s(u));return $.useEffect(()=>{o.set(t)},[t,o]),a.jsx(As.span,{className:`inline-block ${r}`,children:c})},PT=({gameState:t,taxes:s,netSilverPerDay:r,tradeStats:o={tradeTax:0},armyFoodNeed:c,playerInstallmentPayment:u=null,onResourceDetailClick:p,onPopulationDetailClick:m,onStrataClick:h,onMarketClick:x,onEmpireSceneClick:g,gameControls:b})=>{const[_,N]=$.useState(!1),[M,R]=$.useState(!1),E=$.useRef(null),T=$.useRef(null),D=$.useRef(null),O=$.useRef(M),[q,I]=$.useState({top:0,left:0}),Z=()=>{if(!E.current)return null;const me=E.current.getBoundingClientRect();return{top:me.bottom+8,left:me.left+me.width/2}},Y=id(t.daysElapsed||0),U=t.market?.prices?.food??(Re.food?.basePrice||1),S=t.militaryWageRatio||1,Q=c*U*S,ne=o?.tradeTax||0,Ne=s.breakdown?.policyIncome||0,$e=s.breakdown?.policyExpense||0,de=r>=0?"text-green-300":"text-red-300",P=ne>=0?"text-emerald-300":"text-red-300",z=wn[t.epoch]||wn[0],V=me=>me>=1e6?(me/1e6).toFixed(1)+"M":me>=1e3?(me/1e3).toFixed(1)+"K":Math.floor(me).toString(),re=(me=>({:{icon:"Leaf",color:"text-green-400"},:{icon:"Sun",color:"text-yellow-400"},:{icon:"Wind",color:"text-orange-400"},:{icon:"Snowflake",color:"text-blue-300"}})[me]||{icon:"Calendar",color:"text-ancient-gold"})(Y.season);$.useLayoutEffect(()=>{if(!_)return;const me=()=>{const X=Z();X&&I(X)};return me(),window.addEventListener("resize",me),window.addEventListener("scroll",me,!0),()=>{window.removeEventListener("resize",me),window.removeEventListener("scroll",me,!0)}},[_]),$.useEffect(()=>{O.current=M},[M]),$.useEffect(()=>()=>{D.current&&clearTimeout(D.current)},[]);const C=()=>{const me=Z();me&&I(me),N(!0)},L=()=>{N(!1)},ie=()=>{R(me=>{const X=!me;return X?C():L(),X})},H=me=>{if(D.current&&(clearTimeout(D.current),D.current=null),me){C();return}O.current||(D.current=window.setTimeout(()=>{O.current||L()},150))},ve=me=>{if(T.current){const X=T.current.getBoundingClientRect(),qe=me.clientX;if(qe>=X.left&&qe<=X.right){D.current&&(clearTimeout(D.current),D.current=null),_&&L(),M&&R(!1),p&&p("silver");return}}ie()};return a.jsxs("header",{className:"relative overflow-visible",children:[a.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-ancient-ink/95 via-ancient-stone/40 to-ancient-ink/95 backdrop-blur-md"}),a.jsx("div",{className:"absolute inset-0 animate-shimmer opacity-20",style:{backgroundImage:"linear-gradient(90deg, transparent 0%, rgba(212, 175, 55, 0.15) 50%, transparent 100%)",backgroundSize:"200% 100%"}}),a.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-px bg-gradient-to-r from-transparent via-ancient-gold/50 to-transparent"}),a.jsx("div",{className:"status-bar-scroll max-w-[1920px] mx-auto px-2 sm:px-4 py-1.5 sm:py-2 relative z-10 overflow-x-auto overflow-y-visible cursor-grab active:cursor-grabbing select-none",style:{WebkitOverflowScrolling:"touch"},onMouseDown:me=>{const X=me.currentTarget;X.dataset.isDragging="true",X.dataset.startX=me.pageX-X.offsetLeft,X.dataset.scrollLeft=X.scrollLeft},onMouseUp:me=>{me.currentTarget.dataset.isDragging="false"},onMouseLeave:me=>{me.currentTarget.dataset.isDragging="false"},onMouseMove:me=>{const X=me.currentTarget;if(X.dataset.isDragging!=="true")return;me.preventDefault();const fe=(me.pageX-X.offsetLeft-parseFloat(X.dataset.startX))*1.5;X.scrollLeft=parseFloat(X.dataset.scrollLeft)-fe},children:a.jsxs("div",{className:"flex items-center justify-between gap-2 min-w-max",children:[a.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 flex-shrink-0",children:[a.jsxs("div",{className:"relative group",children:[a.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-ancient-gold to-ancient-bronze rounded-lg blur-md opacity-40 group-hover:opacity-60 transition-opacity"}),a.jsx("div",{className:"relative bg-gradient-to-br from-ancient-gold/20 to-ancient-bronze/20 p-1.5 rounded-lg border border-ancient-gold/30 shadow-glow-gold",children:a.jsx(k,{name:"Globe",size:14,className:"text-ancient-gold"})})]}),a.jsxs("div",{className:"hidden sm:flex flex-col",children:[a.jsx("span",{className:"text-[11px] font-bold text-ancient-stone uppercase tracking-wider font-decorative",children:""}),a.jsxs("span",{className:"text-[10px] font-bold text-ancient flex items-center gap-1 font-decorative",children:[a.jsx("span",{children:z.icon||""}),z.name]})]}),a.jsxs("div",{className:"sm:hidden flex items-center gap-1",children:[a.jsx("span",{className:"text-sm",children:z.icon||""}),a.jsx("span",{className:"text-[10px] font-bold text-ancient-gold",children:z.name})]}),a.jsxs("button",{onClick:()=>{g&&g()},className:"relative group flex items-center gap-1.5 glass-ancient px-2 py-1 rounded-lg border border-ancient-gold/20 hover:border-ancient-gold/40 hover:shadow-glow-gold transition-all touch-feedback",children:[a.jsx(k,{name:re.icon,size:12,className:re.color}),a.jsx("div",{className:"text-[9px] sm:text-[10px] leading-tight",children:a.jsxs("span",{className:"font-bold text-ancient-parchment font-decorative",children:[Y.year,"  ",Y.season]})})]})]}),a.jsxs("div",{className:"flex items-center gap-1.5 sm:gap-2 justify-start sm:justify-center flex-shrink-0",children:[a.jsxs("div",{className:"relative flex items-center gap-0.5",children:[a.jsxs("button",{ref:E,onClick:ve,onMouseEnter:()=>H(!0),onMouseLeave:()=>H(!1),className:"relative group flex items-center gap-1 sm:gap-1.5 glass-ancient px-2 sm:px-2.5 py-1 rounded-lg border border-ancient-gold/30 hover:border-ancient-gold/60 hover:shadow-glow-gold transition-all flex-shrink-0 overflow-hidden touch-feedback",children:[a.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-ancient-gold/10 via-ancient-gold/5 to-transparent opacity-0 group-hover:opacity-100 transition-opacity"}),a.jsxs("div",{ref:T,className:"flex items-center gap-1 sm:gap-1.5 relative z-10",children:[a.jsx("div",{className:"icon-epic-frame icon-frame-xs resource-icon-gold",children:a.jsx(k,{name:"Coins",size:10,className:"text-ancient-gold"})}),a.jsx("span",{className:"font-mono text-[11px] sm:text-xs font-bold text-ancient",children:a.jsx(iy,{value:t.resources.silver||0,format:V})})]}),a.jsxs("div",{className:`flex items-center gap-0.5 text-[9px] px-1 py-0.5 rounded ${r>=0?"bg-green-900/30":"bg-red-900/30"}`,children:[a.jsx(k,{name:r>=0?"TrendingUp":"TrendingDown",size:9,className:de}),a.jsxs("span",{className:`font-mono ${de}`,children:[r>=0?"+":"",r.toFixed(0)]})]})]}),_&&Ps.createPortal(a.jsx("div",{className:"pointer-events-none fixed inset-0",style:{zIndex:95},"aria-live":"polite",children:a.jsx("div",{className:"absolute pointer-events-none",style:{top:`${q.top}px`,left:`${q.left}px`,transform:"translateX(-50%)"},children:a.jsxs("div",{className:"pointer-events-auto w-72 glass-epic border border-ancient-gold/40 rounded-xl p-3 shadow-monument animate-slide-up",onMouseEnter:()=>H(!0),onMouseLeave:()=>H(!1),children:[a.jsxs("div",{className:"flex items-center justify-between text-[11px] text-ancient-parchment mb-2",children:[a.jsxs("span",{className:"font-bold flex items-center gap-1.5",children:[a.jsx(k,{name:"BarChart",size:12,className:"text-ancient-gold"})," ()"]}),a.jsx("button",{onClick:()=>N(!1),children:a.jsx(k,{name:"X",size:14,className:"text-ancient-stone hover:text-white"})})]}),a.jsxs("div",{className:"text-[10px] space-y-1.5",children:[a.jsxs("div",{className:"stat-item-compact",children:[a.jsx("span",{className:"text-ancient-stone",children:""}),a.jsxs("span",{className:"text-green-300 font-mono",children:["+",s.breakdown?.headTax?.toFixed(1)||"0"]})]}),a.jsxs("div",{className:"stat-item-compact",children:[a.jsx("span",{className:"text-ancient-stone",children:""}),a.jsxs("span",{className:"text-green-300 font-mono",children:["+",s.breakdown?.industryTax?.toFixed(1)||"0"]})]}),a.jsxs("div",{className:"stat-item-compact",children:[a.jsx("span",{className:"text-ancient-stone",children:""}),a.jsxs("span",{className:"text-green-300 font-mono",children:["+",s.breakdown?.businessTax?.toFixed(1)||"0"]})]}),a.jsxs("div",{className:"stat-item-compact",children:[a.jsx("span",{className:"text-ancient-stone",children:""}),a.jsxs("span",{className:`${P} font-mono`,children:[ne>=0?"+":"",ne.toFixed(1)]})]}),Ne>0&&a.jsxs("div",{className:"stat-item-compact",children:[a.jsx("span",{className:"text-ancient-stone",children:""}),a.jsxs("span",{className:"text-green-300 font-mono",children:["+",Ne.toFixed(1)]})]}),(s.breakdown?.warIndemnity||0)>0&&a.jsxs("div",{className:"stat-item-compact",children:[a.jsx("span",{className:"text-ancient-stone",children:""}),a.jsxs("span",{className:"text-green-300 font-mono",children:["+",s.breakdown.warIndemnity.toFixed(1)]})]}),a.jsx("div",{className:"epic-divider"}),a.jsxs("div",{className:"stat-item-compact",children:[a.jsx("span",{className:"text-ancient-stone",children:""}),a.jsxs("span",{className:"text-red-300 font-mono",children:["-",Q.toFixed(1)]})]}),s.breakdown?.subsidy>0&&a.jsxs("div",{className:"stat-item-compact",children:[a.jsx("span",{className:"text-ancient-stone",children:""}),a.jsxs("span",{className:"text-red-300 font-mono",children:["-",s.breakdown.subsidy.toFixed(1)]})]}),$e>0&&a.jsxs("div",{className:"stat-item-compact",children:[a.jsx("span",{className:"text-ancient-stone",children:""}),a.jsxs("span",{className:"text-red-300 font-mono",children:["-",$e.toFixed(1)]})]}),u&&u.remainingDays>0&&a.jsxs("div",{className:"stat-item-compact",children:[a.jsx("span",{className:"text-ancient-stone",children:""}),a.jsxs("span",{className:"text-red-300 font-mono",children:["-",u.amount.toFixed(1)]})]}),a.jsx("div",{className:"epic-divider"}),a.jsxs("div",{className:"stat-item-compact bg-ancient-gold/10",children:[a.jsx("span",{className:"font-bold text-ancient-parchment",children:""}),a.jsxs("span",{className:`font-bold font-mono ${de}`,children:[r>=0?"+":"",r.toFixed(1)]})]})]})]})})}),document.body)]}),a.jsxs("button",{onClick:m,className:"relative group flex items-center gap-1 glass-ancient px-2 py-1 rounded-lg border border-blue-400/30 hover:border-blue-400/60 hover:shadow-glow transition-all flex-shrink-0 overflow-hidden touch-feedback",children:[a.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-blue-500/10 via-blue-400/5 to-transparent opacity-0 group-hover:opacity-100 transition-opacity"}),a.jsx("div",{className:"icon-epic-frame icon-frame-xs",style:{borderColor:"rgba(96, 165, 250, 0.4)",background:"linear-gradient(135deg, rgba(59, 130, 246, 0.1), rgba(37, 99, 235, 0.08))"},children:a.jsx(k,{name:"Users",size:10,className:"text-blue-300"})}),a.jsxs("div",{className:"flex items-baseline gap-0.5 relative z-10",children:[a.jsx("span",{className:"font-mono text-[13px] font-bold text-blue-200",children:a.jsx(iy,{value:t.population,format:V})}),a.jsxs("span",{className:"text-[11px] font-bold text-ancient-gold",children:["/",V(t.maxPop)]})]})]}),a.jsxs("div",{className:"lg:hidden flex items-center gap-1",children:[a.jsxs("button",{onClick:h,className:"relative group flex items-center gap-1 glass-ancient px-2 py-1 rounded-lg border border-purple-400/40 hover:border-purple-300/60 transition-all flex-shrink-0 overflow-hidden touch-feedback",title:"",children:[a.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-purple-500/20 via-purple-400/10 to-transparent opacity-0 group-hover:opacity-100 transition-opacity"}),a.jsx(k,{name:"Crown",size:12,className:"text-purple-300 relative z-10"}),a.jsx("span",{className:"text-[9px] text-purple-200 font-semibold relative z-10",children:""})]}),a.jsxs("button",{onClick:x,className:"relative group flex items-center gap-1 glass-ancient px-2 py-1 rounded-lg border border-amber-400/40 hover:border-amber-300/60 transition-all flex-shrink-0 overflow-hidden touch-feedback",title:"",children:[a.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-amber-500/20 via-amber-400/10 to-transparent opacity-0 group-hover:opacity-100 transition-opacity"}),a.jsx(k,{name:"Package",size:12,className:"text-amber-300 relative z-10"}),a.jsx("span",{className:"text-[9px] text-amber-200 font-semibold relative z-10",children:""})]})]})]}),b&&a.jsx("div",{className:"hidden lg:flex items-center flex-shrink-0",children:b})]})})]})},DT={build:{label:"",icon:"Hammer",color:"from-amber-500 to-yellow-600",glow:"shadow-amber-500/40",text:"text-amber-400",border:"border-amber-500/50"},military:{label:"",icon:"Swords",color:"from-red-500 to-rose-600",glow:"shadow-red-500/40",text:"text-red-400",border:"border-red-500/50"},tech:{label:"",icon:"Cpu",color:"from-cyan-500 to-blue-600",glow:"shadow-cyan-500/40",text:"text-cyan-400",border:"border-cyan-500/50"},politics:{label:"",icon:"Gavel",color:"from-purple-500 to-violet-600",glow:"shadow-purple-500/40",text:"text-purple-400",border:"border-purple-500/50"},diplo:{label:"",icon:"Globe",color:"from-emerald-500 to-green-600",glow:"shadow-emerald-500/40",text:"text-emerald-400",border:"border-emerald-500/50"}},RT=({activeTab:t,onTabChange:s,epoch:r=0})=>{const o=Object.entries(DT).map(([c,u])=>({id:c,...u}));return a.jsxs("nav",{className:"fixed bottom-0 left-0 right-0 z-50 lg:hidden",role:"tablist","aria-label":"",style:{paddingBottom:"env(safe-area-inset-bottom, 0px)"},children:[a.jsxs("div",{className:"absolute inset-0",children:[a.jsx("div",{className:"absolute inset-0 backdrop-blur-lg",style:{background:"linear-gradient(to top, var(--theme-background, rgb(17, 24, 39)) 0%, color-mix(in srgb, var(--theme-surface, rgb(31, 41, 55)) 95%, transparent) 50%, color-mix(in srgb, var(--theme-surface-alt, rgb(55, 65, 81)) 90%, transparent) 100%)"}}),a.jsx("div",{className:"absolute top-0 left-0 right-0 h-px",style:{background:"linear-gradient(to right, transparent, var(--theme-accent, rgb(212, 175, 55)) 50%, transparent)"}}),a.jsx("div",{className:"absolute top-[1px] left-0 right-0 h-px bg-gradient-to-r from-transparent via-white/10 to-transparent"}),a.jsx("div",{className:"absolute inset-0 opacity-[0.03]",style:{backgroundImage:"repeating-linear-gradient(90deg, transparent, transparent 1px, rgba(255,255,255,0.03) 1px, rgba(255,255,255,0.03) 2px)"}})]}),a.jsx("div",{className:"relative max-w-lg mx-auto px-1",children:a.jsx("div",{className:"flex items-stretch justify-around h-14",children:o.map(c=>{const u=t===c.id;return a.jsxs("button",{type:"button",role:"tab","aria-label":c.label,"aria-selected":u,onClick:()=>s(c.id),className:`
                  relative flex flex-col items-center justify-center flex-1
                  transition-all duration-200 ease-out
                  ${u?"scale-105":"active:scale-95"}
                `,children:[u&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:`absolute inset-x-1 top-1 bottom-1 rounded-lg bg-gradient-to-b ${c.color} opacity-15 blur-sm`}),a.jsx("div",{className:`absolute inset-x-1 top-1 bottom-1 rounded-lg bg-gradient-to-b ${c.color} opacity-20 border ${c.border}`}),a.jsx("div",{className:`absolute top-0 left-1/4 right-1/4 h-0.5 rounded-full bg-gradient-to-r ${c.color}`})]}),a.jsx("div",{className:`
                  relative z-10 p-1 rounded-md transition-all duration-200
                  ${u?"":"text-gray-500"}
                `,children:a.jsx(k,{name:c.icon,size:u?20:18,className:`transition-all duration-200 ${u?c.text:""}`})}),a.jsx("span",{className:`
                  relative z-10 text-[9px] font-bold mt-0.5 transition-all duration-200 tab-title
                  ${u?c.text:"text-gray-500"}
                `,children:c.label})]},c.id)})})})]})},bo={overlay:"fixed inset-0 bg-ancient-ink/80 backdrop-blur-sm z-50 flex items-center justify-center p-4",container:{base:"relative w-full max-w-2xl glass-epic border-2 border-ancient-gold/30 rounded-2xl shadow-metal-xl shadow-depth-xl flex flex-col max-h-[90vh]",sm:"max-w-md",md:"max-w-2xl",lg:"max-w-4xl",xl:"max-w-6xl"},header:"flex items-center justify-between p-4 border-b border-ancient-gold/20 flex-shrink-0",body:"flex-1 overflow-y-auto p-4",footer:"flex items-center justify-end gap-3 p-4 border-t border-ancient-gold/20 flex-shrink-0",closeButton:"p-2 rounded-lg hover:bg-ancient-gold/10 transition-colors text-ancient-stone hover:text-ancient-gold"},wo=(...t)=>t.filter(Boolean).join(" "),ry=({isPaused:t,gameSpeed:s,onPauseToggle:r,onSpeedChange:o,onSave:c,onLoadManual:u,onLoadAuto:p,onSettings:m,onReset:h,onTutorial:x,onWiki:g,autoSaveAvailable:b,menuDirection:j="down",onTriggerEvent:_})=>{const[N,M]=$.useState(!1),[R,E]=$.useState(!1),[T,D]=$.useState(!1),[O,q]=$.useState(null),[I,Z]=$.useState(null),Y=$.useRef(null),U=$.useRef(null),S=$.useRef(null),Q=$.useRef(null),{playSound:ne,SOUND_TYPES:Ne}=Mf(),$e=(F,re="down")=>{if(!F)return null;const C=F.getBoundingClientRect(),L=8,ie=re==="up";return{top:ie?C.top-L:C.bottom+L,left:C.right,translateY:ie?"-100%":"0"}},de=()=>{if(!Y.current)return;const F=$e(Y.current,j);F&&q(F)},P=()=>{if(!U.current)return;const F=$e(U.current,j);F&&Z(F)};$.useLayoutEffect(()=>{if(!N)return;de();const F=()=>de();return window.addEventListener("resize",F),window.addEventListener("scroll",F,!0),()=>{window.removeEventListener("resize",F),window.removeEventListener("scroll",F,!0)}},[N,j]),$.useLayoutEffect(()=>{if(!T)return;P();const F=()=>P();return window.addEventListener("resize",F),window.addEventListener("scroll",F,!0),()=>{window.removeEventListener("resize",F),window.removeEventListener("scroll",F,!0)}},[T,j]),$.useEffect(()=>{const F=re=>{const C=re.target;N&&!Y.current?.contains(C)&&!S.current?.contains(C)&&(M(!1),E(!1)),T&&!U.current?.contains(C)&&!Q.current?.contains(C)&&D(!1)};return document.addEventListener("mousedown",F),()=>document.removeEventListener("mousedown",F)},[N,T]);const z=()=>{N?E(!1):de(),M(F=>!F)},V=()=>{T||P(),D(F=>!F)};return a.jsxs("div",{className:"game-controls flex items-stretch sm:items-center gap-0.5 sm:gap-1.5 h-8 sm:h-7",children:[a.jsxs("div",{className:"flex items-center h-full rounded-md sm:rounded-lg border border-ancient-gold/20 glass-ancient shadow-ancient",children:[a.jsxs("button",{onClick:()=>{ne(Ne.CLICK),r()},className:wo("h-full px-1.5 sm:px-2 transition-all flex items-center justify-center gap-1 text-[9px] sm:text-[10px] font-bold touch-feedback",t?"bg-green-500/10 border-r border-green-500/30 text-green-300 hover:bg-green-500/20":"bg-orange-500/10 border-r border-orange-500/30 text-orange-300 hover:bg-orange-500/20"),title:t?"":"",children:[a.jsx(k,{name:t?"Play":"Pause",size:10,className:"sm:w-3 sm:h-3 flex-shrink-0"}),a.jsx("span",{className:"hidden sm:inline",children:t?"":""})]}),a.jsx("div",{className:"flex items-center h-full",children:e5.map((F,re)=>a.jsxs("button",{onClick:()=>{ne(Ne.CLICK),o(F),t&&r()},disabled:t,className:wo("h-full px-1.5 sm:px-2 text-[9px] sm:text-[10px] font-bold transition-all flex items-center justify-center touch-feedback",re>0&&"border-l border-ancient-gold/10",t?"text-ancient-stone/40 cursor-not-allowed":"hover:bg-ancient-gold/10",s===F&&!t?"bg-gradient-to-b from-ancient-gold/25 to-ancient-bronze/15 text-ancient-gold":t?"":"text-ancient-parchment/80"),title:t?"":`${F}`,children:[F,"x"]},F))})]}),a.jsxs("div",{className:"flex h-full",children:[a.jsx("button",{ref:Y,onClick:z,className:"h-full px-2 glass-ancient border border-ancient-gold/20 rounded-md sm:rounded-lg transition-all flex items-center justify-center text-ancient-parchment shadow-ancient hover:border-ancient-gold/40 hover:shadow-glow-gold touch-feedback",title:"",children:a.jsx(k,{name:"Menu",size:12,className:"sm:w-3.5 sm:h-3.5 text-ancient-gold"})}),N&&O&&Ps.createPortal(a.jsx("div",{className:"pointer-events-none fixed inset-0 z-40",children:a.jsx("div",{className:"absolute",style:{top:O.top,left:O.left,transform:`translate(-100%, ${O.translateY})`},children:a.jsxs("div",{ref:S,className:wo("relative w-40 rounded-lg border border-ancient-gold/30 glass-epic shadow-monument py-1 pointer-events-auto animate-slide-up",j==="up"?"origin-bottom-right":"origin-top-right"),children:[a.jsxs("button",{onClick:()=>{c(),M(!1)},className:"w-full flex items-center px-3 py-2 text-[10px] font-semibold text-green-300 hover:bg-ancient-gold/10 transition-colors rounded touch-feedback",children:[a.jsx(k,{name:"Save",size:12}),a.jsx("span",{className:"ml-2",children:""})]}),a.jsxs("div",{className:"relative",children:[a.jsxs("button",{onClick:()=>E(!R),className:"w-full flex items-center justify-between px-3 py-2 text-[10px] font-semibold text-purple-300 hover:bg-ancient-gold/10 transition-colors rounded touch-feedback",children:[a.jsxs("div",{className:"flex items-center",children:[a.jsx(k,{name:"Upload",size:12}),a.jsx("span",{className:"ml-2",children:""})]}),a.jsx(k,{name:R?"ChevronDown":"ChevronRight",size:10})]}),R&&a.jsxs("div",{className:wo("absolute w-36 rounded-lg border border-ancient-gold/30 glass-epic shadow-monument py-1 animate-slide-up",j==="up"?"right-full bottom-0 mr-1 origin-bottom-right":"right-full top-0 mr-1 origin-top-right"),children:[a.jsxs("button",{onClick:()=>{u(),M(!1),E(!1)},className:"w-full flex items-center px-3 py-2 text-[10px] font-semibold text-ancient-parchment hover:bg-ancient-gold/10 transition-colors rounded touch-feedback",children:[a.jsx(k,{name:"Upload",size:10}),a.jsx("span",{className:"ml-2",children:""})]}),a.jsxs("button",{onClick:()=>{b&&(p(),M(!1),E(!1))},disabled:!b,className:wo("w-full flex items-center justify-between px-3 py-2 text-[10px] font-semibold transition-colors rounded touch-feedback",b?"text-amber-300 hover:bg-ancient-gold/10":"text-ancient-stone/40 cursor-not-allowed"),children:[a.jsx("span",{className:"ml-2",children:""}),a.jsx(k,{name:"Clock",size:10})]})]})]}),a.jsxs("button",{onClick:()=>{m(),M(!1)},className:"w-full flex items-center px-3 py-2 text-[10px] font-semibold text-ancient-parchment hover:bg-ancient-gold/10 transition-colors rounded touch-feedback",children:[a.jsx(k,{name:"Settings",size:12}),a.jsx("span",{className:"ml-2",children:""})]}),a.jsx("div",{className:"my-1 h-px bg-gradient-to-r from-transparent via-ancient-gold/30 to-transparent mx-2"}),a.jsxs("button",{onClick:()=>{window.confirm("")&&(h(),M(!1))},className:"w-full flex items-center px-3 py-2 text-[10px] font-semibold text-red-300 hover:bg-red-500/10 transition-colors rounded touch-feedback",children:[a.jsx(k,{name:"RefreshCw",size:12}),a.jsx("span",{className:"ml-2",children:""})]})]})})}),document.body)]}),a.jsxs("div",{className:"flex h-full",children:[a.jsx("button",{ref:U,onClick:V,className:"h-full px-2 glass-ancient border border-blue-500/30 rounded-md sm:rounded-lg transition-all flex items-center justify-center text-blue-300 shadow-ancient hover:border-blue-500/50 hover:bg-blue-500/10 touch-feedback",title:"",children:a.jsx(k,{name:"HelpCircle",size:12,className:"sm:w-3.5 sm:h-3.5"})}),T&&I&&Ps.createPortal(a.jsx("div",{className:"pointer-events-none fixed inset-0 z-40",children:a.jsx("div",{className:"absolute",style:{top:I.top,left:I.left,transform:`translate(-100%, ${I.translateY})`},children:a.jsxs("div",{ref:Q,className:wo("w-36 rounded-lg border border-ancient-gold/30 glass-epic shadow-monument py-1 pointer-events-auto animate-slide-up",j==="up"?"origin-bottom-right":"origin-top-right"),children:[a.jsxs("button",{onClick:()=>{x(),D(!1)},className:"w-full flex items-center px-3 py-2 text-[10px] font-semibold text-ancient-parchment hover:bg-ancient-gold/10 transition-colors rounded touch-feedback",children:[a.jsx(k,{name:"BookOpen",size:10}),a.jsx("span",{className:"ml-2",children:""})]}),a.jsxs("button",{onClick:()=>{g(),D(!1)},className:"w-full flex items-center px-3 py-2 text-[10px] font-semibold text-ancient-parchment hover:bg-ancient-gold/10 transition-colors rounded touch-feedback",children:[a.jsx(k,{name:"Book",size:10}),a.jsx("span",{className:"ml-2",children:""})]})]})})}),document.body)]})]})},mr=({isOpen:t,onClose:s,children:r,title:o,showHeader:c=!0,preventBackdropClose:u=!1,showCloseButton:p=!0,preventEscapeClose:m=!1})=>($.useEffect(()=>{if(m)return;const h=x=>{x.key==="Escape"&&s()};return document.addEventListener("keydown",h),()=>document.removeEventListener("keydown",h)},[m,s]),Ps.createPortal(a.jsx(Ro,{children:t&&a.jsxs("div",{className:"fixed inset-0 z-50 flex items-end justify-center lg:items-center",role:"dialog","aria-modal":"true",children:[a.jsx(As.div,{className:"absolute inset-0 bg-black/60",onClick:u?void 0:s,initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.3}}),a.jsx(As.div,{className:"relative w-full max-w-2xl glass-epic border-t-2 lg:border-2 border-ancient-gold/30 rounded-t-2xl lg:rounded-2xl shadow-metal-xl flex flex-col max-h-[85vh]",initial:{y:"100%",opacity:0},animate:{y:0,opacity:1},exit:{y:"100%",opacity:0},transition:{type:"spring",damping:25,stiffness:300},children:c?a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex-shrink-0 p-4 border-b border-theme-border flex items-center justify-between",children:[a.jsx("h3",{className:"text-lg font-bold text-white font-decorative",children:o}),p&&a.jsx("button",{onClick:s,className:"p-2 rounded-full hover:bg-gray-700",children:a.jsx(k,{name:"X",size:20,className:"text-gray-400"})})]}),a.jsx("div",{className:"flex-1 p-4 overflow-y-auto",children:r})]}):a.jsxs("div",{className:"relative flex-1 p-4 overflow-y-auto",children:[p&&a.jsx("button",{onClick:s,className:"absolute top-3 right-3 z-10 p-2 rounded-full bg-gray-900/50 hover:bg-gray-700/80 transition-colors",children:a.jsx(k,{name:"X",size:20,className:"text-gray-400"})}),r]})})]})}),document.body)),$T=(t,s)=>{if(t==="silver")return 1;const r=Re[t]?.basePrice||1;return s?.prices?.[t]??r},Ci=(t={},s)=>Object.entries(t).reduce((r,[o,c])=>c?r+c*$T(o,s):r,0),vr=t=>`${Math.ceil(t)} `,Sp=({title:t,icon:s,children:r,className:o=""})=>a.jsxs("div",{className:`bg-gray-900/50 p-3 rounded-lg border border-gray-700/80 ${o}`,children:[a.jsxs("h4",{className:"text-xs font-semibold text-gray-300 mb-2 flex items-center gap-1.5 font-decorative",children:[a.jsx(k,{name:s,size:16}),t]}),a.jsx("div",{className:"space-y-1 text-xs",children:r})]}),Ap=({label:t,value:s,valueClass:r="text-white"})=>a.jsxs("div",{className:"flex justify-between items-center py-0.5",children:[a.jsx("span",{className:"text-gray-300",children:t}),a.jsx("span",{className:`font-mono font-semibold ${r}`,children:s})]}),OT=t=>t>=1e6?(t/1e6).toFixed(1)+"M":t>=1e4?(t/1e3).toFixed(0)+"k":t>=1e3?(t/1e3).toFixed(1)+"k":Math.floor(t).toString(),zT=({building:t,gameState:s,onBuy:r,onSell:o,taxPolicies:c,onUpdateTaxPolicies:u})=>{if(!t||!s)return null;const{resources:p,epoch:m,techsUnlocked:h,market:x,buildings:g,jobFill:b}=s,j=g[t.id]||0,[_,N]=$.useState(null),M=F=>!F||F==="silver"?1:x?.prices?.[F]??(Re[F]?.basePrice||0),R=F=>{const re=Object.entries(F.output||{}).reduce((ie,[H,ve])=>ie+M(H)*ve,0),C=Object.entries(F.input||{}).reduce((ie,[H,ve])=>ie+M(H)*ve,0),L=Object.entries(F.jobs||{}).reduce((ie,[H,ve])=>ie+(x?.wages?.[H]||0)*ve,0);return re-C-L},E=F=>{const re=R(F);let C=0,L=1;return F.owner&&F.jobs?.[F.owner]&&(L=F.jobs[F.owner],C=(x?.wages?.[F.owner]||0)*L),(re+C)/L},T=F=>{const re=g[F.id]||0,C={};for(let L in F.baseCost)C[L]=Math.ceil(F.baseCost[L]*Math.pow(1.15,re));return C};R(t);const D=E(t),O=T(t),q=Ci(O,x),I=vl(t.output,m,h),Z=vl(t.input,m,h),Y=Object.entries(O).every(([F,re])=>(p[F]||0)>=re),U=(p.silver||0)>=q,S=Y&&U,Q=OT(q),ne=(t.jobs?.[t.owner]||0)*j,Ne=D*ne,$e=c?.businessTaxRates?.[t.id]??1,de=t.businessTaxBase??.1,P=de*$e,z=F=>{N(F)},V=()=>{if(_===null||!u)return;const F=parseFloat(_),re=Number.isNaN(F)?1:F;u(C=>({...C,businessTaxRates:{...C?.businessTaxRates||{},[t.id]:re}})),N(null)};return a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-start gap-4 p-1",children:[a.jsx("div",{className:`flex-shrink-0 w-16 h-16 rounded-lg ${t.visual.color} flex items-center justify-center icon-metal-container icon-metal-container-lg`,children:a.jsx(k,{name:t.visual.icon,size:36,className:`${t.visual.text} icon-metal`})}),a.jsxs("div",{className:"flex-1",children:[a.jsx("h3",{className:"text-xl font-bold text-white font-decorative",children:t.name}),a.jsx("p",{className:"text-sm text-gray-300 mt-1",children:t.desc}),t.owner&&a.jsxs("div",{className:"mt-2 inline-flex items-center gap-1.5 text-xs text-yellow-200 bg-yellow-900/40 border border-yellow-600/40 rounded-full px-2.5 py-1",children:[a.jsx(k,{name:"User",size:12}),a.jsxs("span",{className:"font-semibold",children:[": ",Ke[t.owner]?.name||t.owner]})]})]})]}),a.jsxs("div",{className:"grid grid-cols-3 gap-3 text-center",children:[a.jsxs("div",{className:"bg-gray-900/50 p-3 rounded-lg border border-gray-700/80",children:[a.jsx("div",{className:"text-xs text-gray-400 mb-1",children:""}),a.jsx("div",{className:"text-2xl font-bold text-white",children:j})]}),a.jsxs("div",{className:"bg-gray-900/50 p-3 rounded-lg border border-gray-700/80",children:[a.jsxs("div",{className:"flex items-center justify-center gap-1 text-xs text-gray-400 mb-1",children:[a.jsx("span",{children:""})," ",a.jsx(k,{name:"Coins",size:12,className:"text-yellow-400"})]}),a.jsx("div",{className:`text-2xl font-bold ${D>=0?"text-green-400":"text-red-400"}`,children:D.toFixed(2)}),a.jsx("div",{className:"text-[10px] text-gray-500 -mt-1",children:"()"})]}),a.jsxs("div",{className:"bg-gray-900/50 p-3 rounded-lg border border-gray-700/80",children:[a.jsxs("div",{className:"flex items-center justify-center gap-1 text-xs text-gray-400 mb-1",children:[a.jsx("span",{children:""})," ",a.jsx(k,{name:"Coins",size:12,className:"text-yellow-400"})]}),a.jsx("div",{className:`text-2xl font-bold ${Ne>=0?"text-green-400":"text-red-400"}`,children:Ne.toFixed(1)}),a.jsxs("div",{className:"text-[10px] text-gray-500 -mt-1",children:["( ",Math.round(ne)," )"]})]})]}),u&&a.jsxs("div",{className:"bg-gray-900/50 p-3 rounded-lg border border-gray-700/80",children:[a.jsxs("h4",{className:"text-xs font-semibold text-gray-300 mb-2 flex items-center gap-1.5 font-decorative",children:[a.jsx(k,{name:"Sliders",size:16,className:"text-yellow-400"}),""]}),a.jsxs("div",{className:"grid grid-cols-2 gap-2 items-center",children:[a.jsxs("div",{children:[a.jsx("div",{className:"text-[10px] text-gray-400 mb-0.5 leading-none",children:""}),a.jsx("input",{type:"text",inputMode:"decimal",step:"0.05",value:_??$e,onChange:F=>z(F.target.value),onBlur:V,onKeyDown:F=>{F.key==="Enter"&&(V(),F.target.blur())},className:"w-full bg-gray-800/70 border border-gray-600 text-sm text-gray-200 rounded px-2 py-1 focus:ring-1 focus:ring-blue-500 focus:border-blue-500 text-center",placeholder:""})]}),a.jsxs("div",{children:[a.jsx("div",{className:"text-[10px] text-gray-400 mb-0.5 leading-none",children:" ()"}),a.jsxs("div",{className:"bg-gray-800/50 rounded px-2 py-1.5 text-center",children:[a.jsxs("span",{className:`text-sm font-bold font-mono ${P>0?"text-yellow-300":P<0?"text-green-300":"text-gray-400"}`,children:[P<0?" ":"",Math.abs(P).toFixed(3)]}),a.jsx(k,{name:P>0?"TrendingUp":P<0?"TrendingDown":"Coins",size:12,className:`inline-block ml-1 ${P>0?"text-yellow-400":P<0?"text-green-400":"text-gray-500"}`})]})]})]}),a.jsxs("p",{className:"text-[10px] text-gray-500 mt-1.5",children:[" = (",de.toFixed(2),")  "]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(Object.keys(I).length>0||Object.keys(Z).length>0)&&a.jsxs(Sp,{title:" ()",icon:"ArrowRightLeft",children:[Object.entries(I).map(([F,re])=>a.jsx(Ap,{label:Re[F]?.name||F,value:`+${re}`,valueClass:"text-green-400"},`out-${F}`)),Object.entries(Z).map(([F,re])=>a.jsx(Ap,{label:Re[F]?.name||F,value:`-${re}`,valueClass:"text-red-400"},`in-${F}`)),Object.keys(I).length===0&&Object.keys(Z).length===0&&a.jsx("p",{className:"text-gray-500 text-center text-xs",children:""})]}),t.jobs&&Object.keys(t.jobs).length>0&&a.jsx(Sp,{title:"",icon:"Users",children:Object.entries(t.jobs).map(([F,re],C)=>{const L=re*j,ie=b?.[t.id]?.[F]??0,H=Math.min(ie,L),ve=L>0?H/L*100:0,me=x?.wages?.[F]||0;return a.jsxs("div",{className:C>0?"pt-2 mt-2 border-t border-gray-700/60":"",children:[a.jsxs("div",{className:"flex justify-between items-center text-xs mb-0.5",children:[a.jsx("span",{className:"text-gray-200 font-semibold",children:Ke[F]?.name||F}),a.jsxs("span",{className:"text-yellow-300 font-mono",children:[": ",me.toFixed(2)]})]}),a.jsxs("div",{className:"flex justify-between text-[11px] text-gray-400 mb-1",children:[a.jsxs("span",{children:[" ",re]}),a.jsxs("span",{children:[" ",Math.round(L)]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"w-full bg-gray-700 rounded-full h-2",children:a.jsx("div",{className:"bg-blue-500 h-2 rounded-full",style:{width:`${ve}%`}})}),a.jsxs("span",{className:"text-gray-300 font-mono text-[11px] w-20 text-right",children:[Math.round(H),"/",Math.round(L)]})]})]},F)})}),a.jsxs(Sp,{title:"",icon:"Hammer",className:"md:col-span-2",children:[a.jsx("div",{className:"grid grid-cols-2 gap-x-4 gap-y-1",children:Object.entries(O).map(([F,re])=>{const C=(p[F]||0)>=re;return a.jsx(Ap,{label:Re[F]?.name||F,value:`${re}`,valueClass:C?"text-green-400":"text-red-400"},F)})}),a.jsx("div",{className:"pt-2 mt-2 border-t border-gray-700/60",children:a.jsxs("div",{className:"flex justify-between items-center py-0.5",children:[a.jsxs("span",{className:"text-gray-300 flex items-center gap-1.5",children:[a.jsx(k,{name:"Coins",size:14,className:"text-yellow-400"})," "]}),a.jsx("span",{className:`font-mono font-semibold ${U?"text-green-400":"text-red-400"}`,children:vr(q)})]})})]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4 pt-2",children:[a.jsxs("button",{onClick:()=>r&&r(t.id),disabled:!S,className:"w-full px-4 py-3 rounded-lg text-xs sm:text-sm font-bold transition-all bg-green-600 hover:bg-green-500 text-white shadow-lg hover:shadow-green-500/30 disabled:bg-gray-600 disabled:text-gray-400 disabled:cursor-not-allowed disabled:shadow-none flex items-center justify-center gap-2",children:[a.jsx(k,{name:"Plus",size:16}),a.jsxs("div",{className:"flex flex-col items-center sm:flex-row sm:items-center gap-0 sm:gap-1 leading-tight whitespace-nowrap sm:whitespace-normal",children:[a.jsx("span",{className:"tracking-wide",children:""}),a.jsxs("span",{className:"font-mono text-[11px] sm:text-sm opacity-90 flex items-center gap-0.5",children:[a.jsxs("span",{className:"inline-flex items-center gap-0.5 sm:hidden",children:[a.jsx(k,{name:"Coins",size:10,className:"text-yellow-300"}),Q]}),a.jsxs("span",{className:"hidden sm:inline-flex items-center gap-0.5",children:[a.jsx(k,{name:"Coins",size:12,className:"text-yellow-300"}),"(",vr(q),")"]})]})]})]}),j>0&&a.jsxs("button",{onClick:()=>o&&o(t.id),className:"w-full px-4 py-3 bg-red-700 hover:bg-red-600 text-white rounded-lg text-sm font-bold transition-all shadow-lg hover:shadow-red-600/30 flex items-center justify-center gap-2",children:[a.jsx(k,{name:"Minus",size:16}),a.jsx("span",{children:""})]})]})]})},BT=({isOpen:t,onClose:s,title:r,children:o,footer:c,size:u="md",showCloseButton:p=!0})=>t?a.jsx("div",{className:bo.overlay,onClick:s,children:a.jsxs("div",{className:wo(bo.container.base,bo.container[u]),onClick:m=>m.stopPropagation(),children:[a.jsxs("div",{className:bo.header,children:[a.jsx("h3",{className:"text-lg font-bold text-ancient-gold font-decorative",children:r}),p&&a.jsx("button",{className:bo.closeButton,onClick:s,children:a.jsx(k,{name:"X",size:20})})]}),a.jsx("div",{className:bo.body,children:o}),c&&a.jsx("div",{className:bo.footer,children:c})]})}):null,oy=({resources:t,rates:s,market:r,epoch:o=0,onDetailClick:c,title:u="",showDetailedMobile:p=!1})=>{const[m,h]=$.useState("list"),x=N=>{const M=Math.floor(N);return M>=1e6?(M/1e6).toFixed(1)+"M":M>=1e4?(M/1e3).toFixed(0)+"k":M>=1e3?(M/1e3).toFixed(1)+"k":M.toString()},g=N=>{if(!r)return Re[N]?.basePrice||1;const M=Re[N]?.basePrice||1;return r.prices?.[N]??M},b=$.useMemo(()=>Object.entries(Re).filter(([N,M])=>!(M.type==="virtual"||M.type==="currency"||typeof M.unlockEpoch=="number"&&M.unlockEpoch>o)),[o]),j=N=>N>0?{icon:"TrendingUp",color:"text-green-400"}:N<0?{icon:"TrendingDown",color:"text-red-400"}:{icon:"Minus",color:"text-ancient-stone/50"},_=N=>({food:"resource-icon-food",wood:"resource-icon-wood",stone:"resource-icon-stone",iron:"resource-icon-iron",silver:"resource-icon-gold"})[N]||"";return a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center justify-between pb-1.5 border-b border-ancient-gold/20",children:[a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsx("div",{className:"icon-epic-frame icon-frame-xs",children:a.jsx(k,{name:"Package",size:12,className:"text-ancient-gold"})}),u&&a.jsx("span",{className:"text-[10px] font-bold text-ancient tracking-wide uppercase font-decorative",children:u})]}),a.jsxs("div",{className:"btn-group-compact",children:[a.jsx("button",{onClick:()=>h("grid"),className:m==="grid"?"active text-ancient-gold":"text-ancient-stone",title:"",children:a.jsx(k,{name:"LayoutGrid",size:10})}),a.jsx("button",{onClick:()=>h("list"),className:m==="list"?"active text-ancient-gold":"text-ancient-stone",title:"",children:a.jsx(k,{name:"List",size:10})})]})]}),m==="grid"&&a.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-1.5",children:b.map(([N,M])=>{const R=t[N]||0,E=s[N]||0,T=g(N),D=j(E);return a.jsxs("button",{onClick:()=>c&&c(N),className:`relative group w-full min-w-0 p-2 rounded-lg transition-all touch-feedback card-epic-hover
                  bg-gradient-to-br from-ancient-ink/60 via-transparent to-ancient-ink/40
                  border border-ancient-gold/15 hover:border-ancient-gold/40
                  hover:shadow-glow-gold overflow-hidden`,title:`${M.name}: ${R.toFixed(0)} | : ${T.toFixed(2)} | : ${E>0?"+":""}${E.toFixed(1)}/`,children:[a.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-ancient-gold/0 via-ancient-gold/5 to-transparent opacity-0 group-hover:opacity-100 transition-opacity"}),a.jsxs("div",{className:"relative z-10",children:[a.jsxs("div",{className:"flex items-center justify-between mb-1",children:[a.jsxs("div",{className:"flex items-center gap-1.5 min-w-0",children:[a.jsx("div",{className:`icon-epic-frame icon-frame-xs ${_(N)}`,children:a.jsx(k,{name:M.icon,size:12,className:M.color||"text-ancient-parchment"})}),a.jsx("span",{className:"text-[10px] font-semibold text-ancient-parchment truncate max-w-[50px]",children:M.name})]}),a.jsx(k,{name:D.icon,size:10,className:D.color})]}),a.jsx("div",{className:"text-sm font-bold font-mono text-ancient group-hover:text-ancient-gold transition-colors",children:x(R)}),a.jsxs("div",{className:"flex items-center justify-between gap-1 mt-1 font-bold text-[11px] min-w-0",children:[a.jsxs("span",{className:"text-ancient-stone flex items-center gap-0.5 min-w-0 truncate",children:[a.jsx(k,{name:"Coins",size:8,className:"text-ancient-gold/70"}),T.toFixed(1)]}),a.jsx("span",{className:`font-mono text-right ${E>0?"text-green-400":E<0?"text-red-400":"text-ancient-stone/50"}`,children:E!==0?`${E>0?"+":""}${E.toFixed(1)}`:"--"})]})]})]},N)})}),m==="list"&&a.jsx("div",{className:"space-y-1",children:p?a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"grid grid-cols-[minmax(0,1fr)_minmax(48px,auto)_minmax(48px,auto)_minmax(52px,auto)] items-center gap-x-1 text-[9px] text-ancient-stone px-1.5 pb-1 opacity-70",children:[a.jsx("span",{children:""}),a.jsx("span",{className:"text-right",children:""}),a.jsx("span",{className:"text-right",children:""}),a.jsx("span",{className:"text-right",children:""})]}),b.map(([N,M])=>{const R=t[N]||0,E=s[N]||0,T=g(N),D=E!==0?`${E>0?"+":""}${E.toFixed(1)}`:"--",O=E>0?"text-green-400 group-hover:text-green-300":E<0?"text-red-400 group-hover:text-red-300":"text-ancient-stone opacity-50";return a.jsxs("button",{onClick:()=>c&&c(N),className:"w-full relative group grid grid-cols-[minmax(0,1fr)_minmax(48px,auto)_minmax(48px,auto)_minmax(52px,auto)] items-center gap-x-1 text-[10px] sm:text-xs p-1.5 rounded-lg transition-all cursor-pointer overflow-hidden border border-ancient-gold/10 hover:border-ancient-gold/30 hover:bg-ancient-gold/5 hover:shadow-glow-gold touch-feedback",children:[a.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-ancient-gold/0 via-ancient-gold/5 to-transparent opacity-0 group-hover:opacity-100 transition-opacity"}),a.jsxs("div",{className:"flex items-center gap-1 overflow-hidden relative z-10 min-w-0",children:[a.jsx("div",{className:`icon-epic-frame icon-frame-xs flex-shrink-0 ${_(N)}`,children:a.jsx(k,{name:M.icon,size:11,className:M.color||"text-ancient-parchment"})}),a.jsx("span",{className:"text-[12px] sm:text-[15px] text-ancient-parchment font-semibold truncate leading-tight group-hover:text-ancient",children:M.name})]}),a.jsx("span",{className:"font-mono font-bold text-ancient-parchment text-right relative z-10 group-hover:text-ancient text-[12px]",children:x(R)}),a.jsxs("div",{className:"flex items-center justify-end gap-0.5 font-mono text-ancient-stone font-bold text-[11px] sm:text-[13px] relative z-10 group-hover:text-ancient-gold",children:[a.jsx("span",{children:T.toFixed(1)}),a.jsx(k,{name:"Coins",size:8,className:"text-ancient-gold/70 flex-shrink-0"})]}),a.jsx("span",{className:`font-mono text-right relative z-10 transition-colors text-[9px] ${O}`,children:D})]},N)})]}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"grid grid-cols-[20px_1.3fr_1fr] xl:grid-cols-[20px_1.5fr_1fr_1fr_1fr] items-center gap-x-3 text-[12px] text-ancient-gold px-1.5 pb-1 opacity-70",children:[a.jsx("span",{className:"hidden xl:col-span-2 xl:inline pl-0.5 whitespace-nowrap overflow-hidden",children:""}),a.jsx("span",{className:"xl:hidden w-5"}),a.jsx("span",{className:"text-right whitespace-nowrap",children:""}),a.jsx("span",{className:"text-right whitespace-nowrap",children:""}),a.jsx("span",{className:"hidden xl:block text-right whitespace-nowrap",children:""})]}),b.map(([N,M])=>{const R=t[N]||0,E=s[N]||0,T=g(N),D=E!==0?`${E>0?"+":""}${E.toFixed(1)}`:"--",O=E>0?"text-green-400 group-hover:text-green-300":E<0?"text-red-400 group-hover:text-red-300":"text-ancient-stone opacity-50";return a.jsxs("button",{onClick:()=>c&&c(N),className:"w-full relative group grid grid-cols-[20px_1.3fr_1fr] xl:grid-cols-[20px_1.5fr_1fr_1fr_1fr] items-center gap-x-3 text-xs p-1.5 rounded-lg transition-all cursor-pointer overflow-hidden border border-ancient-gold/10 hover:border-ancient-gold/30 hover:bg-ancient-gold/5 hover:shadow-glow-gold touch-feedback",children:[a.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-ancient-gold/0 via-ancient-gold/5 to-transparent opacity-0 group-hover:opacity-100 transition-opacity"}),a.jsx("div",{className:`icon-epic-frame icon-frame-xs flex-shrink-0 relative z-10 ${_(N)}`,children:a.jsx(k,{name:M.icon,size:11,className:M.color||"text-ancient-parchment"})}),a.jsx("div",{className:"hidden xl:flex flex-col gap-0.5 overflow-hidden relative z-10 min-w-0",children:a.jsx("span",{className:"text-[13px] text-ancient-parchment font-semibold truncate leading-tight group-hover:text-ancient text-left",children:M.name})}),a.jsx("span",{className:"font-mono font-bold text-ancient-parchment text-right relative z-10 group-hover:text-ancient text-[11px] whitespace-nowrap truncate tracking-tight",children:x(R)}),a.jsxs("div",{className:"flex items-center justify-end gap-0.5 font-mono text-ancient-parchment text-[11px] relative z-10 group-hover:text-ancient-gold whitespace-nowrap overflow-hidden",children:[a.jsx("span",{children:T.toFixed(1)}),a.jsx(k,{name:"Coins",size:8,className:"text-ancient-gold/70 flex-shrink-0"})]}),a.jsx("span",{className:`hidden xl:block font-mono text-right relative z-10 transition-colors text-[10px] truncate ${O}`,children:D})]},N)})]})}),a.jsx("div",{className:"epic-divider"}),a.jsx("div",{className:"flex items-center justify-between text-[9px] text-ancient-stone px-1",children:a.jsxs("span",{className:"flex items-center gap-1",children:[a.jsx(k,{name:"Info",size:10,className:"text-ancient-gold/70"}),""]})})]})},ly={production:{label:"",type:"percent"},industryBonus:{label:"",type:"percent"},stability:{label:"",type:"percent"},taxIncome:{label:"",type:"percent"},militaryPower:{label:"",type:"percent"},cultureBonus:{label:"",type:"percent"},scienceBonus:{label:"",type:"percent"}},LT=(t,s)=>s==="flat"?`${t>0?"+":""}${t}`:`${t>0?"+":""}${(t*100).toFixed(0)}%`,Xr=(t={})=>{const s=[];return Object.entries(ly).forEach(([r,{label:o,type:c}])=>{typeof t[r]=="number"&&t[r]!==0&&s.push(`${o} ${LT(t[r],c)}`)}),Object.entries(t).forEach(([r,o])=>{ly[r]||["desc","class","source","name","description"].includes(r)||typeof o=="number"&&o!==0&&s.push(`${r} ${o>0?"+":""}${o}`)}),s},VT=t=>{switch(t){case"Skull":return"";case"AlertTriangle":return"";case"UtensilsCrossed":return"";case"Home":return"";case"Gem":return"";case"Crown":return"";default:return""}},cy=({popStructure:t,classApproval:s,classInfluence:r,stability:o,activeBuffs:c=[],activeDebuffs:u=[],classWealth:p={},classWealthDelta:m={},classShortages:h={},classIncome:x={},classExpense:g={},classLivingStandard:b={},rebellionStates:j={},onDetailClick:_,dayScale:N=1,hideTitle:M=!1})=>{const R=Math.max(N,1e-4),E=O=>O>=70?"text-green-400":O>=40?"text-yellow-400":"text-red-400",T=$.useMemo(()=>Object.values(r||{}).reduce((O,q)=>O+(q||0),0),[r]),D=$.useMemo(()=>Object.entries(Ke).map(([O,q])=>{const I=t[O]||0,Z=s[O]||50,Y=r[O]||0,U=T>0?Y/T*100:0,S=p[O]??0,Q=(x[O]||0)/R,ne=(g[O]||0)/R,Ne=Q/Math.max(I,1),$e=ne/Math.max(I,1),de=(m[O]||0)/R,P=de!=null?de/Math.max(I,1):Ne-$e,z=h[O]||[],V=b[O];let F,re,C;if(V)F=V.icon,re=V.color,C=V.wealthRatio;else{const fe=I>0?S/I:0,Je=q.startingWealth||10;C=Je>0?fe/Je:0;const tt=L5(C);F=tt.icon,re=tt.color}const L=j[O]||{},ie=L.organization??0,H=L.growthRate??0,ve=Fr(ie),me=By(ve),X=zy(ve),qe=Ly(ie,H);return{key:O,info:q,count:I,approval:Z,influence:Y,influenceShare:U,wealthValue:S,incomePerCapita:Ne,expensePerCapita:$e,netIncomePerCapita:P,shortages:z,wealthRatio:C,livingStandardIcon:F,livingStandardColor:re,livingStandardData:V,organization:ie,growthRate:H,orgStage:ve,orgStageName:me,orgStageIcon:X,daysToUprising:qe}}).filter(O=>O.count>0),[t,s,r,p,m,x,g,h,b,j,R,T]);return a.jsxs("div",{className:"glass-epic p-1.5 rounded-xl border border-ancient-gold/20 shadow-epic min-h-[460px] flex flex-col relative overflow-hidden",children:[a.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-ancient-ink/50 via-ancient-stone/20 to-ancient-ink/50 opacity-50"}),a.jsx("div",{className:"absolute inset-0 opacity-[0.02]",children:a.jsxs("svg",{className:"w-full h-full",xmlns:"http://www.w3.org/2000/svg",children:[a.jsx("pattern",{id:"strata-pattern",x:"0",y:"0",width:"40",height:"40",patternUnits:"userSpaceOnUse",children:a.jsx("circle",{cx:"20",cy:"20",r:"1",fill:"currentColor",className:"text-ancient-gold"})}),a.jsx("rect",{width:"100%",height:"100%",fill:"url(#strata-pattern)"})]})}),a.jsxs("div",{className:"relative z-10 flex flex-col h-full",children:[!M&&a.jsxs("div",{className:"flex flex-wrap items-center justify-between mb-1 gap-1.5 flex-shrink-0",children:[a.jsxs("h3",{className:"text-xs font-bold text-ancient flex items-center gap-1.5 font-decorative",children:[a.jsx(k,{name:"Users",size:14,className:"text-ancient-gold"}),""]}),a.jsxs("div",{className:"flex items-center gap-0.5",children:[a.jsx(k,{name:"TrendingUp",size:12,className:o>=70?"text-green-400":o>=40?"text-yellow-400":"text-red-400"}),a.jsxs("span",{className:`text-[10px] font-bold ${o>=70?"text-green-400":o>=40?"text-yellow-400":"text-red-400"}`,children:[o.toFixed(0),"%"]})]})]}),M&&a.jsxs("div",{className:"flex items-center justify-center gap-1.5 mb-1.5 flex-shrink-0 bg-ancient-ink/30 rounded-lg px-2 py-1 border border-ancient-gold/20",children:[a.jsx("span",{className:"text-[10px] text-ancient-stone",children:""}),a.jsx(k,{name:"TrendingUp",size:12,className:o>=70?"text-green-400":o>=40?"text-yellow-400":"text-red-400"}),a.jsxs("span",{className:`text-[11px] font-bold ${o>=70?"text-green-400":o>=40?"text-yellow-400":"text-red-400"}`,children:[o.toFixed(0),"%"]})]}),a.jsxs("div",{className:"flex-1 overflow-y-auto pr-0.5 scrollbar-thin scrollbar-thumb-gray-600 scrollbar-track-gray-800 hover:scrollbar-thumb-gray-500",style:{maxHeight:"calc(100vh - 520px)",minHeight:"300px"},children:[a.jsxs("div",{className:"md:hidden grid grid-cols-3 sm:grid-cols-4 gap-1.5",children:[D.map(O=>{const q=I=>I>=70?`linear-gradient(to right, rgba(34, 197, 94, 0.15) 0%, rgba(34, 197, 94, 0.15) ${I}%, rgba(31, 41, 55, 0.5) ${I}%, rgba(31, 41, 55, 0.5) 100%)`:I>=40?`linear-gradient(to right, rgba(234, 179, 8, 0.15) 0%, rgba(234, 179, 8, 0.15) ${I}%, rgba(31, 41, 55, 0.5) ${I}%, rgba(31, 41, 55, 0.5) 100%)`:`linear-gradient(to right, rgba(239, 68, 68, 0.15) 0%, rgba(239, 68, 68, 0.15) ${I}%, rgba(31, 41, 55, 0.5) ${I}%, rgba(31, 41, 55, 0.5) 100%)`;return a.jsx("div",{className:"relative rounded-lg overflow-hidden hover:scale-[1.02] transition-all cursor-pointer border border-ancient-gold/30 shadow-ancient hover:shadow-glow-gold backdrop-blur-sm",style:{background:q(O.approval)},onClick:()=>_&&_(O.key),children:a.jsxs("div",{className:"relative z-10 p-1",children:[a.jsxs("div",{className:"flex items-center gap-1 mb-1",children:[a.jsx("div",{className:"w-6 h-6 bg-ancient-ink/60 rounded flex items-center justify-center flex-shrink-0 border border-ancient-gold/20",children:a.jsx(k,{name:O.info.icon,size:12,className:"text-ancient-gold"})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("div",{className:"text-[10px] font-bold text-ancient-parchment truncate leading-tight",children:O.info.name}),a.jsx("div",{className:"text-[8px] text-ancient-stone font-mono leading-none",children:O.count})]}),a.jsx("div",{className:"flex-shrink-0",children:a.jsx(k,{name:O.livingStandardIcon,size:10,className:`${O.livingStandardColor} drop-shadow-[0_0_2px_rgba(255,255,255,0.3)]`,title:`:  ${O.wealthRatio.toFixed(2)}x`})}),O.shortages.length>0&&a.jsx("div",{className:"flex-shrink-0",children:a.jsx(k,{name:"AlertTriangle",size:10,className:"text-red-400 animate-pulse drop-shadow-[0_0_3px_rgba(248,113,113,0.8)]"})})]}),a.jsx("div",{className:"bg-ancient-ink/60 rounded px-1 py-0.5 backdrop-blur-sm border border-ancient-gold/10",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-[8px] text-ancient-stone leading-none",children:""}),a.jsxs("span",{className:`text-[9px] font-bold font-mono leading-none ${O.netIncomePerCapita>=0?"text-green-300":"text-red-300"}`,children:[O.netIncomePerCapita>=0?"+":"",O.netIncomePerCapita.toFixed(1)]})]})})]})},`grid-${O.key}`)}),D.length===0&&a.jsx("div",{className:"col-span-full text-center text-ancient-stone opacity-70 text-[10px] py-4",children:""})]}),a.jsx("div",{className:"hidden md:block space-y-1",children:D.map(({key:O,info:q,count:I,approval:Z,influence:Y,influenceShare:U,wealthValue:S,incomePerCapita:Q,expensePerCapita:ne,netIncomePerCapita:Ne,shortages:$e,wealthRatio:de,livingStandardIcon:P,livingStandardColor:z,organization:V,growthRate:F,orgStage:re,orgStageName:C,orgStageIcon:L,daysToUprising:ie})=>a.jsxs("div",{className:"glass-ancient p-1.5 rounded-lg hover:bg-ancient-gold/10 transition-all cursor-pointer border border-ancient-gold/20 hover:border-ancient-gold/40 hover:shadow-glow-gold",onClick:()=>_&&_(O),children:[a.jsxs("div",{className:"flex items-center justify-between mb-0.5",children:[a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(k,{name:q.icon,size:10,className:"text-ancient-gold"}),a.jsx("span",{className:"text-[11px] font-semibold text-ancient-parchment",children:q.name}),a.jsxs("span",{className:"text-[9px] text-ancient-stone",children:[I,""]}),a.jsx(k,{name:P,size:10,className:`${z} drop-shadow-[0_0_2px_rgba(255,255,255,0.3)]`,title:`: ${VT(P)} ( ${de.toFixed(2)}x)`}),V>0&&a.jsx(k,{name:L,size:10,className:`${V>=70?"text-red-500 animate-pulse":V>=30?"text-orange-400":"text-yellow-400"}`,title:`: ${V.toFixed(0)}% (${C})`})]}),a.jsx("div",{className:"flex items-center gap-1",children:a.jsxs("span",{className:`text-[9px] font-semibold font-mono ${E(Z)}`,children:[Z.toFixed(0),"%"]})})]}),a.jsxs("div",{className:"grid grid-cols-3 gap-0.5 text-[8px] mb-0.5 bg-ancient-ink/30 px-1 py-0.5 rounded border border-ancient-gold/10",children:[a.jsxs("div",{className:"flex items-center gap-0.5",title:"",children:[a.jsx("span",{className:"text-ancient-stone",children:""}),a.jsxs("span",{className:"text-green-300 font-mono",children:["+",Q.toFixed(1)]})]}),a.jsxs("div",{className:"flex items-center gap-0.5 justify-center",title:"",children:[a.jsx("span",{className:"text-ancient-stone",children:""}),a.jsxs("span",{className:"text-red-300 font-mono",children:["-",ne.toFixed(1)]})]}),a.jsxs("div",{className:"flex items-center gap-0.5 justify-end",title:"",children:[a.jsx("span",{className:"text-ancient-stone",children:""}),a.jsxs("span",{className:`font-mono ${Ne>=0?"text-green-300":"text-red-300"}`,children:[Ne>0?"+":"",Ne.toFixed(1)]})]})]}),a.jsx("div",{className:"mb-0.5",children:a.jsx("div",{className:"w-full bg-ancient-ink/50 rounded-full h-0.5 border border-ancient-gold/10",children:a.jsx("div",{className:`h-0.5 rounded-full transition-all ${Z>=70?"bg-green-500":Z>=40?"bg-yellow-500":"bg-red-500"}`,style:{width:`${Z}%`}})})}),V>5&&a.jsxs("div",{className:"mb-0.5",children:[a.jsxs("div",{className:"flex items-center gap-1 text-[7px] mb-0.5",children:[a.jsx("span",{className:"text-ancient-stone",children:""}),a.jsxs("span",{className:`font-mono ${V>=70?"text-red-400":V>=30?"text-orange-400":"text-yellow-400"}`,children:[V.toFixed(0),"%"]}),ie!==null&&ie<100&&a.jsxs("span",{className:"text-red-400 animate-pulse",children:["~",ie,""]})]}),a.jsx("div",{className:"w-full bg-ancient-ink/50 rounded-full h-1 border border-ancient-gold/10 overflow-hidden",children:a.jsx("div",{className:`h-1 rounded-full transition-all ${V>=90?"bg-red-500 animate-pulse":V>=70?"bg-orange-500":V>=30?"bg-yellow-500":"bg-gray-500"}`,style:{width:`${V}%`}})})]}),a.jsxs("div",{className:"flex items-center justify-between text-[8px]",children:[a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx("span",{className:"text-ancient-stone",children:""}),a.jsxs("span",{className:"text-purple-400 font-semibold font-mono",children:[U.toFixed(1),"%"]})]}),a.jsxs("div",{className:"flex items-center gap-0.5",title:"",children:[a.jsx(k,{name:"Coins",size:8,className:"text-ancient-gold"}),a.jsx("span",{className:"text-ancient-parchment font-mono",children:S.toFixed(0)})]})]}),$e.length>0&&(()=>{const H=$e.some(Je=>{const tt=typeof Je=="string"?"outOfStock":Je.reason;return tt==="outOfStock"||tt==="both"}),ve=$e.some(Je=>{const tt=typeof Je=="string"?"outOfStock":Je.reason;return tt==="unaffordable"||tt==="both"});let me="",X="AlertTriangle",qe="bg-red-900/30",fe="border-red-500/40";return H&&ve?(me="&",X="XCircle",qe="bg-red-900/40",fe="border-red-600/50"):ve?(me="",X="DollarSign",qe="bg-orange-900/30",fe="border-orange-500/40"):H&&(me="",X="Package",qe="bg-red-900/30",fe="border-red-500/40"),a.jsxs("div",{className:`flex items-center gap-0.5 text-[8px] text-red-300 flex-wrap ${qe} border ${fe} rounded px-1 py-0.5 mt-0.5`,children:[a.jsx(k,{name:X,size:10,className:"text-red-400 animate-pulse"}),a.jsxs("span",{className:"text-red-200 font-semibold",children:[me,":"]}),a.jsx("div",{className:"flex items-center gap-0.5 flex-wrap",children:$e.map((Je,tt)=>{const Mt=typeof Je=="string"?Je:Je.resource,jt=typeof Je=="string"?"outOfStock":Je.reason,ot=Re[Mt];let B="AlertTriangle",Ue="",ht="bg-red-800/60",ft="border-red-500/60";return jt==="unaffordable"?(B="DollarSign",Ue="",ht="bg-orange-800/60",ft="border-orange-500/60"):jt==="outOfStock"?(B="Package",Ue="",ht="bg-red-800/60",ft="border-red-500/60"):jt==="both"&&(B="XCircle",Ue="",ht="bg-red-900/80",ft="border-red-600/80"),a.jsxs("span",{className:`px-0.5 py-0.5 ${ht} border ${ft} rounded flex items-center gap-0.5 animate-pulse`,title:`${ot?.name||Mt} ${Ue}`,children:[a.jsx(k,{name:B,size:8,className:"text-red-200"}),a.jsx(k,{name:ot?.icon||"HelpCircle",size:9,className:"text-red-200"}),a.jsx("span",{className:"text-red-100 font-medium text-[8px]",children:ot?.name||Mt})]},`${O}-${Mt}-${tt}`)})})]})})()]},O))})]}),a.jsxs("div",{className:"mt-1 pt-1 border-t border-ancient-gold/20 flex-shrink-0",children:[a.jsxs("h4",{className:"text-[14px] font-bold text-ancient-stone mb-0.5 flex items-center gap-0.5 font-decorative",children:[a.jsx(k,{name:"Activity",size:10,className:"text-ancient-gold "}),""]}),a.jsxs("div",{className:"space-y-0.5 text-[12px] max-h-16 overflow-y-auto pr-0.5 scrollbar-thin scrollbar-thumb-ancient-gold/40 scrollbar-track-ancient-ink/30",children:[c.map((O,q)=>{const I=Xr(O);return a.jsxs("div",{className:"text-green-400 leading-tight",children:[a.jsxs("div",{className:"flex items-center gap-0.5",children:[a.jsx(k,{name:"ArrowUp",size:8}),a.jsx("span",{className:"font-semibold",children:O.desc||""})]}),I.length>0&&a.jsx("div",{className:"text-ancient-parchment opacity-80 ml-2 text-[10px]",children:I.join("")})]},`buff-${q}`)}),u.map((O,q)=>{const I=Xr(O);return a.jsxs("div",{className:"text-red-400 leading-tight",children:[a.jsxs("div",{className:"flex items-center gap-0.5",children:[a.jsx(k,{name:"ArrowDown",size:8}),a.jsx("span",{className:"font-semibold",children:O.desc||""})]}),I.length>0&&a.jsx("div",{className:"text-ancient-parchment opacity-70 ml-2 text-[10px]",children:I.join("")})]},`debuff-${q}`)}),c.length===0&&u.length===0&&a.jsx("span",{className:"text-ancient-stone opacity-60 text-[10px] italic",children:""})]})]}),a.jsx("div",{className:"mt-1 px-1.5 py-1 bg-ancient-ink/30 rounded-lg border border-ancient-gold/10 flex-shrink-0",children:a.jsxs("p",{className:"text-[8px] text-ancient-stone text-center flex items-center justify-center gap-1",children:[a.jsx(k,{name:"Info",size:8,className:"text-ancient-gold/60"}),""]})})]})]})},Tl={crackdown:{id:"crackdown",name:"",icon:"Shield",description:"",detailedDescription:"",effectPreview:{organization:{value:-30,unit:"%",label:"",type:"immediate"},approval:{value:-20,unit:"",label:"",type:"immediate"},stability:{value:-10,unit:"%",label:"",type:"immediate"},population:{value:-5,unit:"%",label:"",type:"immediate"}},sideEffects:[{text:" -15",severity:"warning",icon:"Users"},{text:" -5",severity:"warning",icon:"Users"},{text:" -20%30",severity:"danger",icon:"AlertTriangle"},{text:" -15%20",severity:"danger",icon:"AlertOctagon"},{text:"5%",severity:"danger",icon:"Skull"}],usageHint:"(90%+)/",applicableStagesNames:["","",""],forbiddenStrata:["soldier","knight"],cost:{silver:300},militaryCost:{approvalPenalty:{soldier:-15,knight:-15}},otherStrataApprovalPenalty:-5,effects:{organization:-30,approval:-20,stability:-10,populationLoss:.05},debuffs:[{id:"suppression_fatigue",name:"",description:" -20%",duration:30,effects:{militaryPower:-.2}},{id:"terror_atmosphere",name:"",description:" -15%",duration:20,effects:{production:-.15}}],cooldown:30,requirements:{minMilitaryPower:.3},applicableStages:["mobilizing","radicalizing","uprising"]},divide:{id:"divide",name:"",icon:"GitBranch",description:"",detailedDescription:"",effectPreview:{targetOrganization:{value:-40,unit:"%",label:"",type:"immediate"},rivalOrganization:{value:20,unit:"%",label:"",type:"immediate"},rivalApproval:{value:-10,unit:"",label:"",type:"immediate"}},sideEffects:[{text:"",severity:"warning",icon:"TrendingUp"},{text:"",severity:"warning",icon:"ThumbsDown"}],usageHint:"",applicableStagesNames:["","",""],rivalPairsHint:{peasant:"",serf:"",worker:"",miner:"",lumberjack:"",merchant:"",artisan:"",soldier:"",knight:"",landowner:"",capitalist:""},cost:{culture:200,silver:500},effects:{targetOrganization:-40,rivalOrganization:20,rivalApproval:-10},cooldown:60,requirements:{hasRival:!0},applicableStages:["grumbling","mobilizing","radicalizing"]},bribe:{id:"bribe",name:"",icon:"Coins",description:"",detailedDescription:'""1050%',effectPreview:{approval:{value:15,unit:"",label:"",duration:"30"},organizationPause:{value:180,unit:"",label:"",type:"immediate"}},sideEffects:[{text:"50%",severity:"info",icon:"TrendingUp"},{text:"30180",severity:"info",icon:"Clock"}],usageHint:"",applicableStagesNames:["","",""],costCalculationHint:"  10  +50%",cost:{silverPerPop:10},effects:{approval:15,approvalDuration:30,organizationPause:180},cooldown:15,costMultiplier:1.5,applicableStages:["grumbling","mobilizing","radicalizing"]},promise:{id:"promise",name:"",icon:"FileText",description:"",detailedDescription:"20%50%",effectPreview:{organization:{value:-20,unit:"%",label:"",type:"immediate"},task:{label:"",duration:"30-180",type:"special"}},sideEffects:[{text:"",severity:"info",icon:"Zap"},{text:"",severity:"warning",icon:"Target"},{text:" +50%",severity:"danger",icon:"AlertOctagon"}],usageHint:"(360)",applicableStagesNames:["","",""],cost:null,effects:{organization:-20,generateTask:!0},failurePenalty:{organization:50},cooldown:90,applicableStages:["grumbling","mobilizing","radicalizing"]}};function M2(t,s,r){const o=Tl[t];if(!o)return{available:!1,reason:""};const{resources:c,organizationStates:u,actionCooldowns:p={},population:m,popStructure:h,militaryPower:x}=r,g=u?.[s];if(!g)return{available:!1,reason:""};if(o.applicableStages&&!o.applicableStages.includes(g.stage))return{available:!1,reason:`${o.applicableStagesNames?.join("/")||o.applicableStages.join("/")}`};if(t==="crackdown"&&(r.nations||[]).some(N=>N?.isRebelNation&&N.rebellionStratum===s&&N.isAtWar))return{available:!1,reason:""};if(o.forbiddenStrata&&o.forbiddenStrata.includes(s))return{available:!1,reason:""};const b=`${t}_${s}`,j=p[b]||0;if(j>0)return{available:!1,reason:`${j}`};if(o.cost){if(o.cost.silver&&(c?.silver||0)<o.cost.silver)return{available:!1,reason:`${o.cost.silver}`};if(o.cost.culture&&(c?.culture||0)<o.cost.culture)return{available:!1,reason:`${o.cost.culture}`};if(o.cost.silverPerPop){const _=h?.[s]||0,N=o.cost.silverPerPop*_;if((c?.silver||0)<N)return{available:!1,reason:`${N}`}}}if(o.requirements){if(o.requirements.minMilitaryPower&&(x||0)<o.requirements.minMilitaryPower)return{available:!1,reason:""};if(o.requirements.hasRival){const _=Nf(s);if(!h?.[_])return{available:!1,reason:""}}}return{available:!0}}function _2(t,s,r){const o=Tl[t];if(!o||!o.cost)return{};const c={...o.cost};if(o.cost.silverPerPop){const u=r.popStructure?.[s]||0;c.silver=o.cost.silverPerPop*u,delete c.silverPerPop}if(o.costMultiplier){const u=r.actionUsage?.[`${t}_${s}`]||0,p=Math.pow(o.costMultiplier,u);c.silver&&(c.silver=Math.ceil(c.silver*p)),c.culture&&(c.culture=Math.ceil(c.culture*p))}return c}function WT(t,s,r){const o=Tl[t];if(!o)return{success:!1,message:""};const c=M2(t,s,r);if(!c.available)return{success:!1,message:c.reason};const u=_2(t,s,r),p=Ke[s]?.name||s,h=(r.organizationStates?.[s]||{}).resistance||0,x=Math.max(.2,1-h/100),g={success:!0,actionId:t,stratumKey:s,cost:u,effects:{resourceCost:u,organizationChanges:{},approvalChanges:{},stabilityChange:0,debuffs:o.debuffs||[],cooldown:o.cooldown,specialEffects:[],resistanceChange:15},message:""};if(o.effects.organization){const b=o.effects.organization,j=b<0?Math.ceil(b*x):b;g.effects.organizationChanges[s]=j}if(o.effects.approval){const b=o.effects.approval,j=b>0?Math.floor(b*x):b;g.effects.approvalChanges[s]={value:j,duration:o.effects.approvalDuration||0}}if(o.effects.stability&&(g.effects.stabilityChange=o.effects.stability),o.effects.organizationPause){const b=Math.ceil(o.effects.organizationPause*x);g.effects.specialEffects.push({type:"organizationPause",stratum:s,duration:b})}if(t==="divide"){const b=Nf(s);g.effects.organizationChanges[b]=o.effects.rivalOrganization,g.effects.approvalChanges[b]={value:o.effects.rivalApproval,duration:0},g.effects.specialEffects.push({type:"divideEffect",target:s,rival:b})}return t==="promise"&&o.effects.generateTask&&(g.effects.specialEffects.push({type:"promiseTask",stratum:s,deadline:60,failurePenalty:o.failurePenalty}),g.effects.resistanceChange=10),o.militaryCost?.approvalPenalty&&Object.entries(o.militaryCost.approvalPenalty).forEach(([b,j])=>{g.effects.approvalChanges[b]||(g.effects.approvalChanges[b]={value:0,duration:0}),g.effects.approvalChanges[b].value+=j}),g.message=`${p}${o.name}`+(h>0?` (${h.toFixed(0)}%: ${((1-x)*100).toFixed(0)}%)`:""),g}function UT(t,s,r){const o=Tl[t];if(!o)return null;const c=M2(t,s,r),u=_2(t,s,r);return{id:o.id,name:o.name,icon:o.icon,description:o.description,detailedDescription:o.detailedDescription,effectPreview:o.effectPreview,sideEffects:o.sideEffects,usageHint:o.usageHint,applicableStagesNames:o.applicableStagesNames,costCalculationHint:o.costCalculationHint,rivalPairsHint:o.rivalPairsHint,failurePenalty:o.failurePenalty,cost:u,effects:o.effects,cooldown:o.cooldown,available:c.available,unavailableReason:c.reason,debuffs:o.debuffs,applicableStages:o.applicableStages}}function IT(t,s){return Object.keys(Tl).map(r=>UT(r,t,s))}const HT=({action:t,stratumKey:s,stratumName:r,disabled:o=!1,unavailableReason:c="",onExecute:u,popCount:p=0,actionUsage:m={}})=>{const[h,x]=$.useState(!1);if(!t)return null;const g=()=>{if(!t.cost)return"";const N=[];if(t.cost.silver&&N.push(`${t.cost.silver}`),t.cost.culture&&N.push(`${t.cost.culture}`),t.cost.silverPerPop){const M=`${t.id}_${s}`,R=m[M]||0,E=Math.pow(t.costMultiplier||1,R),T=Math.ceil(t.cost.silverPerPop*p*E);N.push(`${T}`)}return N.length>0?N.join(" + "):""},b=()=>{if(t.id==="divide"){const N=Nf(s);return Ke[N]?.name||N}return null},j=()=>{x(!1),u&&u(t.id,s)},_=b();return a.jsxs(a.Fragment,{children:[a.jsx("button",{onClick:()=>x(!0),className:`w-full p-2 rounded-lg border transition-all text-left ${o?"bg-gray-800/30 border-gray-700/50 opacity-50 cursor-not-allowed":"bg-gray-800/50 border-gray-600/50 hover:bg-gray-700/50 hover:border-gray-500/50"}`,children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:`w-8 h-8 rounded flex items-center justify-center ${o?"bg-gray-700/50":"bg-gray-700"}`,children:a.jsx(k,{name:t.icon,size:16,className:o?"text-gray-500":"text-gray-200"})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:`text-xs font-bold ${o?"text-gray-400":"text-white"}`,children:t.name}),t.cooldown>0&&a.jsxs("span",{className:"text-[8px] px-1 py-0.5 rounded bg-gray-700 text-gray-400",children:[t.cooldown," "]})]}),a.jsx("p",{className:"text-[9px] text-gray-400 truncate",children:t.description})]}),a.jsx(k,{name:"ChevronRight",size:14,className:"text-gray-500"})]})}),h&&Ps.createPortal(a.jsxs("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4",onClick:()=>x(!1),children:[a.jsx("div",{className:"absolute inset-0 bg-black/70 backdrop-blur-sm"}),a.jsxs("div",{className:"relative w-full max-w-sm bg-gray-800 rounded-2xl border border-gray-600 shadow-2xl overflow-hidden animate-slide-up",onClick:N=>N.stopPropagation(),children:[a.jsxs("div",{className:"flex items-center gap-3 p-4 border-b border-gray-700 bg-gradient-to-r from-blue-900/40 to-gray-800/60",children:[a.jsx("div",{className:"w-10 h-10 rounded-lg bg-gray-700 flex items-center justify-center",children:a.jsx(k,{name:t.icon,size:20,className:"text-white"})}),a.jsxs("div",{className:"flex-1",children:[a.jsx("h3",{className:"text-sm font-bold text-white",children:t.name}),a.jsxs("p",{className:"text-[10px] text-gray-400",children:[" ",r]})]}),a.jsx("button",{onClick:()=>x(!1),className:"p-2 rounded-full hover:bg-white/10 transition-colors text-gray-400",children:a.jsx(k,{name:"X",size:16})})]}),a.jsxs("div",{className:"p-4 space-y-3",children:[a.jsxs("div",{className:"bg-gray-900/50 rounded-lg p-3",children:[a.jsx("div",{className:"text-[10px] text-gray-400 mb-2",children:""}),a.jsx("div",{className:"grid grid-cols-2 gap-2",children:t.effectPreview&&Object.entries(t.effectPreview).map(([N,M])=>a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsxs("span",{className:`text-xs font-bold ${M.value>0?"text-green-400":M.value<0?"text-red-400":"text-blue-400"}`,children:[M.value>0?"+":"",M.value,M.unit||""]}),a.jsx("span",{className:"text-[9px] text-gray-500",children:M.label})]},N))})]}),t.id==="divide"&&_&&a.jsxs("div",{className:"text-[10px] text-purple-300 bg-purple-900/20 rounded p-2",children:[a.jsx(k,{name:"GitBranch",size:10,className:"inline mr-1"}),"",_]}),a.jsxs("div",{className:"flex items-center justify-between text-[10px]",children:[a.jsx("span",{className:"text-gray-400",children:""}),a.jsx("span",{className:"text-yellow-300 font-medium",children:g()})]}),t.sideEffects&&t.sideEffects.length>0&&a.jsxs("div",{className:"text-[9px] text-orange-300/80 flex items-start gap-1",children:[a.jsx(k,{name:"AlertTriangle",size:10,className:"mt-0.5 flex-shrink-0"}),a.jsx("span",{children:t.sideEffects.map(N=>N.text).join("")})]}),o&&c&&a.jsxs("div",{className:"text-[10px] text-red-400 bg-red-900/20 rounded p-2 flex items-center gap-1",children:[a.jsx(k,{name:"XCircle",size:12}),c]})]}),a.jsxs("div",{className:"p-4 border-t border-gray-700/50 bg-gray-900/50 flex gap-3",children:[a.jsx("button",{onClick:()=>x(!1),className:"flex-1 px-4 py-2.5 bg-gray-600 hover:bg-gray-500 text-white rounded-lg text-sm font-bold transition-colors",children:""}),a.jsxs("button",{onClick:j,disabled:o,className:`flex-1 px-4 py-2.5 rounded-lg text-sm font-bold transition-colors flex items-center justify-center gap-2 ${o?"bg-gray-700 text-gray-500 cursor-not-allowed":"bg-blue-600 hover:bg-blue-500 text-white"}`,children:[a.jsx(k,{name:"Play",size:14}),""]})]})]})]}),document.body)]})},qT=({sources:t=[],totalContribution:s=0,className:r=""})=>{if(!t||t.length===0)return a.jsx("div",{className:`bg-green-900/20 rounded-lg p-3 border border-green-500/30 ${r}`,children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(k,{name:"CheckCircle",size:16,className:"text-green-400"}),a.jsx("span",{className:"text-xs text-green-300",children:""})]})});const o=m=>{switch(m){case"danger":return{bg:"bg-red-900/30",border:"border-red-500/40",text:"text-red-300",icon:"text-red-400",bar:"bg-red-500"};case"warning":return{bg:"bg-orange-900/30",border:"border-orange-500/40",text:"text-orange-300",icon:"text-orange-400",bar:"bg-orange-500"};case"info":return{bg:"bg-gray-800/30",border:"border-gray-500/40",text:"text-gray-300",icon:"text-gray-400",bar:"bg-gray-500"};default:return{bg:"bg-yellow-900/30",border:"border-yellow-500/40",text:"text-yellow-300",icon:"text-yellow-400",bar:"bg-yellow-500"}}},c=m=>m>=1.5?"":m>=1?"":m>=.5?"":"",p=(m=>m>=3?{text:"",color:"text-red-400"}:m>=2?{text:"",color:"text-red-400"}:m>=1?{text:"",color:"text-orange-400"}:{text:"",color:"text-yellow-400"})(s);return a.jsxs("div",{className:`space-y-2 ${r}`,children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsx(k,{name:"BarChart2",size:14,className:"text-gray-400"}),a.jsx("span",{className:"text-xs font-bold text-gray-300",children:""})]}),a.jsxs("span",{className:"text-[10px] text-gray-400",children:[": ",a.jsx("span",{className:p.color,children:p.text})]})]}),a.jsx("div",{className:"space-y-1.5",children:t.map((m,h)=>{const x=o(m.severity),g=Math.min(100,m.contribution/2*100),b=c(m.contribution);return a.jsxs("div",{className:`rounded-lg p-2 border ${x.bg} ${x.border}`,children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(k,{name:m.icon,size:14,className:x.icon}),a.jsxs("div",{children:[a.jsx("div",{className:`text-xs font-medium ${x.text}`,children:m.label}),a.jsx("div",{className:"text-[9px] text-gray-400",children:m.detail})]})]}),a.jsx("div",{className:"text-right",children:a.jsx("div",{className:`text-xs font-bold ${x.text}`,children:b})})]}),a.jsx("div",{className:"mt-1.5 h-1 bg-gray-700/50 rounded-full overflow-hidden",children:a.jsx("div",{className:`h-full rounded-full transition-all duration-300 ${x.bar}`,style:{width:`${g}%`}})}),m.resources&&m.resources.length>0&&a.jsxs("div",{className:"flex flex-wrap gap-1 mt-1.5",children:[m.resources.slice(0,4).map((j,_)=>a.jsx("span",{className:"text-[8px] px-1 py-0.5 rounded bg-gray-700/50 text-gray-400",children:j},_)),m.resources.length>4&&a.jsxs("span",{className:"text-[8px] text-gray-500",children:["+",m.resources.length-4]})]})]},h)})})]})},GT=({demands:t=[],currentDay:s=0,className:r=""})=>{if(!t||t.length===0)return null;const o=p=>p>=.8?"bg-green-500":p>=.5?"bg-yellow-500":"bg-orange-500",c=(p,m)=>{const h=p/m;return h<=.25?"critical":h<=.5?"urgent":"normal"},u=p=>{switch(p){case"critical":return{border:"border-red-500/50",bg:"bg-red-900/20",timeText:"text-red-400",pulse:!0};case"urgent":return{border:"border-orange-500/40",bg:"bg-orange-900/20",timeText:"text-orange-400",pulse:!1};default:return{border:"border-gray-600/50",bg:"bg-gray-800/30",timeText:"text-gray-400",pulse:!1}}};return a.jsxs("div",{className:`space-y-2 ${r}`,children:[a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsx(k,{name:"Scroll",size:14,className:"text-purple-400"}),a.jsx("span",{className:"text-xs font-bold text-gray-300",children:""}),a.jsx("span",{className:"text-[9px] px-1.5 py-0.5 rounded bg-purple-900/30 text-purple-300",children:t.length})]}),a.jsx("div",{className:"space-y-2",children:t.map((p,m)=>{const h=F5[p.type]||{},x=X5(p,s),g=h.duration||30,b=c(x,g),j=u(b),_=p.currentProgress||0;return a.jsxs("div",{className:`rounded-lg border p-3 ${j.border} ${j.bg} ${j.pulse?"animate-pulse":""}`,children:[a.jsxs("div",{className:"flex items-start justify-between mb-2",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:`w-8 h-8 rounded-lg flex items-center justify-center ${h.bgColor||"bg-gray-700"}`,children:a.jsx(k,{name:h.icon||"HelpCircle",size:16,className:h.color||"text-gray-400"})}),a.jsxs("div",{children:[a.jsx("div",{className:`text-xs font-bold ${h.color||"text-gray-300"}`,children:h.name||p.type}),a.jsx("div",{className:"text-[9px] text-gray-400",children:h.description})]})]}),a.jsxs("div",{className:"text-right",children:[a.jsxs("div",{className:`text-xs font-bold ${j.timeText}`,children:[" ",x," "]}),b==="critical"&&a.jsxs("div",{className:"text-[9px] text-red-400 flex items-center gap-0.5 justify-end",children:[a.jsx(k,{name:"AlertTriangle",size:10}),""]})]})]}),a.jsx("div",{className:"bg-gray-900/40 rounded p-2 mb-2",children:a.jsxs("div",{className:"text-[10px] text-gray-400",children:[a.jsx("span",{className:"font-bold text-gray-300",children:""}),p.requirement||h.requirement]})}),a.jsxs("div",{className:"mb-2",children:[a.jsxs("div",{className:"flex items-center justify-between mb-1",children:[a.jsx("span",{className:"text-[9px] text-gray-400",children:""}),a.jsxs("span",{className:"text-[9px] text-gray-300",children:[Math.round(_*100),"%"]})]}),a.jsx("div",{className:"h-1.5 bg-gray-700/50 rounded-full overflow-hidden",children:a.jsx("div",{className:`h-full rounded-full transition-all duration-300 ${o(_)}`,style:{width:`${_*100}%`}})})]}),a.jsx("div",{className:"bg-red-900/20 rounded p-2 border border-red-500/30",children:a.jsxs("div",{className:"flex items-start gap-1.5",children:[a.jsx(k,{name:"AlertOctagon",size:12,className:"text-red-400 flex-shrink-0 mt-0.5"}),a.jsxs("div",{children:[a.jsx("div",{className:"text-[9px] text-red-300 font-bold",children:""}),a.jsx("div",{className:"text-[9px] text-red-400",children:p.failurePenalty?.description||h.failurePenalty?.description})]})]})}),p.missingResources&&p.missingResources.length>0&&a.jsxs("div",{className:"mt-2",children:[a.jsx("div",{className:"text-[9px] text-gray-400 mb-1",children:""}),a.jsx("div",{className:"flex flex-wrap gap-1",children:p.missingResources.map((N,M)=>a.jsx("span",{className:"text-[9px] px-1.5 py-0.5 rounded bg-orange-900/30 text-orange-300 border border-orange-500/30",children:N},M))})]}),p.type==="tax_relief"&&p.daysMet!==void 0&&a.jsxs("div",{className:"mt-2 text-[9px] text-gray-400",children:[" ",p.daysMet,"/",p.daysRequired||10," "]})]},p.id||m)})})]})},FT=({stratumKey:t,popStructure:s,population:r=0,classApproval:o,classInfluence:c,classWealth:u,classWealthDelta:p={},classIncome:m,classExpense:h,classShortages:x,classLivingStandard:g={},rebellionStates:b={},actionCooldowns:j={},actionUsage:_={},activeBuffs:N=[],activeDebuffs:M=[],dayScale:R=1,daysElapsed:E=0,taxPolicies:T,onUpdateTaxPolicies:D,onStrategicAction:O,resources:q={},militaryPower:I=0,promiseTasks:Z=[],epoch:Y=0,techsUnlocked:U=[],totalInfluence:S=0,activeDemands:Q={},nations:ne=[],onClose:Ne})=>{const $e=Math.max(R,1e-4),de=Ke[t],[P,z]=$.useState(null),[V,F]=$.useState("overview");if(!de)return a.jsxs("div",{className:"text-center text-gray-400 py-8",children:[a.jsx(k,{name:"AlertCircle",size:32,className:"mx-auto mb-2"}),a.jsx("p",{children:""})]});const re=s[t]||0,C=o[t]||50,L=c[t]||0,ie=u[t]??0,H=(m[t]||0)/$e,ve=(h[t]||0)/$e,me=H/Math.max(re,1),X=ve/Math.max(re,1),qe=(p[t]||0)/$e,fe=qe!=null?qe/Math.max(re,1):me-X,Je=x[t]||[],tt=T?.headTaxRates?.[t]??1,Mt=b[t]||{},jt=Mt.organization??0,ot=Q[t]&&Q[t].length>0?Q[t]:Mt.activeDemands||[];let B=g[t];if(!B){const je=de.startingWealth||10,J=de.luxuryNeeds||{},le=Object.keys(J).map(Number).sort((Ce,rt)=>Ce-rt),ue=re>0?ie/re:0,Me=je>0?ue/je:0,Ie=de.needs?Object.keys(de.needs).filter(Ce=>si(Ce,Y,U)).length:0;let at=0,Ze=Ie;for(const Ce of le)if(Me>=Ce){at++;const rt=J[Ce],Ve=Object.keys(rt).filter(ca=>si(ca,Y,U)).filter(ca=>!de.needs?.[ca]);Ze+=Ve.length}B=$y({count:re,wealthValue:ie,startingWealth:je,shortagesCount:Je.length,effectiveNeedsCount:Ze,unlockedLuxuryTiers:at,totalLuxuryTiers:le.length})}const{wealthPerCapita:Ue,wealthRatio:ht,wealthMultiplier:ft,satisfactionRate:$t,luxuryUnlockRatio:It,unlockedLuxuryTiers:oe,totalLuxuryTiers:Ye,level:bt,icon:Pe,color:lt,bgColor:Vt,borderColor:oa,approvalCap:Ka,score:gn}=B,Zt=de.luxuryNeeds||{},la=Object.keys(Zt).map(Number).sort((je,J)=>je-J);let qt=[];for(const je of la)if(ht>=je){const J=Zt[je],le=Object.keys(J).filter(Me=>si(Me,Y,U)),ue=le.filter(Me=>!de.needs?.[Me]);le.length>0&&qt.push({threshold:je,count:le.length,newResources:ue})}const Gt=je=>{z(je)},kt=()=>{if(P===null||!D)return;const je=parseFloat(P),J=Number.isNaN(je)?1:je;D(le=>({...le,headTaxRates:{...le?.headTaxRates||{},[t]:J}})),z(null)},ta=je=>je>=70?"text-green-400":je>=40?"text-yellow-400":"text-red-400",Ht=N.filter(je=>je.class===t),se=M.filter(je=>je.class===t),he=IT(t,{resources:q,organizationStates:b,popStructure:s,actionCooldowns:j,actionUsage:_,population:r,militaryPower:I,nations:ne}),K=(Z||[]).filter(je=>je.stratumKey===t);return a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center gap-2 pb-2 border-b border-gray-700",children:[a.jsx("div",{className:"w-12 h-12 bg-gray-700 rounded-lg flex items-center justify-center flex-shrink-0",children:a.jsx(k,{name:de.icon,size:24,className:"text-gray-300"})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h2",{className:"text-lg font-bold text-white leading-tight font-decorative",children:de.name}),a.jsx("p",{className:"text-xs text-gray-400 leading-tight truncate",children:de.desc})]})]}),a.jsxs("div",{className:"flex border-b border-gray-700",children:[a.jsxs("button",{onClick:()=>F("overview"),className:`flex-1 py-2 text-xs font-bold transition-colors flex items-center justify-center gap-1 ${V==="overview"?"text-blue-400 border-b-2 border-blue-400 bg-blue-900/20":"text-gray-400 hover:text-gray-200"}`,children:[a.jsx(k,{name:"FileText",size:12}),""]}),a.jsxs("button",{onClick:()=>F("organization"),className:`flex-1 py-2 text-xs font-bold transition-colors flex items-center justify-center gap-1 ${V==="organization"?"text-orange-400 border-b-2 border-orange-400 bg-orange-900/20":"text-gray-400 hover:text-gray-200"}`,children:[a.jsx(k,{name:"AlertTriangle",size:12}),"",(()=>{const je=b[t]?.organization??0;return je>30?a.jsxs("span",{className:`ml-1 px-1 py-0.5 rounded text-[9px] ${je>=70?"bg-red-600":"bg-orange-600"}`,children:[je.toFixed(0),"%"]}):null})()]})]}),V==="overview"&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"grid grid-cols-4 gap-1.5",children:[a.jsxs("div",{className:"bg-gray-700/50 rounded p-1.5 border border-gray-600",children:[a.jsxs("div",{className:"flex items-center gap-1 mb-0.5",children:[a.jsx(k,{name:"Users",size:12,className:"text-blue-400"}),a.jsx("span",{className:"text-[9px] text-gray-400 leading-none",children:""})]}),a.jsx("div",{className:"text-sm font-bold text-white font-mono leading-none",children:re})]}),a.jsxs("div",{className:"bg-gray-700/50 rounded p-1.5 border border-gray-600",children:[a.jsxs("div",{className:"flex items-center gap-1 mb-0.5",children:[a.jsx(k,{name:"Heart",size:12,className:"text-pink-400"}),a.jsx("span",{className:"text-[9px] text-gray-400 leading-none",children:""})]}),a.jsxs("div",{className:`text-sm font-bold font-mono leading-none ${ta(C)}`,children:[C.toFixed(0),"%"]})]}),a.jsxs("div",{className:"bg-gray-700/50 rounded p-1.5 border border-gray-600",children:[a.jsxs("div",{className:"flex items-center gap-1 mb-0.5",children:[a.jsx(k,{name:"Zap",size:12,className:"text-purple-400"}),a.jsx("span",{className:"text-[9px] text-gray-400 leading-none",children:""})]}),a.jsx("div",{className:"text-sm font-bold text-purple-300 font-mono leading-none",children:L.toFixed(0)})]}),a.jsxs("div",{className:"bg-gray-700/50 rounded p-1.5 border border-gray-600",children:[a.jsxs("div",{className:"flex items-center gap-1 mb-0.5",children:[a.jsx(k,{name:"Coins",size:12,className:"text-yellow-400"}),a.jsx("span",{className:"text-[9px] text-gray-400 leading-none",children:""})]}),a.jsx("div",{className:"text-sm font-bold text-yellow-300 font-mono leading-none",children:ie.toFixed(0)})]})]}),a.jsxs("div",{className:`rounded p-2 border ${oa} ${Vt}`,children:[a.jsxs("h3",{className:"text-[10px] font-bold text-white mb-1.5 flex items-center gap-1",children:[a.jsx(k,{name:"Activity",size:12,className:"text-cyan-400"}),""]}),a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:`w-10 h-10 rounded-lg flex items-center justify-center ${Vt} border ${oa}`,children:a.jsx(k,{name:Pe,size:20,className:lt})}),a.jsxs("div",{children:[a.jsx("div",{className:`text-lg font-bold ${lt}`,children:bt}),a.jsxs("div",{className:"text-[9px] text-gray-400 leading-none",children:[": ",gn.toFixed(0)]})]})]}),a.jsxs("div",{className:"flex-1 grid grid-cols-3 gap-1.5",children:[a.jsxs("div",{className:"bg-gray-800/40 rounded px-2 py-1",children:[a.jsx("div",{className:"text-[9px] text-gray-400 leading-none mb-0.5",children:""}),a.jsx("div",{className:"text-xs font-bold text-yellow-300 font-mono",children:Ue.toFixed(1)}),a.jsxs("div",{className:"text-[8px] text-gray-500 leading-none",children:[ht>=1?"":""," ",ht>=1?"+":"",((ht-1)*100).toFixed(0),"%"]})]}),a.jsxs("div",{className:"bg-gray-800/40 rounded px-2 py-1",children:[a.jsx("div",{className:"text-[9px] text-gray-400 leading-none mb-0.5",children:""}),a.jsxs("div",{className:`text-xs font-bold font-mono ${ft>=2?"text-purple-400":ft>=1.5?"text-blue-400":ft>=1?"text-green-400":"text-red-400"}`,children:["",ft.toFixed(2)]}),a.jsx("div",{className:"text-[8px] text-gray-500 leading-none",children:""})]}),a.jsxs("div",{className:"bg-gray-800/40 rounded px-2 py-1",children:[a.jsx("div",{className:"text-[9px] text-gray-400 leading-none mb-0.5",children:""}),a.jsxs("div",{className:`text-xs font-bold font-mono ${$t>=.8?"text-green-400":$t>=.5?"text-yellow-400":"text-red-400"}`,children:[($t*100).toFixed(0),"%"]}),a.jsxs("div",{className:"text-[8px] text-gray-500 leading-none",children:[": ",Ka,"%"]})]})]})]}),qt.length>0&&a.jsxs("div",{className:"mt-2 pt-2 border-t border-gray-700/50",children:[a.jsxs("div",{className:"flex items-center justify-between mb-1",children:[a.jsx("span",{className:"text-[9px] text-gray-400",children:""}),a.jsxs("span",{className:"text-[9px] font-bold text-blue-400",children:[qt.length," "]})]}),a.jsx("div",{className:"flex gap-1",children:qt.map(({threshold:je,count:J})=>{const le=Zt[je],Me=Object.keys(le).filter(Ie=>si(Ie,Y,U)).map(Ie=>Re[Ie]?.name||Ie).join("");return a.jsxs("div",{className:"flex-1 rounded px-1.5 py-1 text-center bg-blue-900/30 border border-blue-500/40",title:`${je}x: ${Me}`,children:[a.jsxs("div",{className:"text-[9px] font-bold text-blue-300",children:[je,""]}),a.jsxs("div",{className:"text-[8px] text-gray-300",children:["+",J,""]})]},je)})})]})]}),D&&a.jsxs("div",{className:"bg-gray-700/50 rounded p-2 border border-gray-600",children:[a.jsxs("h3",{className:"text-[10px] font-bold text-white mb-1.5 flex items-center gap-1",children:[a.jsx(k,{name:"Sliders",size:12,className:"text-yellow-400"}),""]}),a.jsxs("div",{className:"grid grid-cols-2 gap-2 items-center",children:[a.jsxs("div",{children:[a.jsx("div",{className:"text-[9px] text-gray-400 mb-0.5 leading-none",children:""}),a.jsx("input",{type:"text",inputMode:"decimal",step:"0.05",value:P??tt,onChange:je=>Gt(je.target.value),onBlur:kt,onKeyDown:je=>{je.key==="Enter"&&(kt(),je.target.blur())},className:"w-full bg-gray-900/70 border border-gray-600 text-sm text-gray-200 rounded px-2 py-1 focus:ring-1 focus:ring-blue-500 focus:border-blue-500 text-center",placeholder:""})]}),a.jsxs("div",{children:[a.jsx("div",{className:"text-[9px] text-gray-400 mb-0.5 leading-none",children:" ()"}),a.jsxs("div",{className:"bg-gray-800/50 rounded px-2 py-1.5 text-center",children:[a.jsxs("span",{className:`text-sm font-bold font-mono ${de.headTaxBase*tt>0?"text-yellow-300":de.headTaxBase*tt<0?"text-green-300":"text-gray-400"}`,children:[de.headTaxBase*tt<0?" ":"",Math.abs((de.headTaxBase||.01)*tt).toFixed(3)]}),a.jsx(k,{name:de.headTaxBase*tt>0?"TrendingUp":de.headTaxBase*tt<0?"TrendingDown":"Coins",size:12,className:`inline-block ml-1 ${de.headTaxBase*tt>0?"text-yellow-400":de.headTaxBase*tt<0?"text-green-400":"text-gray-500"}`})]})]})]}),a.jsx("p",{className:"text-[10px] text-gray-500 mt-1.5",children:" =   "})]}),a.jsxs("div",{className:"bg-gray-700/50 rounded p-2 border border-gray-600",children:[a.jsxs("h3",{className:"text-[10px] font-bold text-white mb-1.5 flex items-center gap-1",children:[a.jsx(k,{name:"TrendingUp",size:12,className:"text-green-400"}),""]}),a.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[a.jsxs("div",{children:[a.jsx("div",{className:"text-[9px] text-gray-400 mb-0.5 leading-none",children:""}),a.jsxs("div",{className:"text-sm font-bold text-green-400 font-mono leading-none",children:["+",me.toFixed(2)]})]}),a.jsxs("div",{children:[a.jsx("div",{className:"text-[9px] text-gray-400 mb-0.5 leading-none",children:""}),a.jsxs("div",{className:"text-sm font-bold text-red-400 font-mono leading-none",children:["-",X.toFixed(2)]})]}),a.jsxs("div",{children:[a.jsx("div",{className:"text-[9px] text-gray-400 mb-0.5 leading-none",children:""}),a.jsxs("div",{className:`text-sm font-bold font-mono leading-none ${fe>=0?"text-green-400":"text-red-400"}`,children:[fe>=0?"+":"",fe.toFixed(2)]})]})]})]}),a.jsxs("div",{className:"bg-gray-700/50 rounded p-2 border border-gray-600",children:[a.jsxs("h3",{className:"text-[10px] font-bold text-white mb-1.5 flex items-center gap-1",children:[a.jsx(k,{name:"Package",size:12,className:"text-amber-400"}),"",Ye>0&&oe>0&&a.jsx("span",{className:"text-[8px] text-purple-400 ml-1",children:"()"})]}),(()=>{const je={};if(de.needs)for(const[le,ue]of Object.entries(de.needs))si(le,Y,U)&&(je[le]={amount:ue,isBase:!0,luxuryThreshold:null});if(de.luxuryNeeds){for(const le of la)if(ht>=le){const ue=de.luxuryNeeds[le];for(const[Me,Ie]of Object.entries(ue))si(Me,Y,U)&&(je[Me]?(je[Me].amount+=Ie,je[Me].isBase||(je[Me].luxuryThreshold=Math.min(je[Me].luxuryThreshold||1/0,le))):je[Me]={amount:Ie,isBase:!1,luxuryThreshold:le})}}const J=Object.entries(je);return J.length===0?a.jsx("div",{className:"text-center text-gray-400 text-[10px] py-2",children:""}):a.jsx("div",{className:"space-y-1.5",children:J.map(([le,{amount:ue,isBase:Me,luxuryThreshold:Ie}])=>{const at=Re[le],Ze=Je.find(Tt=>(typeof Tt=="string"?Tt:Tt.resource)===le),Ce=!!Ze,rt=Ze&&typeof Ze!="string"?Ze.reason:"outOfStock";let zt="CheckCircle",Ve="text-green-400",ca=" ",ha="bg-green-900/20",Ra="border-green-500/30",xe="";return Ce&&(rt==="unaffordable"?(zt="DollarSign",Ve="text-orange-400",ca=" ",ha="bg-orange-900/20",Ra="border-orange-500/40",xe=""):rt==="outOfStock"?(zt="XCircle",Ve="text-red-400",ca=" ",ha="bg-red-900/20",Ra="border-red-500/40",xe=""):rt==="both"&&(zt="AlertTriangle",Ve="text-red-500",ca=" ",ha="bg-red-900/30",Ra="border-red-500/50",xe="")),a.jsxs("div",{className:`rounded p-2 border ${Ra} ${ha} ${Ce?"animate-pulse":""}`,children:[a.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[a.jsx("div",{className:"w-7 h-7 bg-gray-800/60 rounded flex items-center justify-center flex-shrink-0",children:a.jsx(k,{name:at?.icon||"HelpCircle",size:16,className:at?.color||"text-gray-400"})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx("span",{className:"text-xs font-bold text-white leading-tight",children:at?.name||le}),!Me&&a.jsxs("span",{className:"text-[8px] px-1 py-0.5 rounded bg-purple-900/40 text-purple-300 border border-purple-500/30",children:[" ",Ie,""]})]}),a.jsx("div",{className:"text-[9px] text-gray-400 leading-tight truncate",children:at?.desc||""})]})]}),a.jsxs("div",{className:"bg-gray-800/40 rounded px-2 py-1 mb-1",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-[9px] text-gray-400 leading-none",children:""}),a.jsx("span",{className:"text-[10px] font-bold text-white font-mono leading-none",children:ue})]}),a.jsxs("div",{className:"flex items-center justify-between mt-0.5",children:[a.jsx("span",{className:"text-[9px] text-gray-400 leading-none",children:""}),a.jsx("span",{className:"text-[10px] font-bold text-blue-300 font-mono leading-none",children:(ue*re).toFixed(0)})]})]}),a.jsxs("div",{className:`flex items-center gap-1.5 px-2 py-1 rounded ${ha}`,children:[a.jsx(k,{name:zt,size:12,className:Ve}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("div",{className:`text-[10px] font-bold ${Ve} leading-tight`,children:ca}),xe&&a.jsx("div",{className:`text-[9px] ${Ve} leading-tight truncate`,children:xe})]})]})]},le)})})})()]}),(Ht.length>0||se.length>0)&&a.jsxs("div",{className:"bg-gray-700/50 rounded p-2 border border-gray-600",children:[a.jsxs("h3",{className:"text-[10px] font-bold text-white mb-1.5 flex items-center gap-1",children:[a.jsx(k,{name:"Activity",size:12,className:"text-blue-400"}),""]}),a.jsxs("div",{className:"space-y-1",children:[Ht.map((je,J)=>{const le=Xr(je);return a.jsxs("div",{className:"bg-green-900/20 border border-green-500/30 rounded p-1.5",children:[a.jsxs("div",{className:"flex items-center gap-1 mb-0.5",children:[a.jsx(k,{name:"ArrowUp",size:10,className:"text-green-400"}),a.jsx("span",{className:"text-[10px] font-semibold text-green-300 leading-tight",children:je.desc||""})]}),le.length>0&&a.jsx("div",{className:"text-[9px] text-gray-300 ml-4 leading-tight",children:le.join("")})]},`buff-${J}`)}),se.map((je,J)=>{const le=Xr(je);return a.jsxs("div",{className:"bg-red-900/20 border border-red-500/30 rounded p-1.5",children:[a.jsxs("div",{className:"flex items-center gap-1 mb-0.5",children:[a.jsx(k,{name:"ArrowDown",size:10,className:"text-red-400"}),a.jsx("span",{className:"text-[10px] font-semibold text-red-300 leading-tight",children:je.desc||""})]}),le.length>0&&a.jsx("div",{className:"text-[9px] text-gray-300 ml-4 leading-tight",children:le.join("")})]},`debuff-${J}`)})]})]})]}),V==="organization"&&a.jsx("div",{className:"space-y-2",children:(()=>{const je=b[t]||{},J=je.organization??0,le=je.growthRate??0,ue=Fr(J),Me=By(ue),Ie=zy(ue),at=Ly(J,le);return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"bg-gray-700/50 rounded p-3 border border-gray-600",children:[a.jsxs("h3",{className:"text-sm font-bold text-white mb-2 flex items-center gap-2",children:[a.jsx(k,{name:"AlertTriangle",size:16,className:"text-orange-400"}),""]}),a.jsxs("div",{className:"mb-3",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(k,{name:Ie,size:18,className:J>=70?"text-red-500 animate-pulse":J>=30?"text-orange-400":"text-yellow-400"}),a.jsx("span",{className:`text-sm font-bold ${J>=70?"text-red-400":J>=30?"text-orange-400":"text-yellow-400"}`,children:Me})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs("span",{className:"text-lg font-mono font-bold text-white",children:[J.toFixed(0),"%"]}),le!==0&&a.jsxs("span",{className:`text-xs font-mono ${le>0?"text-red-300":"text-green-300"}`,children:["(",le>0?"+":"",le.toFixed(2),"/)"]})]})]}),a.jsx("div",{className:"w-full bg-gray-800/50 rounded-full h-3 border border-gray-600 overflow-hidden",children:a.jsx("div",{className:`h-3 rounded-full transition-all ${J>=90?"bg-red-500 animate-pulse":J>=70?"bg-orange-500":J>=30?"bg-yellow-500":"bg-gray-500"}`,style:{width:`${J}%`}})}),at!==null&&at<200&&a.jsxs("div",{className:"text-sm text-red-400 mt-2 animate-pulse font-bold",children:["  ",at," "]})]})]}),(()=>{const Ce=Y5(t,{classShortages:x,classApproval:o,classInfluence:c,totalInfluence:S,classLivingStandard:g,taxPolicies:T,classIncome:m,popStructure:s});return Ce.hasIssues?a.jsx("div",{className:"bg-gray-700/50 rounded p-3 border border-gray-600",children:a.jsx(qT,{sources:Ce.sources,totalContribution:Ce.totalContribution})}):null})(),(jt>=50||ot.length>0)&&a.jsxs("div",{className:"bg-gray-700/50 rounded p-3 border border-gray-600",children:[a.jsx(GT,{demands:ot,currentDay:E}),ot.length===0&&a.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-400",children:[a.jsx(k,{name:"Scroll",size:14,className:"text-purple-400"}),a.jsx("span",{children:""})]})]}),a.jsxs("div",{className:"bg-gray-700/50 rounded p-3 border border-gray-600 space-y-3",children:[a.jsxs("div",{children:[a.jsxs("h3",{className:"text-sm font-bold text-white mb-3 flex items-center gap-2",children:[a.jsx(k,{name:"Zap",size:16,className:"text-blue-400"}),""]}),a.jsx("div",{className:"space-y-1.5",children:he.map(Ze=>a.jsx(HT,{action:Ze,stratumKey:t,stratumName:de.name,popCount:re,disabled:!O||!Ze.available,unavailableReason:Ze.unavailableReason,onExecute:O,actionUsage:_},Ze.id))}),he.length===0&&a.jsx("div",{className:"text-xs text-gray-400 text-center mt-2",children:""}),!O&&a.jsx("div",{className:"text-xs text-gray-500 mt-2 text-center bg-gray-800/30 rounded p-2",children:"..."})]}),a.jsxs("div",{className:"pt-2 border-t border-gray-600/60",children:[a.jsxs("h4",{className:"text-[11px] font-bold text-white mb-1 flex items-center gap-1",children:[a.jsx(k,{name:"FileText",size:12,className:"text-amber-300"}),""]}),K.length>0?a.jsx("div",{className:"space-y-1",children:K.map(Ze=>{const Ce=g3(Ze,E||0);return a.jsxs("div",{className:"bg-gray-800/60 border border-gray-600 rounded p-2",children:[a.jsxs("div",{className:"flex items-center justify-between text-[10px] text-gray-300",children:[a.jsx("span",{className:"font-semibold text-white",children:Ze.description}),a.jsxs("span",{className:`font-mono ${Ce<=5?"text-red-300":"text-green-300"}`,children:[" ",Ce," "]})]}),a.jsxs("div",{className:"text-[9px] text-gray-400 mt-0.5",children:[":  +",Ze.failurePenalty?.organization||0,"%",Ze.failurePenalty?.forcedUprising?"":""]})]},Ze.id)})}):a.jsx("div",{className:"text-[11px] text-gray-400",children:""})]})]})]})})()})]})},YT=t=>{if(typeof t!="string")return t;if(t.includes("RAID_EVENT"))try{const s=t.replace("RAID_EVENT",""),r=JSON.parse(s),o=r.actionName||"";if(r.victory)return`  ${r.nationName} ${o}`;{const c=[];r.foodLoss>0&&c.push(` -${r.foodLoss}`),r.silverLoss>0&&c.push(` -${r.silverLoss}`),r.woodLoss>0&&c.push(` -${r.woodLoss}`),r.popLoss>0&&c.push(` -${r.popLoss}`);const u=c.length>0?`${c.join("")}`:"";return`  ${r.nationName} ${o}${u}`}}catch{return" "}if(t.includes("WAR_DECLARATION_EVENT:"))try{const s=t.replace("WAR_DECLARATION_EVENT:","");return` ${JSON.parse(s).nationName} `}catch{return" "}return t},XT=({logs:t})=>{const s=t.map(YT);return a.jsxs("div",{className:"glass-epic p-3 rounded-2xl border border-ancient-gold/20 shadow-epic relative overflow-hidden",children:[a.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-ancient-ink/60 via-ancient-stone/30 to-ancient-ink/60 opacity-60"}),a.jsx("div",{className:"absolute inset-0 opacity-[0.03] pointer-events-none",children:a.jsxs("svg",{className:"w-full h-full",xmlns:"http://www.w3.org/2000/svg",children:[a.jsxs("pattern",{id:"log-panel-pattern",width:"80",height:"80",patternUnits:"userSpaceOnUse",children:[a.jsx("path",{d:"M0 20 H80 M0 60 H80",stroke:"currentColor",strokeWidth:"0.5",className:"text-ancient-gold/10"}),a.jsx("path",{d:"M20 0 V80 M60 0 V80",stroke:"currentColor",strokeWidth:"0.5",className:"text-ancient-gold/10"}),a.jsx("circle",{cx:"40",cy:"40",r:"2",fill:"currentColor",className:"text-ancient-gold/30"})]}),a.jsx("rect",{width:"100%",height:"100%",fill:"url(#log-panel-pattern)"})]})}),a.jsxs("div",{className:"relative z-10 flex flex-col gap-2",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("h3",{className:"text-sm font-bold text-ancient flex items-center gap-2",children:[a.jsx(k,{name:"ScrollText",size:16,className:"text-ancient-gold"}),""]}),a.jsxs("span",{className:"text-[11px] text-ancient-stone opacity-80",children:[" ",s.length," "]})]}),a.jsx("div",{className:"space-y-1.5 max-h-48 overflow-y-auto pr-1 scrollbar-thin scrollbar-thumb-ancient-gold/40",children:s.length===0?a.jsx("p",{className:"text-xs text-ancient-stone opacity-70 italic text-center py-4",children:""}):s.map((r,o)=>a.jsxs("div",{className:"text-xs text-ancient-parchment glass-ancient border border-ancient-gold/10 rounded-lg px-2 py-1.5 hover:border-ancient-gold/30 transition-all animate-fade-in",children:[a.jsxs("span",{className:"text-ancient-gold/60 font-mono text-[10px] mr-2",children:["#",o+1]}),r]},o))})]})]})},ZT=({isAutoSaveEnabled:t,autoSaveInterval:s,onToggleAutoSave:r,onIntervalChange:o,lastAutoSaveTime:c,onManualSave:u,onManualLoad:p,onAutoLoad:m,autoSaveAvailable:h,isSaving:x,onClose:g,timeSettings:b,onTimeSettingsChange:j})=>{const{enabled:_,volume:N,toggleSound:M,setVolume:R,playSound:E,SOUND_TYPES:T}=Mf(),D=b?.approval||{},O=b?.stability||{};Math.max(5,D.duration||30),Math.max(5,O.duration||30),Math.max(0,Math.min(.95,D.decayRate??.04)),Math.max(0,Math.min(.95,O.decayRate??.04));const q=()=>{if(!c)return"";try{return new Date(c).toLocaleTimeString()}catch{return""}};return a.jsxs("div",{className:"bg-gray-900/90 backdrop-blur border border-gray-700 rounded-xl p-4 space-y-4 shadow-lg",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("h3",{className:"text-sm font-bold text-gray-200 flex items-center gap-2",children:[a.jsx(k,{name:"Sliders",size:16})," "]}),a.jsxs("div",{className:"flex items-center gap-2",children:[x&&a.jsxs("div",{className:"flex items-center gap-1 text-emerald-300 text-[11px]",children:[a.jsx(k,{name:"Activity",size:12,className:"animate-spin"}),a.jsx("span",{children:""})]}),g&&a.jsx("button",{type:"button",onClick:g,className:"p-1 rounded-full bg-gray-800/80 hover:bg-gray-700 border border-gray-600 text-gray-300 transition-colors",title:"",children:a.jsx(k,{name:"X",size:14})})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-300",children:[a.jsx("span",{children:""}),a.jsx("span",{className:t?"text-emerald-300":"text-gray-500",children:t?"":""})]}),a.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[a.jsx("input",{type:"checkbox",className:"sr-only peer",checked:t,onChange:I=>r(I.target.checked)}),a.jsx("div",{className:"w-10 h-5 bg-gray-700 rounded-full peer peer-checked:bg-emerald-600 transition-colors"}),a.jsx("div",{className:`absolute left-1 top-1 w-3 h-3 rounded-full bg-white transition-transform ${t?"translate-x-5":""}`})]})]}),a.jsxs("div",{className:"space-y-2 text-xs text-gray-300",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{children:""}),a.jsxs("span",{children:[s," "]})]}),a.jsx("input",{type:"range",min:15,max:300,step:15,value:s,onChange:I=>o(Number(I.target.value)),className:"w-full accent-emerald-500"}),a.jsx("p",{className:"text-[11px] text-gray-400",children:" 15  5 "})]}),a.jsxs("div",{className:"text-[11px] text-gray-400 flex items-center gap-2",children:[a.jsx(k,{name:"Clock",size:12,className:"text-gray-500"}),a.jsxs("span",{children:["",q()]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[a.jsxs("button",{type:"button",onClick:u,className:"flex items-center justify-center gap-1 px-3 py-2 rounded-lg bg-emerald-700/30 hover:bg-emerald-700/50 border border-emerald-500/30 text-emerald-200 transition-colors",children:[a.jsx(k,{name:"Save",size:14}),""]}),a.jsxs("button",{type:"button",onClick:p,className:"flex items-center justify-center gap-1 px-3 py-2 rounded-lg bg-purple-700/30 hover:bg-purple-700/50 border border-purple-500/30 text-purple-200 transition-colors",children:[a.jsx(k,{name:"Download",size:14}),""]}),a.jsxs("button",{type:"button",onClick:m,disabled:!h,className:`col-span-2 flex items-center justify-center gap-1 px-3 py-2 rounded-lg border transition-colors ${h?"bg-amber-700/30 hover:bg-amber-700/50 border-amber-500/30 text-amber-200":"bg-gray-700/40 border-gray-600 text-gray-400 cursor-not-allowed"}`,title:h?"":"",children:[a.jsx(k,{name:"Clock",size:14}),""]})]}),a.jsxs("div",{className:"text-[11px] text-gray-400 flex items-center gap-2",children:[a.jsx("span",{className:`w-2 h-2 rounded-full ${h?"bg-emerald-400":"bg-gray-500"}`}),h?"":""]}),a.jsxs("div",{className:"border-t border-gray-700 pt-4 space-y-4",children:[a.jsxs("h4",{className:"text-sm font-bold text-gray-200 flex items-center gap-2",children:[a.jsx(k,{name:"Volume2",size:16})," "]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-300",children:[a.jsx("span",{children:""}),a.jsx("span",{className:_?"text-emerald-300":"text-gray-500",children:_?"":""})]}),a.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[a.jsx("input",{type:"checkbox",className:"sr-only peer",checked:_,onChange:()=>{M(),_||setTimeout(()=>E(T.SUCCESS),100)}}),a.jsx("div",{className:"w-10 h-5 bg-gray-700 rounded-full peer peer-checked:bg-emerald-600 transition-colors"}),a.jsx("div",{className:`absolute left-1 top-1 w-3 h-3 rounded-full bg-white transition-transform ${_?"translate-x-5":""}`})]})]}),_&&a.jsxs("div",{className:"space-y-2 text-xs text-gray-300",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{children:""}),a.jsxs("span",{children:[Math.round(N*100),"%"]})]}),a.jsx("input",{type:"range",min:0,max:100,step:5,value:N*100,onChange:I=>R(Number(I.target.value)/100),className:"w-full accent-emerald-500"})]}),_&&a.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[a.jsx("button",{type:"button",onClick:()=>E(T.CLICK),className:"flex items-center justify-center gap-1 px-2 py-1.5 rounded-lg bg-gray-700/50 hover:bg-gray-700 border border-gray-600 text-gray-300 transition-colors",children:""}),a.jsx("button",{type:"button",onClick:()=>E(T.SUCCESS),className:"flex items-center justify-center gap-1 px-2 py-1.5 rounded-lg bg-gray-700/50 hover:bg-gray-700 border border-gray-600 text-gray-300 transition-colors",children:""}),a.jsx("button",{type:"button",onClick:()=>E(T.BUILD),className:"flex items-center justify-center gap-1 px-2 py-1.5 rounded-lg bg-gray-700/50 hover:bg-gray-700 border border-gray-600 text-gray-300 transition-colors",children:""}),a.jsx("button",{type:"button",onClick:()=>E(T.BATTLE),className:"flex items-center justify-center gap-1 px-2 py-1.5 rounded-lg bg-gray-700/50 hover:bg-gray-700 border border-gray-600 text-gray-300 transition-colors",children:""})]})]})]})};function dy({daysElapsed:t=0,season:s="",population:r=0,stability:o=100,wealth:c=0,epoch:u=0}){const[p,m]=$.useState(0),[h,x]=$.useState(.5),[g,b]=$.useState(1),j=$.useMemo(()=>Math.random().toString(36).substr(2,9),[]),_=85;$.useEffect(()=>{const S=setInterval(()=>{m(ne=>(ne+.002)%1)},50),Q=setInterval(()=>{x(Math.random()),b(.5+Math.random()*1.5)},15e3);return()=>{clearInterval(S),clearInterval(Q)}},[]);const N=$.useMemo(()=>{const S=p;let Q,ne,Ne,$e;const de=110-Math.sin((S-.2)*(Math.PI/.6))*100,P=20+(S-.2)/.6*160;let z=S<.5?S+1:S;const V=110-Math.sin((z-.7)*(Math.PI/.6))*100,F=20+(z-.7)/.6*160;if(S<.25){const re=S/.25;Q=`rgb(${20+re*100}, ${30+re*120}, ${60+re*130})`,ne=`rgb(${40+re*120}, ${60+re*140}, ${100+re*135})`,Ne=1-re*2,$e="#ffccbc"}else if(S<.75)Q="#4fc3f7",ne="#b3e5fc",Ne=0,$e="#ffffff";else{const re=(S-.75)/.25;Q=`rgb(${25+(1-re)*10}, ${25+(1-re)*20}, ${60+(1-re)*60})`,ne="rgb(10, 10, 30)",Ne=re*2,$e="#546e7a"}return{from:Q,to:ne,sunX:P,sunY:de,moonX:F,moonY:V,starOpacity:Ne,cloudColor:$e}},[p]),M=$.useMemo(()=>{const S={:{ground:["#8bc34a","#c5e1a5"],grass:"#8bc34a",bush:"#7cb342",treeTrunk:"#795548",treeLeaf:"#66bb6a",flower:"#f48fb1",particles:"#f8bbd0",mountain1:["#6b8e7f","#4a6b5c"],mountain2:["#7fa89b","#5d7f72"]},:{ground:["#558b2f","#8bc34a"],grass:"#558b2f",bush:"#33691e",treeTrunk:"#5d4037",treeLeaf:"#2e7d32",flower:null,particles:"#fff176",mountain1:["#546e7a","#37474f"],mountain2:["#607d8b","#455a64"]},:{ground:["#d7ccc8","#efebe9"],grass:"#d7ccc8",bush:"#ffb74d",treeTrunk:"#4e342e",treeLeaf:["#ff7043","#ffca28","#d84315"],flower:null,particles:"#d84315",mountain1:["#8d6e63","#5d4037"],mountain2:["#a1887f","#6d4c41"]},:{ground:["#eceff1","#ffffff"],grass:"#cfd8dc",bush:"#b0bec5",treeTrunk:"#3e2723",treeLeaf:"#ffffff",flower:null,particles:"#ffffff",mountain1:["#b0bec5","#78909c"],mountain2:["#cfd8dc","#90a4ae"]}};return S[s]||S.},[s]),R=$.useMemo(()=>{const S={0:{type:"tent",color:"#a1887f",roof:"#8d6e63",detail:"campfire",atmosphere:"rgba(139,69,19,0.1)",landmark:"cave"},1:{type:"clay",color:"#d7ccc8",roof:"#a1887f",detail:"pot",atmosphere:"rgba(205,127,50,0.08)",landmark:"obelisk"},2:{type:"clay",color:"#f5f5dc",roof:"#cd853f",detail:"column",atmosphere:"rgba(255,215,0,0.06)",landmark:"temple"},3:{type:"timber",color:"#8b7355",roof:"#3e2723",detail:"banner",atmosphere:"rgba(70,130,180,0.08)",landmark:"tower"},4:{type:"timber",color:"#deb887",roof:"#654321",detail:"ship",atmosphere:"rgba(0,128,128,0.06)",landmark:"lighthouse"},5:{type:"brick",color:"#f4a460",roof:"#2f4f4f",detail:"lamp",atmosphere:"rgba(138,43,226,0.05)",landmark:"dome"},6:{type:"brick",color:"#b71c1c",roof:"#263238",detail:"chimney",atmosphere:"rgba(105,105,105,0.12)",landmark:"factory"},7:{type:"modern",color:"#cfd8dc",roof:"#607d8b",detail:"glass",atmosphere:"rgba(0,255,127,0.05)",landmark:"antenna"}};return S[u]||S[0]},[u]),E=$.useMemo(()=>{const S=Math.min(Math.floor(r/5),15);return Array.from({length:S}).map((ne,Ne)=>{const $e=Math.sin(Ne*132.1)*10,de=Math.floor(Ne/5),P=(2-de)*4,z=_+P+2,V=1-de*.15;return{x:20+Ne*35%160+$e,y:z,scale:V,id:Ne}}).sort((ne,Ne)=>ne.y-Ne.y)},[r]),T=$.useMemo(()=>{const S=Math.min(Math.floor(r/3),8);return Array.from({length:S}).map((Q,ne)=>({id:ne,startX:10+Math.random()*180,y:_+2+Math.random()*10,duration:15+Math.random()*10,delay:-Math.random()*20,scale:.5+Math.random()*.3,color:["#5d4037","#3e2723","#4e342e"][Math.floor(Math.random()*3)]})).sort((Q,ne)=>Q.y-ne.y)},[r]),D=$.useMemo(()=>{const S=[],ne=Ne=>{const $e=Math.sin(Ne+123.45)*1e4;return $e-Math.floor($e)};for(let Ne=0;Ne<60;Ne++){const $e=ne(Ne*1.1),de=ne(Ne*2.2),P=ne(Ne*3.3);let z="grass";de>.5&&(z="bush"),de>.8&&(z="tree");const V=$e,F=_+2+V*35,re=-20+ne(Ne*99)*240;let C=.5+V*.8;z==="grass"&&(C*=.6);let L=0;Array.isArray(M.treeLeaf)&&(L=Math.floor(P*M.treeLeaf.length)),S.push({id:Ne,type:z,x:re,y:F,scale:C,flip:P>.5?1:-1,variant:P,colorIdx:L})}return S.sort((Ne,$e)=>Ne.y-$e.y)},[s,M]),O=(100-o)/100*.8,q=h<O,I=o<80||h<.7,Z=o<30&&q,Y=Math.min(100,c/20+o/2+r/2),U=Y>70;return a.jsxs("div",{className:"relative w-full h-48 md:h-64 group select-none",children:[a.jsx("div",{className:"absolute inset-0 rounded-lg",style:{background:"linear-gradient(135deg, #8b7355 0%, #d4af37 15%, #c9a227 50%, #d4af37 85%, #8b7355 100%)",padding:"3px",boxShadow:"0 4px 20px rgba(0,0,0,0.6), inset 0 1px 0 rgba(255,255,255,0.3), inset 0 -1px 0 rgba(0,0,0,0.4)"},children:a.jsx("div",{className:"absolute inset-[3px] rounded-md",style:{background:"linear-gradient(180deg, #3d2415 0%, #1a1410 50%, #2c1810 100%)",border:"1px solid rgba(212,175,55,0.4)",boxShadow:"inset 0 2px 4px rgba(0,0,0,0.8), inset 0 -1px 0 rgba(212,175,55,0.2)"}})}),a.jsx("div",{className:"absolute top-0 left-0 w-6 h-6 pointer-events-none z-20",children:a.jsxs("svg",{viewBox:"0 0 24 24",className:"w-full h-full",children:[a.jsx("path",{d:"M0,0 L24,0 L24,4 L4,4 L4,24 L0,24 Z",fill:"url(#cornerGold)",opacity:"0.9"}),a.jsx("path",{d:"M2,2 L20,2 L20,3 L3,3 L3,20 L2,20 Z",fill:"rgba(255,235,180,0.4)"}),a.jsx("circle",{cx:"4",cy:"4",r:"2",fill:"#d4af37"}),a.jsx("circle",{cx:"4",cy:"4",r:"1",fill:"#f4e8d0"})]})}),a.jsx("div",{className:"absolute top-0 right-0 w-6 h-6 pointer-events-none z-20",style:{transform:"scaleX(-1)"},children:a.jsxs("svg",{viewBox:"0 0 24 24",className:"w-full h-full",children:[a.jsx("path",{d:"M0,0 L24,0 L24,4 L4,4 L4,24 L0,24 Z",fill:"url(#cornerGold)",opacity:"0.9"}),a.jsx("path",{d:"M2,2 L20,2 L20,3 L3,3 L3,20 L2,20 Z",fill:"rgba(255,235,180,0.4)"}),a.jsx("circle",{cx:"4",cy:"4",r:"2",fill:"#d4af37"}),a.jsx("circle",{cx:"4",cy:"4",r:"1",fill:"#f4e8d0"})]})}),a.jsx("div",{className:"absolute bottom-0 left-0 w-6 h-6 pointer-events-none z-20",style:{transform:"scaleY(-1)"},children:a.jsxs("svg",{viewBox:"0 0 24 24",className:"w-full h-full",children:[a.jsx("path",{d:"M0,0 L24,0 L24,4 L4,4 L4,24 L0,24 Z",fill:"url(#cornerGold)",opacity:"0.9"}),a.jsx("path",{d:"M2,2 L20,2 L20,3 L3,3 L3,20 L2,20 Z",fill:"rgba(255,235,180,0.4)"}),a.jsx("circle",{cx:"4",cy:"4",r:"2",fill:"#d4af37"}),a.jsx("circle",{cx:"4",cy:"4",r:"1",fill:"#f4e8d0"})]})}),a.jsx("div",{className:"absolute bottom-0 right-0 w-6 h-6 pointer-events-none z-20",style:{transform:"scale(-1)"},children:a.jsxs("svg",{viewBox:"0 0 24 24",className:"w-full h-full",children:[a.jsx("path",{d:"M0,0 L24,0 L24,4 L4,4 L4,24 L0,24 Z",fill:"url(#cornerGold)",opacity:"0.9"}),a.jsx("path",{d:"M2,2 L20,2 L20,3 L3,3 L3,20 L2,20 Z",fill:"rgba(255,235,180,0.4)"}),a.jsx("circle",{cx:"4",cy:"4",r:"2",fill:"#d4af37"}),a.jsx("circle",{cx:"4",cy:"4",r:"1",fill:"#f4e8d0"})]})}),a.jsx("div",{className:"absolute top-[3px] left-8 right-8 h-[2px] z-20",style:{background:"linear-gradient(90deg, transparent 0%, rgba(212,175,55,0.6) 20%, rgba(244,232,208,0.8) 50%, rgba(212,175,55,0.6) 80%, transparent 100%)"}}),a.jsx("div",{className:"absolute bottom-[3px] left-8 right-8 h-[2px] z-20",style:{background:"linear-gradient(90deg, transparent 0%, rgba(212,175,55,0.6) 20%, rgba(244,232,208,0.8) 50%, rgba(212,175,55,0.6) 80%, transparent 100%)"}}),a.jsxs("div",{className:"absolute inset-[5px] rounded overflow-hidden",style:{boxShadow:"inset 0 0 20px rgba(0,0,0,0.5), inset 0 0 3px rgba(212,175,55,0.3)"},children:[a.jsx("style",{children:`
        @keyframes cloud-drift { from { transform: translateX(-50px); } to { transform: translateX(250px); } }
        @keyframes twinkle { 0%, 100% { opacity: 0.3; transform: scale(0.8); } 50% { opacity: 1; transform: scale(1.2); } }
        @keyframes sway { 0%, 100% { transform: rotate(-3deg); } 50% { transform: rotate(3deg); } }
        @keyframes grass-sway { 0%, 100% { transform: rotate(-5deg); } 50% { transform: rotate(5deg); } }
        @keyframes smoke { 0% { opacity: 0.7; transform: translateY(0) scale(1); } 100% { opacity: 0; transform: translateY(-18px) scale(2.5); } }
        @keyframes rain { 0% { transform: translateY(-20px) translateX(${g*-5}px); opacity: 0; } 50% { opacity: 0.8; } 100% { transform: translateY(20px) translateX(${g*5}px); opacity: 0; } }
        @keyframes walk { 0% { transform: translateX(0) scaleX(1); } 45% { transform: translateX(40px) scaleX(1); } 50% { transform: translateX(40px) scaleX(-1); } 95% { transform: translateX(0) scaleX(-1); } 100% { transform: translateX(0) scaleX(1); } }
        @keyframes bob { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-0.8px); } }
        @keyframes float-up { 0% { opacity: 0.8; transform: translateY(0); } 100% { opacity: 0; transform: translateY(-25px); } }
        @keyframes shimmer { 0%, 100% { opacity: 0.4; } 50% { opacity: 0.8; } }
        @keyframes bird-fly { 0% { transform: translateX(-20px) translateY(0); } 25% { transform: translateX(50px) translateY(-5px); } 50% { transform: translateX(120px) translateY(2px); } 75% { transform: translateX(180px) translateY(-3px); } 100% { transform: translateX(220px) translateY(0); } }
        @keyframes caravan-move { 0% { transform: translateX(-30px); } 100% { transform: translateX(230px); } }
        @keyframes flag-wave { 0%, 100% { transform: scaleX(1) skewY(0deg); } 25% { transform: scaleX(0.95) skewY(2deg); } 50% { transform: scaleX(1.05) skewY(-1deg); } 75% { transform: scaleX(0.98) skewY(1deg); } }
        
        .cloud-anim { animation: cloud-drift linear infinite; }
        .tree-sway { transform-origin: bottom center; animation: sway 4s ease-in-out infinite; transform-box: fill-box; }
        .grass-sway { transform-origin: bottom center; animation: grass-sway 2s ease-in-out infinite; transform-box: fill-box; }
        .rain-drop { animation: rain 0.5s linear infinite; }
        .pedestrian-walk { animation: walk linear infinite; }
        .pedestrian-bob { animation: bob 0.5s ease-in-out infinite; }
        .smoke-particle { animation: smoke 2.5s ease-out infinite; }
        .star-twinkle { animation: twinkle 3s ease-in-out infinite; }
        .float-particle { animation: float-up 3s ease-out infinite; }
        .shimmer-effect { animation: shimmer 2s ease-in-out infinite; }
        
        /*  -  */
        svg { transition: background 3s ease-in-out; }
        path, circle, ellipse, rect, line, polygon { 
            transition: fill 3s ease-in-out, stroke 3s ease-in-out, opacity 3s ease-in-out, stop-color 3s ease-in-out; 
        }
        stop { transition: stop-color 3s ease-in-out; }
        g { transition: opacity 2s ease-in-out; }
      `}),a.jsxs("svg",{viewBox:"0 0 200 150",preserveAspectRatio:"xMidYMid slice",className:"w-full h-full block",style:{background:`linear-gradient(to bottom, ${N.from}, ${N.to})`,transition:"background 3s ease-in-out"},children:[a.jsxs("defs",{children:[a.jsx("filter",{id:`dropShadow-${j}`,x:"-20%",y:"-20%",width:"140%",height:"140%",children:a.jsx("feDropShadow",{dx:"1",dy:"2",stdDeviation:"1.5",floodColor:"#000",floodOpacity:"0.4"})}),a.jsxs("filter",{id:`prosperityGlow-${j}`,x:"-50%",y:"-50%",width:"200%",height:"200%",children:[a.jsx("feGaussianBlur",{stdDeviation:"2",result:"blur"}),a.jsxs("feMerge",{children:[a.jsx("feMergeNode",{in:"blur"}),a.jsx("feMergeNode",{in:"SourceGraphic"})]})]}),a.jsxs("filter",{id:`atmosphericHaze-${j}`,children:[a.jsx("feGaussianBlur",{stdDeviation:"0.5"}),a.jsx("feColorMatrix",{type:"matrix",values:"1 0 0 0 0.05  0 1 0 0 0.08  0 0 1 0 0.12  0 0 0 0.85 0"})]}),a.jsxs("filter",{id:`paperTexture-${j}`,children:[a.jsx("feTurbulence",{type:"fractalNoise",baseFrequency:"0.04",numOctaves:"3",result:"noise"}),a.jsx("feColorMatrix",{in:"noise",type:"saturate",values:"0"}),a.jsx("feBlend",{in:"SourceGraphic",in2:"noise",mode:"multiply"})]}),a.jsxs("linearGradient",{id:`mountainGrad1-${j}`,x1:"0",x2:"0",y1:"0",y2:"1",children:[a.jsx("stop",{offset:"0%",stopColor:M.mountain1[0]}),a.jsx("stop",{offset:"100%",stopColor:M.mountain1[1]})]}),a.jsxs("linearGradient",{id:`mountainGrad2-${j}`,x1:"0",x2:"0",y1:"0",y2:"1",children:[a.jsx("stop",{offset:"0%",stopColor:M.mountain2[0]}),a.jsx("stop",{offset:"100%",stopColor:M.mountain2[1]})]}),a.jsxs("linearGradient",{id:`groundGrad-${j}`,x1:"0",x2:"0",y1:"0",y2:"1",children:[a.jsx("stop",{offset:"0%",stopColor:M.ground[0]}),a.jsx("stop",{offset:"100%",stopColor:M.ground[1]})]}),a.jsxs("linearGradient",{id:`groundLayer2-${j}`,x1:"0",x2:"0",y1:"0",y2:"1",children:[a.jsx("stop",{offset:"0%",stopColor:M.ground[0],stopOpacity:"0.6"}),a.jsx("stop",{offset:"100%",stopColor:M.ground[1],stopOpacity:"0.9"})]}),a.jsxs("radialGradient",{id:`sunGlow-${j}`,children:[a.jsx("stop",{offset:"0%",stopColor:"#fff176",stopOpacity:"0.8"}),a.jsx("stop",{offset:"50%",stopColor:"#ffcc02",stopOpacity:"0.3"}),a.jsx("stop",{offset:"100%",stopColor:"transparent",stopOpacity:"0"})]}),a.jsxs("radialGradient",{id:`goldGlow-${j}`,children:[a.jsx("stop",{offset:"0%",stopColor:"#ffd700",stopOpacity:"0.6"}),a.jsx("stop",{offset:"100%",stopColor:"#ffd700",stopOpacity:"0"})]})]}),a.jsxs("g",{id:"sky",children:[a.jsx("g",{style:{opacity:N.starOpacity,transition:"opacity 3s ease-in-out"},children:[...Array(15)].map((S,Q)=>a.jsx("circle",{cx:Math.random()*200,cy:Math.random()*60,r:Math.random()*.6+.2,fill:"#fff",className:"star-twinkle",style:{animationDelay:`${Q*.2}s`}},`s${Q}`))}),N.sunY<130&&a.jsxs("g",{transform:`translate(${N.sunX}, ${N.sunY})`,style:{transition:"transform 1s ease-out, opacity 2s ease-in-out",opacity:N.sunY<110?1:.5},children:[a.jsx("circle",{r:"18",fill:`url(#sunGlow-${j})`,opacity:"0.4",className:"shimmer-effect"}),a.jsx("circle",{r:"12",fill:`url(#sunGlow-${j})`,opacity:"0.6"}),a.jsx("circle",{r:"5",fill:"#fdd835"}),a.jsx("circle",{r:"4",fill:"#ffeb3b"}),a.jsx("circle",{r:"2",cx:"-1",cy:"-1",fill:"#fff9c4",opacity:"0.6"})]}),N.moonY<130&&a.jsxs("g",{transform:`translate(${N.moonX}, ${N.moonY})`,style:{transition:"transform 1s ease-out, opacity 2s ease-in-out",opacity:N.moonY<110?1:.5},children:[a.jsx("circle",{r:"8",fill:"#f5f5f5",opacity:"0.15",className:"shimmer-effect"}),a.jsx("circle",{r:"4",fill:"#f5f5f5"}),a.jsx("circle",{r:"4",fill:"#e0e0e0",cx:"0.5",cy:"0"}),a.jsx("circle",{r:"4",fill:"#1a1a1a",fillOpacity:"0.25",cx:"1.5",cy:"-1"}),a.jsx("circle",{r:"0.5",cx:"-1",cy:"0.5",fill:"#bdbdbd",opacity:"0.5"}),a.jsx("circle",{r:"0.3",cx:"0.5",cy:"-1",fill:"#bdbdbd",opacity:"0.4"})]})]}),a.jsxs("g",{id:"background",children:[a.jsxs("g",{filter:`url(#atmosphericHaze-${j})`,children:[a.jsx("path",{d:"M0,70 L30,40 L60,55 L100,30 L140,50 L180,35 L200,55 L200,150 L0,150 Z",fill:`url(#mountainGrad1-${j})`,opacity:"0.7"}),a.jsx("g",{opacity:"0.5",children:[25,55,95,135,175].map((S,Q)=>a.jsx("g",{transform:`translate(${S}, ${45+Math.sin(Q*2)*10})`,children:a.jsx("path",{d:"M0,0 L-2,6 L2,6 Z",fill:M.treeLeaf&&!Array.isArray(M.treeLeaf)?M.treeLeaf:"#4a6b5c",opacity:"0.6"})},`mt1-${Q}`))})]}),a.jsx("path",{d:"M-10,80 L40,60 L80,75 L120,55 L160,70 L200,60 L220,75 L220,150 L-10,150 Z",fill:`url(#mountainGrad2-${j})`,opacity:"0.9"}),a.jsxs("g",{opacity:"0.7",children:[[15,50,85,115,155,185].map((S,Q)=>a.jsxs("g",{transform:`translate(${S}, ${65+Math.sin(Q*1.5)*8})`,children:[a.jsx("path",{d:"M0,0 L-3,8 L3,8 Z",fill:M.treeLeaf&&!Array.isArray(M.treeLeaf)?M.treeLeaf:"#5d7f72"}),a.jsx("rect",{x:"-0.5",y:"8",width:"1",height:"2",fill:"#5d4037"})]},`mt2-${Q}`)),u>=1&&a.jsxs(a.Fragment,{children:[a.jsxs("g",{transform:"translate(70, 72)",children:[a.jsx("rect",{x:"-3",y:"-4",width:"6",height:"4",fill:R.color,opacity:"0.8"}),a.jsx("path",{d:"M-4,-4 L0,-7 L4,-4 Z",fill:R.roof||"#5d4037",opacity:"0.8"})]}),a.jsxs("g",{transform:"translate(140, 68)",children:[a.jsx("rect",{x:"-2",y:"-3",width:"4",height:"3",fill:R.color,opacity:"0.7"}),a.jsx("path",{d:"M-3,-3 L0,-5 L3,-3 Z",fill:R.roof||"#5d4037",opacity:"0.7"})]})]})]})]}),a.jsxs("g",{id:"ground-layers",children:[a.jsx("path",{d:"M-10,82 Q50,80 100,83 Q150,80 210,82 L210,90 L-10,90 Z",fill:`url(#groundLayer2-${j})`,opacity:"0.5"}),a.jsx("path",{d:"M-10,85 Q100,83 210,85 L210,150 L-10,150 Z",fill:`url(#groundGrad-${j})`,style:{transition:"fill 2s ease-in-out"}}),a.jsx("path",{d:"M-10,130 Q100,125 210,130 L210,150 L-10,150 Z",fill:"rgba(0,0,0,0.15)"})]}),r>5&&a.jsxs("g",{id:"roads",children:[a.jsx("path",{d:`M-10,${95+(u<3?2:0)} Q60,${92+(u<3?3:0)} 100,${94+(u<3?2:0)} Q150,${91+(u<3?3:0)} 210,${93+(u<3?2:0)}`,stroke:u>=6?"#4a4a4a":u>=3?"#8b7355":"#a0896c",strokeWidth:u>=4?"4":"3",fill:"none",opacity:"0.7",strokeLinecap:"round"}),u>=4&&a.jsx("path",{d:"M-10,93 Q60,90 100,92 Q150,89 210,91",stroke:"rgba(255,255,255,0.15)",strokeWidth:"1",fill:"none"}),r>20&&a.jsxs(a.Fragment,{children:[a.jsx("path",{d:"M30,94 Q35,100 40,110",stroke:u>=6?"#555":"#9a8a72",strokeWidth:"2",fill:"none",opacity:"0.5"}),a.jsx("path",{d:"M120,92 Q125,98 135,108",stroke:u>=6?"#555":"#9a8a72",strokeWidth:"2",fill:"none",opacity:"0.5"})]}),u>=2&&u<6&&a.jsx("g",{opacity:"0.3",children:[20,45,70,95,120,145,170].map((S,Q)=>a.jsx("line",{x1:S,y1:"92",x2:S,y2:"96",stroke:"#5d4037",strokeWidth:"0.5"},Q))})]}),a.jsxs("g",{id:"foreground-decorations",children:[u>=1&&a.jsxs("g",{opacity:"0.6",children:[a.jsx("line",{x1:"5",y1:"105",x2:"45",y2:"103",stroke:"#6d4c41",strokeWidth:"1"}),[8,18,28,38].map((S,Q)=>a.jsx("line",{x1:S,y1:"100",x2:S,y2:"105",stroke:"#5d4037",strokeWidth:"1.5"},Q))]}),a.jsxs("g",{opacity:"0.7",children:[a.jsx("ellipse",{cx:"15",cy:"125",rx:"4",ry:"2",fill:"#78909c"}),a.jsx("ellipse",{cx:"180",cy:"118",rx:"3",ry:"1.5",fill:"#90a4ae"}),a.jsx("ellipse",{cx:"60",cy:"135",rx:"5",ry:"2",fill:"#607d8b"})]}),a.jsx("g",{children:[25,75,130,175].map((S,Q)=>a.jsxs("g",{transform:`translate(${S}, ${115+Q%2*8})`,children:[a.jsx("ellipse",{cx:"0",cy:"0",rx:"5",ry:"2.5",fill:M.bush,opacity:"0.8"}),M.flower&&a.jsxs(a.Fragment,{children:[a.jsx("circle",{cx:"-2",cy:"-1",r:"0.8",fill:M.flower}),a.jsx("circle",{cx:"1",cy:"-0.5",r:"0.6",fill:M.flower}),a.jsx("circle",{cx:"2.5",cy:"-1",r:"0.7",fill:M.flower})]})]},`fg-bush-${Q}`))}),a.jsx("g",{opacity:"0.6",children:[10,40,90,150,190].map((S,Q)=>a.jsx("g",{transform:`translate(${S}, ${130+Q%3*5})`,className:"grass-sway",children:a.jsx("path",{d:"M0,0 Q-2,-6 0,-8 M1,0 Q0,-5 2,-7 M-1,0 Q-3,-4 -1,-6",stroke:M.grass,strokeWidth:"0.8",fill:"none"})},`fg-grass-${Q}`))}),u>=2&&a.jsxs("g",{transform:"translate(100, 115)",opacity:"0.8",children:[a.jsx("ellipse",{cx:"0",cy:"0",rx:"5",ry:"2",fill:"#607d8b"}),a.jsx("ellipse",{cx:"0",cy:"-1",rx:"4",ry:"1.5",fill:"#4fc3f7",opacity:"0.6"}),a.jsx("rect",{x:"-5",y:"-3",width:"1",height:"3",fill:"#5d4037"}),a.jsx("rect",{x:"4",y:"-3",width:"1",height:"3",fill:"#5d4037"})]})]}),a.jsxs("g",{id:"era-landmark",filter:`url(#dropShadow-${j})`,children:[R.landmark==="cave"&&a.jsxs("g",{transform:"translate(170, 78)",children:[a.jsx("ellipse",{cx:"0",cy:"0",rx:"12",ry:"8",fill:"#5d4037"}),a.jsx("ellipse",{cx:"0",cy:"2",rx:"6",ry:"4",fill:"#1a1a1a"}),a.jsx("path",{d:"M-5,-3 L-3,-8 L3,-6 L5,-3",stroke:"#8d6e63",strokeWidth:"0.5",fill:"none"})]}),R.landmark==="obelisk"&&a.jsxs("g",{transform:"translate(175, 70)",children:[a.jsx("path",{d:"M-2,15 L-3,0 L0,-8 L3,0 L2,15 Z",fill:"#cd853f"}),a.jsx("path",{d:"M-2,15 L-3,0 L0,-8 L0,15 Z",fill:"#deb887"}),a.jsx("rect",{x:"-4",y:"15",width:"8",height:"2",fill:"#8b7355"})]}),R.landmark==="temple"&&a.jsxs("g",{transform:"translate(170, 68)",children:[a.jsx("rect",{x:"-15",y:"12",width:"30",height:"3",fill:"#f5f5dc"}),a.jsx("rect",{x:"-12",y:"0",width:"24",height:"12",fill:"#fffaf0"}),a.jsx("path",{d:"M-14,-2 L0,-10 L14,-2 Z",fill:"#cd853f"}),[-8,-3,3,8].map((S,Q)=>a.jsx("rect",{x:S,y:"2",width:"2",height:"10",fill:"#deb887"},Q))]}),R.landmark==="tower"&&a.jsxs("g",{transform:"translate(175, 55)",children:[a.jsx("rect",{x:"-6",y:"0",width:"12",height:"30",fill:"#696969"}),a.jsx("rect",{x:"-8",y:"-4",width:"16",height:"5",fill:"#808080"}),a.jsx("path",{d:"M-8,-4 L0,-12 L8,-4 Z",fill:"#2f4f4f"}),a.jsx("rect",{x:"-2",y:"20",width:"4",height:"10",fill:"#3e2723"}),[-4,4].map((S,Q)=>a.jsx("rect",{x:S,y:"5",width:"2",height:"3",fill:"#87ceeb",opacity:"0.8"},Q))]}),R.landmark==="lighthouse"&&a.jsxs("g",{transform:"translate(180, 60)",children:[a.jsx("path",{d:"M-4,30 L-6,0 L6,0 L4,30 Z",fill:"#f5f5f5"}),a.jsx("ellipse",{cx:"0",cy:"-2",rx:"8",ry:"3",fill:"#dcdcdc"}),a.jsx("circle",{cx:"0",cy:"-5",r:"3",fill:"#ffeb3b",className:"shimmer-effect"}),a.jsx("rect",{x:"-5",y:"10",width:"10",height:"2",fill:"#b22222"}),a.jsx("rect",{x:"-5",y:"20",width:"10",height:"2",fill:"#b22222"})]}),R.landmark==="dome"&&a.jsxs("g",{transform:"translate(170, 65)",children:[a.jsx("rect",{x:"-12",y:"5",width:"24",height:"15",fill:"#f4a460"}),a.jsx("ellipse",{cx:"0",cy:"5",rx:"12",ry:"8",fill:"#daa520"}),a.jsx("ellipse",{cx:"0",cy:"5",rx:"10",ry:"6",fill:"#ffd700",opacity:"0.3"}),a.jsx("rect",{x:"-4",y:"12",width:"8",height:"8",fill:"#8b4513"})]}),R.landmark==="factory"&&a.jsxs("g",{transform:"translate(165, 55)",children:[a.jsx("rect",{x:"-15",y:"10",width:"30",height:"25",fill:"#8b0000"}),a.jsx("rect",{x:"-12",y:"0",width:"6",height:"35",fill:"#4a4a4a"}),a.jsx("rect",{x:"6",y:"5",width:"5",height:"30",fill:"#4a4a4a"}),a.jsx("circle",{cx:"-9",cy:"-5",r:"3",fill:"#888",opacity:"0.6",className:"smoke-particle"}),a.jsx("circle",{cx:"8",cy:"-3",r:"2",fill:"#999",opacity:"0.5",className:"smoke-particle",style:{animationDelay:"0.5s"}}),[-8,-2,4,10].map((S,Q)=>a.jsx("rect",{x:S,y:"18",width:"4",height:"6",fill:"#87ceeb",opacity:"0.7"},Q))]}),R.landmark==="antenna"&&a.jsxs("g",{transform:"translate(175, 40)",children:[a.jsx("rect",{x:"-1",y:"0",width:"2",height:"45",fill:"#c0c0c0"}),a.jsx("rect",{x:"-8",y:"5",width:"16",height:"2",fill:"#a0a0a0"}),a.jsx("rect",{x:"-5",y:"15",width:"10",height:"1",fill:"#a0a0a0"}),a.jsx("circle",{cx:"0",cy:"-2",r:"2",fill:"#ff4444",className:"shimmer-effect"}),a.jsx("rect",{x:"-12",y:"35",width:"24",height:"10",fill:"#4169e1"}),a.jsx("rect",{x:"-10",y:"37",width:"8",height:"6",fill:"#00ffff",opacity:"0.5"})]})]}),a.jsx("rect",{x:"0",y:"0",width:"200",height:"150",fill:R.atmosphere,style:{transition:"fill 3s ease-in-out",pointerEvents:"none"}}),U&&a.jsx("g",{opacity:"0.4",children:a.jsx("circle",{cx:"100",cy:"90",r:"60",fill:`url(#goldGlow-${j})`,className:"shimmer-effect"})}),U&&a.jsx("g",{children:[...Array(Math.min(5,Math.floor(Y/20)))].map((S,Q)=>a.jsx("g",{style:{animation:`bird-fly ${8+Q*2}s linear infinite`,animationDelay:`${Q*3}s`},children:a.jsx("path",{d:`M0,${20+Q*8} l-2,-1 l2,1 l2,-1 l-2,1`,stroke:"#333",strokeWidth:"0.5",fill:"none"})},`bird-${Q}`))}),c>1e3&&a.jsx("g",{style:{animation:"caravan-move 30s linear infinite"},children:a.jsxs("g",{transform:"translate(0, 95)",children:[a.jsx("ellipse",{cx:"0",cy:"0",rx:"3",ry:"1.5",fill:"#8b7355"}),a.jsx("circle",{cx:"-2",cy:"-1",r:"1",fill:"#6b5344"}),a.jsx("line",{x1:"-2",y1:"1.5",x2:"-2",y2:"3",stroke:"#5d4037",strokeWidth:"0.5"}),a.jsx("line",{x1:"2",y1:"1.5",x2:"2",y2:"3",stroke:"#5d4037",strokeWidth:"0.5"}),a.jsx("rect",{x:"-1",y:"-3",width:"4",height:"2",fill:"#deb887"}),a.jsx("rect",{x:"0",y:"-4",width:"2",height:"1",fill:"#cd853f"})]})}),u>=3&&a.jsxs("g",{transform:"translate(30, 75)",children:[a.jsx("line",{x1:"0",y1:"0",x2:"0",y2:"15",stroke:"#5d4037",strokeWidth:"0.8"}),a.jsxs("g",{style:{animation:"flag-wave 2s ease-in-out infinite",transformOrigin:"0px 2.5px"},children:[a.jsx("path",{d:"M0,0 L8,2.5 L0,5 Z",fill:u>=6?"#b71c1c":"#1a237e"}),a.jsx("path",{d:"M0,0.5 L5,2 L0,2 Z",fill:"rgba(255,255,255,0.15)"})]})]}),D.map(S=>a.jsx("g",{transform:`translate(${S.x}, ${S.y})`,children:a.jsxs("g",{transform:`scale(${S.scale*S.flip}, ${S.scale})`,children:[S.type==="grass"&&a.jsx("g",{className:"grass-sway",style:{animationDuration:`${1.5+S.variant}s`},children:a.jsx("path",{d:"M0,0 Q-1,-4 0,-5 M2,0 Q1,-3 2,-4 M-2,0 Q-3,-3 -2,-4",stroke:M.grass,strokeWidth:"0.5",fill:"none",opacity:"0.8"})}),S.type==="bush"&&a.jsxs("g",{className:"tree-sway",style:{animationDuration:`${3+S.variant}s`},children:[a.jsx("ellipse",{cx:"0",cy:"0",rx:"4",ry:"1.5",fill:"#000",opacity:"0.2"}),a.jsx("circle",{cx:"-2",cy:"-2",r:"2.5",fill:M.bush}),a.jsx("circle",{cx:"2",cy:"-2",r:"2.5",fill:M.bush}),a.jsx("circle",{cx:"0",cy:"-3.5",r:"3",fill:M.bush}),a.jsx("circle",{cx:"-1",cy:"-3",r:"1",fill:"#fff",opacity:"0.1"})]}),S.type==="tree"&&a.jsxs("g",{className:"tree-sway",style:{animationDuration:`${4+S.variant}s`},children:[a.jsx("ellipse",{cx:"0",cy:"0.5",rx:"5",ry:"1.5",fill:"#000",opacity:"0.2"}),a.jsx("path",{d:"M-1,0 L-0.8,-8 L0.8,-8 L1,0 Z",fill:M.treeTrunk}),s===""?a.jsxs("g",{transform:"translate(0, -8)",stroke:M.treeTrunk,strokeWidth:"0.5",children:[a.jsx("line",{x1:"0",y1:"0",x2:"-3",y2:"-4"}),a.jsx("line",{x1:"0",y1:"0",x2:"3",y2:"-4"}),a.jsx("line",{x1:"0",y1:"-2",x2:"-2",y2:"-5"}),a.jsx("line",{x1:"0",y1:"-2",x2:"2",y2:"-5"}),a.jsx("path",{d:"M-3,-4 Q0,-5 3,-4",stroke:"#fff",strokeWidth:"0.8",opacity:"0.8",fill:"none"})]}):a.jsx("g",{transform:"translate(0, -9)",children:(()=>{const Q=Array.isArray(M.treeLeaf)?M.treeLeaf[S.colorIdx]:M.treeLeaf;return a.jsxs(a.Fragment,{children:[a.jsx("circle",{cx:"-2.5",cy:"1",r:"3.5",fill:Q}),a.jsx("circle",{cx:"2.5",cy:"1",r:"3.5",fill:Q}),a.jsx("circle",{cx:"0",cy:"-2",r:"4",fill:Q}),a.jsx("circle",{cx:"-1.5",cy:"-2.5",r:"1.5",fill:"#fff",opacity:"0.1"}),M.flower&&S.variant>.6&&a.jsxs("g",{fill:M.flower,children:[a.jsx("circle",{cx:"-2",cy:"-1",r:"0.8"}),a.jsx("circle",{cx:"2",cy:"0",r:"0.6"}),a.jsx("circle",{cx:"0",cy:"-3",r:"0.7"})]})]})})()})]})]})},`veg-${S.id}`)),E.map(S=>a.jsxs("g",{transform:`translate(${S.x}, ${S.y}) scale(${S.scale})`,children:[a.jsx("ellipse",{cx:"5",cy:"0.5",rx:"7",ry:"1.8",fill:"#000",opacity:"0.25"}),R.type==="tent"&&a.jsxs("g",{children:[a.jsx("path",{d:"M0,0 L5,-10 L10,0 Z",fill:R.color,stroke:"#8d6e63",strokeWidth:"0.3"}),a.jsx("line",{x1:"5",y1:"-10",x2:"5",y2:"0",stroke:"#6d4c41",strokeWidth:"0.4"}),a.jsx("path",{d:"M2,0 L5,-6 L8,0",fill:"none",stroke:"#6d4c41",strokeWidth:"0.3"})]}),(R.type==="clay"||R.type==="timber")&&a.jsxs("g",{children:[a.jsx("rect",{x:"1",y:"-7",width:"8",height:"7",fill:R.color}),a.jsx("rect",{x:"1",y:"-7",width:"1",height:"7",fill:"#000",opacity:"0.15"}),a.jsx("rect",{x:"8",y:"-7",width:"1",height:"7",fill:"#fff",opacity:"0.1"}),a.jsx("path",{d:"M0,-7 L5,-12 L10,-7 Z",fill:R.roof}),a.jsx("path",{d:"M0,-7 L5,-12 L5,-7 Z",fill:"#000",opacity:"0.2"}),a.jsx("rect",{x:"3.5",y:"-4",width:"3",height:"4",fill:"#3e2723",rx:"0.3"}),a.jsx("circle",{cx:"6",cy:"-2",r:"0.3",fill:"#ffd54f"}),a.jsx("rect",{x:"1.5",y:"-5.5",width:"1.5",height:"1.5",fill:p>.7||p<.2?"#ffb74d":"#90a4ae",opacity:"0.7"})]}),(R.type==="brick"||R.type==="modern")&&a.jsxs("g",{children:[a.jsx("rect",{x:"0",y:"-10",width:"10",height:"10",fill:R.color}),a.jsx("rect",{x:"0",y:"-10",width:"1.5",height:"10",fill:"#000",opacity:"0.15"}),a.jsx("rect",{x:"8.5",y:"-10",width:"1.5",height:"10",fill:"#fff",opacity:"0.1"}),a.jsx("path",{d:"M-1,-10 L5,-14 L11,-10 Z",fill:R.roof}),a.jsx("path",{d:"M-1,-10 L5,-14 L5,-10 Z",fill:"#000",opacity:"0.25"}),a.jsxs("g",{children:[a.jsx("rect",{x:"1.5",y:"-8.5",width:"2.5",height:"2.5",fill:p>.7||p<.2?"#ffeb3b":"#cfd8dc",opacity:p>.7||p<.2?.9:.6,rx:"0.2"}),a.jsx("line",{x1:"2.75",y1:"-8.5",x2:"2.75",y2:"-6",stroke:"#37474f",strokeWidth:"0.2"}),a.jsx("line",{x1:"1.5",y1:"-7.25",x2:"4",y2:"-7.25",stroke:"#37474f",strokeWidth:"0.2"}),a.jsx("rect",{x:"6",y:"-8.5",width:"2.5",height:"2.5",fill:p>.7||p<.2?"#ffeb3b":"#cfd8dc",opacity:p>.7||p<.2?.9:.6,rx:"0.2"}),a.jsx("line",{x1:"7.25",y1:"-8.5",x2:"7.25",y2:"-6",stroke:"#37474f",strokeWidth:"0.2"}),a.jsx("line",{x1:"6",y1:"-7.25",x2:"8.5",y2:"-7.25",stroke:"#37474f",strokeWidth:"0.2"})]}),a.jsx("rect",{x:"3.5",y:"-4.5",width:"3",height:"4.5",fill:"#4e342e",rx:"0.3"}),a.jsx("circle",{cx:"6",cy:"-2.5",r:"0.3",fill:"#ffd54f"}),R.detail==="chimney"&&a.jsxs("g",{transform:"translate(7.5, -14)",children:[a.jsx("rect",{x:"-0.5",y:"0",width:"1.5",height:"4",fill:"#3e2723"}),a.jsx("rect",{x:"-0.5",y:"0",width:"0.3",height:"4",fill:"#000",opacity:"0.2"}),a.jsx("circle",{cy:"-1",r:"1.2",fill:"#e0e0e0",opacity:"0.7",className:"smoke-particle",style:{animationDelay:`${S.id*.5}s`}}),a.jsx("circle",{cy:"-1",r:"0.8",fill:"#f5f5f5",opacity:"0.5",className:"smoke-particle",style:{animationDelay:`${S.id*.5+.3}s`}})]}),R.detail==="glass"&&c>1e3&&a.jsx("rect",{x:"1",y:"-9",width:"8",height:"1",fill:"#4fc3f7",opacity:"0.3"})]})]},`h-${S.id}`)),T.map(S=>a.jsx("g",{transform:`translate(${S.startX}, ${S.y}) scale(${S.scale})`,children:a.jsx("g",{style:{animation:`walk ${S.duration}s linear infinite`,animationDelay:`${S.delay}s`},children:a.jsxs("g",{className:"pedestrian-bob",children:[a.jsx("circle",{cx:"0",cy:"-5.5",r:"1.2",fill:S.color}),a.jsx("ellipse",{cx:"0",cy:"-3",rx:"1.2",ry:"2",fill:S.color}),a.jsx("line",{x1:"-1.2",y1:"-3.5",x2:"-2",y2:"-1.5",stroke:S.color,strokeWidth:"0.6",strokeLinecap:"round"}),a.jsx("line",{x1:"1.2",y1:"-3.5",x2:"2",y2:"-1.5",stroke:S.color,strokeWidth:"0.6",strokeLinecap:"round"}),a.jsx("line",{x1:"-0.5",y1:"-1",x2:"-1",y2:"1",stroke:S.color,strokeWidth:"0.8",strokeLinecap:"round"}),a.jsx("line",{x1:"0.5",y1:"-1",x2:"1",y2:"1",stroke:S.color,strokeWidth:"0.8",strokeLinecap:"round"}),a.jsx("ellipse",{cx:"0",cy:"1.2",rx:"1.5",ry:"0.5",fill:"#000",opacity:"0.2"})]})})},`ped-${S.id}`)),a.jsxs("g",{id:"weather",children:[I&&a.jsxs("g",{opacity:"0.8",style:{transition:"opacity 2s ease-in-out"},children:[a.jsxs("g",{className:"cloud-anim",style:{animationDuration:`${60/g}s`},children:[a.jsx("ellipse",{cx:"20",cy:"25",rx:"12",ry:"6",fill:N.cloudColor,opacity:"0.7"}),a.jsx("ellipse",{cx:"30",cy:"23",rx:"15",ry:"7",fill:N.cloudColor,opacity:"0.8"}),a.jsx("ellipse",{cx:"42",cy:"25",rx:"13",ry:"6",fill:N.cloudColor,opacity:"0.7"}),a.jsx("ellipse",{cx:"30",cy:"28",rx:"18",ry:"5",fill:N.cloudColor,opacity:"0.6"})]}),a.jsxs("g",{className:"cloud-anim",style:{animationDuration:`${45/g}s`,animationDelay:"-10s"},children:[a.jsx("ellipse",{cx:"100",cy:"18",rx:"14",ry:"7",fill:N.cloudColor,opacity:"0.75"}),a.jsx("ellipse",{cx:"112",cy:"16",rx:"16",ry:"8",fill:N.cloudColor,opacity:"0.85"}),a.jsx("ellipse",{cx:"125",cy:"18",rx:"14",ry:"7",fill:N.cloudColor,opacity:"0.75"}),a.jsx("ellipse",{cx:"112",cy:"22",rx:"20",ry:"6",fill:N.cloudColor,opacity:"0.65"})]})]}),q&&s!==""&&[...Array(50)].map((S,Q)=>{const ne=Math.random()*240-20,Ne=g*3;return a.jsx("line",{x1:ne,y1:0,x2:ne+Ne,y2:20,stroke:"#4fc3f7",strokeWidth:"0.4",strokeOpacity:"0.6",className:"rain-drop",style:{animationDuration:`${.4+Math.random()*.3}s`,animationDelay:`${Math.random()}s`}},`rain-${Q}`)}),s===""&&h<.6&&[...Array(30)].map((S,Q)=>a.jsx("circle",{cx:Math.random()*240-20,cy:Math.random()*120,r:Math.random()*1.2+.5,fill:"#ffffff",opacity:"0.8",className:"rain-drop",style:{animationDuration:`${1+Math.random()}s`,animationDelay:`${Math.random()}s`}},`snow-${Q}`)),c>800&&!Z&&[...Array(8)].map((S,Q)=>a.jsxs("g",{children:[a.jsx("circle",{cx:40+Math.random()*120,cy:95,r:"1",fill:"#ffd700",className:"smoke-particle",style:{animationDelay:`${Q*.3}s`}}),a.jsx("circle",{cx:40+Math.random()*120,cy:95,r:"0.5",fill:"#ffeb3b",className:"smoke-particle",style:{animationDelay:`${Q*.3+.15}s`}})]},`wealth-${Q}`)),U&&p>.2&&p<.8&&a.jsx("g",{opacity:"0.4",children:[...Array(3)].map((S,Q)=>a.jsx("line",{x1:N.sunX,y1:N.sunY,x2:30+Q*70,y2:100,stroke:"#fff176",strokeWidth:"0.5",opacity:"0.3",className:"shimmer-effect",style:{animationDelay:`${Q*.5}s`}},`ray-${Q}`))}),o<70&&a.jsx("rect",{x:"0",y:"0",width:"200",height:"150",fill:"#000",opacity:Math.max(0,(70-o)/200),style:{transition:"opacity 3s ease-in-out"}})]})]}),a.jsxs("div",{className:"absolute top-0 left-0 right-0 px-4 py-2 flex items-center justify-between pointer-events-none z-10",style:{background:"linear-gradient(to bottom, rgba(26,20,16,0.9) 0%, rgba(26,20,16,0.6) 70%, transparent 100%)"},children:[a.jsxs("div",{className:"flex items-baseline gap-1",children:[a.jsx("span",{style:{fontFamily:'Georgia, "Times New Roman", serif',fontSize:"18px",fontWeight:"600",color:"#d4af37",textShadow:"0 1px 2px rgba(0,0,0,0.8), 0 0 10px rgba(212,175,55,0.3)"},children:Math.floor(t/360)+1}),a.jsx("span",{style:{fontFamily:"Georgia, serif",fontSize:"10px",color:"#a89070",letterSpacing:"0.05em"},children:""})]}),a.jsx("div",{className:"text-center",children:a.jsx("span",{style:{fontFamily:'Georgia, "Times New Roman", serif',fontSize:"13px",fontWeight:"500",color:"#f4e8d0",letterSpacing:"0.15em",textShadow:"0 1px 3px rgba(0,0,0,0.9)"},children:["","","","","","","",""][u]||""})}),a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsx("span",{style:{width:"6px",height:"6px",borderRadius:"50%",backgroundColor:M.treeLeaf&&!Array.isArray(M.treeLeaf)?M.treeLeaf:M.grass,boxShadow:"0 0 4px currentColor"}}),a.jsx("span",{style:{fontFamily:"Georgia, serif",fontSize:"11px",color:"#c9b896",letterSpacing:"0.1em"},children:s})]})]})]})]})}const QT=({building:t,count:s,epoch:r,techsUnlocked:o,jobFill:c,anchorElement:u,cost:p,resources:m})=>{if(!t||!u)return null;const[h,x]=$.useState({top:0,left:0}),g=$.useRef(null);return $.useEffect(()=>{if(u&&g.current){const b=u.getBoundingClientRect(),j=g.current.getBoundingClientRect();let _=b.top,N=b.right+8;N+j.width>window.innerWidth&&(N=b.left-j.width-8),_<0&&(_=0),_+j.height>window.innerHeight&&(_=window.innerHeight-j.height),x({top:_,left:N})}},[u,t,s]),Ps.createPortal(a.jsxs("div",{ref:g,className:"fixed w-72 bg-gray-800 border border-gray-600 rounded-lg shadow-2xl p-3 z-[9999] pointer-events-none animate-fade-in-fast",style:{top:`${h.top}px`,left:`${h.left}px`},children:[a.jsx("h4",{className:"text-sm font-bold text-white mb-1 font-decorative",children:t.name}),a.jsx("p",{className:"text-xs text-gray-300 mb-2",children:t.desc}),t.owner&&a.jsxs("div",{className:"text-[10px] text-yellow-200 bg-yellow-900/40 border border-yellow-600/40 rounded px-2 py-1 mb-2 inline-flex items-center gap-1",children:[a.jsx(k,{name:"User",size:10,className:"text-yellow-300"}),": ",Ke[t.owner]?.name||t.owner]}),p&&Object.keys(p).length>0&&a.jsxs("div",{className:"glass-ancient rounded px-2 py-1.5 mb-2 text-xs border border-ancient-gold/20",children:[a.jsx("div",{className:"text-[10px] text-gray-300 mb-1",children:""}),Object.entries(p).map(([b,j])=>{const _=(m[b]||0)>=j;return a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-gray-200",children:Re[b]?.name||b}),a.jsx("span",{className:`font-mono ${_?"text-green-400":"text-red-400"}`,children:j})]},`cost-${b}`)})]}),(()=>{const b=vl(t.output,r,o),j=vl(t.input,r,o);return Object.keys(b).length===0&&Object.keys(j).length===0?null:a.jsxs("div",{className:"glass-ancient rounded px-2 py-1.5 mb-2 text-xs border border-ancient-gold/20",children:[a.jsx("div",{className:"text-[10px] text-gray-300 mb-1",children:"/"}),Object.entries(b).map(([_,N])=>a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-gray-200",children:Re[_]?.name||_}),a.jsxs("span",{className:"text-green-400 font-mono",children:["+",N]})]},`out-${_}`)),Object.entries(j).map(([_,N])=>a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-gray-200",children:Re[_]?.name||_}),a.jsxs("span",{className:"text-red-400 font-mono",children:["-",N]})]},`in-${_}`))]})})(),t.jobs&&a.jsxs("div",{className:"glass-ancient rounded px-2 py-1.5 mb-2 text-xs border border-ancient-gold/20",children:[a.jsx("div",{className:"text-[10px] text-gray-300 mb-1",children:""}),Object.entries(t.jobs).map(([b,j])=>{const _=j*s,N=c?.[t.id]?.[b]??0,M=_>0?Math.min(1,N/_)*100:0;return a.jsxs("div",{className:"mb-1.5",children:[a.jsxs("div",{className:"flex justify-between text-[11px] text-gray-300",children:[a.jsx("span",{className:"text-gray-200 font-semibold",children:Ke[b]?.name||b}),a.jsxs("span",{className:"font-mono text-gray-200",children:[Math.round(N),"/",Math.round(_)]})]}),a.jsxs("div",{className:"flex justify-between text-[10px] text-gray-500 mb-0.5",children:[a.jsxs("span",{children:[" ",j]}),a.jsxs("span",{children:[" ",Math.round(_)]})]}),a.jsx("div",{className:"w-full bg-gray-700 rounded-full h-1",children:a.jsx("div",{className:"h-1 rounded-full bg-blue-500",style:{width:`${M}%`}})})]},b)})]}),a.jsx("div",{className:"text-[10px] text-center text-gray-400 pt-1 border-t border-gray-700",children:""})]}),document.body)},JT=t=>t>=1e6?(t/1e6).toFixed(1)+"M":t>=1e4?(t/1e3).toFixed(0)+"k":t>=1e3?(t/1e3).toFixed(1)+"k":Math.floor(t).toString(),KT=({building:t,count:s,affordable:r,silverCost:o,ownerIncome:c,onBuy:u,onSell:p,onShowDetails:m,cost:h,onMouseEnter:x,onMouseLeave:g,epoch:b,techsUnlocked:j,jobFill:_,resources:N})=>{const M=k;return a.jsxs("div",{className:"group relative flex flex-col h-full glass-ancient border border-ancient-gold/20 rounded-lg p-1.5 text-center transition-all hover:border-ancient-gold/40 hover:shadow-glow-gold",onMouseEnter:x,onMouseLeave:g,children:[a.jsxs("div",{className:"flex-grow flex flex-col items-center cursor-pointer",onClick:()=>m(t.id),children:[a.jsx("div",{className:"w-7 h-7 sm:w-8 sm:h-8 rounded-lg flex items-center justify-center mb-0.5 icon-metal-container",children:a.jsx(M,{name:t.visual.icon,size:14,className:`${t.visual.text} icon-metal`})}),a.jsxs("div",{className:"flex items-baseline gap-0.5",children:[a.jsx("h4",{className:"text-[12px] font-bold text-ancient-parchment leading-tight truncate max-w-[60px]",children:t.name}),s>0&&a.jsxs("p",{className:"text-[8px] font-bold text-ancient-gold",children:["",s]})]})]}),s>0&&a.jsxs("div",{className:"space-y-0.5 text-[9px] my-1",children:[t.jobs&&Object.keys(t.jobs).length>0&&a.jsx("div",{className:"bg-gray-900/40 rounded px-1 py-0.5",children:Object.entries(t.jobs).map(([R,E])=>{const T=E*s,D=_?.[t.id]?.[R]??0,O=T>0?Math.min(1,D/T)*100:0;return a.jsxs("div",{className:"flex items-center gap-0.5",title:`${Ke[R]?.name}: ${Math.round(D)}/${Math.round(T)}`,children:[a.jsx(k,{name:Ke[R]?.icon||"User",size:8,className:"text-gray-400 flex-shrink-0"}),a.jsx("div",{className:"flex-1 bg-gray-700 rounded-full h-1",children:a.jsx("div",{className:"h-1 rounded-full bg-green-500",style:{width:`${O}%`}})}),a.jsxs("span",{className:"font-mono text-[8px] text-gray-300 whitespace-nowrap",children:[Math.round(D),"/",Math.round(T)]})]},R)})}),(()=>{const R=vl(t.output,b,j);return Object.keys(R).length===0?null:a.jsx("div",{className:"bg-gray-900/40 rounded px-1 py-0.5",children:a.jsx("div",{className:"flex flex-wrap gap-0.5 justify-center",children:Object.entries(R).map(([E,T])=>{const D=Object.values(t.jobs||{}).reduce((Z,Y)=>Z+Y*s,0),O=Object.values(_?.[t.id]||{}).reduce((Z,Y)=>Z+Y,0),q=D>0?Math.min(1,O/D):1,I=T*s*q;return a.jsxs("div",{className:"flex items-center gap-0.5 text-green-300",title:`${Re[E]?.name} - : ${T} / : ${I.toFixed(1)}`,children:[a.jsx(k,{name:Re[E]?.icon||"Box",size:8}),a.jsxs("span",{className:"font-mono text-[9px]",children:["+",I.toFixed(0)]})]},E)})})})})()]}),a.jsxs("div",{className:"mt-auto pt-0.5 flex flex-col gap-0.5",children:[a.jsxs("button",{onClick:R=>{R.stopPropagation(),u(t.id)},disabled:!r,className:`w-full px-1 py-0.5 rounded text-[10px] font-semibold transition-all ${r?"bg-green-600/80 hover:bg-green-500 text-white":"bg-gray-700/60 text-gray-400 cursor-not-allowed"} flex items-center justify-center gap-0.5`,title:`: ${o.toFixed(0)} `,children:[a.jsx(k,{name:"Plus",size:8,className:"flex-shrink-0"}),a.jsx(k,{name:"Coins",size:8,className:"text-yellow-300 opacity-80 flex-shrink-0"}),a.jsx("span",{className:`truncate ${r?"":"text-red-300"}`,children:JT(o)})]}),s>0&&a.jsxs("button",{onClick:R=>{R.stopPropagation(),p(t.id)},className:"w-full px-1 py-0.5 bg-red-600/80 hover:bg-red-500 text-white rounded text-[10px] font-semibold transition-all flex items-center justify-center gap-0.5",title:"",children:[a.jsx(k,{name:"Minus",size:8}),a.jsx("span",{children:""})]})]})]})},eS=({buildings:t,resources:s,epoch:r,techsUnlocked:o,popStructure:c={},jobFill:u={},onBuy:p,onSell:m,onShowDetails:h,market:x})=>{const[g,b]=$.useState({building:null,element:null}),j=window.matchMedia("(hover: hover)").matches,_=(Y,U,S,Q)=>{j&&b({building:U,element:Y.currentTarget,cost:S,resources:Q})},N=new Set(["maxPop"]),M=Y=>{if(!Y||Y==="silver")return 1;const U=Re[Y];return!U||N.has(Y)?0:x?.prices?.[Y]??U.basePrice??0},R=(Y,U)=>{if(U===0)return 0;const S=Object.values(Y.jobs||{}).reduce((F,re)=>F+re*U,0),Q=Object.values(u?.[Y.id]||{}).reduce((F,re)=>F+re,0),ne=S>0?Math.min(1,Q/S):1,Ne=Object.entries(Y.output||{}).reduce((F,[re,C])=>F+M(re)*C*ne,0),$e=Object.entries(Y.input||{}).reduce((F,[re,C])=>F+M(re)*C*ne,0),de=Object.entries(u?.[Y.id]||{}).reduce((F,[re,C])=>{const L=x?.wages?.[re]??0;return F+L*(C/U)},0),P=Ne-$e-de,z=Y.owner&&x?.wages?.[Y.owner]?x.wages[Y.owner]*(Y.jobs[Y.owner]||0):0,V=Y.jobs?.[Y.owner]||1;return(P+z)/V},E=Y=>!(Y.epoch>r||Y.requiresTech&&!o.includes(Y.requiresTech)),T=Y=>{const U=t[Y.id]||0,S={};for(let Q in Y.baseCost)S[Q]=Math.ceil(Y.baseCost[Q]*Math.pow(1.15,U));return S},D={gather:{name:"",icon:"Wheat",color:"text-yellow-400"},industry:{name:"",icon:"Factory",color:"text-blue-400"},civic:{name:"",icon:"Home",color:"text-green-400"},military:{name:"",icon:"Swords",color:"text-red-400"}},O=[{key:"all",label:""},{key:"gather",label:""},{key:"industry",label:""},{key:"civic",label:""},{key:"military",label:""}],[q,I]=$.useState("all"),Z=q==="all"?Object.entries(D):Object.entries(D).filter(([Y])=>Y===q);return a.jsxs("div",{className:"space-y-4 build-tab",children:[a.jsx("div",{className:"flex flex-wrap gap-2 pb-1 border-b border-gray-700/60 mb-3",children:O.map(Y=>{const U=Y.key===q;return a.jsx("button",{onClick:()=>I(Y.key),className:`px-3 py-1.5 rounded-full text-xs font-semibold transition-colors ${U?"bg-blue-600 text-white shadow-inner":"bg-gray-700/70 text-gray-300 hover:bg-gray-600/60"}`,"aria-pressed":U,children:Y.label},Y.key)})}),Z.map(([Y,U])=>{const S=Ln.filter(Q=>Q.cat===Y);return a.jsxs("div",{className:"glass-ancient p-4 rounded-xl border border-ancient-gold/30",children:[a.jsxs("h3",{className:"text-sm font-bold mb-3 flex items-center gap-2 text-gray-300 font-decorative",children:[a.jsx(k,{name:U.icon,size:16,className:U.color}),U.name]}),a.jsx("div",{className:"grid grid-cols-4 sm:grid-cols-5 md:grid-cols-6 lg:grid-cols-7 xl:grid-cols-9 2xl:grid-cols-11 gap-1",children:S.filter(Q=>E(Q)).map(Q=>{const ne=T(Q),Ne=Ci(ne,x),$e=Object.entries(ne).every(([F,re])=>(s[F]||0)>=re),de=(s.silver||0)>=Ne,P=$e&&de,z=t[Q.id]||0,V=R(Q,z);return a.jsx(KT,{building:Q,count:z,affordable:P,silverCost:Ne,ownerIncome:V,cost:ne,onBuy:p,onSell:m,onMouseEnter:F=>_(F,Q,ne,s),onMouseLeave:()=>j&&b({building:null,element:null}),epoch:r,techsUnlocked:o,jobFill:u,resources:s,onShowDetails:h},Q.id)})})]},Y)}),a.jsx(QT,{building:g.building,anchorElement:g.element,count:g.building&&t[g.building.id]||0,epoch:r,techsUnlocked:o,jobFill:u,cost:g.cost,resources:s})]})},tS=({unit:t,resources:s,market:r,militaryWageRatio:o,anchorElement:c})=>{const u=$.useRef(null),[p,m]=$.useState({width:288,height:400});$.useLayoutEffect(()=>{if(u.current){const g=u.current.getBoundingClientRect();g.width>0&&g.height>0&&m({width:g.width,height:g.height})}},[t]);const h=$.useMemo(()=>{if(!c)return{top:0,left:0};const g=c.getBoundingClientRect();let b=g.top,j=g.right+8;return j+p.width>window.innerWidth&&(j=g.left-p.width-8),b<0&&(b=0),b+p.height>window.innerHeight&&(b=window.innerHeight-p.height),{top:b,left:j}},[c,p]);if(!t||!c)return null;const x=Ci(t.recruitCost,r);return Ps.createPortal(a.jsxs("div",{ref:u,className:"fixed w-72 bg-gray-800 border border-gray-600 rounded-lg shadow-2xl p-3 z-[9999] pointer-events-none animate-fade-in-fast",style:{top:`${h.top}px`,left:`${h.left}px`},children:[a.jsx("h4",{className:"text-sm font-bold text-white mb-1 font-decorative",children:t.name}),a.jsx("p",{className:"text-xs text-gray-400 mb-2",children:t.type}),a.jsxs("div",{className:"bg-gray-900/50 rounded px-2 py-1.5 mb-2",children:[a.jsx("div",{className:"text-[10px] text-gray-400 mb-1",children:""}),a.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(k,{name:"Sword",size:12,className:"text-red-400"}),a.jsx("span",{className:"text-gray-300",children:":"}),a.jsx("span",{className:"text-white",children:t.attack})]}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(k,{name:"Shield",size:12,className:"text-blue-400"}),a.jsx("span",{className:"text-gray-300",children:":"}),a.jsx("span",{className:"text-white",children:t.defense})]}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(k,{name:"Clock",size:12,className:"text-purple-400"}),a.jsx("span",{className:"text-gray-300",children:":"}),a.jsxs("span",{className:"text-white",children:[t.trainingTime,""]})]})]}),a.jsxs("div",{className:"text-xs mt-2 pt-2 border-t border-gray-700",children:[a.jsx("div",{className:"text-[10px] text-gray-400 mb-1",children:":"}),a.jsx("div",{className:"flex flex-wrap gap-1",children:Object.entries(t.maintenanceCost||{}).map(([g,b])=>b>0&&a.jsxs("span",{className:"text-[10px] px-1.5 py-0.5 bg-gray-800 rounded text-gray-300",children:[Re[g]?.name||g,": -",b.toFixed(1)]},g))}),a.jsxs("div",{className:"flex items-center gap-1 mt-1",children:[a.jsx(k,{name:"Coins",size:12,className:"text-yellow-400"}),a.jsx("span",{className:"text-gray-300",children:":"}),a.jsxs("span",{className:"text-yellow-300",children:[((t.maintenanceCost?.silver||0)*o).toFixed(2)," /"]})]})]})]}),(Object.keys(t.counters||{}).length>0||(t.weakAgainst||[]).length>0)&&a.jsxs("div",{className:"bg-gray-900/50 rounded px-2 py-1.5 mb-2",children:[a.jsx("div",{className:"text-[10px] text-gray-400 mb-1",children:""}),Object.keys(t.counters||{}).length>0&&a.jsxs("div",{className:"flex flex-wrap gap-1 mb-1",children:[a.jsx("span",{className:"text-[10px] text-green-400",children:":"}),Object.entries(t.counters).map(([g,b])=>a.jsxs("span",{className:"text-[10px] px-1.5 py-0.5 bg-green-900/40 rounded text-green-300",children:[hr[g]?.name||g," +",Math.round((b-1)*100),"%"]},g))]}),(t.weakAgainst||[]).length>0&&a.jsxs("div",{className:"flex flex-wrap gap-1",children:[a.jsx("span",{className:"text-[10px] text-red-400",children:":"}),t.weakAgainst.map(g=>a.jsx("span",{className:"text-[10px] px-1.5 py-0.5 bg-red-900/40 rounded text-red-300",children:hr[g]?.name||g},g))]})]}),a.jsxs("div",{className:"bg-gray-900/50 rounded px-2 py-1.5 mb-2",children:[a.jsxs("div",{className:"flex justify-between text-xs",children:[a.jsx("span",{className:"text-gray-400",children:""}),a.jsx("span",{className:hr[t.category]?.color||"text-white",children:hr[t.category]?.name||t.category})]}),a.jsxs("div",{className:"flex justify-between text-xs",children:[a.jsx("span",{className:"text-gray-400",children:""}),a.jsxs("span",{className:"text-cyan-400",children:[t.populationCost||1," /"]})]}),a.jsxs("div",{className:"flex justify-between text-xs",children:[a.jsx("span",{className:"text-gray-400",children:""}),a.jsx("span",{className:"text-white",children:wn[t.epoch]?.name||`${t.epoch}`})]}),a.jsxs("div",{className:"flex justify-between text-xs",children:[a.jsx("span",{className:"text-gray-400",children:""}),a.jsxs("span",{className:"text-yellow-400",children:["+",t.obsoleteAfterEpochs||2,""]})]})]}),a.jsxs("div",{className:"bg-gray-900/50 rounded px-2 py-1.5",children:[a.jsx("div",{className:"text-[10px] text-gray-400 mb-1",children:""}),Object.entries(t.recruitCost).map(([g,b])=>a.jsxs("div",{className:"flex justify-between text-xs",children:[a.jsx("span",{className:"text-gray-300",children:Re[g]?.name||g}),a.jsxs("span",{className:(s[g]||0)>=b?"text-green-400":"text-red-400",children:[b," (",(s[g]||0).toFixed(1),")"]})]},g)),a.jsxs("div",{className:"flex justify-between text-xs pt-1 border-t border-gray-700 mt-1",children:[a.jsx("span",{className:"text-gray-300",children:""}),a.jsx("span",{className:(s.silver||0)>=x?"text-green-400":"text-red-400",children:vr(x)})]})]})]}),document.body)},aS=({army:t,militaryQueue:s,resources:r,epoch:o,population:c,buildings:u={},nations:p=[],selectedTarget:m,onRecruit:h,onDisband:x,onCancelTraining:g,onSelectTarget:b,onLaunchBattle:j,market:_,militaryWageRatio:N=1,onUpdateWageRatio:M,techsUnlocked:R=[],onShowUnitDetails:E})=>{const[T,D]=$.useState({unit:null,element:null}),O=window.matchMedia("(hover: hover)").matches,q=(H,ve)=>{O&&D({unit:ve,element:H.currentTarget})},I=Object.values(t).reduce((H,ve)=>H+ve,0),Z=(s||[]).filter(H=>H.status==="waiting").length,Y=(s||[]).filter(H=>H.status==="training").length,U=I+Z+Y,S=wf(t),Q=(s||[]).reduce((H,ve)=>{const me=un[ve.unitId];return H+(me?.populationCost||1)},0),ne=S+Q;let Ne=0;Object.entries(u).forEach(([H,ve])=>{const me=Ln.find(X=>X.id===H);me&&me.output?.militaryCapacity&&(Ne+=me.output.militaryCapacity*ve)});const $e=Py(t),de=jf(t),P=_?.prices?.food??(Re.food?.basePrice||1),z=de*P*N,V=sd(t,o),F=(p||[]).filter(H=>H.isAtWar&&o>=(H.appearEpoch??0)&&(H.expireEpoch==null||o<=H.expireEpoch)),re=F.find(H=>H.id===m)||F[0]||null;Ls.useEffect(()=>{!re&&F.length>0&&b&&b(F[0].id)},[re,F,b]);const C=H=>{if(!Array.isArray(H)||H.length<2)return"";const[ve,me]=H;return`${ve}-${me}`},L=H=>{if(H.epoch>o)return!1;for(let me in H.recruitCost)if((r[me]||0)<H.recruitCost[me])return!1;const ve=Ci(H.recruitCost,_);return!((r.silver||0)<ve||U+1>Ne)},ie=H=>{if(H.epoch>o)return` ${wn[H.epoch].name}`;for(let me in H.recruitCost)if((r[me]||0)<H.recruitCost[me])return` ${Re[me]?.name||me}`;const ve=Ci(H.recruitCost,_);return(r.silver||0)<ve?` ${ve.toFixed(1)} `:U+1>Ne?`${U}/${Ne}`:""};return a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"glass-ancient p-4 rounded-xl border border-ancient-gold/30",children:[a.jsxs("h3",{className:"text-sm font-bold mb-3 flex items-center gap-2 text-gray-300 font-decorative",children:[a.jsx(k,{name:"Shield",size:16,className:"text-red-400"}),""]}),a.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:[a.jsxs("div",{className:"bg-gray-700/50 p-3 rounded",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[a.jsx(k,{name:"Users",size:14,className:"text-blue-400"}),a.jsx("span",{className:"text-xs text-gray-400",children:""})]}),a.jsx("p",{className:"text-lg font-bold text-white",children:I})]}),a.jsxs("div",{className:"bg-gray-700/50 p-3 rounded",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[a.jsx(k,{name:"UserCheck",size:14,className:"text-cyan-400"}),a.jsx("span",{className:"text-xs text-gray-400",children:""})]}),a.jsx("p",{className:"text-lg font-bold text-cyan-400",children:ne}),a.jsxs("p",{className:"text-[10px] text-gray-500",children:[" ",S," +  ",Q]})]}),a.jsxs("div",{className:"bg-gray-700/50 p-3 rounded",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[a.jsx(k,{name:"Castle",size:14,className:"text-red-400"}),a.jsx("span",{className:"text-xs text-gray-400",children:""})]}),a.jsxs("p",{className:`text-lg font-bold ${U>Ne?"text-red-400":"text-white"}`,children:[U," / ",Ne]})]}),a.jsxs("div",{className:"bg-gray-700/50 p-3 rounded",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[a.jsx(k,{name:"Clock",size:14,className:"text-yellow-400"}),a.jsx("span",{className:"text-xs text-gray-400",children:""})]}),a.jsx("p",{className:"text-lg font-bold text-white",children:s.length})]})]}),(()=>{const H=vl($e,o,R);return Object.keys(H).length>0&&a.jsxs("div",{className:"mt-3 pt-3 border-t border-gray-700",children:[a.jsx("p",{className:"text-xs text-gray-400 mb-2",children:""}),a.jsx("div",{className:"flex flex-wrap gap-2",children:Object.entries(H).map(([ve,me])=>a.jsxs("span",{className:`text-xs px-2 py-1 rounded ${(r[ve]||0)>=me?"bg-green-900/30 text-green-400":"bg-red-900/30 text-red-400"}`,children:[Re[ve]?.name||ve,": -",me.toFixed(1),"/"]},ve))})]})})(),a.jsxs("div",{className:"mt-3 pt-3 border-t border-gray-700",children:[a.jsx("p",{className:"text-xs text-gray-400 mb-2",children:""}),a.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[a.jsx(k,{name:"Coins",size:14,className:"text-yellow-400"}),a.jsxs("span",{className:"text-yellow-300 font-mono",children:["-",z.toFixed(2)," "]})]}),a.jsxs("div",{className:"mt-2 flex items-center gap-2 text-[11px] text-gray-400",children:[a.jsx("span",{children:""}),a.jsx("input",{type:"number",step:"0.1",value:N,onChange:H=>M&&M(parseFloat(H.target.value)||0),className:"w-20 bg-gray-900/60 border border-gray-700 rounded px-2 py-0.5 text-xs text-gray-100"}),a.jsx("span",{className:"text-gray-500",children:" =     "})]})]})]}),a.jsxs("div",{className:"glass-ancient p-3 rounded-xl border border-ancient-gold/30",children:[a.jsxs("h3",{className:"text-xs font-bold mb-2 flex items-center gap-2 text-gray-300 font-decorative",children:[a.jsx(k,{name:"Info",size:14,className:"text-blue-400"}),""]}),a.jsxs("div",{className:"flex flex-wrap gap-3 text-[10px]",children:[a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx("span",{className:"text-red-400 font-semibold",children:""}),a.jsx(k,{name:"ArrowRight",size:10,className:"text-green-400"}),a.jsx("span",{className:"text-blue-400 font-semibold",children:""}),a.jsx("span",{className:"text-gray-500 ml-1",children:"()"})]}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx("span",{className:"text-blue-400 font-semibold",children:""}),a.jsx(k,{name:"ArrowRight",size:10,className:"text-green-400"}),a.jsx("span",{className:"text-green-400 font-semibold",children:""}),a.jsx("span",{className:"text-gray-500 ml-1",children:"()"})]}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx("span",{className:"text-green-400 font-semibold",children:""}),a.jsx(k,{name:"ArrowRight",size:10,className:"text-green-400"}),a.jsx("span",{className:"text-red-400 font-semibold",children:""}),a.jsx("span",{className:"text-gray-500 ml-1",children:"()"})]}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx("span",{className:"text-yellow-400 font-semibold",children:""}),a.jsx(k,{name:"ArrowRight",size:10,className:"text-green-400"}),a.jsx("span",{className:"text-red-400 font-semibold",children:""}),a.jsx("span",{className:"text-gray-500",children:"/"}),a.jsx("span",{className:"text-blue-400 font-semibold",children:""}),a.jsx("span",{className:"text-gray-500 ml-1",children:"()"})]}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx("span",{className:"text-blue-400 font-semibold",children:""}),a.jsx(k,{name:"ArrowRight",size:10,className:"text-green-400"}),a.jsx("span",{className:"text-yellow-400 font-semibold",children:""}),a.jsx("span",{className:"text-gray-500 ml-1",children:"()"})]}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx("span",{className:"text-orange-400 font-semibold",children:""}),a.jsx("span",{className:"text-gray-400",children:" "})]}),a.jsxs("div",{className:"flex items-center gap-1 border-l border-gray-700 pl-3",children:[a.jsx(k,{name:"AlertTriangle",size:10,className:"text-yellow-400"}),a.jsx("span",{className:"text-yellow-400",children:"2"})]})]})]}),a.jsxs("div",{className:"glass-ancient p-4 rounded-xl border border-ancient-gold/30",children:[a.jsxs("h3",{className:"text-sm font-bold mb-3 flex items-center gap-2 text-gray-300 font-decorative",children:[a.jsx(k,{name:"Plus",size:16,className:"text-green-400"}),""]}),a.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 2xl:grid-cols-8 gap-2",children:Object.entries(un).filter(([,H])=>{if(H.epoch>o)return!1;const ve=o-H.epoch,me=H.obsoleteAfterEpochs||2;return ve<=me}).map(([H,ve])=>{const me=Ci(ve.recruitCost,_),X=L(ve),qe=hr[ve.category]||{},fe=qe.color||"text-red-400";return a.jsxs("div",{onMouseEnter:Je=>q(Je,ve),onMouseLeave:()=>O&&D({unit:null,element:null}),onClick:()=>E&&E(ve),className:`group relative p-2 rounded-lg border transition-all cursor-pointer ${X?"glass-ancient border border-ancient-gold/30 hover:border-red-500/60 hover:shadow-glow-gold":"bg-gray-700/50 border border-ancient-gold/20"}`,children:[a.jsxs("div",{className:"flex flex-col items-center mb-2",children:[a.jsx("div",{className:"w-12 h-12 icon-metal-container icon-metal-container-lg rounded-lg flex items-center justify-center mb-1",children:a.jsx(k,{name:ve.icon||"Swords",size:24,className:`${fe} icon-metal-red`})}),a.jsx("h4",{className:"text-xs font-bold text-center leading-tight text-white font-decorative",children:ve.name}),a.jsxs("p",{className:"text-[10px] text-gray-400",children:["",t[H]||0]}),a.jsx("span",{className:`text-[9px] px-1.5 py-0.5 rounded-full mt-0.5 ${qe.color?.replace("text-","bg-").replace("-400","-900/50")} ${fe}`,children:qe.name})]}),a.jsxs("div",{className:"space-y-1 text-[10px] mb-2",children:[a.jsxs("div",{className:"bg-gray-900/40 rounded px-1.5 py-1 flex justify-between",children:[a.jsx("span",{className:"text-gray-400",children:"/"}),a.jsxs("span",{className:"text-white",children:[ve.attack,"/",ve.defense]})]}),a.jsxs("div",{className:"bg-gray-900/40 rounded px-1.5 py-1 flex justify-between",children:[a.jsx("span",{className:"text-gray-400",children:""}),a.jsxs("span",{className:`${(ve.populationCost||1)>1?"text-cyan-400":"text-white"}`,children:[ve.populationCost||1," "]})]}),a.jsxs("div",{className:"bg-gray-900/40 rounded px-1.5 py-1",children:[a.jsxs("div",{className:"flex justify-between mb-0.5",children:[a.jsx("span",{className:"text-gray-400",children:""}),a.jsxs("span",{className:"text-yellow-300 text-[9px]",children:[((ve.maintenanceCost?.silver||0)*N).toFixed(1),"/"]})]}),Object.entries(ve.maintenanceCost||{}).filter(([Je,tt])=>Je!=="food"&&Je!=="silver"&&tt>0).length>0&&a.jsx("div",{className:"flex flex-wrap gap-0.5 text-[8px]",children:Object.entries(ve.maintenanceCost||{}).filter(([Je,tt])=>Je!=="food"&&Je!=="silver"&&tt>0).map(([Je,tt])=>a.jsxs("span",{className:"text-gray-400",children:[Re[Je]?.name?.slice(0,1)||Je,":",tt.toFixed(1)]},Je))})]}),Object.keys(ve.counters||{}).length>0&&a.jsxs("div",{className:"bg-green-900/30 rounded px-1.5 py-1 flex justify-between",children:[a.jsx("span",{className:"text-green-400",children:""}),a.jsx("span",{className:"text-green-300 text-[9px]",children:Object.entries(ve.counters).map(([Je,tt])=>`${hr[Je]?.name||Je}+${Math.round((tt-1)*100)}%`).join(", ")})]})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("button",{onClick:Je=>{Je.stopPropagation(),h(H)},disabled:!X,title:X?"":ie(ve),className:`w-full px-2 py-1 rounded text-[10px] font-semibold transition-colors ${X?"bg-green-600 hover:bg-green-500 text-white":"bg-gray-600 text-gray-400 cursor-not-allowed"}`,children:a.jsxs("div",{className:"flex items-center justify-center gap-1",children:[a.jsx(k,{name:"Plus",size:10}),a.jsx("span",{className:(r.silver||0)<me?"text-red-300":"",children:vr(me)})]})}),(t[H]||0)>0&&a.jsxs("button",{onClick:Je=>{Je.stopPropagation(),x(H)},className:"w-full px-2 py-1 bg-red-600 hover:bg-red-500 text-white rounded text-[10px] font-semibold transition-colors flex items-center justify-center gap-1",children:[a.jsx(k,{name:"Minus",size:10}),""]})]})]},H)})})]}),s.length>0&&a.jsxs("div",{className:"glass-ancient p-4 rounded-xl border border-ancient-gold/30",children:[a.jsxs("h3",{className:"text-sm font-bold mb-3 flex items-center gap-2 text-gray-300 font-decorative",children:[a.jsx(k,{name:"Clock",size:16,className:"text-yellow-400"}),""]}),a.jsx("div",{className:"space-y-2",children:s.map((H,ve)=>{const me=un[H.unitId],X=H.status==="waiting",qe=X?0:(H.totalTime-H.remainingTime)/H.totalTime*100;return a.jsxs("div",{className:`flex items-center justify-between p-2 rounded ${X?"bg-gray-700/30 border border-dashed border-gray-600":"bg-gray-700/50"}`,children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(k,{name:X?"UserPlus":"User",size:14,className:X?"text-gray-400":"text-blue-400"}),a.jsx("span",{className:`text-sm ${X?"text-gray-400":"text-white"}`,children:me.name}),X&&a.jsx("span",{className:"text-xs text-yellow-400",children:"..."})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[!X&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"w-32 bg-gray-600 rounded-full h-2",children:a.jsx("div",{className:"bg-yellow-500 h-2 rounded-full transition-all",style:{width:`${qe}%`}})}),a.jsxs("span",{className:"text-xs text-gray-400 w-12 text-right",children:[H.remainingTime,""]})]}),X&&a.jsx("span",{className:"text-xs text-gray-500 w-44 text-right",children:""}),a.jsx("button",{onClick:()=>g&&g(ve),className:"ml-2 p-1 rounded hover:bg-red-900/30 text-red-400 hover:text-red-300 transition-colors",title:"50%",children:a.jsx(k,{name:"X",size:14})})]})]},ve)})})]}),a.jsxs("div",{className:"glass-ancient p-4 rounded-xl border border-ancient-gold/30",children:[a.jsxs("h3",{className:"text-sm font-bold mb-3 flex items-center gap-2 text-gray-300 font-decorative",children:[a.jsx(k,{name:"Swords",size:16,className:"text-red-400"}),""]}),a.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-400 mb-3",children:[a.jsxs("span",{children:["",a.jsx("span",{className:"text-white font-semibold",children:V.toFixed(0)})]}),a.jsxs("span",{children:["",a.jsx("span",{className:"text-white font-semibold",children:I})]})]}),F.length===0?a.jsx("div",{className:"p-3 rounded bg-gray-900/40 border border-gray-700 text-xs text-gray-400",children:""}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex flex-wrap items-center gap-3 text-xs text-gray-400 mb-3",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{children:""}),a.jsx("select",{value:re?.id||"",onChange:H=>b&&b(H.target.value),className:"bg-gray-900/60 border border-gray-700 text-white rounded px-2 py-1",children:F.map(H=>a.jsxs("option",{value:H.id,children:[H.name,"   ",H.warScore||0]},H.id))})]}),re&&a.jsxs("div",{className:"flex flex-wrap gap-3",children:[a.jsxs("span",{children:["",re.warScore||0]}),a.jsxs("span",{children:["",re.enemyLosses||0]}),a.jsxs("span",{children:["",Math.floor(re.wealth||0)]}),a.jsxs("span",{children:["",Math.floor((re.militaryStrength??1)*100),"%"]}),a.jsxs("span",{children:["",Math.floor(re.population||1e3)]})]})]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:ky.map(H=>{const ve=H.baseUnitCount?.min||0,me=H.baseUnitCount?.max||0,X=!H.requiresTech||R.includes(H.requiresTech),qe=H.requiresTech?_l.find(fe=>fe.id===H.requiresTech)?.name||H.requiresTech:null;return a.jsxs("div",{className:`p-3 rounded-lg border flex flex-col gap-3 ${X?"border-gray-700 bg-gray-900/40":"border-gray-800 bg-gray-900/20 opacity-60"}`,children:[a.jsxs("div",{className:"flex items-start justify-between gap-2",children:[a.jsxs("div",{children:[a.jsxs("h4",{className:"text-base font-bold text-white flex items-center gap-2 font-decorative",children:[H.name,a.jsx("span",{className:"text-[11px] px-2 py-0.5 rounded-full bg-gray-700 text-gray-200",children:H.difficulty}),!X&&a.jsxs("span",{className:"text-[10px] px-2 py-0.5 rounded-full bg-red-900/50 text-red-300",children:[a.jsx(k,{name:"Lock",size:10,className:"inline mr-1"}),"",qe]})]}),a.jsx("p",{className:"text-xs text-gray-400 mt-1",children:H.desc})]}),a.jsx(k,{name:"Target",size:18,className:X?"text-red-300":"text-gray-500"})]}),a.jsxs("div",{className:"space-y-2 text-xs text-gray-300",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-gray-400",children:""}),a.jsxs("span",{children:[ve,"-",me," "]})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-gray-400 mb-1",children:""}),a.jsxs("div",{className:"flex flex-wrap gap-2",children:[Object.entries(H.loot||{}).map(([fe,Je])=>a.jsxs("span",{className:"px-2 py-0.5 bg-yellow-900/20 rounded border border-yellow-600/30 text-[11px] text-yellow-200",children:[Re[fe]?.name||fe," ",C(Je)]},fe)),Object.keys(H.loot||{}).length===0&&a.jsx("span",{className:"text-gray-500",children:""})]})]}),H.influence&&a.jsxs("div",{className:"flex items-center justify-between text-[11px]",children:[a.jsx("span",{className:"text-gray-400",children:""}),a.jsxs("span",{className:"text-green-400",children:[" +",H.influence.win]}),a.jsxs("span",{className:"text-red-400",children:[" ",H.influence.lose]})]})]}),a.jsxs("button",{onClick:()=>j(H.id,re?.id),disabled:I===0||!re||!X,className:"px-3 py-2 bg-red-600 hover:bg-red-500 disabled:bg-gray-600 disabled:text-gray-300 disabled:cursor-not-allowed text-white rounded text-sm font-semibold transition-colors flex items-center justify-center gap-2",children:[a.jsx(k,{name:"Sword",size:14}),X?"":`${qe}`]})]},H.id)})})]}),I===0&&a.jsx("p",{className:"text-xs text-yellow-400 mt-2",children:" "})]}),a.jsx(tS,{unit:T.unit,anchorElement:T.element,resources:r,market:_,militaryWageRatio:N})]})},E2={gatherBonus:{label:"",type:"percent"},industryBonus:{label:"",type:"percent"},cultureBonus:{label:"",type:"percent"},scienceBonus:{label:"",type:"percent"},militaryBonus:{label:"",type:"percent"}},nS=(t,s)=>{if(E2[t]?.type==="flat")return`${s>0?"+":""}${s}`;const o=typeof s=="number"?s:Number(s)||0;return`${o>0?"+":""}${(o*100).toFixed(0)}%`},fd=Ln.reduce((t,s)=>{if(!s.requiresTech)return t;const r=s.requiresTech;return t[r]||(t[r]=[]),t[r].push(s.name||s.id),t},{}),ad=t=>Math.min(1,Math.max(0,t)),sS=(t,s=1)=>{if(typeof t!="string")return`rgba(255, 255, 255, ${ad(s)})`;const r=t.replace("#",""),o=r.length===3?r.split("").map(h=>h+h).join(""):r,c=Number.parseInt(o,16);if(Number.isNaN(c))return`rgba(255, 255, 255, ${ad(s)})`;const u=c>>16&255,p=c>>8&255,m=c&255;return`rgba(${u}, ${p}, ${m}, ${ad(s)})`},uy=t=>t.replace(/rgba?\(/,"").replace(")","").split(",").map(s=>parseFloat(s.trim())).filter(s=>!Number.isNaN(s)),ul=(t,s=1)=>{const r=ad(s);if(!t)return`rgba(255, 255, 255, ${r})`;const o=t.trim();if(o.startsWith("#"))return sS(o,r);if(o.startsWith("rgba")){const c=uy(o);if(c.length>=3){const[u,p,m]=c;return`rgba(${u}, ${p}, ${m}, ${r})`}}if(o.startsWith("rgb")){const c=uy(o);if(c.length>=3){const[u,p,m]=c;return`rgba(${u}, ${p}, ${m}, ${r})`}}return o},iS=({tech:t,status:s,resources:r,market:o,anchorElement:c})=>{if(!t||!c)return null;const[u,p]=$.useState({top:0,left:0}),m=$.useRef(null);$.useEffect(()=>{if(c&&m.current){const x=c.getBoundingClientRect(),g=m.current.getBoundingClientRect();let b=x.top,j=x.right+8;j+g.width>window.innerWidth&&(j=x.left-g.width-8),b<0&&(b=0),b+g.height>window.innerHeight&&(b=window.innerHeight-g.height),p({top:b,left:j})}},[c,t]);const h=Ci(t.cost,o);return Ps.createPortal(a.jsxs("div",{ref:m,className:"fixed w-80 bg-gray-800 border border-gray-600 rounded-lg shadow-2xl p-3 z-[9999] pointer-events-none animate-fade-in-fast",style:{top:`${u.top}px`,left:`${u.left}px`},children:[a.jsxs("h5",{className:"text-sm font-bold text-white mb-1 flex items-center gap-1",children:[t.name,s==="unlocked"&&a.jsx(k,{name:"Check",size:14,className:"text-green-400"})]}),a.jsx("p",{className:"text-xs text-gray-400 mb-2",children:t.desc}),t.effect&&a.jsxs("div",{className:"bg-blue-900/30 rounded px-2 py-1.5 mb-2",children:[a.jsx("div",{className:"text-[10px] text-gray-400 mb-1",children:""}),a.jsx("p",{className:"text-xs text-blue-300",children:t.effect})]}),fd[t.id]?.length>0&&a.jsxs("div",{className:"bg-amber-900/30 rounded px-2 py-1.5 mb-2",children:[a.jsx("div",{className:"text-[10px] text-gray-400 mb-1",children:""}),a.jsx("p",{className:"text-xs text-amber-300",children:fd[t.id].join("")})]}),s!=="unlocked"&&a.jsxs("div",{className:"bg-gray-900/50 rounded px-2 py-1.5",children:[a.jsx("div",{className:"text-[10px] text-gray-400 mb-1",children:""}),Object.entries(t.cost).map(([x,g])=>a.jsxs("div",{className:"flex justify-between text-xs",children:[a.jsx("span",{className:"text-gray-300",children:Re[x]?.name||x}),a.jsxs("span",{className:(r[x]||0)>=g?"text-green-400":"text-red-400",children:[Math.round(g)," (",Math.round(r[x]||0),")"]})]},x)),a.jsxs("div",{className:"flex justify-between text-xs pt-1 border-t border-gray-700 mt-1",children:[a.jsx("span",{className:"text-gray-300",children:""}),a.jsx("span",{className:(r.silver||0)>=h?"text-green-400":"text-red-400",children:vr(h)})]})]})]}),document.body)},rS=({techsUnlocked:t,epoch:s,resources:r,population:o,onResearch:c,onUpgradeEpoch:u,canUpgradeEpoch:p,market:m,onShowTechDetails:h})=>{const[x,g]=$.useState({tech:null,element:null}),b=window.matchMedia("(hover: hover)").matches,j=(C,L)=>{b&&g({tech:L,element:C.currentTarget})},_=$.useCallback(C=>{if(t.includes(C.id)||C.epoch>s)return!1;for(let ie in C.cost)if((r[ie]||0)<C.cost[ie])return!1;const L=Ci(C.cost,m);return!((r.silver||0)<L)},[t,s,r,m]),N=C=>t.includes(C.id)?"unlocked":C.epoch>s?"locked":"available",M=$.useMemo(()=>_l.reduce((C,L)=>(C[L.epoch]||(C[L.epoch]=[]),C[L.epoch].push(L),C),{}),[]),[R,E]=$.useState(()=>{const C=new Set;return Object.keys(M).forEach(L=>{const ie=parseInt(L,10),ve=(M[ie]||[]).some(me=>!t.includes(me.id));(ie===s||ve)&&C.add(ie)}),C}),[T,D]=$.useState(!1);$.useEffect(()=>{E(C=>{if(C.has(s))return C;const L=new Set(C);return L.add(s),L})},[s]);const O=$.useMemo(()=>Object.keys(M).map(Number).filter(C=>C<=s).sort((C,L)=>C-L),[M,s]),q=$.useMemo(()=>O.reduce((C,L)=>{const ie=M[L]||[],H=ie.length,ve=ie.filter(X=>t.includes(X.id)).length,me=ie.some(X=>_(X));return C[L]={techs:ie,total:H,researchedCount:ve,isCompleted:H>0&&ve===H,hasResearchable:me},C},{}),[O,M,t,_]),I=O.length>0&&O.every(C=>R.has(C)),Z=C=>{E(L=>{const ie=new Set(L);return ie.has(C)?ie.delete(C):ie.add(C),ie})},Y=()=>{E(()=>I?new Set:new Set(O))},U=typeof s=="number"&&s>=0&&s<wn.length?s:0,S=wn[U],Q=U<wn.length-1?wn[U+1]:null,ne=Q?Ci(Q.cost,m):0,Ne=Q?(r.silver||0)>=ne:!0,$e=Math.min(U+1,wn.length-1),de=rd($e),P=de?.accentColor||de?.primaryColor,z=$.useMemo(()=>de?{backgroundImage:`linear-gradient(135deg, ${ul(de.secondaryColor||de.primaryColor,.35)}, ${ul(de.primaryColor,.85)})`,borderColor:de.borderColor||de.primaryColor,boxShadow:`0 8px 20px ${de.glowColor||ul(de.primaryColor,.25)}`}:{},[de]),V=$.useMemo(()=>de?{backgroundImage:`linear-gradient(90deg, ${ul(de.secondaryColor||de.primaryColor,.95)}, ${ul(de.primaryColor,.95)})`,color:de.textColor||"#fff",borderColor:de.borderColor||de.primaryColor,boxShadow:`0 4px 12px ${de.glowColor||ul(de.primaryColor,.2)}`}:{},[de]),F=s<wn.length-1&&!!Q,re=F&&p()&&Ne;return a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"relative p-4 rounded-2xl border-2 shadow-epic overflow-hidden transition-all",style:z,children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsxs("div",{children:[a.jsxs("h3",{className:"text-lg font-bold text-white flex items-center gap-2 font-decorative",children:[a.jsx(k,{name:"Crown",size:20,className:"drop-shadow",style:{color:P}}),"",S?.name||""]}),a.jsx("p",{className:"text-xs text-gray-300 mt-1",children:S?.description||""})]}),F&&a.jsxs("div",{className:"text-right",children:[a.jsx("p",{className:"text-xs text-gray-400 mb-1",children:""}),a.jsx("p",{className:"text-sm font-bold",style:{color:de?.textColor||"#fff"},children:Q.name})]})]}),S?.bonuses&&a.jsxs("div",{className:"mb-3 p-3 bg-black/20 rounded",children:[a.jsx("p",{className:"text-xs text-gray-400 mb-2",children:""}),a.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2",children:Object.entries(S.bonuses).map(([C,L])=>C==="desc"?null:a.jsxs("div",{className:"flex items-center gap-1 text-xs",children:[a.jsx(k,{name:"TrendingUp",size:12,className:"text-green-400"}),a.jsxs("span",{className:"text-gray-300",children:[E2[C]?.label||Re[C]?.name||C,":",a.jsx("span",{className:"text-green-400 ml-1",children:nS(C,L)})]})]},C))})]}),F&&a.jsxs("div",{children:[a.jsxs("div",{className:"mb-2",children:[a.jsx("p",{className:"text-xs text-gray-400 mb-1",children:""}),a.jsxs("div",{className:"flex flex-wrap gap-2",children:[Q.req.science&&a.jsxs("span",{className:`text-xs px-2 py-1 rounded ${(r.science||0)>=Q.req.science?"bg-green-900/30 text-green-400":"bg-red-900/30 text-red-400"}`,children:[Re.science?.name||"",": ",(r.science||0).toFixed(0)," / ",Q.req.science]}),Q.req.population&&a.jsxs("span",{className:`text-xs px-2 py-1 rounded ${o>=Q.req.population?"bg-green-900/30 text-green-400":"bg-red-900/30 text-red-400"}`,children:[": ",o," / ",Q.req.population]}),Q.req.culture&&a.jsxs("span",{className:`text-xs px-2 py-1 rounded ${(r.culture||0)>=Q.req.culture?"bg-green-900/30 text-green-400":"bg-red-900/30 text-red-400"}`,children:[Re.culture?.name||"",": ",(r.culture||0).toFixed(0)," / ",Q.req.culture]})]})]}),a.jsxs("div",{className:"mb-2",children:[a.jsx("p",{className:"text-xs text-gray-400 mb-1",children:""}),a.jsx("div",{className:"flex flex-wrap gap-2",children:Object.entries(Q.cost).map(([C,L])=>a.jsxs("span",{className:`text-xs px-2 py-1 rounded ${(r[C]||0)>=L?"bg-green-900/30 text-green-400":"bg-red-900/30 text-red-400"}`,children:[Re[C]?.name||C,": ",L]},C))}),a.jsxs("div",{className:"flex items-center justify-between text-xs mt-2",children:[a.jsx("span",{className:"text-gray-400",children:""}),a.jsx("span",{className:Ne?"text-slate-100 font-semibold":"text-red-400 font-semibold",children:vr(ne)})]})]}),a.jsx("button",{onClick:u,disabled:!re,className:`w-full px-4 py-3 rounded-lg text-sm font-bold transition-all border-2 ${re?"shadow-lg":"bg-gray-600 text-gray-400 cursor-not-allowed border-gray-600"}`,style:re?V:void 0,children:re?a.jsxs("span",{className:"flex items-center justify-center gap-2",children:[a.jsx(k,{name:"ArrowUp",size:16})," ",Q.name]}):""})]}),s===wn.length-1&&a.jsx("div",{className:"text-center py-2",children:a.jsx("p",{className:"text-sm text-yellow-400",children:" "})})]}),a.jsxs("div",{className:"glass-ancient p-4 rounded-xl border border-ancient-gold/30",children:[a.jsxs("h3",{className:"text-sm font-bold mb-3 flex items-center gap-2 text-gray-300 font-decorative",children:[a.jsx(k,{name:"Lightbulb",size:16,className:"text-yellow-400"}),""]}),a.jsxs("div",{className:"flex flex-col gap-2 md:flex-row md:items-center md:justify-between mb-4",children:[a.jsxs("label",{className:"flex items-center gap-2 text-xs text-gray-300 cursor-pointer select-none",children:[a.jsx("input",{type:"checkbox",className:"form-checkbox rounded border-ancient-gold/30 text-purple-400 focus:ring-purple-500",checked:T,onChange:C=>D(C.target.checked)}),""]}),a.jsx("button",{onClick:Y,className:"text-xs px-3 py-1.5 rounded border border-ancient-gold/30 text-ancient-parchment hover:border-purple-400 hover:text-ancient transition-colors",children:I?"":""})]}),a.jsx("div",{className:"space-y-4",children:O.map(C=>{const L=wn[C],ie=q[C],H=R.has(C),ve=ie?.isCompleted?" ":`${ie?.researchedCount||0}/${ie?.total||0}`,me=ie?.isCompleted?"text-green-400":"text-gray-300",X=ie?.techs||[],qe=T?X.filter(fe=>!t.includes(fe.id)):X;return a.jsxs("div",{className:`border rounded-lg ${ie?.hasResearchable?"border-yellow-400/70":"border-gray-700"} bg-gray-900/40`,children:[a.jsxs("button",{type:"button",className:"w-full flex items-center justify-between px-3 py-2 text-left text-sm text-purple-200",onClick:()=>Z(C),children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(k,{name:H?"ArrowDown":"ArrowRight",size:16,className:"text-purple-300"}),a.jsx("span",{className:"font-bold",children:L?.name}),ie?.hasResearchable&&a.jsx("span",{className:"h-2 w-2 rounded-full bg-yellow-300 animate-pulse"})]}),a.jsx("div",{className:`text-xs font-semibold ${me}`,children:ve})]}),H&&a.jsx("div",{className:"border-t border-gray-800 px-3 py-4",children:qe.length>0?a.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 2xl:grid-cols-8 gap-2",children:qe.map(fe=>{const Je=N(fe),tt=Ci(fe.cost,m),Mt=_(fe);return a.jsxs("div",{onMouseEnter:jt=>j(jt,fe),onMouseLeave:()=>b&&g({tech:null,element:null}),onClick:()=>h&&h(fe,Je),className:`group relative p-2 rounded-lg border transition-all cursor-pointer ${Je==="unlocked"?"bg-green-900/20 border-green-600":Mt?"glass-ancient border border-ancient-gold/30 hover:border-blue-400/70 hover:shadow-glow-gold":"bg-gray-700/50 border border-ancient-gold/20"}`,children:[a.jsxs("div",{className:"flex flex-col items-center mb-2",children:[a.jsx("div",{className:"w-12 h-12 icon-metal-container icon-metal-container-lg rounded-lg flex items-center justify-center mb-1",children:Je==="unlocked"?a.jsx(k,{name:"Check",size:24,className:"text-green-400 icon-metal-green"}):a.jsx(k,{name:"Lightbulb",size:24,className:"text-blue-400 icon-metal-blue"})}),a.jsx("h5",{className:"text-xs font-bold text-white text-center leading-tight font-decorative",children:fe.name})]}),Je!=="unlocked"&&a.jsxs("div",{className:"space-y-1 text-[10px] mb-2",children:[fd[fe.id]?.length>0&&a.jsxs("div",{className:"bg-amber-900/30 rounded px-1.5 py-1 text-center text-amber-300",children:["",fd[fe.id].length,""]}),fe.effect&&a.jsx("div",{className:"bg-blue-900/30 rounded px-1.5 py-1 text-center text-blue-300",children:""})]}),Je==="unlocked"?a.jsx("div",{className:"text-center py-1 bg-green-900/30 rounded text-[10px] text-green-400 font-semibold",children:" "}):a.jsx("button",{onClick:jt=>{jt.stopPropagation(),c(fe.id)},disabled:!Mt,className:`w-full px-2 py-1 rounded text-[10px] font-semibold transition-colors ${Mt?"bg-blue-600 hover:bg-blue-500 text-white":"bg-gray-600 text-gray-400 cursor-not-allowed"}`,children:a.jsxs("div",{className:"flex items-center justify-center gap-1",children:[a.jsx(k,{name:"Zap",size:10}),a.jsx("span",{className:(r.silver||0)<tt?"text-red-300":"",children:vr(tt)})]})})]},fe.id)})}):a.jsx("p",{className:"text-xs text-gray-400 text-center",children:T?"":""})})]},C)})})]}),a.jsx(iS,{tech:x.tech,anchorElement:x.element,status:x.tech?N(x.tech):null,resources:r,market:m})]})},oS=t=>[/\s*[+-]?\d+%/,/\s*[+-]?\d+%/,/\s*[+-]?\d+%/].some(r=>r.test(t)),py=t=>!t||!Array.isArray(t)?[]:t.filter(s=>!oS(s)),lS=({decree:t,anchorRect:s})=>{if(!t||!s)return null;const r=320,o=200;let c=s.top,u=s.right+8;return u+r>window.innerWidth&&(u=s.left-r-8),c<0&&(c=0),c+o>window.innerHeight&&(c=window.innerHeight-o),Ps.createPortal(a.jsxs("div",{className:"fixed w-80 bg-gray-800 border border-gray-600 rounded-lg shadow-2xl p-3 z-[9999] pointer-events-none animate-fade-in-fast",style:{top:`${c}px`,left:`${u}px`},children:[a.jsxs("h4",{className:"text-sm font-bold text-white mb-1 flex items-center gap-2 font-decorative",children:[t.name,t.active&&a.jsx("span",{className:"px-2 py-0.5 bg-green-600 text-white text-xs rounded",children:""})]}),a.jsx("p",{className:"text-xs text-gray-400 mb-2",children:t.desc}),(()=>{const m=t.modifiers&&(t.modifiers.resourceDemandMod||t.modifiers.stratumDemandMod||t.modifiers.resourceSupplyMod)?py(t.effects):t.effects;return m&&m.length>0&&a.jsxs("div",{className:"bg-green-900/30 rounded px-2 py-1.5 mb-2",children:[a.jsx("div",{className:"text-[10px] text-gray-400 mb-1",children:""}),a.jsx("div",{className:"space-y-1",children:m.map((h,x)=>a.jsxs("div",{className:"flex items-center gap-1 text-xs",children:[a.jsx(k,{name:"Plus",size:12,className:"text-green-400"}),a.jsx("span",{className:"text-green-300",children:h})]},x))})]})})(),(()=>{const m=t.modifiers&&(t.modifiers.resourceDemandMod||t.modifiers.stratumDemandMod||t.modifiers.resourceSupplyMod)?py(t.drawbacks):t.drawbacks;return m&&m.length>0&&a.jsxs("div",{className:"bg-red-900/30 rounded px-2 py-1.5",children:[a.jsx("div",{className:"text-[10px] text-gray-400 mb-1",children:""}),a.jsx("div",{className:"space-y-1",children:m.map((h,x)=>a.jsxs("div",{className:"flex items-center gap-1 text-xs",children:[a.jsx(k,{name:"Minus",size:12,className:"text-red-400"}),a.jsx("span",{className:"text-red-300",children:h})]},x))})]})})(),t.modifiers&&(t.modifiers.resourceDemandMod||t.modifiers.stratumDemandMod||t.modifiers.resourceSupplyMod)&&a.jsxs("div",{className:"bg-blue-900/30 rounded px-2 py-1.5 mt-2",children:[a.jsx("div",{className:"text-[10px] text-gray-400 mb-1",children:""}),a.jsxs("div",{className:"space-y-1.5",children:[t.modifiers.resourceDemandMod&&Object.keys(t.modifiers.resourceDemandMod).length>0&&a.jsx("div",{className:"flex flex-wrap gap-1",children:Object.entries(t.modifiers.resourceDemandMod).map(([p,m])=>{const h=Math.round(m*100),x=h>0?`+${h}%`:`${h}%`;return a.jsxs("span",{className:`text-[10px] px-1 py-0.5 rounded ${m>0?"bg-orange-900/40 text-orange-300":"bg-cyan-900/40 text-cyan-300"}`,children:[Re[p]?.name||p," ",x]},p)})}),t.modifiers.resourceSupplyMod&&Object.keys(t.modifiers.resourceSupplyMod).length>0&&a.jsx("div",{className:"flex flex-wrap gap-1",children:Object.entries(t.modifiers.resourceSupplyMod).map(([p,m])=>{const h=Math.round(m*100),x=h>0?`+${h}%`:`${h}%`;return a.jsxs("span",{className:`text-[10px] px-1 py-0.5 rounded ${m>0?"bg-green-900/40 text-green-300":"bg-red-900/40 text-red-300"}`,children:[Re[p]?.name||p," ",x]},p)})}),t.modifiers.stratumDemandMod&&Object.keys(t.modifiers.stratumDemandMod).length>0&&a.jsx("div",{className:"flex flex-wrap gap-1",children:Object.entries(t.modifiers.stratumDemandMod).map(([p,m])=>{const h=Math.round(m*100),x=h>0?`+${h}%`:`${h}%`;return a.jsxs("span",{className:`text-[10px] px-1 py-0.5 rounded ${m>0?"bg-purple-900/40 text-purple-300":"bg-teal-900/40 text-teal-300"}`,children:[Ke[p]?.name||p," ",x]},p)})})]})]})]}),document.body)},fy={upper:{name:"",keys:["merchant","official","landowner","capitalist","knight","engineer"]},middle:{name:"",keys:["worker","artisan","miner","soldier","cleric","scribe","navigator"]},lower:{name:"",keys:["unemployed","peasant","serf","lumberjack","slave"]}},mf={basic:{name:"",keys:["food","wood","stone","cloth"]},industrial:{name:"",keys:["brick","plank","copper","tools","dye","iron","coal","steel"]},consumer:{name:"",keys:["papyrus","delicacies","furniture","ale","fine_clothes","spice","coffee"]}},my=new Set(Object.values(mf).flatMap(t=>t.keys)),hy=({resourceKey:t,info:s,rate:r,hasSupply:o,draftRate:c,onDraftChange:u,onCommit:p,tariffMultiplier:m,draftTariff:h,onTariffDraftChange:x,onTariffCommit:g})=>{const b=r??0,j=b<0,_=Math.abs(b*100).toFixed(0),N=Number.isFinite(m)?m:1,M=j?"text-green-300":"text-blue-300";return a.jsxs("div",{className:`bg-gray-900/40 p-2 rounded-lg border flex flex-col justify-between transition-opacity ${o?"border-gray-700/60":"border-gray-800/50 opacity-50"}`,children:[a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-1.5 mb-0.5",children:[a.jsx(k,{name:s.icon||"Box",size:14,className:s.color||"text-gray-400"}),a.jsx("span",{className:"font-semibold text-gray-300 text-xs flex-grow whitespace-nowrap overflow-hidden text-ellipsis",children:s.name}),!o&&a.jsx("div",{className:"w-2 h-2 rounded-full bg-red-500 flex-shrink-0",title:""})]}),a.jsx("div",{className:"text-center my-0.5",children:a.jsxs("span",{className:`${M} text-lg`,children:[j?` ${_}`:`${_}`,a.jsx("span",{className:"text-xs",children:"%"})]})})]}),a.jsx("input",{type:"text",inputMode:"numeric",step:"0.01",value:c??(b*100).toFixed(0),onChange:R=>u(t,R.target.value),onBlur:()=>p(t),onKeyDown:R=>{R.key==="Enter"&&(p(t),R.target.blur())},className:"w-full bg-gray-900/70 border border-gray-600 text-[11px] text-gray-200 rounded px-1.5 py-0.5 focus:ring-1 focus:ring-blue-500 focus:border-blue-500 text-center",placeholder:"%"}),a.jsxs("div",{className:"mt-1.5 border-t border-gray-800/70 pt-1.5",children:[a.jsxs("div",{className:"flex items-center justify-between text-[10px] text-gray-400 mb-0.5",children:[a.jsx("span",{children:""}),a.jsxs("span",{className:"text-gray-200 font-mono text-xs",children:[N.toFixed(2),""]})]}),a.jsx("input",{type:"text",inputMode:"decimal",step:"0.1",value:h??N.toFixed(2),onChange:R=>x(t,R.target.value),onBlur:()=>g(t),onKeyDown:R=>{R.key==="Enter"&&(g(t),R.target.blur())},className:"w-full bg-gray-900/70 border border-gray-600 text-[11px] text-gray-200 rounded px-1.5 py-0.5 focus:ring-1 focus:ring-indigo-500 focus:border-indigo-500 text-center",placeholder:""})]})]})},cS=({building:t,multiplier:s,buildingCount:r,draftMultiplier:o,onDraftChange:c,onCommit:u})=>{const p=t.businessTaxBase??.1,m=s??1,h=m*p,x=h<0,g=h>0,b=x?"text-green-300":"text-yellow-300",j=x?"border-green-700/60":g?"border-yellow-700/60":"border-gray-700/60",_=t.visual?.color||"bg-gray-700",N=t.visual?.text||"text-gray-200";return a.jsxs("div",{className:`bg-gray-900/40 p-1.5 rounded-lg border ${j} flex flex-col gap-1 transition-all ${r>0?"":"opacity-50"}`,children:[a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-1 mb-0.5",children:[a.jsx("div",{className:`${_} ${N} p-0.5 rounded`,children:a.jsx(k,{name:t.visual?.icon||"Building",size:14})}),a.jsx("span",{className:"font-semibold text-gray-300 text-xs flex-grow whitespace-nowrap overflow-hidden text-ellipsis",children:t.name}),a.jsx("span",{className:"text-gray-500 text-[10px] font-mono",children:r})]}),a.jsxs("div",{className:"text-center my-0.5",children:[x?a.jsxs("div",{className:"flex items-center justify-center gap-1",children:[a.jsx(k,{name:"TrendingDown",size:12,className:"text-green-400"}),a.jsxs("span",{className:`${b} text-sm font-semibold`,children:[" ",Math.abs(h).toFixed(2)]})]}):g?a.jsxs("div",{className:"flex items-center justify-center gap-1",children:[a.jsx(k,{name:"TrendingUp",size:12,className:"text-yellow-400"}),a.jsx("span",{className:`${b} text-sm font-semibold`,children:h.toFixed(2)})]}):a.jsx("span",{className:"text-gray-500 text-sm",children:""}),a.jsxs("div",{className:"text-[10px] text-gray-500 mt-0",children:["// (",p.toFixed(2),")"]})]})]}),a.jsx("input",{type:"text",inputMode:"decimal",step:"0.05",value:o??m??1,onChange:M=>c(t.id,M.target.value),onBlur:()=>u(t.id),onKeyDown:M=>{M.key==="Enter"&&(u(t.id),M.target.blur())},className:"w-full bg-gray-900/70 border border-gray-600 text-[11px] text-gray-200 rounded px-1.5 py-0 focus:ring-1 focus:ring-blue-500 focus:border-blue-500 text-center",placeholder:""})]})},dS=({decrees:t,onToggle:s,taxPolicies:r,onUpdateTaxPolicies:o,popStructure:c={},buildings:u={},market:p={},epoch:m=0,techsUnlocked:h=[],onShowDecreeDetails:x,jobFill:g={},jobsAvailable:b={}})=>{const j={economy:{name:"",icon:"Coins",color:"text-yellow-400"},military:{name:"",icon:"Shield",color:"text-red-400"},culture:{name:"",icon:"Book",color:"text-purple-400"},social:{name:"",icon:"Users",color:"text-blue-400"}},_=(t||[]).filter(oe=>(oe.unlockEpoch??0)<=m),N=(t||[]).filter(oe=>(oe.unlockEpoch??0)>m),M=N.length>0?N.reduce((oe,Ye)=>{const bt=Ye.unlockEpoch??1/0;return bt<oe?bt:oe},1/0):null,R=Number.isFinite(M)?wn[M]?.name||` ${M+1} `:null,E=_.filter(oe=>oe.active).length,T=_.length-E,D=_.length>0?(E/_.length*100).toFixed(0):"0",O=_.reduce((oe,Ye)=>{const bt=Ye.category||"social";return oe[bt]||(oe[bt]=[]),oe[bt].push(Ye),oe},{}),q=r?.headTaxRates||{},I=r?.resourceTaxRates||{},Z=r?.resourceTariffMultipliers||{},Y=r?.businessTaxRates||{},[U,S]=Ls.useState({}),[Q,ne]=Ls.useState({}),[Ne,$e]=Ls.useState({}),[de,P]=Ls.useState({}),[z,V]=Ls.useState("head"),[F,re]=Ls.useState(null),[C,L]=Ls.useState(null),ie=Ls.useMemo(()=>Object.keys(Ke).filter(oe=>{const Ye=Ke[oe];return!(Ye.unlockEpoch!==void 0&&Ye.unlockEpoch>m||Ye.unlockTech&&!h.includes(Ye.unlockTech))}),[m,h]),H=Ls.useMemo(()=>ie.filter(oe=>oe==="unemployed"?!0:(b[oe]||0)>0),[ie,b]),ve=(oe,Ye)=>{S(bt=>({...bt,[oe]:Ye}))},me=oe=>{if(U[oe]===void 0)return;const Ye=parseFloat(U[oe]),bt=Number.isNaN(Ye)?1:Ye;o(Pe=>({...Pe,headTaxRates:{...Pe?.headTaxRates||{},[oe]:bt}})),S(Pe=>{const lt={...Pe};return delete lt[oe],lt})},X=(oe,Ye)=>{ne(bt=>({...bt,[oe]:Ye}))},qe=(oe,Ye)=>{$e(bt=>({...bt,[oe]:Ye}))},fe=oe=>{if(Q[oe]===void 0)return;const Ye=parseFloat(Q[oe]),Pe=(Number.isNaN(Ye)?0:Ye)/100;o(lt=>({...lt,resourceTaxRates:{...lt?.resourceTaxRates||{},[oe]:Pe}})),ne(lt=>{const Vt={...lt};return delete Vt[oe],Vt})},Je=oe=>{if(Ne[oe]===void 0)return;const Ye=parseFloat(Ne[oe]),bt=Number.isNaN(Ye)?1:Math.max(0,Ye);o?.(Pe=>({...Pe,resourceTariffMultipliers:{...Pe?.resourceTariffMultipliers||{},[oe]:bt}})),$e(Pe=>{const lt={...Pe};return delete lt[oe],lt})},tt=(oe,Ye)=>{P(bt=>({...bt,[oe]:Ye}))},Mt=oe=>{if(de[oe]===void 0)return;const Ye=parseFloat(de[oe]),bt=Number.isNaN(Ye)?1:Ye;o(Pe=>({...Pe,businessTaxRates:{...Pe?.businessTaxRates||{},[oe]:bt}})),P(Pe=>{const lt={...Pe};return delete lt[oe],lt})},jt=Ls.useMemo(()=>Object.keys(Re).filter(oe=>{const Ye=Re[oe];return Ye.type&&(Ye.type==="virtual"||Ye.type==="currency")?!1:si(oe,m,h)}),[m,h]),B=Ls.useMemo(()=>{if(jt.length===0)return[];const oe=[];return Object.values(mf).forEach(Ye=>{Ye.keys.forEach(bt=>{jt.includes(bt)&&oe.push(bt)})}),jt.forEach(Ye=>{oe.includes(Ye)||oe.push(Ye)}),oe},[jt]).map(oe=>[oe,Re[oe]]).filter(([,oe])=>oe&&(!oe.type||oe.type!=="virtual"&&oe.type!=="currency")),Ue=Ls.useMemo(()=>Ln.filter(oe=>(u[oe.id]||0)>0).sort((oe,Ye)=>{const bt=u[oe.id]||0,Pe=u[Ye.id]||0;return oe.cat!==Ye.cat?oe.cat.localeCompare(Ye.cat):Pe-bt}),[u]),ht=Ls.useMemo(()=>{const oe={gather:{name:"",buildings:[]},industry:{name:"",buildings:[]},civic:{name:"",buildings:[]}};return Ue.forEach(Ye=>{const bt=Ye.cat||"civic";oe[bt]&&oe[bt].buildings.push(Ye)}),oe},[Ue]),ft=oe=>{const Ye=Ke[oe]||{},bt=Ye.headTaxBase??.01,lt=(q[oe]??1)*bt,Vt=c[oe]||0,oa=Vt>0,Ka=lt<0,gn=lt>0;return a.jsxs("div",{className:`bg-gray-900/40 p-1.5 rounded-md border text-xs flex flex-col gap-1 ${oa?Ka?"border-green-700/60":gn?"border-yellow-700/60":"border-gray-700/60":"border-gray-800 opacity-60"}`,children:[a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(k,{name:Ye.icon||"User",size:14,className:"text-gray-400"}),a.jsx("span",{className:"font-semibold text-gray-300 flex-grow",children:Ye.name||oe}),a.jsxs("span",{className:"text-gray-500 text-[10px] font-mono",children:[Vt.toLocaleString()," "]})]}),a.jsx("div",{className:"flex items-center justify-center gap-0.5",children:Ka?a.jsxs(a.Fragment,{children:[a.jsx(k,{name:"TrendingDown",size:12,className:"text-green-400"}),a.jsxs("span",{className:"font-mono text-green-300 whitespace-nowrap text-[11px]",children:[" ",Math.abs(lt).toFixed(3),"/"]})]}):gn?a.jsxs(a.Fragment,{children:[a.jsx(k,{name:"TrendingUp",size:12,className:"text-yellow-400"}),a.jsxs("span",{className:"font-mono text-yellow-300 whitespace-nowrap text-[11px]",children:[lt.toFixed(3),"/"]})]}):a.jsx("span",{className:"font-mono text-gray-500 whitespace-nowrap text-[11px]",children:""})}),a.jsx("div",{className:"flex items-center gap-1",children:a.jsx("input",{type:"text",inputMode:"decimal",step:"0.05",value:U[oe]??q[oe]??1,onChange:Zt=>ve(oe,Zt.target.value),onBlur:()=>me(oe),onKeyDown:Zt=>{Zt.key==="Enter"&&(me(oe),Zt.target.blur())},className:"w-full bg-gray-900/70 border border-gray-600 text-[11px] text-gray-200 rounded px-1 py-0 focus:ring-1 focus:ring-blue-500 focus:border-blue-500 text-center",placeholder:""})})]},oe)},$t=new Set(Object.values(fy).flatMap(oe=>oe.keys)),It=(oe,Ye)=>{const bt=Ye.filter(([Pe])=>oe.keys.includes(Pe));return bt.length===0?null:a.jsxs("div",{className:"mb-4",children:[a.jsx("h5",{className:"text-xs font-semibold text-gray-400 mb-2",children:oe.name}),a.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 2xl:grid-cols-8 gap-2",children:bt.map(([Pe,lt])=>a.jsx(hy,{resourceKey:Pe,info:lt,rate:I[Pe],hasSupply:(p?.supply?.[Pe]||0)>0,draftRate:Q[Pe],tariffMultiplier:Z[Pe]??1,draftTariff:Ne[Pe],onDraftChange:X,onCommit:fe,onTariffDraftChange:qe,onTariffCommit:Je},Pe))})]},oe.name)};return a.jsxs("div",{className:"space-y-4",children:[o&&a.jsxs("div",{className:"glass-ancient p-4 rounded-xl border border-ancient-gold/30",children:[a.jsxs("h3",{className:"text-sm font-bold mb-3 flex items-center gap-2 text-gray-300 font-decorative",children:[a.jsx(k,{name:"DollarSign",size:16,className:"text-yellow-400"}),""]}),a.jsxs("div",{className:"flex flex-nowrap gap-2 mb-4 border-b border-gray-700 overflow-x-auto scrollbar-thin",children:[a.jsx("button",{onClick:()=>V("head"),className:`flex-1 min-w-[90px] px-4 py-2 text-sm font-semibold transition-all ${z==="head"?"text-yellow-300 border-b-2 border-yellow-400":"text-gray-400 hover:text-gray-300"}`,children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(k,{name:"Users",size:14}),""]})}),a.jsx("button",{onClick:()=>V("resource"),className:`flex-1 min-w-[90px] px-4 py-2 text-sm font-semibold transition-all ${z==="resource"?"text-blue-300 border-b-2 border-blue-400":"text-gray-400 hover:text-gray-300"}`,children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(k,{name:"Package",size:14}),""]})}),a.jsx("button",{onClick:()=>V("business"),className:`flex-1 min-w-[90px] px-4 py-2 text-sm font-semibold transition-all ${z==="business"?"text-green-300 border-b-2 border-green-400":"text-gray-400 hover:text-gray-300"}`,children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(k,{name:"Building",size:14}),""]})})]}),z==="head"&&a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"bg-blue-900/20 border border-blue-500/30 p-3 rounded-lg text-xs text-blue-100",children:[a.jsxs("p",{className:"flex items-center gap-2 mb-1",children:[a.jsx(k,{name:"Info",size:12,className:"text-blue-400"}),a.jsx("span",{className:"font-semibold",children:""})]}),a.jsx("p",{children:""})]}),Object.entries(fy).map(([oe,Ye])=>{const bt=H.filter(Pe=>Ye.keys.includes(Pe));return bt.length===0?null:a.jsxs("div",{children:[a.jsx("h4",{className:"text-xs font-semibold text-gray-400 mb-2",children:Ye.name}),a.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 gap-2",children:bt.map(Pe=>ft(Pe))})]},oe)}),H.filter(oe=>!$t.has(oe)).length>0&&a.jsxs("div",{children:[a.jsx("h4",{className:"text-xs font-semibold text-gray-400 mb-2",children:""}),a.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 gap-2",children:H.filter(oe=>!$t.has(oe)).map(oe=>ft(oe))})]})]}),z==="resource"&&a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"bg-blue-900/20 border border-blue-500/30 p-3 rounded-lg text-xs text-blue-100",children:[a.jsxs("p",{className:"flex items-center gap-2 mb-1",children:[a.jsx(k,{name:"Info",size:12,className:"text-blue-400"}),a.jsx("span",{className:"font-semibold",children:""})]}),a.jsx("p",{children:""})]}),Object.values(mf).map(oe=>It(oe,B)),B.filter(([oe])=>!my.has(oe)).length>0&&a.jsxs("div",{children:[a.jsx("h5",{className:"text-xs font-semibold text-gray-400 mb-2",children:""}),a.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 2xl:grid-cols-8 gap-2",children:B.filter(([oe])=>!my.has(oe)).map(([oe,Ye])=>a.jsx(hy,{resourceKey:oe,info:Ye,rate:I[oe],hasSupply:(p?.supply?.[oe]||0)>0,draftRate:Q[oe],tariffMultiplier:Z[oe]??1,draftTariff:Ne[oe],onDraftChange:X,onCommit:fe,onTariffDraftChange:qe,onTariffCommit:Je},oe))})]})]}),z==="business"&&a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"bg-blue-900/20 border border-blue-500/30 p-3 rounded-lg text-xs text-blue-100",children:[a.jsxs("p",{className:"flex items-center gap-2 mb-1",children:[a.jsx(k,{name:"Info",size:12,className:"text-blue-400"}),a.jsx("span",{className:"font-semibold",children:""})]}),a.jsx("p",{children:""})]}),Object.entries(ht).map(([oe,Ye])=>Ye.buildings.length===0?null:a.jsxs("div",{children:[a.jsx("h4",{className:"text-xs font-semibold text-gray-400 mb-2",children:Ye.name}),a.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 gap-2",children:Ye.buildings.map(bt=>a.jsx(cS,{building:bt,multiplier:Y[bt.id],buildingCount:u[bt.id]||0,draftMultiplier:de[bt.id],onDraftChange:tt,onCommit:Mt},bt.id))})]},oe)),Ue.length===0&&a.jsxs("div",{className:"text-center text-gray-500 py-8",children:[a.jsx(k,{name:"Building",size:32,className:"mx-auto mb-2 opacity-50"}),a.jsx("p",{className:"text-sm",children:""})]})]})]}),_.length===0&&a.jsxs("div",{className:"bg-yellow-900/20 border border-yellow-600/30 p-4 rounded-lg text-xs text-yellow-100",children:[a.jsxs("p",{className:"font-semibold mb-1 flex items-center gap-2",children:[a.jsx(k,{name:"Lock",size:14,className:"text-yellow-300"}),""]}),a.jsxs("p",{children:[" ",R||""," "]})]}),Object.entries(j).map(([oe,Ye])=>{const bt=O[oe]||[];return bt.length===0?null:a.jsxs("div",{className:"glass-ancient p-4 rounded-xl border border-ancient-gold/30",children:[a.jsxs("h3",{className:"text-sm font-bold mb-3 flex items-center gap-2 text-gray-300 font-decorative",children:[a.jsx(k,{name:Ye.icon,size:16,className:Ye.color}),Ye.name]}),a.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 2xl:grid-cols-8 gap-2",children:bt.map(Pe=>a.jsxs("div",{onClick:()=>x&&x(Pe),onMouseEnter:lt=>{L(lt.currentTarget.getBoundingClientRect()),re(Pe)},onMouseLeave:()=>{re(null),L(null)},className:`relative p-2 rounded-lg border transition-all cursor-pointer ${Pe.active?"bg-green-900/20 border-green-600 shadow-lg":"bg-gray-700/50 border-gray-600 hover:border-purple-500 hover:shadow-lg"}`,children:[a.jsxs("div",{className:"flex flex-col items-center mb-2",children:[a.jsx("div",{className:"w-12 h-12 icon-metal-container icon-metal-container-lg rounded-lg flex items-center justify-center mb-1",children:Pe.active?a.jsx(k,{name:"Check",size:24,className:"text-green-400 icon-metal-green"}):a.jsx(k,{name:"FileText",size:24,className:"text-purple-400 icon-metal-purple"})}),a.jsx("h4",{className:"text-xs font-bold text-white text-center leading-tight font-decorative",children:Pe.name}),Pe.active&&a.jsx("span",{className:"text-[10px] text-green-400 mt-0.5",children:""})]}),a.jsxs("div",{className:"space-y-1 text-[10px] mb-2",children:[Pe.effects&&Pe.effects.length>0&&a.jsxs("div",{className:"bg-green-900/30 rounded px-1.5 py-1 text-center text-green-300",children:[Pe.effects.length,""]}),Pe.drawbacks&&Pe.drawbacks.length>0&&a.jsxs("div",{className:"bg-red-900/30 rounded px-1.5 py-1 text-center text-red-300",children:[Pe.drawbacks.length,""]})]}),a.jsx("button",{onClick:lt=>{lt.stopPropagation(),s(Pe.id)},className:`w-full px-2 py-1 rounded text-[10px] font-semibold transition-all ${Pe.active?"bg-red-600 hover:bg-red-500 text-white":"bg-green-600 hover:bg-green-500 text-white"}`,children:a.jsxs("div",{className:"flex items-center justify-center gap-1",children:[a.jsx(k,{name:Pe.active?"X":"Check",size:10}),Pe.active?"":""]})})]},Pe.id))})]},oe)}),a.jsx(lS,{decree:F,anchorRect:C}),a.jsxs("div",{className:"glass-ancient p-4 rounded-xl border border-ancient-gold/30",children:[a.jsxs("h3",{className:"text-sm font-bold mb-2 flex items-center gap-2 text-gray-300 font-decorative",children:[a.jsx(k,{name:"FileText",size:16,className:"text-blue-400"}),""]}),a.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-3",children:[a.jsxs("div",{className:"bg-gray-700/50 p-3 rounded",children:[a.jsx("p",{className:"text-xs text-gray-400 mb-1",children:""}),a.jsx("p",{className:"text-lg font-bold text-white",children:_.length})]}),a.jsxs("div",{className:"bg-gray-700/50 p-3 rounded",children:[a.jsx("p",{className:"text-xs text-gray-400 mb-1",children:""}),a.jsx("p",{className:"text-lg font-bold text-green-400",children:E})]}),a.jsxs("div",{className:"bg-gray-700/50 p-3 rounded",children:[a.jsx("p",{className:"text-xs text-gray-400 mb-1",children:""}),a.jsx("p",{className:"text-lg font-bold text-gray-400",children:T})]}),a.jsxs("div",{className:"bg-gray-700/50 p-3 rounded",children:[a.jsx("p",{className:"text-xs text-gray-400 mb-1",children:""}),a.jsxs("p",{className:"text-lg font-bold text-blue-400",children:[D,"%"]})]}),a.jsxs("div",{className:"bg-gray-700/50 p-3 rounded",children:[a.jsx("p",{className:"text-xs text-gray-400 mb-1",children:""}),a.jsx("p",{className:"text-lg font-bold text-yellow-300",children:N.length})]})]}),N.length>0&&a.jsxs("p",{className:"text-[11px] text-gray-400 mt-3",children:[" ",N.length," ",R?` ${R}`:"",""]})]})]})},uS=({targetNation:t,allies:s=[],onConfirm:r,onCancel:o})=>{if(!t)return null;const c=s.length>0;return Ps.createPortal(a.jsxs("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4",children:[a.jsx("div",{className:"absolute inset-0 bg-black/70 backdrop-blur-sm",onClick:o}),a.jsxs("div",{className:"relative w-full max-w-md glass-monument border-2 border-red-500/40 rounded-2xl shadow-monument overflow-hidden animate-slide-up",children:[a.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-red-900/30 via-ancient-ink/70 to-red-900/20 opacity-80"}),a.jsxs("div",{className:"relative z-10",children:[a.jsx("div",{className:"p-4 border-b border-red-500/30 bg-gradient-to-r from-red-900/40 to-ancient-ink/60",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-12 h-12 rounded-xl bg-red-900/60 border border-red-500/30 flex items-center justify-center flex-shrink-0 shadow-inner",children:a.jsx(k,{name:"Swords",size:26,className:"text-red-400"})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h2",{className:"text-lg font-bold text-red-200 leading-tight",children:""}),a.jsxs("p",{className:"text-[11px] text-gray-300 leading-tight",children:[" ",t.name," "]})]}),a.jsx("button",{onClick:o,className:"p-2 rounded-full hover:bg-white/10 transition-colors text-gray-400",children:a.jsx(k,{name:"X",size:18})})]})}),a.jsxs("div",{className:"p-4 space-y-4",children:[a.jsxs("div",{className:"p-3 bg-gray-800/50 rounded-lg border border-gray-600/50",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[a.jsx(k,{name:"Flag",size:14,className:t.color||"text-gray-300"}),a.jsx("span",{className:"text-sm font-bold text-white",children:t.name}),a.jsxs("span",{className:"px-1.5 py-0.5 text-[9px] rounded bg-gray-700 text-gray-300",children:[": ",Math.round(t.relation)||0]})]}),t.desc&&a.jsx("p",{className:"text-[10px] text-gray-400 leading-relaxed",children:t.desc})]}),c&&a.jsxs("div",{className:"p-3 bg-orange-900/30 rounded-lg border border-orange-500/40",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[a.jsx(k,{name:"AlertTriangle",size:16,className:"text-orange-400"}),a.jsx("span",{className:"text-sm font-bold text-orange-200",children:""})]}),a.jsxs("p",{className:"text-[11px] text-orange-100 mb-3 leading-relaxed",children:[t.name,"  ",a.jsx("span",{className:"font-bold text-orange-300",children:s.length}),"  "]}),a.jsx("div",{className:"space-y-1.5",children:s.map(u=>a.jsxs("div",{className:"flex items-center justify-between p-2 bg-orange-900/40 rounded border border-orange-600/30",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(k,{name:"Flag",size:12,className:u.color||"text-orange-300"}),a.jsx("span",{className:"text-xs text-orange-100",children:u.name})]}),a.jsxs("span",{className:"text-[10px] text-orange-300",children:[": ",Math.round(u.foreignRelation)||80,"+"]})]},u.id))})]}),!c&&a.jsx("div",{className:"p-3 bg-gray-800/40 rounded-lg border border-gray-600/30",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(k,{name:"Info",size:14,className:"text-blue-400"}),a.jsxs("span",{className:"text-xs text-gray-300",children:[t.name," "]})]})}),a.jsx("div",{className:"p-2 bg-red-900/20 rounded border border-red-600/30",children:a.jsx("p",{className:"text-[10px] text-red-200 text-center",children:" "})})]}),a.jsxs("div",{className:"p-4 border-t border-gray-700/50 bg-gray-900/50 flex gap-3",children:[a.jsx("button",{onClick:o,className:"flex-1 px-4 py-2.5 bg-gray-600 hover:bg-gray-500 text-white rounded-lg text-sm font-bold transition-colors",children:""}),a.jsxs("button",{onClick:r,className:"flex-1 px-4 py-2.5 bg-red-600 hover:bg-red-500 text-white rounded-lg text-sm font-bold transition-colors flex items-center justify-center gap-2",children:[a.jsx(k,{name:"Swords",size:14}),c?` (${s.length+1})`:""]})]})]})]})]}),document.body)},pS=({tradeRoutes:t,nations:s,resources:r,market:o,taxPolicies:c,daysElapsed:u,epoch:p=0,onClose:m,onCancelRoute:h,onCreateRoute:x})=>{const[g,b]=$.useState("active"),j=$.useMemo(()=>Object.entries(Re).filter(([U,S])=>S.type!=="virtual"&&U!=="silver"&&(S.unlockEpoch??0)<=p),[p]),_=$.useMemo(()=>s.filter(U=>p>=(U.appearEpoch??0)&&(U.expireEpoch==null||p<=U.expireEpoch)&&!U.isAtWar),[s,p]),N=(U,S,Q)=>t?.routes?t.routes.some(ne=>ne.nationId===U&&ne.resource===S&&ne.type===Q):!1,M=(U,S,Q)=>{const ne=o?.prices?.[S]??(Re[S]?.basePrice||1),Ne=jl(S,U,u),$e=gl(S,U,u),de=.05,P=c?.resourceTaxRates?.[S]||0,z=Math.max(0,c?.resourceTariffMultipliers?.[S]??1),V=P*z,F=Re[S]?.name||S,re=N(U.id,S,Q);if(Q==="export"){const C=r[S]||0,L=Math.max(0,C-500),ie=$e.shortageAmount||0,H=Math.min(L,ie)*de,ve=Math.max(H,ie*de),me=ne*ve,X=me*V,fe=Ne*ve-me-X,Je=Ne-ne;return{nationId:U.id,nationName:U.name,resource:S,resourceName:F,type:"export",isActive:re,localPrice:ne,foreignPrice:Ne,priceDiff:Je,taxRevenue:H>.1&&fe>0?X:0,possibleVolume:H,shortage:ie,surplus:L,merchantMargin:fe,profitScore:Je>0?Je*Math.min(ie,1e3):0,status:H<.1?L<1?"":"":fe<=0?"":"",statusClass:H<.1||fe<=0?"text-gray-500":"text-green-400"}}else{const C=$e.surplusAmount||0,L=Math.min(C,500)*de,ie=ne-Ne,H=ie*L;return{nationId:U.id,nationName:U.name,resource:S,resourceName:F,type:"import",isActive:re,localPrice:ne,foreignPrice:Ne,priceDiff:ie,savingsPerDay:H,possibleVolume:L,surplus:C,profitScore:ie>0?ie*Math.min(C,1e3):0,status:L<.1?"":ie<=0?"":"",statusClass:L<.1?"text-gray-500":ie<=0?"text-yellow-500":"text-blue-400"}}},R=$.useMemo(()=>{const U=[];for(const S of _)for(const[Q]of j)U.push(M(S,Q,"export")),U.push(M(S,Q,"import"));return U},[_,j,o,r,c,u,t]),E=$.useMemo(()=>R.filter(U=>U.type==="export"&&U.profitScore>0).sort((U,S)=>S.profitScore-U.profitScore).slice(0,20),[R]),T=$.useMemo(()=>R.filter(U=>U.type==="import"&&U.profitScore>0).sort((U,S)=>S.profitScore-U.profitScore).slice(0,20),[R]),D=$.useMemo(()=>(t.routes||[]).map(U=>{const S=s.find(Q=>Q.id===U.nationId);return S?{...U,opportunity:M(S,U.resource,U.type)}:{...U,economics:null}}),[t.routes,s,o,r,c,u]),O=E.length,q=T.length,I=[{id:"active",label:"",count:D.length,icon:"List"},{id:"bestExport",label:"",count:O,icon:"ArrowUpRight"},{id:"bestImport",label:"",count:q,icon:"ArrowDownLeft"}],Z=(U,S,Q=!1)=>{const ne=U.type==="export";return a.jsxs("div",{className:`grid grid-cols-12 gap-1 sm:gap-2 items-center p-2 sm:p-3 rounded-lg ${U.isActive?"bg-amber-900/30 border-amber-500/30":"bg-gray-800/40 border-white/5"} hover:bg-gray-800/60 border hover:border-white/10 transition-colors text-xs sm:text-sm`,children:[Q&&a.jsx("div",{className:"col-span-1 text-center",children:a.jsx("span",{className:`inline-flex items-center justify-center w-5 h-5 sm:w-6 sm:h-6 rounded text-[10px] sm:text-xs font-bold ${S===0?"bg-yellow-500/30 text-yellow-300":S===1?"bg-gray-400/30 text-gray-300":S===2?"bg-amber-700/30 text-amber-400":"bg-gray-700/30 text-gray-500"}`,children:S+1})}),a.jsx("div",{className:`${Q?"col-span-2":"col-span-3"} font-medium text-gray-200 truncate`,title:U.nationName,children:U.nationName}),a.jsx("div",{className:"col-span-2 flex items-center gap-1",children:a.jsx("span",{className:"text-gray-300 truncate",children:U.resourceName})}),a.jsx("div",{className:"col-span-3 text-right",children:a.jsxs("div",{className:"flex flex-col items-end",children:[a.jsx("span",{className:`font-mono text-[10px] sm:text-xs ${U.priceDiff>0?"text-green-400":U.priceDiff<0?"text-red-400":"text-gray-400"}`,children:ne?a.jsxs(a.Fragment,{children:[": ",U.foreignPrice.toFixed(1)," (",U.priceDiff>0?"+":"",U.priceDiff.toFixed(1),")"]}):a.jsxs(a.Fragment,{children:[": ",U.foreignPrice.toFixed(1)," (",U.priceDiff>0?"-":"+",Math.abs(U.priceDiff).toFixed(1),")"]})}),a.jsxs("span",{className:"text-[9px] sm:text-[10px] text-gray-500",children:[": ",U.localPrice.toFixed(1)]})]})}),a.jsxs("div",{className:"col-span-2 text-center",children:[a.jsx("span",{className:`text-[10px] sm:text-xs ${U.statusClass}`,children:U.status}),U.possibleVolume>.1&&a.jsxs("div",{className:"text-[9px] text-gray-500",children:[U.possibleVolume.toFixed(1),"/"]})]}),a.jsx("div",{className:"col-span-2 flex justify-center",children:U.isActive?a.jsx("button",{onClick:()=>h(U.nationId,U.resource,U.type),className:"p-1 sm:p-1.5 rounded bg-red-500/10 hover:bg-red-500/20 text-red-400 border border-red-500/20 transition-colors",title:"",children:a.jsx(k,{name:"X",size:12})}):x?a.jsx("button",{onClick:()=>x(U.nationId,U.resource,U.type),className:`p-1 sm:p-1.5 rounded ${ne?"bg-green-500/10 hover:bg-green-500/20 text-green-400 border border-green-500/20":"bg-blue-500/10 hover:bg-blue-500/20 text-blue-400 border border-blue-500/20"} transition-colors`,title:"",children:a.jsx(k,{name:"Plus",size:12})}):a.jsx("span",{className:"text-[10px] text-gray-600",children:"-"})})]},`${U.nationId}-${U.resource}-${U.type}-${S}`)},Y=(U,S)=>{const Q=U.opportunity;return Q?Z(Q,S,!1):a.jsxs("div",{className:"p-3 bg-gray-800/40 rounded-lg text-gray-500 text-sm flex items-center justify-between group",children:[a.jsx("span",{children:""}),a.jsxs("button",{onClick:()=>h(U.nationId,U.resource,U.type),className:"px-2 py-1 bg-red-600/20 hover:bg-red-600/40 text-red-400 rounded text-xs transition-colors flex items-center gap-1",children:[a.jsx(k,{name:"Trash",size:12}),a.jsx("span",{className:"opacity-0 group-hover:opacity-100 transition-opacity",children:""})]})]},S)};return $.useEffect(()=>{const U=D.filter(S=>S.economics===null);if(U.length>0){const S=U[0];if(h){const Q=setTimeout(()=>{h(S.nationId,S.resource,S.type)},0);return()=>clearTimeout(Q)}}},[D,h]),Ps.createPortal(a.jsxs("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-2 sm:p-4",children:[a.jsx("div",{className:"absolute inset-0 bg-black/70 backdrop-blur-sm",onClick:m}),a.jsxs("div",{className:"relative w-full max-w-2xl glass-panel border-2 border-amber-500/30 rounded-2xl shadow-2xl overflow-hidden animate-slide-up bg-gray-900/90 max-h-[90vh] flex flex-col",children:[a.jsxs("div",{className:"p-3 sm:p-4 border-b border-amber-500/20 bg-gradient-to-r from-amber-900/40 to-gray-900/60 flex items-center justify-between flex-shrink-0",children:[a.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[a.jsx("div",{className:"w-8 h-8 sm:w-10 sm:h-10 rounded-lg bg-amber-500/20 flex items-center justify-center border border-amber-500/30",children:a.jsx(k,{name:"TrendingUp",size:18,className:"text-amber-400"})}),a.jsxs("div",{children:[a.jsx("h2",{className:"text-base sm:text-xl font-bold text-amber-100",children:""}),a.jsx("p",{className:"text-[10px] sm:text-xs text-gray-400 hidden sm:block",children:""})]})]}),a.jsx("button",{onClick:m,className:"p-2 rounded-full hover:bg-white/10 transition-colors text-gray-400 hover:text-white",children:a.jsx(k,{name:"X",size:18})})]}),a.jsx("div",{className:"flex border-b border-white/10 bg-gray-800/50 flex-shrink-0",children:I.map(U=>a.jsxs("button",{onClick:()=>b(U.id),className:`flex-1 flex items-center justify-center gap-1 sm:gap-2 px-2 sm:px-4 py-2 sm:py-3 text-xs sm:text-sm font-medium transition-all ${g===U.id?"text-amber-300 border-b-2 border-amber-400 bg-amber-500/10":"text-gray-400 hover:text-gray-200 hover:bg-white/5"}`,children:[a.jsx(k,{name:U.icon,size:14}),a.jsx("span",{className:"hidden xs:inline sm:inline",children:U.label}),a.jsx("span",{className:`px-1 sm:px-1.5 py-0.5 rounded text-[10px] sm:text-xs ${g===U.id?"bg-amber-500/20 text-amber-200":"bg-gray-700 text-gray-400"}`,children:U.count})]},U.id))}),a.jsxs("div",{className:"grid grid-cols-12 gap-1 sm:gap-2 px-3 sm:px-6 py-2 bg-white/5 text-[10px] sm:text-xs font-bold text-gray-400 uppercase tracking-wider border-b border-white/5 flex-shrink-0",children:[g!=="active"&&a.jsx("div",{className:"col-span-1 text-center",children:"#"}),a.jsx("div",{className:`${g!=="active"?"col-span-2":"col-span-3"}`,children:""}),a.jsx("div",{className:"col-span-2",children:""}),a.jsx("div",{className:"col-span-3 text-right",children:""}),a.jsx("div",{className:"col-span-2 text-center",children:""}),a.jsx("div",{className:"col-span-2 text-center",children:""})]}),a.jsxs("div",{className:"flex-1 overflow-y-auto p-2 sm:p-4 space-y-1 sm:space-y-2 custom-scrollbar",children:[g==="active"&&(D.length===0?a.jsxs("div",{className:"text-center py-8 sm:py-12 text-gray-500",children:[a.jsx(k,{name:"Route",size:40,className:"mx-auto mb-3 opacity-20"}),a.jsx("p",{className:"text-sm",children:""}),a.jsx("p",{className:"text-xs mt-1",children:'""""'})]}):D.map((U,S)=>Y(U,S))),g==="bestExport"&&(E.length===0?a.jsxs("div",{className:"text-center py-8 sm:py-12 text-gray-500",children:[a.jsx(k,{name:"ArrowUpRight",size:40,className:"mx-auto mb-3 opacity-20"}),a.jsx("p",{className:"text-sm",children:""}),a.jsx("p",{className:"text-xs mt-1",children:""})]}):E.map((U,S)=>Z(U,S,!0))),g==="bestImport"&&(T.length===0?a.jsxs("div",{className:"text-center py-8 sm:py-12 text-gray-500",children:[a.jsx(k,{name:"ArrowDownLeft",size:40,className:"mx-auto mb-3 opacity-20"}),a.jsx("p",{className:"text-sm",children:""}),a.jsx("p",{className:"text-xs mt-1",children:""})]}):T.map((U,S)=>Z(U,S,!0)))]}),a.jsxs("div",{className:"p-2 sm:p-4 border-t border-white/5 bg-gray-900/50 flex justify-between items-center text-[10px] sm:text-xs text-gray-500 flex-shrink-0",children:[a.jsxs("div",{className:"flex gap-2 sm:gap-4",children:[a.jsxs("span",{children:[": ",a.jsx("span",{className:"text-amber-300",children:D.length})]}),a.jsxs("span",{className:"hidden sm:inline",children:[": ",a.jsx("span",{className:"text-green-400",children:O})]}),a.jsxs("span",{className:"hidden sm:inline",children:[": ",a.jsx("span",{className:"text-blue-400",children:q})]})]}),a.jsx("button",{onClick:m,className:"px-3 sm:px-4 py-1.5 sm:py-2 bg-gray-700 hover:bg-gray-600 text-gray-200 rounded transition-colors text-xs",children:""})]})]})]}),document.body)},Pp=(t=0,s=!1)=>s?{label:"",color:"text-green-300",bg:"bg-green-900/20"}:t>=80?{label:"",color:"text-emerald-300",bg:"bg-emerald-900/20"}:t>=60?{label:"",color:"text-blue-300",bg:"bg-blue-900/20"}:t>=40?{label:"",color:"text-gray-300",bg:"bg-gray-800/40"}:t>=20?{label:"",color:"text-yellow-300",bg:"bg-yellow-900/20"}:{label:"",color:"text-red-300",bg:"bg-red-900/20"},fS=(t=0,s=!1)=>s?5:t>=80?4:t>=60?3:t>=40?2:t>=20?1:0,mS=(t=[],s)=>t.filter(r=>r.nationId===s).length,xy=(t,s="")=>Number.isFinite(t)?t>=1e6?`${(t/1e6).toFixed(1)}M${s}`:t>=1e3?`${(t/1e3).toFixed(1)}K${s}`:`${Math.max(0,Math.floor(t))}${s}`:`${s}`,hS=500,xS=t=>t?.economyTraits?.resourceBias?Object.entries(t.economyTraits.resourceBias).filter(([,s])=>s>1.05).sort((s,r)=>r[1]-s[1]).map(([s,r])=>({key:s,bias:r,name:Re[s]?.name||s,icon:Re[s]?.icon||"Box",color:Re[s]?.color||"text-gray-300"})):[],gS=({nations:t=[],epoch:s=0,market:r={},resources:o={},daysElapsed:c=0,onDiplomaticAction:u,tradeRoutes:p={routes:[]},onTradeRouteAction:m,playerInstallmentPayment:h=null,jobsAvailable:x={},popStructure:g={},taxPolicies:b={}})=>{const[j,_]=$.useState(null),[N,M]=$.useState(10),[R,E]=$.useState(!1),[T,D]=$.useState(null),[O,q]=$.useState(!1),[I,Z]=$.useState(!1),Y=$.useMemo(()=>Object.entries(Re).filter(([X,qe])=>qe.type!=="virtual"&&X!=="silver"&&(qe.unlockEpoch??0)<=s),[s]),U=$.useMemo(()=>t.filter(X=>s>=(X.appearEpoch??0)&&(X.expireEpoch==null||s<=X.expireEpoch)),[t,s]);$.useEffect(()=>{!j&&U.length>0?_(U[0].id):j&&!U.some(X=>X.id===j)&&_(U[0]?.id||null)},[j,U]);const S=U.find(X=>X.id===j)||U[0]||null,Q=S?Pp(S.relation,S.alliedWithPlayer===!0):null,ne=$.useMemo(()=>xS(S),[S]),Ne=U.filter(X=>X.alliedWithPlayer===!0).length,$e=U.filter(X=>X.isAtWar).length,de=x?.merchant||0,P=g?.merchant||0,z=p.routes.length,V=Math.min(z,P),F=(X,qe,fe)=>!p||!p.routes||!Array.isArray(p.routes)?!1:p.routes.some(Je=>Je.nationId===X&&Je.resource===qe&&Je.type===fe),re=(X,qe)=>{if(!S||!m)return;F(S.id,X,qe)?m(S.id,"cancel",{resource:X,type:qe}):m(S.id,"create",{resource:X,type:qe})},C=(X,qe,fe)=>{u&&u(X,qe,fe)},L=()=>{!S||!T||!u||(u(S.id,"provoke",{targetNationId:T}),E(!1),D(null))},ie=$.useMemo(()=>S?U.filter(X=>X.id!==S.id):[],[U,S]),H=$.useMemo(()=>S?U.filter(X=>X.id===S.id?!1:(S.allies||[]).includes(X.id)||(X.allies||[]).includes(S.id)).map(X=>({...X,foreignRelation:S.foreignRelations?.[X.id]??50})):[],[U,S]),ve=X=>r?.prices?.[X]??(Re[X]?.basePrice||1),me=X=>X?.isAtWar?(X.warScore||0)>0?"":(X.warScore||0)<0?"":"":null;return a.jsxs("div",{className:"space-y-2 font-body",children:[a.jsxs("div",{className:"hidden md:flex gap-2 text-xs font-epic",children:[a.jsxs("div",{className:"bg-gray-800/60 px-2 py-1 rounded border border-gray-700",children:[a.jsx("span",{className:"text-gray-400 font-body",children:":"}),a.jsx("span",{className:"text-white font-semibold ml-1 font-epic",children:U.length})]}),a.jsxs("div",{className:"bg-green-900/20 px-2 py-1 rounded border border-green-600/20",children:[a.jsx("span",{className:"text-gray-400 font-body",children:":"}),a.jsx("span",{className:"text-green-300 font-semibold ml-1 font-epic",children:Ne})]}),a.jsxs("div",{className:"bg-red-900/20 px-2 py-1 rounded border border-red-600/30",children:[a.jsx("span",{className:"text-gray-400 font-body",children:":"}),a.jsx("span",{className:"text-red-300 font-semibold ml-1 font-epic",children:$e})]}),a.jsxs("div",{className:"bg-blue-900/20 px-2 py-1 rounded border border-blue-600/20 flex items-center gap-2",children:[a.jsx("span",{className:"text-gray-400 font-body",children:":"}),a.jsxs("span",{className:`font-semibold ml-1 font-epic ${V<z?"text-yellow-300":"text-blue-300"}`,children:[V,"/",z]}),a.jsxs("span",{className:"text-gray-500 text-[10px] ml-1 font-body",children:["(:",de,")"]}),a.jsxs("button",{onClick:()=>Z(!0),className:"ml-auto flex items-center gap-1 px-2 py-0.5 bg-amber-600 hover:bg-amber-500 text-white text-[10px] rounded shadow-sm border border-amber-400/50 transition-all active:scale-95",children:[a.jsx(k,{name:"Settings",size:10}),a.jsx("span",{className:"font-bold",children:""})]})]}),a.jsxs("div",{className:"bg-amber-900/20 px-2 py-1 rounded border border-amber-600/20",children:[a.jsx("span",{className:"text-gray-400 font-body",children:":"}),a.jsxs("span",{className:"text-amber-300 font-semibold ml-1 font-epic",children:[P,"/",de]})]})]}),a.jsxs("div",{className:"md:hidden flex items-center justify-between gap-2 bg-gray-800/60 px-3 py-2 rounded-lg border border-gray-700 text-xs",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx("span",{className:"text-gray-400",children:":"}),a.jsxs("span",{className:`font-semibold ${V<z?"text-yellow-300":"text-blue-300"}`,children:[V,"/",z]})]}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx("span",{className:"text-gray-400",children:":"}),a.jsxs("span",{className:"text-amber-300 font-semibold",children:[P,"/",de]})]})]}),a.jsxs("button",{onClick:()=>Z(!0),className:"flex items-center gap-1.5 px-3 py-1.5 bg-amber-600 hover:bg-amber-500 text-white text-xs rounded shadow-sm border border-amber-400/50 transition-all active:scale-95",children:[a.jsx(k,{name:"Settings",size:14}),a.jsx("span",{className:"font-bold",children:""})]})]}),a.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-3 gap-3 h-[calc(100vh-260px)] md:h-[900px]",children:[a.jsxs("div",{className:"glass-ancient rounded-xl border border-ancient-gold/30 flex flex-col overflow-hidden",children:[a.jsx("div",{className:"px-2 py-1.5 border-b border-gray-700/80 text-[15px] uppercase tracking-wide text-gray-400 font-decorative font-bold",children:""}),a.jsxs("div",{className:"flex-1 overflow-y-auto scrollbar-thin scrollbar-thumb-gray-600 scrollbar-track-gray-900 hover:scrollbar-thumb-gray-500",children:[U.map((X,qe)=>{if(!X)return null;const fe=Pp(X.relation||0,X.alliedWithPlayer===!0),Je=X.id===S?.id;return a.jsxs("button",{onClick:()=>_(X.id),className:`w-full flex items-center gap-2 px-2 py-1.5 text-left transition-colors border-b border-gray-700/60 focus:outline-none font-body ${Je?"bg-blue-900/30 border-l-2 border-l-blue-400":"hover:bg-gray-800/60"} ${qe===U.length-1?"border-b-0":""}`,children:[a.jsx(k,{name:"Flag",size:14,className:X.color||"text-gray-300"}),a.jsx("div",{className:"flex-1 min-w-0",children:a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsx("span",{className:"text-xs font-semibold text-white truncate",children:X.name||""}),a.jsx("span",{className:`px-1 py-0.5 rounded text-[9px] ${fe.bg} ${fe.color} font-epic`,children:fe.label}),X.isRebelNation&&a.jsx("span",{className:"px-1 py-0.5 rounded text-[9px] bg-red-900 text-red-100 font-epic",children:""})]})}),a.jsx(k,{name:X.isAtWar===!0?"Swords":"ShieldCheck",size:12,className:X.isAtWar===!0?"text-red-400":"text-green-400"})]},X.id)}),U.length===0&&a.jsx("div",{className:"p-3 text-xs text-gray-400 font-body",children:""})]})]}),a.jsx("div",{className:"xl:col-span-2 space-y-2 max-h-[calc(100vh-180px)] md:max-h-[900px] overflow-y-auto pr-1 scrollbar-thin scrollbar-thumb-gray-600 scrollbar-track-gray-800 hover:scrollbar-thumb-gray-500",children:S?a.jsxs(Ls.Fragment,{children:[a.jsxs("div",{className:"bg-gray-800/60 p-2 rounded-lg border border-gray-700",children:[a.jsxs("div",{className:"flex items-center justify-between gap-2 mb-2",children:[a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsx(k,{name:"Globe",size:14,className:"text-amber-300"}),a.jsx("h3",{className:"text-sm font-bold text-white font-decorative",children:S?.name||""}),S?.type&&a.jsx("span",{className:"px-1.5 py-0.5 text-[9px] rounded bg-indigo-900/40 text-indigo-300 border border-indigo-500/30 font-epic",children:S.type}),Q&&a.jsx("span",{className:`px-1.5 py-0.5 text-[9px] rounded ${Q.bg} ${Q.color} font-epic`,children:Q.label})]}),a.jsx(k,{name:S?.isAtWar===!0?"Swords":"ShieldCheck",size:14,className:S?.isAtWar===!0?"text-red-400":"text-green-400"})]}),S?.desc&&a.jsx("div",{className:"mb-2 p-2 bg-gray-900/40 rounded border border-gray-700/50",children:a.jsxs("p",{className:"text-[11px] text-gray-300 leading-relaxed font-body",children:[a.jsx(k,{name:"BookOpen",size:10,className:"inline mr-1 text-amber-300"}),S.desc]})}),a.jsxs("div",{className:"grid grid-cols-2 gap-1 mb-2 text-xs font-body",children:[a.jsxs("div",{className:"p-2 rounded border border-blue-500/20 bg-blue-900/10 flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-1 text-blue-200 font-body",children:[a.jsx(k,{name:"Users",size:12}),""]}),a.jsx("span",{className:"font-mono text-blue-100 font-semibold font-epic",children:xy(S?.population,"")})]}),a.jsxs("div",{className:"p-2 rounded border border-amber-500/20 bg-amber-900/10 flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-1 text-amber-200 font-body",children:[a.jsx(k,{name:"Coins",size:12}),""]}),a.jsx("span",{className:"font-mono text-amber-100 font-semibold font-epic",children:xy(S?.wealth," ")})]})]}),(()=>{const X=S?.relation||0,qe=(S?.militaryStrength??1)*(S?.population||100)*(1+(S?.aggression||.3)),Je=1-Math.max(.1,X/100),tt=`${S?.id||"unknown"}-${Math.floor(c/30)}`;let Mt=0;for(let Ue=0;Ue<tt.length;Ue++)Mt=(Mt<<5)-Mt+tt.charCodeAt(Ue),Mt|=0;const jt=Math.abs(Mt)%1e3/1e3-.5,ot=Math.floor(qe*(1+jt*Je*2)),B=X>=60?` ${ot}`:X>=40?`${Math.floor(ot*.8)} - ${Math.floor(ot*1.2)}`:X>=20?"":"";return a.jsxs("div",{className:"p-2 rounded border border-red-500/20 bg-red-900/10 flex items-center justify-between mb-2",children:[a.jsxs("div",{className:"flex items-center gap-1 text-red-200 font-body",children:[a.jsx(k,{name:"Swords",size:12}),""]}),a.jsx("span",{className:`font-mono font-semibold font-epic ${X>=60?"text-green-300":X>=40?"text-yellow-300":"text-gray-400"}`,children:B})]})})(),S?.foreignWars&&Object.keys(S.foreignWars).some(X=>S.foreignWars[X]?.isAtWar)&&a.jsxs("div",{className:"p-2 rounded border border-orange-500/20 bg-orange-900/10 mb-2",children:[a.jsxs("div",{className:"flex items-center gap-1 text-orange-200 font-body mb-1",children:[a.jsx(k,{name:"Flame",size:12}),""]}),a.jsx("div",{className:"flex flex-wrap gap-1",children:Object.keys(S.foreignWars).filter(X=>S.foreignWars[X]?.isAtWar).map(X=>{const qe=t.find(fe=>fe.id===X);return qe?a.jsxs("span",{className:"px-1.5 py-0.5 rounded bg-red-900/40 text-red-200 text-[10px] font-body",children:[" ",qe.name]},X):null})})]}),a.jsxs("div",{className:"flex gap-1.5 text-xs font-body",children:[a.jsxs("button",{className:"flex-1 px-2 py-1.5 bg-green-600 hover:bg-green-500 rounded text-white flex items-center justify-center gap-1 font-semibold font-body",onClick:()=>C(S.id,"gift"),children:[a.jsx(k,{name:"Gift",size:12})," "]}),a.jsxs("button",{className:"flex-1 px-2 py-1.5 bg-yellow-600 hover:bg-yellow-500 rounded text-white flex items-center justify-center gap-1 font-semibold font-body",onClick:()=>C(S.id,"demand"),children:[a.jsx(k,{name:"ShieldAlert",size:12})," "]}),a.jsxs("button",{className:`flex-1 px-2 py-1.5 rounded text-white flex items-center justify-center gap-1 font-semibold font-body ${S.isAtWar?"bg-purple-600 hover:bg-purple-500":"bg-red-600 hover:bg-red-500"}`,onClick:()=>{S?.isAtWar===!0?C(S.id,"peace"):q(!0)},children:[a.jsx(k,{name:S?.isAtWar===!0?"Flag":"Swords",size:12}),S?.isAtWar===!0?"":""]})]}),a.jsx("div",{className:"mt-1.5 flex gap-1.5 text-xs font-body",children:a.jsxs("button",{className:"flex-1 px-2 py-1.5 bg-indigo-600 hover:bg-indigo-500 rounded text-white flex items-center justify-center gap-1 font-semibold font-body",onClick:()=>{D(null),E(!0)},title:"",children:[a.jsx(k,{name:"MessageSquareWarning",size:12})," "]})}),a.jsx("div",{className:"mt-1.5 flex gap-1.5 text-xs font-body",children:S?.alliedWithPlayer===!0?a.jsxs("button",{className:"flex-1 px-2 py-1.5 bg-red-700 hover:bg-red-600 rounded text-white flex items-center justify-center gap-1 font-semibold font-body",onClick:()=>C(S.id,"break_alliance"),title:"",children:[a.jsx(k,{name:"UserMinus",size:12})," "]}):a.jsxs("button",{className:`flex-1 px-2 py-1.5 rounded text-white flex items-center justify-center gap-1 font-semibold font-body ${(S?.relation||0)>=60&&!S?.isAtWar?"bg-emerald-600 hover:bg-emerald-500":"bg-gray-600 cursor-not-allowed"}`,onClick:()=>C(S.id,"propose_alliance"),disabled:(S?.relation||0)<60||S?.isAtWar,title:(S?.relation||0)<60?`60${Math.round(S?.relation||0)}`:S?.isAtWar?"":"",children:[a.jsx(k,{name:"Users",size:12})," "]})}),a.jsx("div",{className:"mt-1 text-[10px] text-gray-400 flex items-center justify-between font-epic",children:a.jsxs("span",{className:"flex items-center gap-1",children:[a.jsx(k,{name:"Coins",size:10,className:"text-amber-300"}),"",hS,"  | 300 "]})}),ne.length>0&&a.jsxs("div",{className:"mt-2",children:[a.jsxs("div",{className:"text-[10px] text-gray-400 uppercase tracking-wide mb-1 flex items-center gap-1 font-decorative",children:[a.jsx(k,{name:"Package",size:10,className:"text-amber-300"}),""]}),a.jsx("div",{className:"flex flex-wrap gap-1",children:ne.slice(0,4).map(X=>a.jsxs("span",{className:"px-2 py-0.5 rounded-full bg-gray-900/40 border border-amber-500/30 text-[10px] text-amber-100 flex items-center gap-1 font-body",title:` x${X.bias.toFixed(1)}`,children:[a.jsx(k,{name:X.icon,size:10,className:X.color||"text-amber-200"}),a.jsx("span",{className:"font-body",children:X.name}),a.jsxs("span",{className:"text-amber-300 font-mono text-[9px] font-epic",children:["x",X.bias.toFixed(1)]})]},X.key))})]}),S?.specialAbilities&&S.specialAbilities.length>0&&a.jsxs("div",{className:"mt-2",children:[a.jsxs("div",{className:"text-[10px] text-gray-400 uppercase tracking-wide mb-1 flex items-center gap-1 font-decorative",children:[a.jsx(k,{name:"Sparkles",size:10,className:"text-purple-300"}),""]}),a.jsx("div",{className:"flex flex-wrap gap-1",children:S.specialAbilities.map((X,qe)=>a.jsxs("span",{className:"px-2 py-0.5 rounded-full bg-purple-900/30 border border-purple-500/30 text-[10px] text-purple-200 flex items-center gap-1 font-body",title:X.desc,children:[a.jsx(k,{name:"Zap",size:10,className:"text-purple-300"}),a.jsx("span",{className:"font-body",children:X.desc})]},qe))})]})]}),a.jsx("div",{className:"bg-gray-800/60 p-2 rounded-lg border border-gray-700",children:(()=>{const X=S?.relation||0,qe=S?.alliedWithPlayer===!0,fe=S?.openMarketUntil&&c<S.openMarketUntil,Je=fe?S.openMarketUntil-c:0,tt=fe?999:fS(X,qe),Mt=mS(p.routes,S?.id);return a.jsxs(Ls.Fragment,{children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsxs("h3",{className:"text-xs font-bold text-white flex items-center gap-1 font-decorative",children:[a.jsx(k,{name:"Route",size:12,className:"text-blue-300"}),""]}),a.jsxs("div",{className:"text-[10px] text-gray-400 font-body",children:[a.jsx("div",{className:"font-body",children:""}),a.jsxs("div",{className:"mt-0.5 font-epic",children:[a.jsxs("span",{className:V<z?"text-yellow-400":"text-blue-400",children:[": ",V,"/",z]}),a.jsx("span",{className:"text-gray-500 mx-1",children:"|"}),a.jsxs("span",{className:z>=de?"text-red-400":"text-green-400",children:[": ",de]}),a.jsx("span",{className:"text-gray-500 mx-1",children:"|"}),a.jsxs("span",{className:"text-amber-400",children:[": ",P,"/",de]})]})]}),"                      "]}),a.jsxs("div",{className:`mb-2 p-2 rounded border ${fe?"bg-green-900/30 border-green-600/30":"bg-indigo-900/30 border-indigo-600/30"}`,children:[a.jsxs("div",{className:"flex items-center justify-between text-[10px]",children:[a.jsxs("span",{className:`flex items-center gap-1 font-body ${fe?"text-green-300":"text-indigo-300"}`,children:[a.jsx(k,{name:fe?"Store":"Heart",size:10})," ",S?.name," "]}),a.jsx("span",{className:`font-epic ${fe?"text-green-300":Mt>=tt?"text-red-300":"text-green-300"}`,children:fe?`${Mt}/`:`${Mt}/${tt}`})]}),fe?a.jsxs("div",{className:"text-[9px] text-green-400 mt-1 font-body",children:["  ",Math.ceil(Je/365),"  ",Je%365," ",a.jsx("span",{className:"text-green-300 ml-1",children:"()"})]}):a.jsx("div",{className:"text-[9px] text-gray-400 mt-1 font-body",children:qe?a.jsxs("span",{className:"text-green-400",children:["    ",tt," "]}):a.jsxs(a.Fragment,{children:[" ",Math.round(X),"   ",tt," ",tt===0&&a.jsx("span",{className:"text-red-400 ml-1",children:"()"}),tt===1&&a.jsx("span",{className:"text-yellow-400 ml-1",children:"()"}),tt===2&&a.jsx("span",{className:"text-gray-300 ml-1",children:"()"}),tt===3&&a.jsx("span",{className:"text-blue-400 ml-1",children:"()"}),tt===4&&a.jsx("span",{className:"text-emerald-400 ml-1",children:"()"})]})})]}),V<z&&a.jsxs("div",{className:"mb-2 p-2 bg-yellow-900/30 border border-yellow-600/30 rounded text-[10px] text-yellow-300 font-body",children:[a.jsx(k,{name:"AlertTriangle",size:12,className:"inline mr-1"})," ",z-V," "]}),z>=de&&a.jsxs("div",{className:"mb-2 p-2 bg-red-900/30 border border-red-600/30 rounded text-[10px] text-red-300 font-body",children:[a.jsx(k,{name:"AlertCircle",size:12,className:"inline mr-1"}),""]}),Mt>=tt&&tt>0&&a.jsxs("div",{className:"mb-2 p-2 bg-purple-900/30 border border-purple-600/30 rounded text-[10px] text-purple-300 font-body",children:[a.jsx(k,{name:"UserX",size:12,className:"inline mr-1"})," ",S?.name," ",tt,""]}),tt===0&&a.jsxs("div",{className:"mb-2 p-2 bg-red-900/30 border border-red-600/30 rounded text-[10px] text-red-300 font-body",children:[a.jsx(k,{name:"Ban",size:12,className:"inline mr-1"})," ",S?.name," 20"]}),a.jsx("div",{className:"space-y-1",children:Y.map(([jt,ot])=>{if(!S)return null;const B=ve(jt),Ue=jl(jt,S,c),ht=Ue-B,ft=gl(jt,S,c)||{},$t=Math.floor(ft.shortageAmount||0),It=Math.floor(ft.surplusAmount||0),oe=$t>9999?"9999+":$t,Ye=It>9999?"9999+":It;if(!((ot.unlockEpoch??0)<=s))return null;const Pe=S?.isAtWar||!1,lt=F(S.id,jt,"export"),Vt=F(S.id,jt,"import"),oa=Mt>=tt;return a.jsxs("div",{className:"bg-gray-900/40 rounded p-1.5 border border-gray-700/50",children:[a.jsxs("div",{className:"flex items-center justify-between mb-1",children:[a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsx(k,{name:ot.icon||"Box",size:12,className:ot.color||"text-gray-400"}),a.jsx("span",{className:"text-xs font-semibold text-white font-body",children:ot.name})]}),a.jsxs("div",{className:"flex items-center gap-1 text-[10px] font-epic",children:[ft.isShortage&&a.jsxs("span",{className:"text-red-400 font-mono",children:["",oe]}),ft.isSurplus&&a.jsxs("span",{className:"text-green-400 font-mono",children:["",Ye]})]})]}),a.jsxs("div",{className:"flex items-center justify-between text-[10px]",children:[a.jsxs("div",{className:"flex gap-2 text-gray-400 font-body",children:[a.jsxs("span",{children:[": ",a.jsx("span",{className:"text-white font-mono font-epic",children:B.toFixed(1)})]}),a.jsxs("span",{children:[": ",a.jsx("span",{className:`font-mono font-epic ${ht>0?"text-green-300":"text-red-300"}`,children:Ue.toFixed(1)})]})]}),a.jsxs("div",{className:"flex gap-1",children:[a.jsxs("button",{className:`px-1.5 py-0.5 rounded text-white flex items-center gap-0.5 font-body ${lt?"bg-red-600 hover:bg-red-500":Pe||oa&&!lt?"bg-gray-600 cursor-not-allowed":"bg-teal-600 hover:bg-teal-500"}`,onClick:()=>re(jt,"export"),disabled:Pe&&!lt||oa&&!lt,title:Pe&&!lt?"":oa&&!lt?"":"",children:[a.jsx(k,{name:lt?"X":"ArrowUpRight",size:10}),lt?"":""]}),a.jsxs("button",{className:`px-1.5 py-0.5 rounded text-white flex items-center gap-0.5 font-body ${Vt?"bg-red-600 hover:bg-red-500":Pe||oa&&!Vt?"bg-gray-600 cursor-not-allowed":"bg-purple-600 hover:bg-purple-500"}`,onClick:()=>re(jt,"import"),disabled:Pe&&!Vt||oa&&!Vt,title:Pe&&!Vt?"":oa&&!Vt?"":"",children:[a.jsx(k,{name:Vt?"X":"ArrowDownLeft",size:10}),Vt?"":""]})]})]})]},jt)})})]})})()}),S.peaceTreatyUntil&&c<S.peaceTreatyUntil&&a.jsxs("div",{className:"bg-green-900/20 p-2 rounded-lg border border-green-600/30 mb-2",children:[a.jsxs("h3",{className:"text-xs font-bold text-white flex items-center gap-1 mb-1.5 font-decorative",children:[a.jsx(k,{name:"HandHeart",size:12,className:"text-green-300"}),""]}),a.jsxs("p",{className:"text-[10px] text-gray-300 font-body",children:[": ",a.jsx("span",{className:"text-green-300 font-semibold font-epic",children:S.peaceTreatyUntil-c})]}),S.installmentPayment&&a.jsxs("p",{className:"text-[10px] text-gray-300 mt-1 font-body",children:[":  ",a.jsx("span",{className:"text-yellow-300 font-semibold font-epic",children:S.installmentPayment.amount}),"   ",a.jsx("span",{className:"text-white font-semibold font-epic",children:S.installmentPayment.remainingDays})," "]})]}),S.isAtWar&&a.jsxs("div",{className:"bg-red-900/20 p-2 rounded-lg border border-red-600/30",children:[a.jsxs("h3",{className:"text-xs font-bold text-white flex items-center gap-1 mb-1.5 font-decorative",children:[a.jsx(k,{name:"AlertTriangle",size:12,className:"text-red-300"}),""]}),a.jsx("div",{className:"flex items-center justify-between text-[10px] mb-1.5 font-body",children:a.jsxs("div",{className:"flex gap-2 text-gray-300 font-body",children:[a.jsxs("span",{children:[": ",a.jsx("span",{className:"text-red-300 font-semibold font-epic",children:S.warScore?.toFixed(0)||0})]}),a.jsxs("span",{children:[": ",a.jsx("span",{className:"text-white font-semibold font-epic",children:S.warDuration||0})]}),a.jsxs("span",{children:[": ",a.jsx("span",{className:"text-white font-semibold font-epic",children:S.enemyLosses||0})]}),a.jsxs("span",{children:[": ",a.jsxs("span",{className:`font-semibold font-epic ${(S.militaryStrength??1)>.7?"text-green-300":(S.militaryStrength??1)>.4?"text-yellow-300":"text-red-300"}`,children:[Math.floor((S.militaryStrength??1)*100),"%"]})]})]})}),a.jsx("p",{className:"text-[10px] text-gray-400 mb-1.5 font-body",children:me(S)}),a.jsx("button",{className:"w-full px-2 py-1.5 bg-red-600 hover:bg-red-500 text-white rounded text-xs font-semibold font-body",onClick:()=>C(S.id,"peace"),children:""})]}),h&&h.nationId===S.id&&a.jsxs("div",{className:"bg-yellow-900/20 p-2 rounded-lg border border-yellow-600/30 mt-2",children:[a.jsxs("h3",{className:"text-xs font-bold text-white flex items-center gap-1 mb-1.5 font-decorative",children:[a.jsx(k,{name:"Coins",size:12,className:"text-yellow-300"}),""]}),a.jsxs("p",{className:"text-[10px] text-gray-300 font-body",children:[": ",a.jsx("span",{className:"text-yellow-300 font-semibold font-epic",children:h.amount})," "]}),a.jsxs("p",{className:"text-[10px] text-gray-300 mt-1 font-body",children:[": ",a.jsx("span",{className:"text-white font-semibold font-epic",children:h.remainingDays})]}),a.jsxs("p",{className:"text-[10px] text-gray-300 mt-1 font-body",children:[": ",a.jsx("span",{className:"text-green-300 font-semibold font-epic",children:h.paidAmount})," /",a.jsxs("span",{className:"text-white font-semibold font-epic",children:[" ",h.totalAmount]})," "]})]})]}):a.jsx("div",{className:"glass-ancient p-4 rounded-xl border border-ancient-gold/30 text-sm text-gray-400 font-body",children:""})})]}),a.jsx(BT,{isOpen:R,onClose:()=>{E(!1),D(null)},title:` ${S?.name||""} `,footer:a.jsxs("div",{className:"flex gap-2 justify-end",children:[a.jsx("button",{className:"px-3 py-1.5 bg-gray-600 hover:bg-gray-500 rounded text-white text-sm font-body",onClick:()=>{E(!1),D(null)},children:""}),a.jsx("button",{className:`px-3 py-1.5 rounded text-white text-sm font-body ${T?"bg-indigo-600 hover:bg-indigo-500":"bg-gray-500 cursor-not-allowed"}`,onClick:L,disabled:!T,children:" (300)"})]}),children:a.jsxs("div",{className:"space-y-2",children:[a.jsxs("p",{className:"text-sm text-gray-300 font-body mb-3",children:["",S?.name," "]}),a.jsx("div",{className:"max-h-60 overflow-y-auto space-y-1",children:ie.map(X=>{const qe=Pp(X.relation||0,X.alliedWithPlayer===!0),fe=S?.foreignRelations?.[X.id]??50,Je=(S?.allies||[]).includes(X.id)||(X.allies||[]).includes(S?.id),tt=Je?{label:"",color:"text-green-300"}:fe>=80?{label:"",color:"text-emerald-300"}:fe>=60?{label:"",color:"text-blue-300"}:fe>=40?{label:"",color:"text-gray-300"}:fe>=20?{label:"",color:"text-yellow-300"}:{label:"",color:"text-red-300"};return a.jsxs("button",{onClick:()=>D(X.id),className:`w-full flex items-center justify-between p-2 rounded border transition-colors ${T===X.id?"bg-indigo-900/50 border-indigo-500":"bg-gray-800/60 border-gray-700 hover:bg-gray-700/60"}`,children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(k,{name:"Flag",size:14,className:X.color||"text-gray-300"}),a.jsx("span",{className:"text-sm text-white font-body",children:X.name}),a.jsxs("span",{className:`text-[10px] px-1 py-0.5 rounded ${qe.bg} ${qe.color}`,children:[":",qe.label]})]}),a.jsxs("div",{className:"flex items-center gap-1 text-[10px]",children:[a.jsx("span",{className:"text-gray-400",children:":"}),a.jsx("span",{className:tt.color,children:tt.label}),a.jsxs("span",{className:"text-gray-500",children:["(",Math.round(fe),")"]})]})]},X.id)})}),ie.length===0&&a.jsx("p",{className:"text-sm text-gray-400 text-center py-4 font-body",children:""})]})}),O&&S&&a.jsx(uS,{targetNation:S,allies:H,onConfirm:()=>{C(S.id,"declare_war"),q(!1)},onCancel:()=>q(!1)}),I&&a.jsx(pS,{tradeRoutes:p,nations:U,resources:o,market:r,taxPolicies:b,daysElapsed:c,epoch:s,onClose:()=>Z(!1),onCancelRoute:(X,qe,fe)=>{m&&m(X,"cancel",{resource:qe,type:fe})},onCreateRoute:(X,qe,fe)=>{m&&m(X,"create",{resource:qe,type:fe})}})]})},yS=({result:t,onClose:s})=>Ps.createPortal(a.jsx(Ro,{children:t&&a.jsxs("div",{className:"fixed inset-0 z-[100] flex items-end lg:items-center justify-center p-2",children:[a.jsx(As.div,{className:"absolute inset-0 bg-ancient-ink/90 backdrop-blur-sm",onClick:s,initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.3}}),a.jsxs(As.div,{className:"relative w-full max-w-2xl glass-monument border-2 border-ancient-gold/40 rounded-t-2xl lg:rounded-2xl shadow-monument flex flex-col max-h-[90vh] overflow-hidden",initial:{y:"100%",opacity:0},animate:{y:0,opacity:1},exit:{y:"100%",opacity:0},transition:{type:"spring",damping:25,stiffness:300},children:[a.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-ancient-ink/80 via-ancient-stone/20 to-ancient-ink/70 opacity-70"}),a.jsx("div",{className:"absolute inset-0 opacity-[0.04] pointer-events-none",children:a.jsxs("svg",{className:"w-full h-full",xmlns:"http://www.w3.org/2000/svg",children:[a.jsxs("pattern",{id:"battle-result-pattern",x:"0",y:"0",width:"80",height:"80",patternUnits:"userSpaceOnUse",children:[a.jsx("circle",{cx:"10",cy:"10",r:"1",fill:"currentColor",className:"text-ancient-gold/50"}),a.jsx("circle",{cx:"70",cy:"70",r:"1",fill:"currentColor",className:"text-ancient-gold/30"}),a.jsx("path",{d:"M0 0 L80 0 L80 80",stroke:"currentColor",strokeWidth:"0.4",className:"text-ancient-gold/10",fill:"none"})]}),a.jsx("rect",{width:"100%",height:"100%",fill:"url(#battle-result-pattern)"})]})}),a.jsxs("div",{className:"relative z-10 flex flex-col h-full",children:[a.jsxs("div",{className:`flex-shrink-0 p-4 border-b border-ancient-gold/20 ${t.victory?"bg-gradient-to-r from-emerald-900/40 to-blue-900/30":"bg-gradient-to-r from-red-900/50 to-ancient-ink/60"}`,children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-12 h-12 rounded-xl bg-ancient-ink/60 border border-ancient-gold/30 flex items-center justify-center flex-shrink-0 shadow-inner",children:a.jsx(k,{name:t.victory?"Trophy":"Skull",size:26,className:t.victory?"text-ancient-gold":"text-red-400"})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("h2",{className:"text-lg font-bold text-ancient leading-tight flex items-center gap-2",children:[t.victory?"":"",typeof t.score=="number"&&a.jsxs("span",{className:"px-2 py-0.5 text-[10px] rounded-full border border-ancient-gold/30 text-ancient-parchment bg-ancient-ink/40",children:[" ",t.score.toFixed(0)]})]}),a.jsxs("p",{className:"text-[11px] text-ancient-parchment opacity-80 leading-tight truncate",children:[t.missionName||"",t.missionDifficulty&&`  ${t.missionDifficulty}`,t.nationName&&`  ${t.nationName}`]})]}),a.jsx("button",{onClick:s,className:"p-2 rounded-full hover:bg-ancient-gold/10 transition-colors flex-shrink-0 text-ancient-stone",children:a.jsx(k,{name:"X",size:18})})]}),t.missionDesc&&a.jsx("p",{className:"text-[11px] text-ancient-stone mt-2 leading-snug",children:t.missionDesc})]}),a.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-3",children:[(!t.isRaid||t.isRaid&&t.ourPower>0)&&a.jsxs("div",{className:"glass-ancient rounded-xl border border-ancient-gold/20 p-3 shadow-ancient",children:[a.jsxs("h3",{className:"text-[11px] font-bold mb-2 flex items-center gap-1 text-ancient-parchment",children:[a.jsx(k,{name:"BarChart",size:14,className:"text-ancient-gold"}),""]}),a.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[a.jsxs("div",{className:"bg-ancient-ink/50 border border-ancient-gold/10 rounded-lg p-2",children:[a.jsx("p",{className:"text-[10px] text-ancient-stone mb-1 leading-none",children:""}),a.jsx("p",{className:"text-base font-bold text-ancient font-mono leading-none",children:t.ourPower?.toFixed(0)||0})]}),a.jsxs("div",{className:"bg-ancient-ink/50 border border-ancient-gold/10 rounded-lg p-2",children:[a.jsx("p",{className:"text-[10px] text-ancient-stone mb-1 leading-none",children:""}),a.jsx("p",{className:"text-base font-bold text-red-400 font-mono leading-none",children:t.enemyPower?.toFixed(0)||0})]}),a.jsxs("div",{className:"bg-ancient-ink/50 border border-ancient-gold/10 rounded-lg p-2",children:[a.jsx("p",{className:"text-[10px] text-ancient-stone mb-1 leading-none",children:""}),a.jsxs("p",{className:`text-base font-bold font-mono leading-none ${t.powerRatio>1?"text-green-400":"text-red-400"}`,children:[t.powerRatio?.toFixed(2)||0,"x"]})]}),a.jsxs("div",{className:"bg-ancient-ink/50 border border-ancient-gold/10 rounded-lg p-2",children:[a.jsx("p",{className:"text-[10px] text-ancient-stone mb-1 leading-none",children:""}),a.jsx("p",{className:"text-base font-bold text-purple-400 font-mono leading-none",children:t.score?.toFixed(0)||0})]})]})]}),(!t.isRaid||t.isRaid&&Object.keys(t.losses||t.defenderLosses||{}).length>0)&&a.jsxs("div",{className:"bg-gray-700/50 rounded p-2 border border-gray-600",children:[a.jsxs("h3",{className:"text-[10px] font-bold mb-1.5 flex items-center gap-1 text-white",children:[a.jsx(k,{name:"Heart",size:12,className:"text-red-400"}),""]}),Object.keys(t.losses||t.defenderLosses||t.attackerLosses||{}).length>0?a.jsx("div",{className:"space-y-1",children:Object.entries(t.losses||t.defenderLosses||t.attackerLosses||{}).map(([r,o])=>{const c=un[r];return!c||o===0?null:a.jsxs("div",{className:"flex items-center justify-between bg-red-900/20 border border-red-600/30 p-1.5 rounded",children:[a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsx(k,{name:"User",size:12,className:"text-red-400"}),a.jsx("span",{className:"text-[10px] text-white leading-none",children:c.name})]}),a.jsxs("span",{className:"text-[10px] font-bold text-red-400 font-mono leading-none",children:["-",o]})]},r)})}):a.jsxs("div",{className:"text-center py-2 bg-green-900/20 border border-green-600/30 rounded",children:[a.jsx(k,{name:"Check",size:16,className:"text-green-400 mx-auto mb-1"}),a.jsx("p",{className:"text-[10px] text-green-300 leading-tight",children:""})]})]}),(t.enemyLosses||t.attackerLosses)&&Object.keys(t.enemyLosses||t.attackerLosses||{}).length>0&&a.jsxs("div",{className:"bg-gray-700/50 rounded p-2 border border-gray-600",children:[a.jsxs("h3",{className:"text-[10px] font-bold mb-1.5 flex items-center gap-1 text-white",children:[a.jsx(k,{name:"Skull",size:12,className:"text-gray-400"}),""]}),a.jsx("div",{className:"space-y-1",children:Object.entries(t.enemyLosses||t.attackerLosses||{}).map(([r,o])=>{const c=un[r];return!c||o===0?null:a.jsxs("div",{className:"flex items-center justify-between bg-gray-800/50 p-1.5 rounded",children:[a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsx(k,{name:"User",size:12,className:"text-gray-400"}),a.jsx("span",{className:"text-[10px] text-white leading-none",children:c?.name||r})]}),a.jsxs("span",{className:"text-[10px] font-bold text-gray-400 font-mono leading-none",children:["-",o]})]},r)})})]}),t.isRaid&&(t.foodLoss>0||t.silverLoss>0)&&a.jsxs("div",{className:"bg-gray-700/50 rounded p-2 border border-gray-600",children:[a.jsxs("h3",{className:"text-[10px] font-bold mb-1.5 flex items-center gap-1 text-white",children:[a.jsx(k,{name:"AlertTriangle",size:12,className:"text-red-400"}),""]}),a.jsxs("div",{className:"grid grid-cols-2 gap-1.5",children:[t.foodLoss>0&&a.jsxs("div",{className:"flex items-center justify-between bg-red-900/20 border border-red-600/30 p-1.5 rounded",children:[a.jsx("span",{className:"text-[10px] text-gray-300 leading-none",children:""}),a.jsxs("span",{className:"text-[10px] font-bold text-red-400 font-mono leading-none",children:["-",t.foodLoss]})]}),t.silverLoss>0&&a.jsxs("div",{className:"flex items-center justify-between bg-red-900/20 border border-red-600/30 p-1.5 rounded",children:[a.jsx("span",{className:"text-[10px] text-gray-300 leading-none",children:""}),a.jsxs("span",{className:"text-[10px] font-bold text-red-400 font-mono leading-none",children:["-",t.silverLoss]})]})]})]}),t.isRaid&&t.popLoss>0&&a.jsxs("div",{className:"bg-gray-700/50 rounded p-2 border border-gray-600",children:[a.jsxs("h3",{className:"text-[10px] font-bold mb-1.5 flex items-center gap-1 text-white",children:[a.jsx(k,{name:"Users",size:12,className:"text-red-400"}),""]}),a.jsx("div",{className:"bg-red-900/20 border border-red-600/30 p-1.5 rounded",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-[10px] text-gray-300 leading-none",children:""}),a.jsxs("span",{className:"text-[10px] font-bold text-red-400 font-mono leading-none",children:["-",t.popLoss]})]})})]}),t.victory&&t.resourcesGained&&Object.keys(t.resourcesGained).length>0&&a.jsxs("div",{className:"bg-gray-700/50 rounded p-2 border border-gray-600",children:[a.jsxs("h3",{className:"text-[10px] font-bold mb-1.5 flex items-center gap-1 text-white",children:[a.jsx(k,{name:"Gift",size:12,className:"text-yellow-400"}),""]}),a.jsx("div",{className:"grid grid-cols-2 gap-1.5",children:Object.entries(t.resourcesGained).map(([r,o])=>a.jsxs("div",{className:"flex items-center justify-between bg-yellow-900/20 border border-yellow-600/30 p-1.5 rounded",children:[a.jsx("span",{className:"text-[10px] text-gray-300 leading-none",children:Re[r]?.name||r}),a.jsxs("span",{className:"text-[10px] font-bold text-yellow-400 font-mono leading-none",children:["+",o]})]},r))})]})]}),a.jsx("div",{className:"flex-shrink-0 p-3 border-t border-gray-700 bg-gray-800/50",children:a.jsx("button",{onClick:s,className:"w-full px-4 py-2 bg-blue-600 hover:bg-blue-500 text-white rounded-lg text-sm font-bold transition-colors",children:""})})]})]})]})}),document.body),Dp=t=>Number.isFinite(t)?Math.abs(t)>=1e3?t.toFixed(0):Math.abs(t)>=100?t.toFixed(1):Math.abs(t)>=1?t.toFixed(2):t.toFixed(3):"--",gy=(t,{color:s,label:r})=>{const o=Array.isArray(t)?t.filter(Number.isFinite):[],c={min:o.length?Math.min(...o):0,max:o.length?Math.max(...o):0,current:o.length?o[o.length-1]:0};return{color:s,label:r,data:o,stats:c}},bl=({data:t=[],data2:s=[],color:r="#34d399",color2:o="#f87171",label:c="",label2:u="",height:p=128})=>{const m=gy(t,{color:r,label:c}),h=gy(s,{color:o,label:u}),x=m.data.length>0,g=h.data.length>0;if(!x&&!g)return a.jsx("div",{className:"flex h-32 flex-col items-center justify-center text-xs text-gray-500",children:a.jsx("p",{children:""})});const b=320,j=10,_=[...m.data,...h.data],N=Math.min(..._),M=Math.max(..._),R=(M-N)*.1||1,E=N-R,T=M+R,D=Math.max(T-E,1),O=Math.max(m.data.length,h.data.length,2),q=O>1?(b-j*2)/(O-1):0,I=Q=>{if(!Q.length)return"";const ne=O-Q.length;return Q.map((Ne,$e)=>{const de=j+(ne+$e)*q,P=(Ne-E)/D,z=p-j-P*(p-j*2);return`${de.toFixed(1)},${z.toFixed(1)}`}).join(" ")},Z=I(m.data),Y=I(h.data),U=({color:Q,text:ne})=>a.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-400",children:[a.jsx("span",{className:"h-2.5 w-2.5 rounded-full",style:{backgroundColor:Q}}),a.jsx("span",{children:ne})]}),S=({title:Q,stats:ne})=>a.jsxs("div",{className:"text-[11px] text-gray-400",children:[a.jsx("p",{className:"text-xs text-gray-300",children:Q}),a.jsxs("div",{className:"mt-1 flex gap-4 font-mono",children:[a.jsxs("span",{children:["Max ",Dp(ne.max)]}),a.jsxs("span",{children:["Min ",Dp(ne.min)]}),a.jsxs("span",{children:["Now ",Dp(ne.current)]})]})]});return a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"flex flex-wrap gap-4",children:[x&&a.jsx(U,{color:m.color,text:m.label}),g&&a.jsx(U,{color:h.color,text:h.label})]}),a.jsx("div",{className:"relative h-32 w-full overflow-hidden rounded-xl border border-gray-800/60 bg-gray-950/50",children:a.jsxs("svg",{viewBox:`0 0 ${b} ${p}`,preserveAspectRatio:"none",className:"h-full w-full",children:[[.25,.5,.75].map(Q=>{const ne=p-j-Q*(p-j*2);return a.jsx("line",{x1:j,x2:b-j,y1:ne,y2:ne,stroke:"rgba(255,255,255,0.05)",strokeWidth:"1"},Q)}),g&&a.jsx("polyline",{points:Y,stroke:h.color,strokeWidth:"2",fill:"none",strokeLinecap:"round",strokeLinejoin:"round",opacity:"0.7"}),x&&a.jsx("polyline",{points:Z,stroke:m.color,strokeWidth:"2.5",fill:"none",strokeLinecap:"round",strokeLinejoin:"round"})]})}),x&&a.jsx(S,{title:m.label,stats:m.stats}),g&&a.jsx(S,{title:h.label,stats:h.stats})]})},bS=({popStructure:t,classApproval:s,classInfluence:r,activeBuffs:o,activeDebuffs:c,stability:u,onClose:p})=>a.jsx("div",{className:"fixed inset-0 bg-black/70 flex items-center justify-center z-[100] p-4",children:a.jsxs("div",{className:"glass-epic rounded-xl border-2 border-ancient-gold/30 max-w-4xl w-full max-h-[90vh] flex flex-col shadow-metal-xl",children:[a.jsx("div",{className:"p-4 md:p-6 border-b border-gray-700",children:a.jsxs("div",{className:"flex items-start justify-between gap-3",children:[a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h2",{className:"text-xl md:text-2xl font-bold text-white font-decorative",children:""}),a.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[a.jsx(k,{name:"Heart",size:16,className:`flex-shrink-0 ${u>=70?"text-green-400":u>=40?"text-yellow-400":"text-red-400 animate-pulse"}`}),a.jsx("span",{className:"text-sm text-gray-300",children:":"}),a.jsxs("span",{className:`text-sm font-bold ${u>=70?"text-green-400":u>=40?"text-yellow-400":"text-red-400"}`,children:[Math.floor(u),"%"]})]})]}),a.jsx("button",{onClick:p,className:"p-2 hover:bg-gray-700 rounded-lg flex-shrink-0",children:a.jsx(k,{name:"X",size:20,className:"text-gray-400"})})]})}),a.jsx("div",{className:"p-6 overflow-y-auto",children:a.jsxs("table",{className:"w-full text-left table-auto",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b border-gray-600",children:[a.jsx("th",{className:"p-2 text-sm font-semibold text-gray-300",children:""}),a.jsx("th",{className:"p-2 text-sm font-semibold text-gray-300",children:""}),a.jsx("th",{className:"p-2 text-sm font-semibold text-gray-300",children:""}),a.jsx("th",{className:"p-2 text-sm font-semibold text-gray-300",children:""}),a.jsx("th",{className:"p-2 text-sm font-semibold text-gray-300",children:""})]})}),a.jsx("tbody",{children:Object.keys(Ke).map(m=>{const h=Ke[m],x=t[m]||0;if(x===0)return null;const g=s[m]||50,b=r[m]||0,j=o.filter(N=>N.class===m||N.source===m),_=c.filter(N=>N.class===m||N.source===m);return a.jsxs("tr",{className:"border-b border-gray-700 hover:bg-gray-700/50",children:[a.jsxs("td",{className:"p-2 text-sm text-white flex items-center gap-2",children:[a.jsx(k,{name:h.icon,size:16})," ",h.name]}),a.jsx("td",{className:"p-2 text-sm text-gray-300",children:x}),a.jsx("td",{className:"p-2 text-sm",children:a.jsxs("span",{className:g>=70?"text-green-400":g>=40?"text-yellow-400":"text-red-400",children:[g.toFixed(0),"%"]})}),a.jsx("td",{className:"p-2 text-sm text-purple-400",children:b.toFixed(1)}),a.jsxs("td",{className:"p-2 text-xs space-y-1",children:[j.map((N,M)=>{const R=Xr(N);return a.jsxs("div",{className:"text-green-400",children:[a.jsx("span",{className:"font-semibold",children:N.desc||""}),R.length>0&&a.jsxs("span",{className:"text-gray-300 ml-2",children:["(",R.join(""),")"]})]},M)}),_.map((N,M)=>{const R=Xr(N);return a.jsxs("div",{className:"text-red-400",children:[a.jsx("span",{className:"font-semibold",children:N.desc||""}),R.length>0&&a.jsxs("span",{className:"text-gray-300 ml-2",children:["(",R.join(""),")"]})]},M)})]})]},m)})})]})}),a.jsx("div",{className:"p-6 border-t border-gray-700 bg-gray-800/50",children:a.jsx("button",{onClick:p,className:"w-full px-6 py-3 bg-blue-600 hover:bg-blue-500 text-white rounded-lg text-sm font-bold transition-colors",children:""})})]})}),yy=[{id:"overview",label:"",description:""},{id:"economy",label:"",description:""},{id:"needs",label:"",description:""}],vS=({stratumKey:t,popStructure:s,classApproval:r,classInfluence:o,classWealth:c,classWealthHistory:u={},totalInfluence:p,totalWealth:m,activeBuffs:h,activeDebuffs:x,epoch:g=0,techsUnlocked:b=[],history:j={},stability:_=50,onClose:N})=>{const[M,R]=$.useState("overview");if(!t||t==="all")return a.jsx(bS,{popStructure:s,classApproval:r,classInfluence:o,activeBuffs:h,activeDebuffs:x,stability:_,onClose:N});const E=Ke[t];if(!E)return null;const T=yy.find(P=>P.id===M),D=s[t]||0,O=r[t]||50,q=o[t]||0,I=c[t]||0,Z=Object.values(s).reduce((P,z)=>P+z,0),Y=Z>0?D/Z*100:0,U=p>0?q/p*100:0,S=m>0?I/m*100:0,Q=h.filter(P=>P.class===t||P.source===t),ne=x.filter(P=>P.class===t||P.source===t),Ne=u[t]||[],$e=j?.class?.[t]||{pop:[],income:[],expense:[]},de=(P=[])=>{if(!P||P.length<=1)return null;const z=260,V=90,F=Math.max(...P),re=Math.min(...P),C=F-re||1,L=P.map((ie,H)=>{const ve=P.length>1?H/(P.length-1)*z:z,me=V-(ie-re)/C*V;return`${ve},${me}`}).join(" ");return a.jsx("svg",{viewBox:`0 0 ${z} ${V}`,preserveAspectRatio:"none",className:"w-full h-24 text-emerald-300 stroke-current fill-none",children:a.jsx("polyline",{points:L,strokeWidth:"2"})})};return a.jsx("div",{className:"fixed inset-0 bg-black/70 backdrop-blur-sm flex items-center justify-center z-[100] p-4 animate-fade-in",children:a.jsxs("div",{className:"glass-epic rounded-xl border border-ancient-gold/30 max-w-3xl w-full max-h-[90vh] flex flex-col overflow-hidden shadow-monument animate-slide-bounce",children:[a.jsx("div",{className:"p-3 md:p-4 border-b border-ancient-gold/20 bg-gradient-to-r from-purple-900/30 via-ancient-ink/50 to-blue-900/30",children:a.jsxs("div",{className:"flex items-start justify-between gap-3",children:[a.jsxs("div",{className:"flex items-start gap-2 md:gap-3 flex-1 min-w-0",children:[a.jsx("div",{className:"p-2 md:p-2.5 icon-metal-container icon-metal-container-lg flex-shrink-0 animate-breathe-glow",children:a.jsx(k,{name:E.icon,size:22,className:"text-ancient-gold icon-metal-gold md:w-7 md:h-7"})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h2",{className:"text-lg md:text-2xl font-bold text-white font-decorative",children:E.name}),a.jsx("p",{className:"text-xs md:text-sm text-gray-300 mt-1",children:E.description}),a.jsxs("div",{className:"flex items-center gap-1.5 md:gap-2 mt-2",children:[a.jsx(k,{name:"Heart",size:14,className:`flex-shrink-0 ${_>=70?"text-green-400":_>=40?"text-yellow-400":"text-red-400 animate-pulse"}`}),a.jsx("span",{className:"text-xs text-gray-400 whitespace-nowrap",children:":"}),a.jsxs("span",{className:`text-xs md:text-sm font-bold ${_>=70?"text-green-400":_>=40?"text-yellow-400":"text-red-400"}`,children:[Math.floor(_),"%"]})]})]})]}),a.jsx("button",{onClick:N,className:"p-1.5 hover:bg-ancient-gold/20 rounded-lg transition-colors flex-shrink-0 border border-ancient-gold/20 hover:border-ancient-gold/40",children:a.jsx(k,{name:"X",size:18,className:"text-ancient-stone hover:text-ancient-gold transition-colors md:w-5 md:h-5"})})]})}),a.jsx("div",{className:"border-b border-gray-700 bg-gray-800/60 px-6 pt-4",children:a.jsxs("div",{className:"flex flex-wrap items-center gap-3 pb-4",children:[yy.map(P=>a.jsx("button",{type:"button",className:`rounded-full px-4 py-1.5 text-sm font-semibold ${P.id===M?"bg-indigo-500/20 text-indigo-200":"text-gray-400 hover:text-white"}`,onClick:()=>R(P.id),children:P.label},P.id)),T?.description&&a.jsx("span",{className:"text-sm text-gray-500",children:T.description})]})}),a.jsxs("div",{className:"flex-1 overflow-y-auto p-6",children:[M==="overview"&&a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{children:[a.jsxs("h3",{className:"text-sm font-bold mb-3 flex items-center gap-2 text-gray-300",children:[a.jsx(k,{name:"BarChart",size:16,className:"text-blue-400"}),""]}),a.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:[a.jsxs("div",{className:"bg-gray-700/50 p-3 rounded",children:[a.jsx("p",{className:"text-xs text-gray-400 mb-1",children:""}),a.jsx("p",{className:"text-lg font-bold text-white",children:D}),a.jsxs("p",{className:"text-xs text-blue-400 mt-1",children:[Y.toFixed(1),"%"]})]}),a.jsxs("div",{className:"bg-gray-700/50 p-3 rounded",children:[a.jsx("p",{className:"text-xs text-gray-400 mb-1",children:""}),a.jsxs("p",{className:`text-lg font-bold ${O>=70?"text-green-400":O>=40?"text-yellow-400":"text-red-400"}`,children:[O.toFixed(0),"%"]})]}),a.jsxs("div",{className:"bg-gray-700/50 p-3 rounded",children:[a.jsx("p",{className:"text-xs text-gray-400 mb-1",children:""}),a.jsx("p",{className:"text-lg font-bold text-purple-400",children:q.toFixed(1)}),a.jsxs("p",{className:"text-xs text-purple-400 mt-1",children:[U.toFixed(1),"%"]})]}),a.jsxs("div",{className:"bg-gray-700/50 p-3 rounded",children:[a.jsx("p",{className:"text-xs text-gray-400 mb-1",children:""}),a.jsx("p",{className:"text-lg font-bold text-yellow-400",children:I.toFixed(0)}),a.jsxs("p",{className:"text-xs text-yellow-400 mt-1",children:[S.toFixed(1),"%"]})]})]})]}),(Q.length>0||ne.length>0)&&a.jsxs("div",{children:[a.jsxs("h3",{className:"text-sm font-bold mb-3 flex items-center gap-2 text-gray-300",children:[a.jsx(k,{name:"Zap",size:16,className:"text-yellow-400"}),""]}),a.jsxs("div",{className:"space-y-2",children:[Q.map((P,z)=>{const V=Xr(P);return a.jsxs("div",{className:"flex items-start gap-2 bg-green-900/20 border border-green-600/30 p-3 rounded",children:[a.jsx(k,{name:"TrendingUp",size:14,className:"text-green-400 flex-shrink-0 mt-0.5"}),a.jsxs("div",{className:"flex-1",children:[a.jsx("p",{className:"text-sm font-semibold text-green-300",children:P.desc||P.name||""}),V.length>0&&a.jsx("p",{className:"text-xs text-gray-400 mt-1",children:V.join("")})]})]},`buff-${z}`)}),ne.map((P,z)=>{const V=Xr(P);return a.jsxs("div",{className:"flex items-start gap-2 bg-red-900/20 border border-red-600/30 p-3 rounded",children:[a.jsx(k,{name:"TrendingDown",size:14,className:"text-red-400 flex-shrink-0 mt-0.5"}),a.jsxs("div",{className:"flex-1",children:[a.jsx("p",{className:"text-sm font-semibold text-red-300",children:P.desc||P.name||""}),V.length>0&&a.jsx("p",{className:"text-xs text-gray-400 mt-1",children:V.join("")})]})]},`debuff-${z}`)})]})]}),a.jsx("div",{className:"bg-blue-900/20 border border-blue-500/30 p-4 rounded",children:a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx(k,{name:"Lightbulb",size:20,className:"text-blue-400 flex-shrink-0 mt-0.5"}),a.jsxs("div",{children:[a.jsx("h4",{className:"text-sm font-bold text-blue-300 mb-2",children:""}),a.jsxs("ul",{className:"space-y-1 text-xs text-gray-300",children:[O<40&&a.jsx("li",{children:" "}),q>p*.3&&a.jsx("li",{children:" "}),D>Z*.4&&a.jsx("li",{children:" "}),O>=70&&a.jsx("li",{children:" "})]})]})]})})]}),M==="economy"&&a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{children:[a.jsxs("h3",{className:"text-sm font-bold mb-3 flex items-center gap-2 text-gray-300",children:[a.jsx(k,{name:"Activity",size:16,className:"text-cyan-400"}),""]}),a.jsxs("div",{className:"grid gap-3 md:grid-cols-3",children:[a.jsxs("div",{className:"bg-gray-700/40 p-3 rounded",children:[a.jsx("p",{className:"text-xs text-gray-400 mb-2",children:""}),a.jsx(bl,{data:$e.pop,color:"#38bdf8",label:""})]}),a.jsxs("div",{className:"bg-gray-700/40 p-3 rounded",children:[a.jsx("p",{className:"text-xs text-gray-400 mb-2",children:""}),a.jsx(bl,{data:$e.income,color:"#4ade80",label:""})]}),a.jsxs("div",{className:"bg-gray-700/40 p-3 rounded",children:[a.jsx("p",{className:"text-xs text-gray-400 mb-2",children:""}),a.jsx(bl,{data:$e.expense,color:"#f87171",label:""})]})]})]}),a.jsxs("div",{children:[a.jsxs("h3",{className:"text-sm font-bold mb-3 flex items-center gap-2 text-gray-300",children:[a.jsx(k,{name:"TrendingUp",size:16,className:"text-emerald-400"}),""]}),a.jsx("div",{className:"bg-gray-700/40 p-3 rounded",children:de(Ne)||a.jsx("p",{className:"text-xs text-gray-500",children:""})})]}),a.jsxs("div",{children:[a.jsxs("h3",{className:"text-sm font-bold mb-3 flex items-center gap-2 text-gray-300",children:[a.jsx(k,{name:"Star",size:16,className:"text-yellow-400"}),""]}),a.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[a.jsxs("div",{className:"bg-gray-700/50 p-3 rounded",children:[a.jsx("p",{className:"text-xs text-gray-400 mb-1",children:""}),a.jsxs("p",{className:"text-sm text-white",children:[E.wealthWeight,"x"]})]}),a.jsxs("div",{className:"bg-gray-700/50 p-3 rounded",children:[a.jsx("p",{className:"text-xs text-gray-400 mb-1",children:""}),a.jsx("p",{className:"text-sm text-white",children:E.influenceBase})]})]})]})]}),M==="needs"&&a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{children:[a.jsxs("h3",{className:"text-sm font-bold mb-3 flex items-center gap-2 text-gray-300",children:[a.jsx(k,{name:"Package",size:16,className:"text-green-400"}),""]}),a.jsx("div",{className:"space-y-2",children:(()=>{const z=Object.entries(E.needs||{}).filter(([V])=>si(V,g,b));return z.length>0?z.map(([V,F])=>{const re=Re[V]?.name||V;return a.jsxs("div",{className:"flex items-center justify-between bg-gray-700/50 p-3 rounded",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(k,{name:"Package",size:14,className:"text-blue-400"}),a.jsx("span",{className:"text-sm text-white",children:re})]}),a.jsxs("div",{className:"text-right",children:[a.jsxs("p",{className:"text-sm font-bold text-white",children:[F,"//"]}),a.jsxs("p",{className:"text-xs text-gray-400",children:[": ",(F*D).toFixed(1),"/"]})]})]},V)}):a.jsx("p",{className:"text-xs text-gray-500 italic",children:""})})()})]}),E.satisfiedEffects&&E.satisfiedEffects.length>0&&a.jsxs("div",{children:[a.jsxs("h3",{className:"text-sm font-bold mb-3 flex items-center gap-2 text-gray-300",children:[a.jsx(k,{name:"ThumbsUp",size:16,className:"text-green-400"}),""]}),a.jsx("div",{className:"space-y-2",children:E.satisfiedEffects.map((P,z)=>a.jsxs("div",{className:"flex items-start gap-2 bg-green-900/20 border border-green-600/30 p-3 rounded",children:[a.jsx(k,{name:"Plus",size:14,className:"text-green-400 flex-shrink-0 mt-0.5"}),a.jsx("p",{className:"text-sm text-green-300",children:P})]},z))})]}),E.dissatisfiedEffects&&E.dissatisfiedEffects.length>0&&a.jsxs("div",{children:[a.jsxs("h3",{className:"text-sm font-bold mb-3 flex items-center gap-2 text-gray-300",children:[a.jsx(k,{name:"ThumbsDown",size:16,className:"text-red-400"}),""]}),a.jsx("div",{className:"space-y-2",children:E.dissatisfiedEffects.map((P,z)=>a.jsxs("div",{className:"flex items-start gap-2 bg-red-900/20 border border-red-600/30 p-3 rounded",children:[a.jsx(k,{name:"Minus",size:14,className:"text-red-400 flex-shrink-0 mt-0.5"}),a.jsx("p",{className:"text-sm text-red-300",children:P})]},z))})]})]})]}),a.jsx("div",{className:"p-6 border-t border-gray-700 bg-gray-800/50",children:a.jsx("button",{onClick:N,className:"w-full px-6 py-3 bg-blue-600 hover:bg-blue-500 text-white rounded-lg text-sm font-bold transition-colors",children:""})})]})})},qa=t=>!Number.isFinite(t)||t===0?"0":Math.abs(t)>=10?t.toFixed(1):Math.abs(t)>=1?t.toFixed(2):t.toFixed(3),by=t=>t?Array.isArray(t)?t:[t]:[],vy=({series:t=[],height:s=220})=>{const r=t.map(N=>({...N,data:Array.isArray(N.data)?N.data:[],color:N.color||"#60a5fa"})).filter(N=>N.data.length>0),o=r.flatMap(N=>N.data.filter(M=>Number.isFinite(M)));if(!r.length||!o.length)return a.jsx("div",{className:"flex h-48 items-center justify-center text-sm text-gray-500",children:""});let c=Math.min(...o),u=Math.max(...o);if(u===c){const N=Math.abs(u)*.1||1;u+=N,c-=N}const p=Math.max(u-c,1),m=640,h=40,x=Math.max(...r.map(N=>N.data.length)),g=x>1?(m-h*2)/(x-1):0,b=4,j=Array.from({length:b+1},(N,M)=>({value:c+p/b*M,y:s-h-(c+p/b*M-c)/p*(s-h*2)})),_=N=>{const M=x-N.length,R=N.map((T,D)=>{if(!Number.isFinite(T))return null;const O=M+D,q=h+O*g,I=(T-c)/p,Z=s-h-I*(s-h*2);return{x:q,y:Z}}).filter(Boolean);return R.length?{pathD:R.map((T,D)=>`${D===0?"M":"L"}${T.x.toFixed(2)} ${T.y.toFixed(2)}`).join(" "),coords:R}:null};return a.jsxs("div",{className:"w-full",children:[a.jsx("div",{className:"mb-4 flex flex-wrap gap-4 text-sm",children:r.map(N=>a.jsxs("div",{className:"flex items-center gap-2 text-gray-300",children:[a.jsx("span",{className:"h-3 w-3 rounded-full",style:{backgroundColor:N.color}}),N.label]},N.label))}),a.jsx("div",{className:"relative h-56 w-full overflow-hidden rounded-2xl bg-gray-950/60",children:a.jsxs("svg",{viewBox:`0 0 ${m} ${s}`,preserveAspectRatio:"none",className:"h-full w-full",children:[j.map(({value:N,y:M},R)=>a.jsxs("g",{children:[a.jsx("line",{x1:h,x2:m-h/2,y1:M,y2:M,stroke:"rgba(255,255,255,0.08)",strokeWidth:"1"}),a.jsx("text",{x:h-10,y:M+4,fill:"rgba(255,255,255,0.45)",fontSize:"10",textAnchor:"end",children:N.toFixed(1)})]},`grid-${R}`)),a.jsx("line",{x1:h,x2:m-h/2,y1:s-h,y2:s-h,stroke:"rgba(255,255,255,0.15)",strokeWidth:"1"}),r.map(N=>{const M=_(N.data);return M?a.jsxs("g",{children:[a.jsx("path",{d:M.pathD,stroke:N.color,strokeWidth:"2.5",fill:"none",strokeLinecap:"round",strokeLinejoin:"round"}),M.coords.map((R,E)=>a.jsx("circle",{cx:R.x,cy:R.y,r:"3",fill:N.color,stroke:"rgba(15,23,42,0.8)",strokeWidth:"1"},`${N.label}-${E}`))]},`series-${N.label}`):null})]})})]})},Rp=[{id:"market",label:"",description:""},{id:"analysis",label:"",description:""},{id:"chain",label:"",description:""}],jy=({label:t,subLabel:s})=>a.jsxs("div",{className:"flex flex-col items-center justify-center px-2 min-w-[60px]",children:[t&&a.jsx("span",{className:"text-[10px] text-gray-400 mb-1",children:t}),a.jsx("div",{className:"h-[2px] w-full bg-gradient-to-r from-gray-700 via-gray-500 to-gray-700 relative",children:a.jsx("div",{className:"absolute right-0 top-1/2 -translate-y-1/2 translate-x-1/2",children:a.jsx(k,{name:"ChevronRight",size:14,className:"text-gray-500"})})}),s&&a.jsx("span",{className:"text-[10px] text-emerald-400 mt-1",children:s})]}),wy=({buildingId:t,building:s,role:r,currentResource:o,count:c=0})=>{if(!s)return null;const u=r==="producer";let p=null;if(u){const m=s.output?.[o]||0,h=Object.entries(s.input||{}).map(([x,g])=>({key:x,name:Re[x]?.name||x,ratio:m?(g/m).toFixed(2):"?"}));p=a.jsx("div",{className:"mt-1.5 space-y-0.5",children:h.length>0?h.map(x=>a.jsxs("div",{className:"text-[10px] text-gray-400 flex justify-between",children:[a.jsx("span",{children:x.name}),a.jsxs("span",{className:"text-gray-500",children:["x",x.ratio]})]},x.key)):a.jsx("div",{className:"text-[10px] text-gray-500",children:"/"})})}else{const m=s.input?.[o]||0,h=Object.entries(s.output||{}).map(([x,g])=>({key:x,name:Re[x]?.name||x,ratio:m?(g/m).toFixed(2):"?"}));p=a.jsx("div",{className:"mt-1.5 space-y-0.5",children:h.length>0?h.map(x=>a.jsxs("div",{className:"text-[10px] text-gray-400 flex justify-between",children:[a.jsxs("span",{children:[" ",x.name]}),a.jsxs("span",{className:"text-gray-500",children:["x",x.ratio]})]},x.key)):a.jsx("div",{className:"text-[10px] text-gray-500",children:""})})}return a.jsxs("div",{className:"relative group min-w-[140px] max-w-[160px] rounded-xl border border-gray-700 bg-gray-900/80 p-3 hover:border-gray-500 transition-colors",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[a.jsx("div",{className:`p-1.5 rounded-lg ${s.visual?.color||"bg-gray-800"}`,children:a.jsx(k,{name:s.visual?.icon||"Home",size:14,className:"text-white"})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("p",{className:"text-xs font-bold text-white truncate",children:s.name}),a.jsx("p",{className:"text-[9px] text-gray-400",children:c>0?` ${c|0} `:""})]})]}),a.jsx("div",{className:"h-px bg-gray-800 w-full mb-1.5"}),p,a.jsxs("div",{className:"mt-2 pt-1 border-t border-gray-800/50 flex justify-between items-center",children:[a.jsxs("span",{className:"text-[9px] text-gray-500",children:[u?"":"","/"]}),a.jsx("span",{className:`text-xs font-mono font-bold ${u?"text-emerald-300":"text-rose-300"}`,children:u?s.output?.[o]:s.input?.[o]})]})]})},jS=({resourceKey:t,buildings:s={}})=>{const{producers:r,consumers:o}=$.useMemo(()=>{const p=[],m=[];return Ln.forEach(h=>{h.output?.[t]>0&&p.push(h),h.input?.[t]>0&&m.push(h)}),{producers:p,consumers:m}},[t]),c=$.useMemo(()=>Object.values(k5).find(p=>p.stages.some(m=>by(m.input).includes(t)||by(m.output).includes(t))),[t]),u=Re[t];return a.jsxs("div",{className:"space-y-6",children:[a.jsx("div",{className:"rounded-xl lg:rounded-2xl border border-gray-800 bg-gray-950/60 p-4 lg:p-6 overflow-x-auto",children:a.jsxs("div",{className:"min-w-[700px] flex items-stretch justify-center gap-4",children:[a.jsxs("div",{className:"flex-1 flex flex-col gap-3",children:[a.jsx("div",{className:"text-center mb-2",children:a.jsx("span",{className:"px-2 py-0.5 rounded-full bg-emerald-950/50 border border-emerald-500/30 text-[10px] text-emerald-300",children:" / "})}),r.length>0?a.jsx("div",{className:"flex flex-col gap-3 items-end",children:r.map(p=>a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(wy,{buildingId:p.id,building:p,role:"producer",currentResource:t,count:s[p.id]}),a.jsx(jy,{label:""})]},p.id))}):a.jsxs("div",{className:"h-full flex items-center justify-center text-xs text-gray-600 italic px-8",children:["",a.jsx("br",{}),"()"]})]}),a.jsx("div",{className:"flex flex-col justify-center items-center z-10 px-4",children:a.jsxs("div",{className:"relative p-6 rounded-2xl border-2 border-indigo-500/50 bg-indigo-900/20 shadow-[0_0_30px_-5px_rgba(99,102,241,0.3)] backdrop-blur-sm",children:[a.jsx("div",{className:"absolute -top-3 left-1/2 -translate-x-1/2 px-3 py-0.5 bg-gray-950 border border-indigo-500/50 rounded-full",children:a.jsx("span",{className:"text-[10px] font-bold text-indigo-300 uppercase tracking-widest",children:"o"})}),a.jsxs("div",{className:"flex flex-col items-center gap-3",children:[a.jsx("div",{className:"w-16 h-16 rounded-xl bg-gray-900 border border-gray-700 flex items-center justify-center shadow-inner",children:a.jsx(k,{name:u?.icon||"Package",size:32,className:u?.color||"text-white"})}),a.jsxs("div",{className:"text-center",children:[a.jsx("h3",{className:"text-lg font-bold text-white",children:u?.name}),a.jsx("p",{className:"text-xs text-gray-400 mt-1",children:(u?.tags||[]).map(p=>({essential:"",raw_material:"",industrial:"",manufactured:"",luxury:"",currency:"",special:"",basic_need:"",luxury_need:"",construction:"",military:"",strategic:"",refined:"",raw:"",food:""})[p]||p).join("  ")||""})]})]})]})}),a.jsxs("div",{className:"flex-1 flex flex-col gap-3",children:[a.jsx("div",{className:"text-center mb-2",children:a.jsx("span",{className:"px-2 py-0.5 rounded-full bg-rose-950/50 border border-rose-500/30 text-[10px] text-rose-300",children:" / "})}),o.length>0?a.jsx("div",{className:"flex flex-col gap-3 items-start",children:o.map(p=>a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(jy,{label:""}),a.jsx(wy,{buildingId:p.id,building:p,role:"consumer",currentResource:t,count:s[p.id]})]},p.id))}):a.jsxs("div",{className:"h-full flex items-center justify-center text-xs text-gray-600 italic px-8",children:["",a.jsx("br",{}),"(/)"]})]})]})}),c&&c.upgrades&&a.jsxs("div",{className:"rounded-xl border border-purple-500/20 bg-purple-950/10 p-4",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[a.jsx(k,{name:"Zap",size:16,className:"text-purple-300"}),a.jsxs("h4",{className:"text-sm font-bold text-purple-100",children:[" (",c.name,")"]})]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:c.upgrades.map(p=>a.jsxs("div",{className:"p-3 rounded-lg border border-purple-500/10 bg-purple-500/5 hover:bg-purple-500/10 transition-colors",children:[a.jsxs("div",{className:"flex justify-between items-start mb-1",children:[a.jsx("span",{className:"text-xs font-bold text-purple-200",children:p.name}),a.jsxs("span",{className:"text-[10px] text-gray-500",children:[" ",p.unlockEpoch]})]}),a.jsx("div",{className:"text-[10px] text-gray-400 space-y-0.5",children:Object.entries(p.bonus||{}).map(([m,h])=>{const g={efficiency:"",output:"",input:"",capacity:"",defense:"",attack:"",preservation:"",approval:"",stability:"",sustainability:"",workers:"",processing:"",waste:"",cloth_output:"",dye_output:"",culture:"",extraction:"",depth:"",science:"",spread:"",access:"",price:"",profit:"",influence:"",cost:"",supply:"",mobility:"",production:"",quality:""}[m]||m;return a.jsxs("div",{children:[g,": ",a.jsxs("span",{className:"text-emerald-400",children:["+",h*100,"%"]})]},m)})})]},p.id))})]})]})},wS=({resourceKey:t,resources:s={},market:r,buildings:o={},popStructure:c={},wealth:u={},army:p={},history:m={},onClose:h,taxPolicies:x,onUpdateTaxPolicies:g,activeDebuffs:b=[]})=>{const[j,_]=$.useState(Rp[0].id),N=Re[t],M=t==="silver",R=$.useMemo(()=>{const B=r?.priceHistory?.[t];return B?[...B]:[]},[r,t]),[E,T]=$.useState(null),[D,O]=$.useState(null),q=x?.resourceTaxRates?.[t]??0,I=x?.resourceTariffMultipliers?.[t]??1,Z=B=>{T(B)},Y=()=>{if(E===null||!g)return;const B=parseFloat(E),ht=(Number.isNaN(B)?0:B)/100;g(ft=>({...ft,resourceTaxRates:{...ft?.resourceTaxRates||{},[t]:ht}})),T(null)},U=B=>{O(B)},S=()=>{if(D===null||!g)return;const B=parseFloat(D),Ue=Number.isNaN(B)?1:Math.max(0,B);g(ht=>({...ht,resourceTariffMultipliers:{...ht?.resourceTariffMultipliers||{},[t]:Ue}})),O(null)},Q=$.useMemo(()=>{const B=r?.supplyHistory?.[t];return B?[...B]:[]},[r,t]),ne=$.useMemo(()=>{const B=r?.demandHistory?.[t];return B?[...B]:[]},[r,t]),Ne=$.useMemo(()=>{if(!Array.isArray(b)||!b.length)return[];const B=r?.needsShortages||{},Ue=["production","industryBonus","efficiency"];return b.map(ht=>{if(!ht||!ht.class)return null;const ft=Ue.map(Ye=>({field:Ye,value:ht[Ye]})).filter(Ye=>typeof Ye.value=="number"&&Ye.value<0).sort((Ye,bt)=>Ye.value-bt.value)[0];if(!ft)return null;const $t=Ke[ht.class]||{},oe=(B[ht.class]||[]).map(Ye=>{if(!Ye)return null;const bt=typeof Ye=="string"?{resource:Ye,reason:"outOfStock"}:Ye;if(!bt.resource)return null;const Pe=Re[bt.resource]?.name||bt.resource,lt=bt.reason==="unaffordable"?"":bt.reason==="both"?"/":"";return`${Pe}(${lt})`}).filter(Boolean);return{key:ht.class,name:$t.name||ht.class,icon:$t.icon||"Users",desc:ht.desc,penaltyPercent:Math.round(ft.value*100),shortages:oe}}).filter(Boolean)},[b,r]),{stratumDemand:$e,buildingDemand:de,armyDemand:P,buildingSupply:z,totalBaseDemand:V,totalBaseSupply:F,totalActualDemand:re,totalActualSupply:C}=$.useMemo(()=>{if(!N)return{stratumDemand:[],buildingDemand:[],armyDemand:[],buildingSupply:[],totalBaseDemand:0,totalBaseSupply:0,totalActualDemand:0,totalActualSupply:0};const Ue=(r?.modifiers||{}).sources||{},ht=Ue.decreeResourceDemand?.[t]||0,ft=Ue.eventResourceDemand?.[t]||0,$t=Ue.decreeResourceSupply?.[t]||0,It=1+ht+ft,oe=1+$t;let Ye=0,bt=0,Pe=0,lt=0;const Vt=Object.entries(Ke).reduce((Zt,[la,qt])=>{const Gt=c[la]||0;if(!Gt)return Zt;const kt=Ue.decreeStratumDemand?.[la]||0,ta=Ue.eventStratumDemand?.[la]||0,Ht=1+kt+ta,se=Ue.stratumWealthMultiplier?.[la]||1,pe=qt.startingWealth||1,je=(u[la]||pe*Gt)/Math.max(1,Gt)/pe,J={...qt.needs||{}};if(qt.luxuryNeeds){const Ve=Object.keys(qt.luxuryNeeds).map(Number).sort((ca,ha)=>ca-ha);for(const ca of Ve)if(je>=ca){const ha=qt.luxuryNeeds[ca];for(const[Ra,xe]of Object.entries(ha))J[Ra]=(J[Ra]||0)+xe}}const le=J[t]||0;if(!le)return Zt;const ue=qt.needs?.[t]||0,Me=le-ue,Ie=Me>0,at=ue===0&&Me>0,Ze=le*Gt;Ye+=Ze;const Ce=Ze*Ht*It*se;bt+=Ce;const rt=[];if(kt!==0&&rt.push(`${kt>0?"+":""}${(kt*100).toFixed(0)}%`),ta!==0&&rt.push(`${ta>0?"+":""}${(ta*100).toFixed(0)}%`),Math.abs(se-1)>.01){const Ve=(se-1)*100;rt.push(`${Ve>0?"+":""}${Ve.toFixed(0)}%`)}Ie&&rt.push(`+${Me.toFixed(3)}`);let zt=`${Gt}  ${le.toFixed(3)}`;return Ie&&ue>0?zt=`${Gt}  (${ue}+${Me.toFixed(3)})`:at&&(zt=`${Gt}  ${Me.toFixed(3)}()`),Zt.push({key:la,name:qt.name,icon:qt.icon,baseAmount:Ze,amount:Ce,formula:zt,mods:rt,hasBonus:Ce!==Ze||Ie,isLuxuryNeed:Ie,isPureLuxury:at,wealthRatio:je.toFixed(2)}),Zt},[]),oa=Ln.reduce((Zt,la)=>{const qt=la.input?.[t]||0,Gt=o[la.id]||0;if(!qt||!Gt)return Zt;const kt=qt*Gt;Ye+=kt;const ta=kt*It;return bt+=ta,Zt.push({id:la.id,name:la.name,baseAmount:kt,amount:ta,formula:`${Gt}   ${qt}`,hasBonus:ta!==kt}),Zt},[]),Ka=Ln.reduce((Zt,la)=>{const qt=la.output?.[t]||0,Gt=o[la.id]||0;if(!qt||!Gt)return Zt;const kt=qt*Gt;Pe+=kt;const ta=(Ue.techBuildingBonus?.[la.id]||1)-1,Ht=Ue.eventBuildingProduction?.[la.id]||0,se=(Ue.techCategoryBonus?.[la.cat]||1)-1,pe=Ue.eventBuildingProduction?.[la.cat]||0,he=1+ta+Ht+se+pe,K=kt*he*oe;lt+=K;const je=[];return ta!==0&&je.push(`${ta>0?"+":""}${(ta*100).toFixed(0)}%`),Ht!==0&&je.push(`${Ht>0?"+":""}${(Ht*100).toFixed(0)}%`),se!==0&&je.push(`${se>0?"+":""}${(se*100).toFixed(0)}%`),pe!==0&&je.push(`${pe>0?"+":""}${(pe*100).toFixed(0)}%`),Zt.push({id:la.id,name:la.name,baseAmount:kt,amount:K,formula:`${Gt}   ${qt}`,mods:je,hasBonus:K!==kt}),Zt},[]),gn=Object.entries(un).reduce((Zt,[la,qt])=>{const Gt=qt.maintenanceCost?.[t]||0,kt=p[la]||0;if(!Gt||!kt)return Zt;const ta=Gt*kt;Ye+=ta;const Ht=ta*It;return bt+=Ht,Zt.push({id:la,name:qt.name,baseAmount:ta,amount:Ht,formula:`${kt}   ${Gt}`,hasBonus:Ht!==ta}),Zt},[]);return{stratumDemand:Vt,buildingDemand:oa,armyDemand:gn,buildingSupply:Ka,totalBaseDemand:Ye,totalBaseSupply:Pe,totalActualDemand:bt,totalActualSupply:lt}},[N,t,c,o,p,r,u]),L=()=>{h()},ie=m?.treasury||[],H=m?.tax||[],ve=ie.length?ie[ie.length-1]:s[t]||0,me=H.length?H[H.length-1]:0,X=s[t]||0,qe=r?.supply?.[t]||0,fe=r?.demand?.[t]||0,Je=r?.prices?.[t]??N.basePrice??0,tt=R.length>=2?R[R.length-1]-R[R.length-2]:0,Mt=Q[Q.length-1]??qe,jt=ne[ne.length-1]??fe,ot=Rp.find(B=>B.id===j);return a.jsxs("div",{className:"fixed inset-0 z-[100] flex items-end justify-center lg:items-center",children:[a.jsx(As.div,{className:"absolute inset-0 bg-black/70",onClick:L,initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.3}}),a.jsxs(As.div,{className:"relative w-full max-w-6xl glass-epic border-t-2 lg:border-2 border-ancient-gold/30 rounded-t-2xl lg:rounded-2xl shadow-metal-xl flex flex-col max-h-[95vh] overflow-hidden",initial:{y:"100%",opacity:0},animate:{y:0,opacity:1},exit:{y:"100%",opacity:0},transition:{type:"spring",damping:25,stiffness:300},children:[a.jsx("div",{className:"flex-shrink-0 p-2 lg:p-3 border-b border-gray-700 bg-gradient-to-r from-gray-900 to-gray-800",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"w-9 h-9 lg:w-10 lg:h-10 icon-metal-container icon-metal-container-lg flex-shrink-0",children:a.jsx(k,{name:N.icon,size:20,className:`${N.color} icon-metal`})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h2",{className:"text-sm lg:text-base font-bold text-white leading-tight font-decorative",children:N.name}),a.jsxs("p",{className:"text-[9px] lg:text-[10px] text-gray-400 leading-tight truncate",children:[" ",X.toFixed(1)," ",M?" ":`  ${Je.toFixed(2)}`]})]}),a.jsx("button",{onClick:L,className:"p-1.5 lg:p-2 rounded-full hover:bg-gray-700 flex-shrink-0",children:a.jsx(k,{name:"X",size:16,className:"text-gray-400"})})]})}),a.jsx("div",{className:"flex-1 overflow-y-auto",children:M?a.jsxs("div",{className:"space-y-2 lg:space-y-3 p-2 lg:p-3",children:[a.jsxs("div",{className:"grid gap-1.5 lg:gap-2 grid-cols-2",children:[a.jsxs("div",{className:"rounded-lg border border-yellow-500/30 bg-yellow-500/5 p-2 lg:p-2.5",children:[a.jsx("p",{className:"text-[8px] lg:text-[9px] uppercase tracking-wide text-yellow-300/80 leading-none",children:""}),a.jsx("p",{className:"mt-1 text-base lg:text-lg font-bold text-yellow-200 font-mono leading-none",children:ve.toFixed(0)}),a.jsxs("p",{className:"mt-0.5 lg:mt-1 text-[8px] lg:text-[9px] text-yellow-200/80 leading-none",children:[" ",(s[t]||0).toFixed(0)]})]}),a.jsxs("div",{className:"rounded-lg border border-emerald-500/30 bg-emerald-500/5 p-2 lg:p-2.5",children:[a.jsx("p",{className:"text-[8px] lg:text-[9px] uppercase tracking-wide text-emerald-300/80 leading-none",children:""}),a.jsx("p",{className:"mt-1 text-base lg:text-lg font-bold text-emerald-200 font-mono leading-none",children:qa(me)}),a.jsx("p",{className:"mt-0.5 lg:mt-1 text-[8px] lg:text-[9px] text-emerald-200/80 leading-none",children:""})]})]}),a.jsxs("div",{className:"rounded-lg border border-blue-500/30 bg-blue-500/5 p-2",children:[a.jsx("p",{className:"text-[8px] lg:text-[9px] uppercase tracking-wide text-blue-200/80 leading-none mb-0.5 lg:mb-1",children:""}),a.jsx("p",{className:"text-[9px] lg:text-[10px] text-blue-100/80 leading-snug lg:leading-relaxed",children:",,"})]}),!M&&g&&a.jsxs("div",{className:"rounded-lg border border-emerald-500/30 bg-emerald-500/5 p-3",children:[a.jsx("p",{className:"text-[9px] uppercase tracking-wide text-emerald-300/80 leading-none mb-2",children:""}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("input",{type:"text",inputMode:"decimal",step:"1",value:E??(q*100).toFixed(0),onChange:B=>Z(B.target.value),onBlur:Y,onKeyDown:B=>{B.key==="Enter"&&(Y(),B.target.blur())},className:"w-24 bg-gray-800/70 border border-gray-600 text-sm text-gray-200 rounded px-2 py-1 focus:ring-1 focus:ring-emerald-500 focus:border-emerald-500 text-center",placeholder:"%"}),a.jsxs("div",{className:"flex-1",children:[a.jsxs("p",{className:"text-sm font-semibold text-emerald-200",children:[": ",(q*100).toFixed(0),"%"]}),a.jsx("p",{className:"text-[10px] text-gray-400",children:""})]})]})]}),a.jsxs("div",{className:"rounded-lg border border-blue-500/30 bg-blue-500/5 p-2",children:[a.jsx("p",{className:"text-[8px] lg:text-[9px] uppercase tracking-wide text-blue-200/80 leading-none mb-0.5 lg:mb-1",children:""}),a.jsx("p",{className:"text-[9px] lg:text-[10px] text-blue-100/80 leading-snug lg:leading-relaxed",children:",,"})]}),a.jsxs("div",{className:"space-y-1.5 lg:space-y-2",children:[a.jsxs("div",{className:"rounded-lg border border-gray-700 bg-gray-900/60 p-2",children:[a.jsxs("div",{className:"mb-1.5 lg:mb-2 flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-[8px] lg:text-[9px] uppercase tracking-wide text-gray-500 leading-none",children:""}),a.jsxs("p",{className:"text-xs lg:text-sm font-semibold text-white leading-tight mt-0.5",children:[" ",(s[t]||0).toFixed(0)," "]})]}),a.jsx(k,{name:"Coins",size:14,className:"text-yellow-200"})]}),a.jsx(bl,{data:ie,color:"#facc15",label:""})]}),a.jsxs("div",{className:"rounded-lg border border-gray-700 bg-gray-900/60 p-2",children:[a.jsxs("div",{className:"mb-1.5 lg:mb-2 flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-[8px] lg:text-[9px] uppercase tracking-wide text-gray-500 leading-none",children:""}),a.jsxs("p",{className:"text-xs lg:text-sm font-semibold text-white leading-tight mt-0.5",children:[" ",qa(me)," / "]})]}),a.jsx(k,{name:"Activity",size:14,className:"text-emerald-300"})]}),a.jsx(bl,{data:H,color:"#34d399",label:""})]})]})]}):a.jsxs("div",{className:"flex h-full flex-col",children:[a.jsxs("div",{className:"border-b border-gray-700 bg-gray-900/70 px-2 lg:px-3 pt-1.5 lg:pt-2 flex-shrink-0",children:[a.jsx("div",{className:"flex items-center gap-1.5 lg:gap-2 overflow-x-auto pb-1.5 lg:pb-2",children:Rp.map(B=>a.jsx("button",{type:"button",className:`rounded-full px-2.5 lg:px-3 py-1 text-[9px] lg:text-[10px] font-semibold whitespace-nowrap ${B.id===j?"bg-emerald-500/20 text-emerald-300":"text-gray-400 hover:text-white"}`,onClick:()=>_(B.id),children:B.label},B.id))}),ot&&a.jsx("p",{className:"text-[8px] lg:text-[9px] text-gray-500 pb-1 leading-tight",children:ot.description})]}),a.jsxs("div",{className:"flex-1 space-y-2 lg:space-y-3 p-2 lg:p-3 overflow-y-auto",children:[!M&&g&&a.jsxs("div",{className:"rounded-xl lg:rounded-2xl border border-emerald-500/30 bg-emerald-950/40 p-2.5 lg:p-4",children:[a.jsx("p",{className:"text-[10px] lg:text-xs uppercase tracking-wide text-gray-500 mb-1.5 lg:mb-2",children:""}),a.jsxs("div",{className:"flex items-center gap-2 lg:gap-4",children:[a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx("input",{type:"text",inputMode:"decimal",value:E??(q*100).toFixed(0),onChange:B=>Z(B.target.value),onBlur:Y,onKeyDown:B=>{B.key==="Enter"&&(Y(),B.target.blur())},className:"w-16 lg:w-24 bg-gray-800/70 border border-gray-600 text-base lg:text-lg font-mono text-gray-200 rounded-lg px-1.5 lg:px-2 py-1 focus:ring-1 focus:ring-emerald-500 focus:border-emerald-500 text-center"}),a.jsx("span",{className:"text-base lg:text-lg font-semibold text-emerald-300",children:"%"})]}),a.jsxs("div",{className:"text-right flex-1",children:[a.jsx("p",{className:`text-base lg:text-lg font-bold ${q>0?"text-yellow-300":q<0?"text-green-300":"text-gray-400"}`,children:q>0?"":q<0?"":""}),a.jsx("p",{className:"text-[10px] lg:text-xs text-gray-400",children:""})]})]}),a.jsx("p",{className:"text-[10px] lg:text-xs text-gray-400 mt-1.5 lg:mt-2",children:""}),a.jsxs("div",{className:"mt-2 lg:mt-3",children:[a.jsx("p",{className:"text-[10px] lg:text-xs uppercase tracking-wide text-gray-500 mb-1",children:""}),a.jsxs("div",{className:"flex items-center gap-2 lg:gap-3",children:[a.jsx("input",{type:"text",inputMode:"decimal",step:"0.1",value:D??I.toFixed(2),onChange:B=>U(B.target.value),onBlur:S,onKeyDown:B=>{B.key==="Enter"&&(S(),B.target.blur())},className:"w-20 lg:w-28 bg-gray-800/70 border border-gray-600 text-base lg:text-lg font-mono text-gray-200 rounded-lg px-1.5 lg:px-2 py-1 focus:ring-1 focus:ring-indigo-500 focus:border-indigo-500 text-center"}),a.jsxs("div",{className:"text-right flex-1",children:[a.jsxs("p",{className:"text-sm lg:text-base font-semibold text-indigo-200",children:[I.toFixed(2),""]}),a.jsx("p",{className:"text-[10px] lg:text-xs text-gray-400",children:""})]})]}),a.jsx("p",{className:"text-[10px] lg:text-xs text-gray-400 mt-1",children:""})]})]}),j==="market"&&a.jsxs("div",{className:"space-y-3 lg:space-y-6",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-2 lg:gap-4",children:[a.jsxs("div",{className:"rounded-xl lg:rounded-2xl border border-gray-800 bg-gray-950/60 p-2.5 lg:p-4",children:[a.jsx("p",{className:"text-[10px] lg:text-xs uppercase tracking-wide text-gray-500",children:""}),a.jsx("p",{className:"mt-1 lg:mt-2 text-2xl lg:text-3xl font-bold text-white",children:X.toFixed(1)}),a.jsxs("p",{className:"mt-1 lg:mt-2 text-xs lg:text-sm text-gray-400",children:[" ",qa(Mt-jt||0)]})]}),a.jsxs("div",{className:"rounded-xl lg:rounded-2xl border border-gray-800 bg-gray-950/60 p-2.5 lg:p-4",children:[a.jsx("p",{className:"text-[10px] lg:text-xs uppercase tracking-wide text-gray-500",children:""}),a.jsxs("div",{className:"mt-1 lg:mt-2 flex items-center gap-2 lg:gap-3 text-white",children:[a.jsx("span",{className:"text-2xl lg:text-3xl font-bold",children:Je.toFixed(2)}),a.jsxs("span",{className:`flex items-center gap-0.5 lg:gap-1 text-xs lg:text-sm ${tt>0?"text-emerald-400":tt<0?"text-rose-400":"text-gray-400"}`,children:[a.jsx(k,{name:tt>=0?"ArrowUp":"ArrowDown",size:14}),tt>=0?"+":"",qa(tt)]})]}),a.jsx("p",{className:"mt-1 lg:mt-2 text-xs lg:text-sm text-gray-400",children:""})]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-2 lg:gap-3",children:[a.jsxs("div",{className:"rounded-xl lg:rounded-2xl border border-gray-800 bg-gray-950/60 p-2 lg:p-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("p",{className:"text-[10px] lg:text-xs uppercase tracking-wide text-gray-500",children:""}),a.jsx(k,{name:"TrendingUp",size:14,className:"text-sky-300"})]}),a.jsx(vy,{series:[{label:"",color:"#60a5fa",data:R}]}),a.jsxs("div",{className:"mt-2 grid grid-cols-2 gap-1.5",children:[a.jsxs("div",{className:"rounded-lg border border-gray-800/60 bg-gray-900/60 p-1.5 text-center",children:[a.jsx("p",{className:"text-[9px] lg:text-[10px] text-gray-500",children:""}),a.jsx("p",{className:"text-sm lg:text-base font-bold text-white",children:Je.toFixed(2)})]}),a.jsxs("div",{className:"rounded-lg border border-gray-800/60 bg-gray-900/60 p-1.5 text-center",children:[a.jsx("p",{className:"text-[9px] lg:text-[10px] text-gray-500",children:""}),a.jsxs("p",{className:`text-sm lg:text-base font-bold ${tt>0?"text-emerald-300":tt<0?"text-rose-300":"text-white"}`,children:[tt>=0?"+":"",qa(tt)]})]})]})]}),a.jsxs("div",{className:"rounded-xl lg:rounded-2xl border border-gray-800 bg-gray-950/60 p-2 lg:p-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("p",{className:"text-[10px] lg:text-xs uppercase tracking-wide text-gray-500",children:""}),a.jsx(k,{name:"Activity",size:14,className:"text-emerald-300"})]}),a.jsx(vy,{series:[{label:"",color:"#34d399",data:Q},{label:"",color:"#f87171",data:ne}]}),a.jsxs("div",{className:"mt-2 grid grid-cols-3 gap-1.5",children:[a.jsxs("div",{className:"rounded-lg border border-gray-800/60 bg-gray-900/60 p-1.5 text-center",children:[a.jsx("p",{className:"text-[9px] lg:text-[10px] text-gray-500",children:""}),a.jsx("p",{className:"text-sm lg:text-base font-bold text-emerald-300",children:qa(Mt)})]}),a.jsxs("div",{className:"rounded-lg border border-gray-800/60 bg-gray-900/60 p-1.5 text-center",children:[a.jsx("p",{className:"text-[9px] lg:text-[10px] text-gray-500",children:""}),a.jsx("p",{className:"text-sm lg:text-base font-bold text-rose-300",children:qa(jt)})]}),a.jsxs("div",{className:"rounded-lg border border-gray-800/60 bg-gray-900/60 p-1.5 text-center",children:[a.jsx("p",{className:"text-[9px] lg:text-[10px] text-gray-500",children:""}),a.jsx("p",{className:"text-sm lg:text-base font-bold text-white",children:qa((Mt||0)-(jt||0))})]})]})]})]})]}),j==="analysis"&&a.jsxs("div",{className:"grid gap-3 lg:gap-6 lg:grid-cols-2",children:[(()=>{const B=r?.demand?.[t]||0,Ue=r?.supply?.[t]||0,ht=re>0?Math.abs(B-re)/re:0,ft=C>0?Math.abs(Ue-C)/C:0;return(B>0||Ue>0)&&(ht>.05||ft>.05)?a.jsxs("div",{className:"lg:col-span-2 rounded-xl border border-blue-500/30 bg-blue-950/20 p-2.5",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[a.jsx(k,{name:"Info",size:14,className:"text-blue-400"}),a.jsx("p",{className:"text-[10px] lg:text-xs text-blue-200 font-medium",children:""})]}),a.jsxs("div",{className:"grid gap-2 grid-cols-2",children:[a.jsxs("div",{className:"flex items-center justify-between px-2 py-1.5 rounded-lg border border-rose-500/30 bg-rose-950/30",children:[a.jsxs("div",{children:[a.jsx("span",{className:"text-[10px] text-rose-300",children:""}),a.jsxs("span",{className:"text-[8px] text-gray-500 ml-1",children:["vs ",qa(re)]})]}),a.jsx("span",{className:"text-xs font-bold text-rose-400",children:qa(B)})]}),a.jsxs("div",{className:"flex items-center justify-between px-2 py-1.5 rounded-lg border border-emerald-500/30 bg-emerald-950/30",children:[a.jsxs("div",{children:[a.jsx("span",{className:"text-[10px] text-emerald-300",children:""}),a.jsxs("span",{className:"text-[8px] text-gray-500 ml-1",children:["vs ",qa(C)]})]}),a.jsx("span",{className:"text-xs font-bold text-emerald-400",children:qa(Ue)})]})]}),a.jsx("p",{className:"text-[9px] text-gray-500 mt-1.5",children:"= | ="})]}):null})(),a.jsxs("div",{className:"rounded-xl lg:rounded-2xl border border-gray-800 bg-gray-950/60 p-3 lg:p-5",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-[10px] lg:text-xs uppercase tracking-wide text-gray-500",children:""}),a.jsxs("p",{className:"text-base lg:text-xl font-semibold text-white",children:[" ",qa(re),V!==re&&a.jsxs("span",{className:"text-sm text-gray-500 ml-2",children:["(: ",qa(V),")"]})]})]}),a.jsx(k,{name:"TrendingUp",size:18,className:"text-rose-300"})]}),a.jsxs("div",{className:"mt-2 lg:mt-4 space-y-2 lg:space-y-4",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-xs lg:text-sm font-semibold text-gray-300",children:""}),a.jsx("div",{className:"mt-1.5 lg:mt-2 space-y-1.5 lg:space-y-2",children:$e.length?$e.map(B=>a.jsxs("div",{className:`flex items-center justify-between rounded-lg lg:rounded-xl border ${B.isPureLuxury?"border-purple-500/30 bg-purple-950/20":B.isLuxuryNeed?"border-indigo-500/30 bg-indigo-950/20":B.hasBonus?"border-amber-500/30 bg-amber-950/20":"border-gray-800/60 bg-gray-900/60"} p-2 lg:p-3`,children:[a.jsxs("div",{className:"flex items-center gap-2 lg:gap-3",children:[a.jsx("div",{className:`rounded-lg lg:rounded-xl p-1.5 lg:p-2 ${B.isPureLuxury?"bg-purple-900/80":B.isLuxuryNeed?"bg-indigo-900/80":"bg-gray-900/80"}`,children:a.jsx(k,{name:B.icon,size:16,className:B.isPureLuxury?"text-purple-300":B.isLuxuryNeed?"text-indigo-300":"text-amber-300"})}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsx("p",{className:"text-xs lg:text-sm font-semibold text-white",children:B.name}),B.isPureLuxury&&a.jsx("span",{className:"text-[8px] px-1 py-0.5 rounded bg-purple-900/50 text-purple-300 border border-purple-500/30",children:""}),B.isLuxuryNeed&&!B.isPureLuxury&&a.jsx("span",{className:"text-[8px] px-1 py-0.5 rounded bg-indigo-900/50 text-indigo-300 border border-indigo-500/30",children:""})]}),a.jsx("p",{className:"text-[10px] lg:text-xs text-gray-500",children:B.formula}),B.mods&&B.mods.length>0&&a.jsx("p",{className:`text-[9px] ${B.isPureLuxury?"text-purple-400":B.isLuxuryNeed?"text-indigo-400":"text-amber-400"}`,children:B.mods.join("  ")})]})]}),a.jsxs("div",{className:"text-right",children:[a.jsx("p",{className:`text-sm lg:text-base font-bold ${B.isPureLuxury?"text-purple-200":B.isLuxuryNeed?"text-indigo-200":"text-rose-200"}`,children:qa(B.amount)}),B.hasBonus&&a.jsxs("p",{className:"text-[9px] text-gray-500",children:[": ",qa(B.baseAmount)]})]})]},B.key)):a.jsx("p",{className:"text-xs lg:text-sm text-gray-500",children:""})})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-xs lg:text-sm font-semibold text-gray-300",children:"/"}),a.jsx("div",{className:"mt-1.5 lg:mt-2 space-y-1.5 lg:space-y-2",children:de.length?de.map(B=>a.jsxs("div",{className:`flex items-center justify-between rounded-lg lg:rounded-xl border ${B.hasBonus?"border-amber-500/30 bg-amber-950/20":"border-gray-800/60 bg-gray-900/60"} p-2 lg:p-3`,children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-xs lg:text-sm font-semibold text-white",children:B.name}),a.jsx("p",{className:"text-[10px] lg:text-xs text-gray-500",children:B.formula})]}),a.jsxs("div",{className:"text-right",children:[a.jsx("p",{className:"text-sm lg:text-base font-bold text-rose-200",children:qa(B.amount)}),B.hasBonus&&a.jsxs("p",{className:"text-[9px] text-gray-500",children:[": ",qa(B.baseAmount)]})]})]},B.id)):a.jsx("p",{className:"text-xs lg:text-sm text-gray-500",children:""})})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-xs lg:text-sm font-semibold text-gray-300",children:""}),a.jsx("div",{className:"mt-1.5 lg:mt-2 space-y-1.5 lg:space-y-2",children:P.length?P.map(B=>a.jsxs("div",{className:`flex items-center justify-between rounded-lg lg:rounded-xl border ${B.hasBonus?"border-amber-500/30 bg-amber-950/20":"border-gray-800/60 bg-gray-900/60"} p-2 lg:p-3`,children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-xs lg:text-sm font-semibold text-white",children:B.name}),a.jsx("p",{className:"text-[10px] lg:text-xs text-gray-500",children:B.formula})]}),a.jsxs("div",{className:"text-right",children:[a.jsx("p",{className:"text-sm lg:text-base font-bold text-rose-200",children:qa(B.amount)}),B.hasBonus&&a.jsxs("p",{className:"text-[9px] text-gray-500",children:[": ",qa(B.baseAmount)]})]})]},B.id)):a.jsx("p",{className:"text-xs lg:text-sm text-gray-500",children:""})})]})]})]}),a.jsxs("div",{className:"rounded-xl lg:rounded-2xl border border-gray-800 bg-gray-950/60 p-3 lg:p-5",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-[10px] lg:text-xs uppercase tracking-wide text-gray-500",children:""}),a.jsxs("p",{className:"text-base lg:text-xl font-semibold text-white",children:[" ",qa(C),F!==C&&a.jsxs("span",{className:"text-sm text-gray-500 ml-2",children:["(: ",qa(F),")"]})]})]}),a.jsx(k,{name:"TrendingDown",size:18,className:"text-emerald-300"})]}),a.jsx("div",{className:"mt-2 lg:mt-4 space-y-1.5 lg:space-y-2",children:z.length?z.map(B=>a.jsxs("div",{className:`flex items-center justify-between rounded-lg lg:rounded-xl border ${B.hasBonus?"border-emerald-500/30 bg-emerald-950/20":"border-gray-800/60 bg-gray-900/60"} p-2 lg:p-3`,children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-xs lg:text-sm font-semibold text-white",children:B.name}),a.jsx("p",{className:"text-[10px] lg:text-xs text-gray-500",children:B.formula}),B.mods&&B.mods.length>0&&a.jsx("p",{className:"text-[9px] text-emerald-400",children:B.mods.join("  ")})]}),a.jsxs("div",{className:"text-right",children:[a.jsx("p",{className:"text-sm lg:text-base font-bold text-emerald-200",children:qa(B.amount)}),B.hasBonus&&a.jsxs("p",{className:"text-[9px] text-gray-500",children:[": ",qa(B.baseAmount)]})]})]},B.id)):a.jsx("p",{className:"text-xs lg:text-sm text-gray-500",children:""})}),Ne.length>0&&a.jsxs("div",{className:"mt-3 rounded-lg lg:rounded-xl border border-amber-600/30 bg-amber-500/5 p-2.5 lg:p-4",children:[a.jsxs("div",{className:"flex items-center gap-2 text-amber-200 text-[10px] lg:text-xs font-semibold",children:[a.jsx(k,{name:"AlertTriangle",size:14,className:"text-amber-300"}),""]}),a.jsx("div",{className:"mt-2 space-y-2",children:Ne.map(B=>a.jsxs("div",{className:"flex items-start justify-between gap-2",children:[a.jsxs("div",{className:"flex items-start gap-2",children:[a.jsx("div",{className:"rounded-lg bg-amber-400/10 border border-amber-400/30 p-1.5",children:a.jsx(k,{name:B.icon,size:14,className:"text-amber-200"})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-xs lg:text-sm font-semibold text-amber-100",children:B.name}),B.desc&&a.jsx("p",{className:"text-[10px] text-gray-400",children:B.desc}),B.shortages.length>0&&a.jsxs("p",{className:"text-[10px] text-amber-200/80 mt-0.5",children:["",B.shortages.join("")]})]})]}),a.jsxs("div",{className:"text-right",children:[a.jsxs("p",{className:"text-sm lg:text-base font-semibold text-amber-200",children:[B.penaltyPercent,"%"]}),a.jsx("p",{className:"text-[9px] text-gray-500",children:""})]})]},B.key))})]}),a.jsxs("div",{className:"mt-2 lg:mt-4 rounded-lg lg:rounded-xl border border-gray-800/60 bg-gray-900/60 p-2.5 lg:p-4 text-xs lg:text-sm text-gray-400",children:[" ",qa(C),"   ",qa(re),"  "," ",qa(Math.max(0,re-C)),(F!==C||V!==re)&&a.jsxs("span",{className:"text-gray-500 ml-2",children:["| : ",qa(F)," / ",qa(V)]})]})]})]}),j==="chain"&&a.jsx(jS,{resourceKey:t,buildings:o})]})]})})]})]})},NS=t=>Ps.createPortal(a.jsx(Ro,{children:t.resourceKey&&Re[t.resourceKey]&&$.createElement(wS,{...t,key:"content"})}),document.body),MS=({isOpen:t,onClose:s,population:r=0,maxPop:o=0,popStructure:c={},history:u={}})=>{const p=()=>{s()},m=u?.population||[],h=Object.keys(Ke).map(x=>{const g=c[x]||0,b=r>0?g/r*100:0;return{key:x,name:Ke[x].name,icon:Ke[x].icon,count:g,percent:b}}).filter(x=>x.count>0).sort((x,g)=>g.count-x.count);return Ps.createPortal(a.jsx(Ro,{children:t&&a.jsxs("div",{className:"fixed inset-0 z-[100] flex items-end justify-center lg:items-center",children:[a.jsx(As.div,{className:"absolute inset-0 bg-black/70",onClick:p,initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.3}}),a.jsxs(As.div,{className:"relative w-full max-w-2xl glass-epic border-t-2 lg:border-2 border-ancient-gold/30 rounded-t-2xl lg:rounded-2xl shadow-metal-xl flex flex-col max-h-[90vh]",initial:{y:"100%",opacity:0},animate:{y:0,opacity:1},exit:{y:"100%",opacity:0},transition:{type:"spring",damping:25,stiffness:300},children:[a.jsx("div",{className:"flex-shrink-0 p-3 border-b border-gray-700 bg-gray-900/70",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"w-10 h-10 icon-metal-container icon-metal-container-lg flex-shrink-0",children:a.jsx(k,{name:"Users",size:24,className:"text-blue-300 icon-metal-blue"})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h2",{className:"text-base font-bold text-white leading-tight font-decorative",children:""}),a.jsxs("p",{className:"text-[10px] text-gray-400 leading-tight",children:[" ",r," / ",o]})]}),a.jsx("button",{onClick:p,className:"p-2 rounded-full hover:bg-gray-700 flex-shrink-0",children:a.jsx(k,{name:"X",size:18,className:"text-gray-400"})})]})}),a.jsxs("div",{className:"flex-1 overflow-y-auto p-3 space-y-3",children:[a.jsxs("div",{className:"bg-gray-700/50 rounded p-2 border border-gray-600",children:[a.jsxs("div",{className:"mb-1.5 flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-[9px] uppercase tracking-wide text-gray-500 leading-none",children:""}),a.jsxs("p",{className:"text-sm font-semibold text-white leading-tight mt-0.5",children:[" ",r,"    ",o]})]}),a.jsx(k,{name:"Activity",size:16,className:"text-blue-300"})]}),a.jsx(bl,{data:m,color:"#60a5fa",label:""})]}),a.jsxs("div",{className:"bg-gray-700/50 rounded p-2 border border-gray-600",children:[a.jsxs("div",{className:"mb-1.5 flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-[9px] uppercase tracking-wide text-gray-500 leading-none",children:""}),a.jsx("p",{className:"text-sm font-semibold text-white leading-tight mt-0.5",children:""})]}),a.jsx(k,{name:"Layers",size:16,className:"text-purple-300"})]}),a.jsx("div",{className:"space-y-2",children:h.length?h.map(x=>a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center justify-between text-[10px] text-gray-300",children:[a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsx(k,{name:x.icon,size:14,className:"text-amber-300"}),a.jsx("span",{className:"leading-none",children:x.name})]}),a.jsxs("div",{className:"text-[9px] text-gray-400 font-mono leading-none",children:[x.count,"   ",x.percent.toFixed(1),"%"]})]}),a.jsx("div",{className:"mt-1 h-1.5 rounded-full bg-gray-800",children:a.jsx("div",{className:"h-full rounded-full bg-gradient-to-r from-blue-400 to-purple-500",style:{width:`${Math.min(x.percent,100)}%`}})})]},x.key)):a.jsx("p",{className:"text-[10px] text-gray-500 text-center py-2",children:""})})]})]}),a.jsx("div",{className:"flex-shrink-0 p-3 border-t border-gray-700 bg-gray-800/50",children:a.jsx("button",{onClick:p,className:"w-full px-4 py-2 bg-blue-600 hover:bg-blue-500 text-white rounded-lg text-sm font-bold transition-colors",children:""})})]})]})}),document.body)},_S=({festivalOptions:t,year:s,epoch:r,onSelect:o})=>{const[c,u]=$.useState(null),[p,m]=$.useState(null),[h,x]=$.useState(!1),g=t&&t.length>0,b=wn[r]||wn[0],j=()=>{c&&o(c)},_=M=>M||"Star",N=M=>{const R=[];return M.categories&&Object.entries(M.categories).forEach(([E,T])=>{const D=(T*100).toFixed(0),O=E==="gather"?"":E==="industry"?"":E;R.push(`${O} +${D}%`)}),M.production&&R.push(` +${(M.production*100).toFixed(0)}%`),M.industry&&R.push(` +${(M.industry*100).toFixed(0)}%`),M.scienceBonus&&R.push(` +${(M.scienceBonus*100).toFixed(0)}%`),M.cultureBonus&&R.push(` +${(M.cultureBonus*100).toFixed(0)}%`),M.militaryBonus&&R.push(` +${(M.militaryBonus*100).toFixed(0)}%`),M.taxIncome&&R.push(` +${(M.taxIncome*100).toFixed(0)}%`),M.stability&&R.push(` +${(M.stability*100).toFixed(0)}%`),M.maxPop&&R.push(` +${M.maxPop}`),R};return Ps.createPortal(a.jsx(Ro,{children:g&&a.jsxs("div",{className:"fixed inset-0 z-[100] flex items-end justify-center lg:items-center",children:[a.jsx(As.div,{className:"absolute inset-0 bg-black/80",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0}}),a.jsxs(As.div,{className:"relative w-full max-w-4xl glass-epic border-t-2 lg:border-2 border-ancient-gold/40 rounded-t-2xl lg:rounded-2xl shadow-metal-xl flex flex-col max-h-[92vh]",initial:{y:"100%",opacity:0},animate:{y:0,opacity:1},exit:{y:"100%",opacity:0},transition:{type:"spring",damping:25,stiffness:300},children:[a.jsx("div",{className:"flex-shrink-0 p-3 border-b border-gray-700 bg-gradient-to-r from-yellow-900/50 via-orange-900/50 to-red-900/50",children:a.jsxs("div",{className:"text-center",children:[a.jsxs("div",{className:"flex items-center justify-center gap-2 mb-1.5",children:[a.jsx(k,{name:"Sparkles",size:20,className:"text-yellow-400 animate-pulse"}),a.jsx("h2",{className:"text-base font-bold text-transparent bg-clip-text bg-gradient-to-r from-yellow-200 via-yellow-400 to-orange-400",children:"  "}),a.jsx(k,{name:"Sparkles",size:20,className:"text-yellow-400 animate-pulse"})]}),a.jsxs("p",{className:"text-sm text-white font-semibold leading-tight",children:[" ",s," "]}),a.jsxs("p",{className:"text-[10px] text-gray-300 leading-tight mt-0.5",children:[a.jsx("span",{className:`font-bold ${b.name}`,children:b.name}),"  "]})]})}),a.jsxs("div",{className:"flex-1 overflow-y-auto p-3 space-y-2",children:[a.jsx("div",{className:"bg-blue-900/20 border border-blue-500/30 p-2 rounded-lg",children:a.jsxs("div",{className:"flex items-start gap-2",children:[a.jsx(k,{name:"Info",size:14,className:"text-blue-400 flex-shrink-0 mt-0.5"}),a.jsxs("div",{className:"text-[10px] text-gray-300 leading-relaxed",children:[a.jsx("p",{className:"font-semibold text-blue-300 mb-0.5 leading-tight",children:""}),a.jsx("p",{children:""}),a.jsxs("p",{className:"mt-0.5",children:[a.jsx("span",{className:"text-yellow-400",children:" "})," 360",a.jsx("span",{className:"text-purple-400 ml-1",children:" "})," "]})]})]})}),a.jsx("div",{className:"grid grid-cols-1 gap-2",children:t.map((M,R)=>{const E=c?.id===M.id,T=M.type==="permanent",D=N(M.effects);return a.jsx(As.div,{className:"relative cursor-pointer transition-all duration-200",onClick:()=>u(M),whileHover:{scale:1.01},whileTap:{scale:.99},children:a.jsxs("div",{className:`rounded-lg border-2 overflow-hidden ${E?T?"border-purple-400 bg-purple-900/30":"border-yellow-400 bg-yellow-900/30":"border-gray-600 bg-gray-700/50"}`,children:[a.jsx("div",{className:`px-2 py-1 text-center text-[14px] font-bold ${T?"bg-gradient-to-r from-purple-600 to-purple-800 text-purple-100":"bg-gradient-to-r from-yellow-600 to-orange-600 text-yellow-100"}`,children:T?" ":" 1"}),a.jsxs("div",{className:"p-2",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-1.5",children:[a.jsx("div",{className:`p-2 rounded-lg ${T?"bg-purple-600/30":"bg-yellow-600/30"}`,children:a.jsx(k,{name:_(M.icon),size:20,className:T?"text-purple-300":"text-yellow-300"})}),a.jsx("div",{className:"flex-1 min-w-0",children:a.jsx("h3",{className:"text-sm font-bold text-white leading-tight",children:M.name})}),E&&a.jsx("div",{className:`p-1 rounded-full ${T?"bg-purple-500":"bg-yellow-500"}`,children:a.jsx(k,{name:"Check",size:14,className:"text-white"})})]}),a.jsx("p",{className:"text-[10px] text-gray-300 mb-1.5 leading-relaxed",children:M.description}),a.jsx("div",{className:"space-y-1 mb-1.5",children:D.map((O,q)=>a.jsxs("div",{className:`flex items-center gap-1.5 text-[11px] p-1 rounded ${T?"bg-purple-900/30 border border-purple-600/30":"bg-yellow-900/30 border border-yellow-600/30"}`,children:[a.jsx(k,{name:"Plus",size:10,className:T?"text-purple-400":"text-yellow-400"}),a.jsx("span",{className:"text-gray-200 leading-none",children:O})]},q))}),a.jsx("div",{className:"pt-1.5 border-t border-gray-600",children:a.jsxs("p",{className:"text-[9px] text-gray-400 italic leading-relaxed",children:['"',M.flavorText,'"']})})]})]})},M.id)})}),!c&&a.jsx("div",{className:"text-center",children:a.jsx("p",{className:"text-[10px] text-gray-400 animate-pulse leading-tight",children:" "})})]}),a.jsx("div",{className:"flex-shrink-0 p-3 border-t border-gray-700 bg-gray-800/50",children:a.jsx("button",{onClick:j,disabled:!c,className:`w-full px-4 py-2 rounded-lg text-sm font-bold transition-all ${c?"bg-gradient-to-r from-yellow-600 via-orange-600 to-red-600 hover:from-yellow-500 hover:via-orange-500 hover:to-red-500 text-white shadow-lg":"bg-gray-600 text-gray-400 cursor-not-allowed"}`,children:c?` ${c.name}`:""})})]})]})}),document.body)},ES=({show:t,onComplete:s,onSkip:r,onOpenWiki:o})=>{const[c,u]=$.useState(0),p=a5,m=p[c],h=c===0,x=c===p.length-1,g=()=>{x?s():u(_=>_+1)},b=()=>{h||u(_=>_-1)},j=()=>{r()};return Ps.createPortal(a.jsx(Ro,{children:t&&a.jsxs("div",{className:"fixed inset-0 z-[100] flex items-end justify-center lg:items-center",children:[a.jsx(As.div,{className:"absolute inset-0 bg-black/90",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.3}}),a.jsxs(As.div,{className:"relative w-full max-w-3xl bg-gray-900/95 backdrop-blur border-t-2 lg:border-2 border-blue-500/50 rounded-t-2xl lg:rounded-2xl shadow-2xl flex flex-col max-h-[92vh] font-sans",initial:{y:"100%",opacity:0},animate:{y:0,opacity:1},exit:{y:"100%",opacity:0},transition:{type:"spring",damping:25,stiffness:300},children:[a.jsx("div",{className:"h-1.5 bg-gray-800 rounded-t-2xl lg:rounded-t-xl overflow-hidden flex-shrink-0",children:a.jsx("div",{className:"h-full bg-gradient-to-r from-blue-500 to-purple-500 transition-all duration-300",style:{width:`${(c+1)/p.length*100}%`}})}),a.jsx("div",{className:"flex-shrink-0 p-3 border-b border-gray-700",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"w-10 h-10 bg-gray-800 rounded-lg flex items-center justify-center flex-shrink-0",children:a.jsx(k,{name:m.icon,size:24,className:m.iconColor})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h2",{className:"text-base font-bold text-white leading-tight font-decorative",children:m.title}),a.jsxs("p",{className:"text-[10px] text-gray-400 leading-tight font-sans",children:[" ",c+1," / ",p.length]})]}),a.jsx("button",{onClick:j,className:"px-2 py-1 text-[14px] text-gray-400 hover:text-white hover:bg-gray-800 rounded transition-colors flex-shrink-0 font-sans",children:""})]})}),a.jsx("div",{className:"flex-1 overflow-y-auto p-3 font-sans",children:a.jsx(CS,{step:m,onOpenWiki:o,isLastStep:x})}),a.jsxs("div",{className:"flex-shrink-0 p-3 border-t border-gray-700 flex items-center justify-between gap-2 font-sans",children:[a.jsxs("button",{onClick:b,disabled:h,className:`flex items-center gap-1 px-3 py-1.5 rounded-lg text-xs font-semibold transition-colors font-sans ${h?"text-gray-600 cursor-not-allowed":"text-white bg-gray-700 hover:bg-gray-600"}`,children:[a.jsx(k,{name:"ChevronLeft",size:14}),a.jsx("span",{className:"hidden sm:inline",children:""})]}),a.jsx("div",{className:"flex gap-1.5",children:p.map((_,N)=>a.jsx("div",{className:`w-1.5 h-1.5 rounded-full transition-colors ${N===c?"bg-blue-500":"bg-gray-700"}`},N))}),a.jsx("button",{onClick:g,className:"flex items-center gap-1 px-4 py-1.5 rounded-lg text-xs font-semibold bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-500 hover:to-purple-500 text-white transition-all shadow-lg font-sans",children:x?a.jsxs(a.Fragment,{children:[a.jsx(k,{name:"Play",size:14}),""]}):a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"hidden sm:inline",children:""}),a.jsx(k,{name:"ChevronRight",size:14})]})})]})]})]})}),document.body)},kS={info:{container:"bg-blue-900/30 border-blue-500/30",text:"text-blue-200"},success:{container:"bg-emerald-900/30 border-emerald-500/30",text:"text-emerald-200"},warning:{container:"bg-amber-900/30 border-amber-500/30",text:"text-amber-200"},tip:{container:"bg-purple-900/30 border-purple-500/30",text:"text-purple-200"}},CS=({step:t,onOpenWiki:s,isLastStep:r})=>t?a.jsxs("div",{className:"space-y-2",children:[t.lead&&a.jsx("p",{className:"text-sm text-white font-semibold font-decorative leading-tight",children:t.lead}),t.paragraphs?.map((o,c)=>a.jsx("p",{className:"text-[12px] text-gray-300 leading-relaxed",children:o},c)),t.cards?.length>0&&a.jsx("div",{className:"space-y-1.5",children:t.cards.map((o,c)=>a.jsxs("div",{className:"bg-gray-700/50 p-2 rounded-lg border border-gray-600",children:[a.jsxs("p",{className:"text-[14px] font-decorative text-white font-semibold mb-1 flex items-center gap-1.5 leading-tight",children:[o.icon&&a.jsx(k,{name:o.icon,size:14,className:o.iconColor||"text-white"}),o.title]}),a.jsx("p",{className:"text-[12px] text-gray-300 leading-relaxed",children:o.text})]},`${o.title}-${c}`))}),t.callouts?.length>0&&a.jsx("div",{className:"space-y-1.5",children:t.callouts.map((o,c)=>{const u=kS[o.tone]||{container:"bg-gray-800/40 border-gray-700",text:"text-gray-200"};return a.jsxs("div",{className:`p-2 rounded-lg border ${u.container} ${u.text}`,children:[a.jsxs("p",{className:"text-[14px] font-decorative font-semibold flex items-center gap-1.5 text-white leading-tight",children:[o.icon&&a.jsx(k,{name:o.icon,size:14,className:"text-current"}),o.title]}),a.jsx("p",{className:"text-[12px] mt-1 leading-relaxed",children:o.text})]},`${o.title}-${c}`)})}),t.wikiPrompt&&a.jsxs("div",{className:"bg-indigo-900/30 border border-indigo-500/40 p-2 rounded-lg space-y-2",children:[a.jsxs("p",{className:"text-indigo-200 flex items-center gap-1.5 text-[10px] leading-tight",children:[a.jsx(k,{name:"BookOpen",size:14,className:"text-indigo-300"}),t.wikiPrompt.text]}),typeof s=="function"&&a.jsxs("button",{type:"button",onClick:s,className:"px-3 py-1.5 rounded-lg bg-indigo-600/30 border border-indigo-500/50 text-[10px] font-semibold text-indigo-100 hover:bg-indigo-600/50 transition-colors flex items-center gap-1.5",children:[a.jsx(k,{name:"Book",size:14}),t.wikiPrompt.buttonLabel||""]})]}),t.footerNote&&a.jsx("p",{className:"text-center text-sm text-yellow-300 font-bold mt-3 leading-tight",children:t.footerNote}),r&&!t.footerNote&&a.jsx("p",{className:"text-center text-sm text-yellow-300 font-bold mt-3 leading-tight",children:""})]}):null,TS=[{id:"mech_quickstart",name:"",icon:"Zap",summary:"",content:[{type:"h4",text:" "},{type:"p",text:""},{type:"h4",text:" "},{type:"list",items:["","","","","",""]},{type:"h4",text:" "},{type:"p",text:"10"},{type:"list",items:["1. ","2. ","3. ",'4. """"',"5. 50020"]},{type:"p",text:"10-30"},{type:"list",items:["1. ","2. ","3. ",'4. ""',"5. "]},{type:"h4",text:" "},{type:"list",items:["1x/2x/5x","","","","",""]}]},{id:"mech_economy",name:"",icon:"Coins",summary:"",content:[{type:"h4",text:"1. "},{type:"p",text:""},{type:"list",items:[" (Supply) + "," (Demand) +  + "," > ",""]},{type:"h4",text:"2. "},{type:"p",text:"-"},{type:"list",items:[" (Head Tax)"," (Resource Tax)"," (Business Tax)"," ()"]},{type:"h4",text:"2.1 "},{type:"p",text:""},{type:"list",items:["",'"    "',"","","",""]},{type:"h4",text:"2.2 "},{type:"list",items:["","","","",""]},{type:"h4",text:"3. "},{type:"p",text:'""'},{type:"list",items:["","",""]},{type:"h4",text:"4. "},{type:"p",text:""},{type:"list",items:["3","320%","",""]}]},{id:"mech_price_calculation",name:"",icon:"TrendingUp",summary:"",content:[{type:"h4",text:" "},{type:"p",text:""},{type:"h4",text:" "},{type:"p",text:""},{type:"list",items:[" = ( + ) / "," = (  )"," = (  )"," = max(  0.8,   1.05)"," marketConfig.wage "]},{type:"p",text:"210=2020=20/20=1.0"},{type:"h4",text:" "},{type:"p",text:""},{type:"list",items:[" = ( + ) / "," =   virtualDemandPerPop","pressure = tanh(ln()  0.9)  supplyDemandWeight"," = 1 + pressure  (3.5 - 1)"," = 1 + pressure  (1 - 0.7)"]},{type:"p",text:"supplyDemandWeight  marketConfig "},{type:"list",items:["0.6","1.5","1.0"]},{type:"p",text:"=2.0pressure0.552.375"},{type:"h4",text:" "},{type:"p",text:""},{type:"list",items:[" =  / "," =   inventoryTargetDays"," = max(0.3, 1 + (1 - )  inventoryPriceImpact)",""]},{type:"p",text:"inventoryTargetDays  inventoryPriceImpact "},{type:"list",items:["300.15","100.4","200.25"]},{type:"p",text:"1002000.5=1+(1-0.5)0.25=1.125"},{type:"h4",text:" "},{type:"list",items:[" =     ","max(,   0.6)","max(, PRICE_FLOOR)"," =  + ( - )  0.1",""]},{type:"h4",text:" "},{type:"p",text:" marketConfig "},{type:"list",items:["price.livingCostWeight","price.taxCostWeight","wage.livingCostWeight","wage.taxCostWeight"]},{type:"p",text:""},{type:"list",items:["price: {livingCostWeight: 0.15, taxCostWeight: 0.2}","wage: {livingCostWeight: 0.08, taxCostWeight: 0.05}",""]},{type:"p",text:""},{type:"list",items:["price: {livingCostWeight: 0.3, taxCostWeight: 0.4}","wage: {livingCostWeight: 0.15, taxCostWeight: 0.15}",""]},{type:"h4",text:" "},{type:"list",items:["1.  marketConfig ","2.  wage ","3.  supplyDemandWeight ","4.  inventoryPriceImpact ","5.  =     ","6. 60%","7. 10%"]},{type:"h4",text:" "},{type:"list",items:[" +  = "," +  = ","","",""]},{type:"h4",text:" "},{type:"list",items:["","","","",""]}]},{id:"mech_strata",name:"",icon:"Users",summary:"",content:[{type:"h4",text:"1. "},{type:"p",text:""},{type:"list",items:[" <  (MaxPop)"," >   1.5",""," (0)"]},{type:"h4",text:"2.  () "},{type:"p",text:'""'},{type:"list",items:["",'""+',"",""]},{type:"h4",text:"3. "},{type:"p",text:"Buff/Debuff"},{type:"list",items:["","","",""]},{type:"h4",text:"4. "},{type:"p",text:""},{type:"list",items:["","",""]},{type:"h4",text:"5.  ()"},{type:"p",text:""},{type:"list",items:["1.523...","","",""]}]},{id:"mech_rebellion",name:"",icon:"Skull",summary:"",content:[{type:"h4",text:" "},{type:"p",text:""},{type:"h4",text:"1. "},{type:"list",items:["( > 30%)","( > 70%)","()"]},{type:"h4",text:"2.  (Coalition)"},{type:"p",text:""},{type:"h4",text:"3. "},{type:"p",text:""},{type:"list",items:["","","",""]}]},{id:"mech_events",name:"",icon:"Zap",summary:"",content:[{type:"h4",text:" "},{type:"p",text:""},{type:"h4",text:"1. "},{type:"list",items:["","","","Buff"]},{type:"h4",text:"2. "},{type:"p",text:""},{type:"list",items:["","",""]}]},{id:"mech_military",name:"",icon:"Swords",summary:"",content:[{type:"h4",text:"1. "},{type:"p",text:""},{type:"list",items:["/   (+60%~100% ) - ","  / (+50%~90% ) - ","   (+40%~70% ) - ","  / (+40%~80% ) - "," "]},{type:"h4",text:"2. "},{type:"p",text:" = (+)      "},{type:"p",text:"Buff"},{type:"h4",text:"3. "},{type:"list",items:["30%","","",""]}]},{id:"mech_military_actions",name:"",icon:"Crosshair",summary:"",content:[{type:"h4",text:" "},{type:"p",text:""},{type:"h4",text:"1. "},{type:"list",items:[" (Raid)"," (Assault)"," (Siege)"," (Naval Raid)"," (Scorched Earth)/"]},{type:"h4",text:"2. "},{type:"list",items:["","",""]}]},{id:"mech_tech",name:"",icon:"Cpu",summary:"",content:[{type:"h4",text:"1. "},{type:"p",text:""},{type:"list",items:["","","",""]},{type:"h4",text:"2. "},{type:"p",text:""},{type:"list",items:["+15%+10%","+20%+15%+10%","+25%+20%+15%","+30%+25%+20%","+35%+30%+25%","+40%+35%+30%","+50%+40%+35%"]},{type:"h4",text:"3. "},{type:"p",text:""},{type:"list",items:["","","",""]},{type:"h4",text:"4. "},{type:"list",items:["","","",""]}]},{id:"mech_diplomacy",name:"",icon:"Globe",summary:"",content:[{type:"h4",text:"1. "},{type:"list",items:["-100 +100","",""]},{type:"h4",text:"2. "},{type:"p",text:""},{type:"list",items:[" +/- 500","AI",""]},{type:"h4",text:"3.  (Annexation)"},{type:"p",text:""},{type:"list",items:[" > 350 "," > 450 ","",""]},{type:"h4",text:"4. "},{type:"p",text:"0"}]},{id:"mech_decrees",name:"",icon:"Gavel",summary:"",content:[{type:"h4",text:"1. "},{type:"p",text:""},{type:"list",items:["","","",""]},{type:"h4",text:"2. "},{type:"list",items:["",""]},{type:"h4",text:"3. "},{type:"p",text:""},{type:"list",items:["+30%-20","+25%-10%","+50%-20%","+30%",""]},{type:"h4",text:"4. "},{type:"p",text:""},{type:"list",items:["","","","",""]},{type:"h4",text:"5. "},{type:"list",items:["","","","",""]}]},{id:"mech_buildings",name:"",icon:"Home",summary:"",content:[{type:"h4",text:"1. "},{type:"list",items:["","","",""]},{type:"h4",text:"2. "},{type:"list",items:["","","",""]},{type:"h4",text:"3. "},{type:"p",text:""},{type:"list",items:["","","","",""]},{type:"h4",text:"4. "},{type:"list",items:["","","","",""]},{type:"h4",text:"5. "},{type:"list",items:["","","",""]}]},{id:"mech_festivals",name:"",icon:"PartyPopper",summary:"",content:[{type:"h4",text:"1. "},{type:"list",items:["","",""]},{type:"h4",text:"2. "},{type:"p",text:"3"},{type:"list",items:["1+50%","+10%",""]},{type:"h4",text:"3. "},{type:"p",text:""},{type:"list",items:["","","",""]},{type:"h4",text:"4. "},{type:"list",items:["","//","","","+10%"]},{type:"h4",text:"5. "},{type:"list",items:["+30%1","20%1","+40%1","+12%","+15%"]}]},{id:"mech_advanced",name:"",icon:"Trophy",summary:"",content:[{type:"h4",text:"1. "},{type:"list",items:["","","","",""]},{type:"h4",text:"2. "},{type:"list",items:["","","","++",""]},{type:"h4",text:"3. "},{type:"list",items:["","","","",""]},{type:"h4",text:"4. "},{type:"list",items:["","","","",""]},{type:"h4",text:"5. "},{type:"p",text:""},{type:"list",items:["","","","",""]},{type:"h4",text:"6. "},{type:"list",items:["","","",""]}]}],Q0=[{id:"mechanics",label:"",icon:"BookOpen"},{id:"economy",label:"",icon:"Users"},{id:"buildings",label:"",icon:"Home"},{id:"military",label:"",icon:"Shield"},{id:"technologies",label:"",icon:"Cpu"},{id:"decrees",label:"",icon:"Gavel"},{id:"events",label:"",icon:"Zap"},{id:"resources",label:"",icon:"Package"}],SS={gather:"",industry:"",civic:"",military:""},AS={infantry:"",archer:"",cavalry:"",siege:"",support:""},PS=(_l||[]).reduce((t,s)=>(t[s.id]=s.name,t),{}),hf=(Ln||[]).reduce((t,s)=>(t[s.id]=s.name,t),{}),xf=Object.entries(Ke||{}).reduce((t,[s,r])=>(t[s]=r?.name||s,t),{}),k2=t=>PS[t]||t,DS=t=>hf[t]||t,bd=t=>xf[t]||t,Ny=RS();function RS(){return{mechanics:TS.map(t=>({id:t.id,name:t.name,summary:t.summary,icon:t.icon,iconColor:"text-blue-300",type:"mechanics",data:t.content})),economy:Object.entries(Ke||{}).map(([t,s])=>({id:t,name:s?.name||t,summary:s?.desc,icon:s?.icon||"Users",iconColor:"text-amber-200",type:"economy",data:s})),buildings:(Ln||[]).map(t=>({id:t.id,name:t.name,summary:t.desc,icon:t.visual?.icon||"Home",iconColor:t.visual?.text||"text-slate-200",type:"building",data:t})),military:Object.values(un||{}).map(t=>({id:t.id,name:t.name,summary:t.desc,icon:t.icon||"Swords",iconColor:"text-red-200",type:"military",data:t})),technologies:(_l||[]).map(t=>({id:t.id,name:t.name,summary:t.desc,icon:"Cpu",iconColor:"text-purple-200",type:"technology",data:t})),decrees:(nd||[]).map(t=>({id:t.id,name:t.name,summary:t.desc,icon:"Gavel",iconColor:"text-amber-200",type:"decree",data:t})),resources:Object.entries(Re||{}).map(([t,s])=>({id:t,name:s?.name||t,summary:s?.tags?.map(r=>r==="raw_material"?"":r==="manufactured"?"":r==="luxury"?"":r==="essential"?"":r==="special"?"":r==="virtual"?"":r==="currency"?"":r==="industrial"?"":r).join("  "),icon:s?.icon||"Package",iconColor:s?.color||"text-slate-200",type:"resource",data:{...s,id:t}})),events:[...Cy.map(t=>({id:t.id,name:t.name,summary:t.description,icon:t.icon||"Zap",iconColor:"text-yellow-400",type:"event",data:{...t,type:"random"}})),...Ty.map(t=>({id:t.id,name:t.name,summary:t.description,icon:"Clock",iconColor:"text-blue-400",type:"event",data:{...t,type:"epoch"}})),...Object.values(Dy).flat().map(t=>({id:t.id,name:t.name,summary:t.description,icon:"PartyPopper",iconColor:"text-purple-400",type:"event",data:{...t,type:"festival",options:[]}})),...(Sy||[]).map(t=>({id:t.id,name:t.name,summary:t.description,icon:t.icon||"Globe2",iconColor:"text-sky-300",type:"event",data:{...t,type:"diplomatic"}}))]}}const Ea=t=>typeof t!="number"?t:Math.abs(t)>=100?t.toFixed(0):Math.abs(t-Math.round(t))<.001?Math.round(t).toString():t.toFixed(2),xr=t=>t==null||Number.isNaN(t)?void 0:wn[t]?.name||` ${t+1} `,am=t=>Re?.[t]||{name:t},$p=(t,{isPercent:s}={})=>{if(typeof t!="number")return t;if(s){const o=t*100;return`${o>0?"+":(o<0,"")}${Ea(o)}%`}return`${t>0?"+":(t<0,"")}${Ea(t)}`},So=(t,s="",r={})=>t?Array.isArray(t)?t:typeof t=="string"?[t]:typeof t=="number"?[`${s}${s?": ":""}${$p(t,r)}`]:typeof t=="object"?Object.entries(t).flatMap(([o,c])=>{let u=o;o==="production"?u="":o==="taxIncome"?u="":o==="stability"?u="":o==="scienceBonus"||o==="science"?u="":o==="cultureBonus"?u="":o==="industry"?u="":o==="gather"?u="":o==="maxPop"?u="":o==="resourcePercent"?u="":o==="populationPercent"?u="":o==="approval"?u="":o==="resourceDemandMod"?u="":o==="buildingProductionMod"?u="":o==="stratumDemandMod"?u="":o==="nationRelation"?u="":o==="nationAggression"?u="":o==="nationWealth"?u="":o==="nationMarketVolatility"?u="":o==="triggerWar"?u="":o==="triggerPeace"?u="":o==="random"?u="":o==="all"?u="":o==="hostile"?u="":o==="friendly"?u="":o==="strongest"?u="":o==="weakest"&&(u=""),Re&&Re[o]?u=am(o).name:hf&&hf[o]?u=DS(o):xf&&xf[o]&&(u=bd(o));const p=r.isPercent||o==="resourcePercent"||o==="populationPercent"||o==="resourceDemandMod"||o==="buildingProductionMod"||o==="stratumDemandMod"||o==="nationAggression"||o==="nationMarketVolatility",m={...r,isPercent:p},h=s?`${s}  ${u}`:u;return typeof c=="object"&&!Array.isArray(c)?So(c,h,m):Array.isArray(c)?c.map(x=>`${h}: ${$p(x,m)}`):[`${h}: ${$p(c,m)}`]}):[]:[],Ao=(t,s)=>{if(!s||typeof s!="object")return null;const r=Object.entries(s);return r.length?a.jsxs("div",{className:"space-y-2",children:[a.jsx("p",{className:"text-sm text-gray-400",children:t}),a.jsx("div",{className:"flex flex-wrap gap-2",children:r.map(([o,c])=>{const u=am(o);return a.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 rounded-full bg-gray-800/70 text-gray-200 text-xs border border-gray-700",children:[u.icon&&a.jsx(k,{name:u.icon,size:14,className:u.color||"text-gray-200"}),a.jsx("span",{children:u.name||o}),c!==void 0&&a.jsx("span",{className:"font-mono text-[11px]",children:Ea(c)})]},`${t}-${o}`)})})]}):null},$S=t=>{if(!t||typeof t!="object")return null;const s=Object.entries(t);return s.length?a.jsxs("div",{className:"space-y-2",children:[a.jsx("p",{className:"text-sm text-gray-400",children:""}),a.jsx("div",{className:"flex flex-wrap gap-2",children:s.map(([r,o])=>{const c=Ke?.[r];return a.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 rounded-full bg-gray-800/70 text-gray-200 text-xs border border-gray-700",children:[c?.icon&&a.jsx(k,{name:c.icon,size:14,className:"text-slate-200"}),a.jsx("span",{children:c?.name||r}),a.jsxs("span",{className:"font-mono text-[11px]",children:["x",Ea(o)]})]},`job-${r}`)})})]}):null},Ml=(t,s)=>!s||!s.length?null:a.jsxs("div",{className:"space-y-2",children:[a.jsx("p",{className:"text-sm text-gray-400",children:t}),a.jsx("ul",{className:"list-disc list-inside text-gray-200 text-sm space-y-1",children:s.map((r,o)=>a.jsx("li",{children:r},`${t}-${o}`))})]}),$o=({rows:t})=>!t||!t.length?null:a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:t.map(s=>a.jsxs("div",{className:"bg-gray-800/60 rounded-lg p-3 border border-gray-700",children:[a.jsx("p",{className:"text-xs text-gray-400",children:s.label}),a.jsx("p",{className:"text-sm text-white font-semibold mt-1",children:s.value})]},s.label))}),OS=({buffs:t})=>{if(!t)return null;const s=Object.entries(t);return s.length?a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:s.map(([r,o])=>{const{desc:c,...u}=o||{};return a.jsxs("div",{className:"bg-gray-800/60 border border-gray-700 rounded-lg p-3",children:[a.jsx("p",{className:"text-xs uppercase tracking-wide text-gray-400",children:r==="satisfied"?"":""}),a.jsx("p",{className:"text-sm text-gray-200 mt-1 font-semibold",children:c}),Ml("",So(u))]},r)})}):null},zS=({tags:t})=>!t||!t.length?null:a.jsx("div",{className:"flex flex-wrap gap-2",children:t.map(s=>a.jsx("span",{className:"px-2 py-0.5 text-[11px] uppercase tracking-wide bg-gray-800/70 border border-gray-700 rounded-full text-gray-300",children:s},s))}),BS=({show:t,onClose:s})=>{const[r,o]=$.useState(Q0[0].id),[c,u]=$.useState(""),[p,m]=$.useState(null),[h,x]=$.useState(!0);$.useEffect(()=>{t&&m(M=>M||(Ny[r]?.[0]?.id??null))},[t,r]);const g=$.useMemo(()=>Ny[r]||[],[r]),b=c.trim().toLowerCase(),j=$.useMemo(()=>b?g.filter(M=>`${M.name} ${M.summary||""}`.toLowerCase().includes(b)):g,[g,b]);$.useEffect(()=>{if(!j.length){m(null);return}j.some(M=>M.id===p)||m(j[0].id)},[j,p]);const _=j.find(M=>M.id===p)||g.find(M=>M.id===p)||j[0],N=M=>{m(M),x(!1)};return t?a.jsx("div",{className:"fixed inset-0 bg-black/80 z-[100] flex items-center justify-center p-0 sm:p-4",children:a.jsxs("div",{className:"bg-gray-900/95 backdrop-blur-lg sm:rounded-2xl border-t sm:border border-indigo-500/40 shadow-2xl w-full max-w-6xl h-full sm:h-[90vh] flex flex-col overflow-hidden",children:[a.jsxs("div",{className:"flex items-center justify-between px-3 sm:px-6 py-2 sm:py-4 border-b border-gray-800 bg-gray-900",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-[10px] sm:text-xs uppercase tracking-widest text-indigo-400 mb-0.5 sm:mb-1",children:"CIVILIZATION KNOWLEDGE BASE"}),a.jsxs("h2",{className:"text-base font-decorative sm:text-2xl font-bold text-white flex items-center gap-1 sm:gap-2",children:[a.jsx(k,{name:"BookOpen",size:18,className:"text-indigo-300 sm:w-6 sm:h-6"}),""]})]}),a.jsx("button",{onClick:s,className:"p-1.5 sm:p-2 rounded-lg border border-gray-700 text-gray-300 hover:text-white hover:border-gray-500 transition-colors","aria-label":"",children:a.jsx(k,{name:"X",size:18,className:"sm:w-5 sm:h-5"})})]}),a.jsxs("div",{className:"flex flex-1 overflow-hidden relative",children:[a.jsxs("aside",{className:`${h?"flex":"hidden"} lg:flex w-full lg:w-72 border-r border-gray-800 bg-gray-900/60 flex-col overflow-y-auto absolute lg:relative inset-0 lg:inset-auto z-10`,children:[a.jsx("div",{className:"grid grid-cols-2 gap-1 sm:gap-2 p-2 sm:p-4",children:Q0.map(M=>{const R=M.id===r;return a.jsxs("button",{type:"button",onClick:()=>o(M.id),className:`flex items-center gap-1 sm:gap-2 px-2 sm:px-3 py-1.5 sm:py-2 rounded-lg border text-[10px] sm:text-xs font-medium transition-colors ${R?"border-indigo-400 bg-indigo-900/40 text-indigo-100":"border-gray-700 text-gray-400 hover:text-gray-100 hover:border-gray-500"}`,children:[a.jsx(k,{name:M.icon,size:12,className:"sm:w-3.5 sm:h-3.5"}),a.jsx("span",{className:"truncate",children:M.label})]},M.id)})}),a.jsx("div",{className:"px-2 sm:px-4 pb-2",children:a.jsxs("div",{className:"relative",children:[a.jsx(k,{name:"Search",size:12,className:"text-gray-500 absolute left-2 sm:left-3 top-1/2 -translate-y-1/2 sm:w-3.5 sm:h-3.5"}),a.jsx("input",{type:"text",value:c,onChange:M=>u(M.target.value),placeholder:`${Q0.find(M=>M.id===r)?.label}...`,className:"w-full bg-gray-800/70 border border-gray-700 rounded-lg pl-7 sm:pl-9 pr-2 sm:pr-3 py-1.5 sm:py-2 text-[11px] sm:text-xs text-gray-100 focus:outline-none focus:ring-2 focus:ring-indigo-500"})]})}),a.jsx("div",{className:"flex-1 overflow-y-auto px-2 sm:px-3 pb-4 space-y-0.5 sm:space-y-1",children:j.length===0?a.jsx("p",{className:"text-[10px] sm:text-xs text-gray-500 px-2 py-3 sm:py-4 text-center border border-dashed border-gray-800 rounded-lg",children:""}):j.map(M=>{const R=M.id===p;return a.jsxs("button",{type:"button",onClick:()=>N(M.id),className:`w-full text-left px-2 sm:px-3 py-1.5 sm:py-2.5 rounded-lg sm:rounded-xl border transition-all ${R?"bg-indigo-900/30 border-indigo-500/40 shadow-sm":"bg-transparent border-transparent hover:bg-gray-800/50 hover:border-gray-700"}`,children:[a.jsxs("p",{className:`text-xs sm:text-sm font-semibold flex items-center gap-1 sm:gap-2 ${R?"text-indigo-200":"text-gray-300"}`,children:[a.jsx(k,{name:M.icon||"Bookmark",size:12,className:`${R?"text-indigo-300":M.iconColor} sm:w-3.5 sm:h-3.5`}),a.jsx("span",{className:"truncate",children:M.name})]}),M.summary&&a.jsx("p",{className:"text-[10px] sm:text-[11px] text-gray-500 mt-0.5 truncate ml-4 sm:ml-6",children:M.summary})]},M.id)})})]}),a.jsx("section",{className:`${h?"hidden":"flex"} lg:flex flex-1 flex-col bg-gray-900/30 overflow-hidden`,children:_?a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"p-3 sm:p-6 border-b border-gray-800 bg-gray-800/20",children:[a.jsxs("button",{onClick:()=>x(!0),className:"lg:hidden mb-2 flex items-center gap-1 text-indigo-300 hover:text-white text-xs font-semibold bg-indigo-900/30 hover:bg-indigo-900/60 border border-indigo-500/40 rounded-full px-3 py-1 transition-all",children:[a.jsx(k,{name:"ChevronLeft",size:14}),a.jsx("span",{children:""})]}),a.jsxs("div",{className:"flex items-center gap-2 sm:gap-4",children:[a.jsx("div",{className:"p-2 sm:p-3 rounded-lg sm:rounded-2xl bg-gray-800 shadow-lg border border-gray-700",children:a.jsx(k,{name:_.icon||"Book",size:20,className:`${_.iconColor} sm:w-8 sm:h-8`})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("p",{className:"text-[10px] sm:text-xs uppercase tracking-widest text-indigo-400 mb-0.5 sm:mb-1",children:Q0.find(M=>M.id===r)?.label}),a.jsx("h3",{className:"text-lg sm:text-3xl font-bold text-white truncate font-decorative",children:_.name}),_.summary&&a.jsx("p",{className:"text-xs sm:text-sm text-gray-400 mt-0.5 sm:mt-1 line-clamp-2",children:_.summary})]})]})]}),a.jsx("div",{className:"flex-1 overflow-y-auto p-3 sm:p-8 space-y-4 sm:space-y-8",children:LS(_)})]}):a.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center text-gray-500 opacity-50 p-4",children:[a.jsx(k,{name:"BookOpen",size:48,className:"mb-3 sm:w-16 sm:h-16 sm:mb-4"}),a.jsx("p",{className:"text-xs sm:text-base text-center",children:""})]})})]})]})}):null},LS=t=>{const{data:s,type:r}=t;if(!s)return a.jsx("p",{className:"text-gray-400",children:""});switch(r){case"mechanics":return VS(s);case"economy":return WS(s);case"building":return US(s);case"military":return IS(s);case"technology":return HS(s);case"decree":return qS(s);case"resource":return GS(s);case"event":return YS(s);default:return a.jsx("div",{className:"space-y-4",children:a.jsx("p",{className:"text-gray-300",children:t.summary||""})})}},VS=t=>Array.isArray(t)?a.jsx("div",{className:"space-y-3 sm:space-y-6 max-w-3xl",children:t.map((s,r)=>s.type==="h4"?a.jsx("h4",{className:"text-sm sm:text-lg font-bold text-indigo-300 mt-3 sm:mt-6 mb-1 sm:mb-2 pb-1 sm:pb-2 border-b border-gray-700 font-decorative",children:s.text},r):s.type==="p"?a.jsx("p",{className:"text-gray-300 leading-5 sm:leading-7 text-xs sm:text-sm",children:s.text},r):s.type==="list"?a.jsx("ul",{className:"list-disc list-inside space-y-1 sm:space-y-2 bg-gray-800/40 p-2 sm:p-4 rounded-lg border border-gray-700/50",children:s.items.map((o,c)=>a.jsx("li",{className:"text-gray-300 text-xs sm:text-sm leading-tight sm:leading-normal",children:o},c))},r):null)}):null,WS=t=>{const s=[t.weight!==void 0&&{label:"",value:Ea(t.weight)},t.tax!==void 0&&{label:" ()",value:Ea(t.tax)},t.headTaxBase!==void 0&&{label:"",value:`${Ea(t.headTaxBase)} /`},t.wealthWeight!==void 0&&{label:"",value:Ea(t.wealthWeight)},t.influenceBase!==void 0&&{label:"",value:Ea(t.influenceBase)},t.startingWealth!==void 0&&{label:"",value:`${Ea(t.startingWealth)} `},t.defaultResource&&{label:"",value:am(t.defaultResource).name}].filter(Boolean);return a.jsxs("div",{className:"space-y-3 sm:space-y-6",children:[a.jsx("div",{className:"bg-gray-800/40 p-2 sm:p-4 rounded-lg sm:rounded-xl border border-gray-700/50",children:a.jsx("p",{className:"text-gray-300 leading-relaxed text-xs sm:text-sm",children:t.desc})}),a.jsx($o,{rows:s}),Ao("",t.needs),a.jsx(OS,{buffs:t.buffs})]})},US=t=>{const s=[t.cat&&{label:"",value:SS[t.cat]||t.cat},t.owner&&{label:"",value:bd(t.owner)},(t.epoch!==void 0||t.unlockEpoch!==void 0)&&{label:"",value:xr(t.epoch??t.unlockEpoch)},t.requiresTech&&{label:"",value:k2(t.requiresTech)}].filter(Boolean);return a.jsxs("div",{className:"space-y-6",children:[a.jsx("div",{className:"bg-gray-800/40 p-4 rounded-xl border border-gray-700/50",children:a.jsx("p",{className:"text-gray-300 leading-relaxed text-sm",children:t.desc})}),a.jsx($o,{rows:s}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[Ao("",t.baseCost),Ao("",t.output),Ao("",t.input),$S(t.jobs)]})]})},IS=t=>{const s=[t.category&&{label:"",value:AS[t.category]||t.category},t.epoch!==void 0&&{label:"",value:xr(t.epoch)},t.populationCost!==void 0&&{label:"",value:Ea(t.populationCost)},t.trainingTime!==void 0&&{label:" ()",value:Ea(t.trainingTime)},t.attack!==void 0&&{label:"",value:Ea(t.attack)},t.defense!==void 0&&{label:"",value:Ea(t.defense)},t.range!==void 0&&{label:"",value:Ea(t.range)}].filter(Boolean);return a.jsxs("div",{className:"space-y-6",children:[a.jsx("div",{className:"bg-gray-800/40 p-4 rounded-xl border border-gray-700/50",children:a.jsx("p",{className:"text-gray-300 leading-relaxed text-sm",children:t.desc})}),a.jsx($o,{rows:s}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[Ao("",t.recruitCost),Ao("",t.maintenanceCost)]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[Ml("",t.abilities),Ml("",So(t.counters).map(r=>r.replace("infantry","").replace("cavalry","").replace("archer","").replace("siege","")))]})]})},HS=t=>{const s=[t.epoch!==void 0&&{label:"",value:xr(t.epoch)}].filter(Boolean);return a.jsxs("div",{className:"space-y-6",children:[a.jsx("div",{className:"bg-gray-800/40 p-4 rounded-xl border border-gray-700/50",children:a.jsx("p",{className:"text-gray-300 leading-relaxed text-sm",children:t.desc})}),a.jsx($o,{rows:s}),Ao("",t.cost),Ml("",So(t.effects))]})},qS=t=>{const s=[t.category&&{label:"",value:t.category==="economy"?"":t.category==="military"?"":t.category==="culture"?"":""},t.unlockEpoch!==void 0&&{label:"",value:xr(t.unlockEpoch)}].filter(Boolean);return a.jsxs("div",{className:"space-y-6",children:[a.jsx("div",{className:"bg-gray-800/40 p-4 rounded-xl border border-gray-700/50",children:a.jsx("p",{className:"text-gray-300 leading-relaxed text-sm",children:t.desc})}),a.jsx($o,{rows:s}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[a.jsx("div",{className:"p-4 bg-green-900/20 border border-green-800/30 rounded-lg",children:Ml("",t.effects)}),a.jsx("div",{className:"p-4 bg-red-900/20 border border-red-800/30 rounded-lg",children:Ml("",t.drawbacks)})]})]})},GS=t=>{const s=[t.basePrice!==void 0&&{label:"",value:`${Ea(t.basePrice)} `},t.type&&{label:"",value:t.type==="currency"?"":t.type==="virtual"?"":""},t.unlockEpoch!==void 0&&{label:"",value:xr(t.unlockEpoch)},t.unlockTech&&{label:"",value:k2(t.unlockTech)},t.defaultOwner&&{label:"",value:bd(t.defaultOwner)}].filter(Boolean);return a.jsxs("div",{className:"space-y-6",children:[a.jsx("div",{className:"bg-gray-800/40 p-4 rounded-xl border border-gray-700/50",children:a.jsx("p",{className:"text-gray-300 leading-relaxed text-sm",children:t.desc||""})}),a.jsx($o,{rows:s}),a.jsx(zS,{tags:t.tags})]})},FS=t=>{if(!t)return[];const s=[],{minEpoch:r,maxEpoch:o,minPopulation:c,maxPopulation:u,minScience:p,minStability:m,maxStability:h,classConditions:x}=t;if((r!==void 0||o!==void 0)&&(r!==void 0&&o!==void 0?s.push(`${xr(r)}  ${xr(o)}`):r!==void 0?s.push(`${xr(r)}`):o!==void 0&&s.push(`${xr(o)}`)),c!==void 0||u!==void 0){const g=[];c!==void 0&&g.push(` ${c}`),u!==void 0&&g.push(` ${u}`),s.push(`${g.join("")}`)}if(m!==void 0||h!==void 0){const g=[];m!==void 0&&g.push(` ${m}`),h!==void 0&&g.push(` ${h}`),s.push(`${g.join("")}`)}return p!==void 0&&s.push(` ${Ea(p)}`),x&&typeof x=="object"&&Object.entries(x).forEach(([g,b])=>{if(!b)return;const j=[];if((b.minPop!==void 0||b.maxPop!==void 0)&&(b.minPop!==void 0&&b.maxPop!==void 0?j.push(` ${b.minPop}${b.maxPop} `):b.minPop!==void 0?j.push(`${b.minPop}`):b.maxPop!==void 0&&j.push(`${b.maxPop}`)),(b.minApproval!==void 0||b.maxApproval!==void 0)&&(b.minApproval!==void 0&&b.maxApproval!==void 0?j.push(` ${b.minApproval}${b.maxApproval} `):b.minApproval!==void 0?j.push(`${b.minApproval}`):b.maxApproval!==void 0&&j.push(`${b.maxApproval}`)),b.minInfluenceShare!==void 0||b.maxInfluenceShare!==void 0){const _=b.minInfluenceShare!==void 0?`${Ea(b.minInfluenceShare*100)}%`:null,N=b.maxInfluenceShare!==void 0?`${Ea(b.maxInfluenceShare*100)}%`:null;_&&N?j.push(` ${_}${N} `):_?j.push(`${_}`):N&&j.push(`${N}`)}if((b.minWealth!==void 0||b.maxWealth!==void 0)&&(b.minWealth!==void 0&&b.maxWealth!==void 0?j.push(` ${Ea(b.minWealth)}${Ea(b.maxWealth)} `):b.minWealth!==void 0?j.push(`${Ea(b.minWealth)}`):b.maxWealth!==void 0&&j.push(`${Ea(b.maxWealth)}`)),b.minWealthShare!==void 0||b.maxWealthShare!==void 0){const _=b.minWealthShare!==void 0?`${Ea(b.minWealthShare*100)}%`:null,N=b.maxWealthShare!==void 0?`${Ea(b.maxWealthShare*100)}%`:null;_&&N?j.push(` ${_}${N} `):_?j.push(`${_}`):N&&j.push(`${N}`)}(b.minWealthDelta!==void 0||b.maxWealthDelta!==void 0)&&(b.minWealthDelta!==void 0&&b.maxWealthDelta!==void 0?j.push(` ${Ea(b.minWealthDelta)}${Ea(b.maxWealthDelta)} `):b.minWealthDelta!==void 0?j.push(`${Ea(b.minWealthDelta)}`):b.maxWealthDelta!==void 0&&j.push(`${Ea(b.maxWealthDelta)}`)),(b.minIncome!==void 0||b.maxIncome!==void 0)&&(b.minIncome!==void 0&&b.maxIncome!==void 0?j.push(` ${Ea(b.minIncome)}${Ea(b.maxIncome)} `):b.minIncome!==void 0?j.push(`${Ea(b.minIncome)}`):b.maxIncome!==void 0&&j.push(`${Ea(b.maxIncome)}`)),j.length&&s.push(`${bd(g)}${j.join("")}`)}),s},YS=t=>{const s=c=>a.jsxs("div",{className:"bg-gray-800/60 p-3 rounded-lg border border-gray-700/50 mb-3 last:mb-0 hover:border-amber-400/60 hover:bg-gray-800/80 transition-colors",children:[a.jsx("div",{className:"flex justify-between items-start mb-2",children:a.jsx("span",{className:"text-amber-300 font-semibold text-sm",children:c.text})}),a.jsx("p",{className:"text-xs text-gray-400 mb-2 leading-relaxed",children:c.description}),(c.effects||c.randomEffects)&&a.jsxs("div",{className:"mt-2 space-y-2 text-xs",children:[c.effects&&a.jsxs("div",{className:"bg-gray-900/60 p-2 rounded-lg border border-emerald-700/40",children:[a.jsxs("div",{className:"flex items-center mb-1",children:[a.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-emerald-400/70 mr-2"}),a.jsx("span",{className:"text-emerald-200 font-medium",children:""})]}),a.jsx("div",{className:"space-y-0.5",children:So(c.effects).map((u,p)=>a.jsxs("div",{className:"flex items-start gap-2 text-gray-200",children:[a.jsx("span",{className:"mt-1 w-1 h-1 rounded-full bg-emerald-300/70"}),a.jsx("span",{className:"leading-snug",children:u})]},p))})]}),c.randomEffects&&c.randomEffects.map((u,p)=>a.jsxs("div",{className:"bg-gray-900/60 p-2 rounded-lg border border-dashed border-purple-700/60",children:[a.jsx("div",{className:"flex items-center justify-between mb-1",children:a.jsxs("span",{className:"text-purple-300 text-[11px] font-medium flex items-center gap-1",children:[a.jsx("span",{children:" "}),a.jsxs("span",{className:"px-1.5 py-0.5 rounded-full bg-purple-900/60 border border-purple-500/50 text-[10px] text-purple-100",children:[Math.round(u.chance*100),"%"]})]})}),u.description&&a.jsxs("div",{className:"text-gray-400 text-[10px] mb-1 italic leading-snug",children:['"',u.description,'"']}),a.jsx("div",{className:"space-y-0.5",children:So(u.effects).map((m,h)=>a.jsxs("div",{className:"flex items-start gap-2 text-gray-200",children:[a.jsx("span",{className:"mt-1 w-1 h-1 rounded-full bg-purple-300/80"}),a.jsx("span",{className:"leading-snug",children:m})]},h))})]},p))]})]},c.id),r=[t.type&&{label:"",value:t.type==="festival"?"":t.type==="epoch"?"":t.type==="diplomatic"?"":""},t.duration&&{label:"",value:`${t.duration} `}].filter(Boolean),o=FS(t.triggerConditions);return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"bg-gray-800/40 p-4 rounded-xl border border-gray-700/50",children:[a.jsxs("p",{className:"text-gray-300 leading-relaxed text-sm italic",children:['"',t.description,'"']}),t.flavorText&&a.jsxs("p",{className:"text-gray-500 text-xs mt-2 text-right",children:[" ",t.flavorText]})]}),a.jsx($o,{rows:r}),o.length>0&&a.jsxs("div",{children:[a.jsx("h4",{className:"text-sm font-medium text-gray-400 mb-2 border-l-4 border-indigo-500/50 pl-3",children:""}),a.jsx("div",{className:"bg-gray-800/60 p-3 rounded-lg border border-gray-700/50",children:o.map((c,u)=>a.jsxs("div",{className:"text-gray-300 mb-1 flex items-center text-xs",children:[a.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-indigo-400/70 mr-2"}),a.jsx("span",{children:c})]},u))})]}),t.options&&t.options.length>0?a.jsxs("div",{children:[a.jsx("h4",{className:"text-sm font-medium text-gray-400 mb-3 border-l-4 border-amber-500/50 pl-3",children:""}),a.jsx("div",{className:"grid grid-cols-1 gap-1",children:t.options.map(s)})]}):t.effects?a.jsxs("div",{children:[a.jsx("h4",{className:"text-sm font-medium text-gray-400 mb-3 border-l-4 border-green-500/50 pl-3",children:""}),a.jsx("div",{className:"bg-gray-800/60 p-3 rounded-lg border border-gray-700/50",children:So(t.effects).map((c,u)=>a.jsxs("div",{className:"text-gray-300 mb-1 flex items-center",children:[a.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-green-500/50 mr-2"}),c]},u))})]}):null]})},XS=({unit:t,resources:s,market:r,militaryWageRatio:o=1,army:c={},onRecruit:u,onDisband:p,onClose:m})=>{if(!t)return a.jsxs("div",{className:"text-center text-gray-400 py-8",children:[a.jsx(k,{name:"AlertCircle",size:32,className:"mx-auto mb-2"}),a.jsx("p",{children:""})]});const h=Ci(t.recruitCost,r),x=t.maintenanceCost?.silver||0,g=x*o,b=Object.entries(t.recruitCost).every(([R,E])=>(s[R]||0)>=E)&&(s.silver||0)>=h,j=c[t.id]||0,_=j>0,N=hr[t.category]||{},M=wn[t.epoch]||{};return a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center gap-2 pb-2 border-b border-gray-700",children:[a.jsx("div",{className:"w-12 h-12 icon-metal-container icon-metal-container-lg rounded-lg flex items-center justify-center flex-shrink-0",children:a.jsx(k,{name:t.icon||"Swords",size:24,className:`${N.color||"text-red-400"} icon-metal-red`})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h2",{className:"text-lg font-bold text-white leading-tight font-decorative",children:t.name}),a.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-400 leading-tight",children:[a.jsx("span",{className:N.color,children:N.name||t.type}),a.jsx("span",{children:""}),a.jsx("span",{children:M.name||` ${t.epoch}`})]})]})]}),a.jsxs("div",{className:"grid grid-cols-4 gap-1.5",children:[a.jsxs("div",{className:"bg-gray-700/50 rounded p-1.5 border border-gray-600",children:[a.jsxs("div",{className:"flex items-center gap-1 mb-0.5",children:[a.jsx(k,{name:"Sword",size:12,className:"text-red-400"}),a.jsx("span",{className:"text-[9px] text-gray-400 leading-none",children:""})]}),a.jsx("div",{className:"text-sm font-bold text-white font-mono leading-none",children:t.attack})]}),a.jsxs("div",{className:"bg-gray-700/50 rounded p-1.5 border border-gray-600",children:[a.jsxs("div",{className:"flex items-center gap-1 mb-0.5",children:[a.jsx(k,{name:"Shield",size:12,className:"text-blue-400"}),a.jsx("span",{className:"text-[9px] text-gray-400 leading-none",children:""})]}),a.jsx("div",{className:"text-sm font-bold text-white font-mono leading-none",children:t.defense})]}),a.jsxs("div",{className:"bg-gray-700/50 rounded p-1.5 border border-gray-600",children:[a.jsxs("div",{className:"flex items-center gap-1 mb-0.5",children:[a.jsx(k,{name:"Target",size:12,className:"text-green-400"}),a.jsx("span",{className:"text-[9px] text-gray-400 leading-none",children:""})]}),a.jsx("div",{className:"text-sm font-bold text-green-300 font-mono leading-none",children:t.range||1})]}),a.jsxs("div",{className:"bg-gray-700/50 rounded p-1.5 border border-gray-600",children:[a.jsxs("div",{className:"flex items-center gap-1 mb-0.5",children:[a.jsx(k,{name:"Clock",size:12,className:"text-purple-400"}),a.jsx("span",{className:"text-[9px] text-gray-400 leading-none",children:""})]}),a.jsxs("div",{className:"text-sm font-bold text-purple-300 font-mono leading-none",children:[t.trainingTime,""]})]})]}),a.jsxs("div",{className:"bg-gray-700/50 rounded p-2 border border-gray-600",children:[a.jsxs("h3",{className:"text-[10px] font-bold text-white mb-1.5 flex items-center gap-1",children:[a.jsx(k,{name:"Swords",size:12,className:"text-yellow-400"}),""]}),a.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[a.jsxs("div",{className:"bg-gray-800/40 rounded px-2 py-1.5",children:[a.jsxs("div",{className:"flex items-center gap-1 mb-1",children:[a.jsx(k,{name:"ChevronUp",size:12,className:"text-green-400"}),a.jsx("span",{className:"text-[9px] text-gray-400",children:""})]}),a.jsx("div",{className:"text-xs",children:t.counters&&Object.keys(t.counters).length>0?Object.entries(t.counters).map(([R,E])=>{const T=hr[R];return a.jsxs("span",{className:`${T?.color||"text-white"} mr-2`,children:[T?.name||R," (+",Math.round((E-1)*100),"%)"]},R)}):a.jsx("span",{className:"text-gray-500",children:""})})]}),a.jsxs("div",{className:"bg-gray-800/40 rounded px-2 py-1.5",children:[a.jsxs("div",{className:"flex items-center gap-1 mb-1",children:[a.jsx(k,{name:"ChevronDown",size:12,className:"text-red-400"}),a.jsx("span",{className:"text-[9px] text-gray-400",children:""})]}),a.jsx("div",{className:"text-xs",children:t.weakAgainst&&t.weakAgainst.length>0?t.weakAgainst.map(R=>{const E=hr[R];return a.jsx("span",{className:`${E?.color||"text-white"} mr-2`,children:E?.name||R},R)}):a.jsx("span",{className:"text-gray-500",children:""})})]})]})]}),t.abilities&&t.abilities.length>0&&a.jsxs("div",{className:"bg-gray-700/50 rounded p-2 border border-gray-600",children:[a.jsxs("h3",{className:"text-[10px] font-bold text-white mb-1.5 flex items-center gap-1",children:[a.jsx(k,{name:"Star",size:12,className:"text-amber-400"}),""]}),a.jsx("div",{className:"flex flex-wrap gap-1",children:t.abilities.map((R,E)=>a.jsx("span",{className:"bg-amber-500/20 text-amber-300 text-[10px] px-2 py-0.5 rounded-full border border-amber-500/30",children:R},E))})]}),a.jsxs("div",{className:"bg-gray-700/50 rounded p-2 border border-gray-600",children:[a.jsxs("h3",{className:"text-[10px] font-bold text-white mb-1.5 flex items-center gap-1",children:[a.jsx(k,{name:"Package",size:12,className:"text-amber-400"}),""]}),a.jsxs("div",{className:"space-y-1",children:[Object.entries(t.recruitCost).map(([R,E])=>{const T=Re[R],D=(s[R]||0)>=E;return a.jsx("div",{className:"bg-gray-800/40 rounded px-2 py-1",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsx(k,{name:T?.icon||"Box",size:14,className:T?.color||"text-gray-400"}),a.jsx("span",{className:"text-xs text-gray-300",children:T?.name||R})]}),a.jsxs("span",{className:`text-xs font-bold font-mono ${D?"text-green-400":"text-red-400"}`,children:[E," (",(s[R]||0).toFixed(1),")"]})]})},R)}),a.jsx("div",{className:"bg-gray-800/40 rounded px-2 py-1 border-t border-gray-700 mt-1",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsx(k,{name:"Coins",size:14,className:"text-yellow-400"}),a.jsx("span",{className:"text-xs text-gray-300",children:""})]}),a.jsx("span",{className:`text-xs font-bold font-mono ${(s.silver||0)>=h?"text-green-400":"text-red-400"}`,children:vr(h)})]})})]})]}),a.jsxs("div",{className:"bg-gray-700/50 rounded p-2 border border-gray-600",children:[a.jsxs("h3",{className:"text-[10px] font-bold text-white mb-1.5 flex items-center gap-1",children:[a.jsx(k,{name:"TrendingDown",size:12,className:"text-red-400"}),""]}),a.jsxs("div",{className:"bg-gray-800/40 rounded px-2 py-1.5",children:[a.jsx("div",{className:"space-y-1 mb-2",children:Object.entries(t.maintenanceCost||{}).map(([R,E])=>{const T=Re[R];return!T||E<=0?null:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-[9px] text-gray-400",children:T.name}),a.jsxs("span",{className:"text-xs font-bold text-white font-mono",children:["-",E.toFixed(2),"/"]})]},R)})}),a.jsxs("div",{className:"flex items-center justify-between mb-1 pt-1 border-t border-gray-700",children:[a.jsx("span",{className:"text-[9px] text-gray-400",children:""}),a.jsxs("span",{className:"text-xs font-bold text-white font-mono",children:[x.toFixed(2)," "]})]}),a.jsxs("div",{className:"flex items-center justify-between mb-1",children:[a.jsx("span",{className:"text-[9px] text-gray-400",children:""}),a.jsxs("span",{className:"text-xs font-bold text-white font-mono",children:["",o.toFixed(2)]})]}),a.jsxs("div",{className:"flex items-center justify-between pt-1 border-t border-gray-700",children:[a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(k,{name:"Coins",size:12,className:"text-yellow-400"}),a.jsx("span",{className:"text-xs text-gray-300",children:""})]}),a.jsxs("span",{className:"text-sm font-bold text-yellow-300 font-mono",children:[g.toFixed(2)," /"]})]})]})]}),t.desc&&a.jsxs("div",{className:"bg-gray-700/50 rounded p-2 border border-gray-600",children:[a.jsxs("h3",{className:"text-[10px] font-bold text-white mb-1 flex items-center gap-1",children:[a.jsx(k,{name:"Info",size:12,className:"text-blue-400"}),""]}),a.jsx("p",{className:"text-xs text-gray-300 leading-relaxed",children:t.desc})]}),a.jsxs("div",{className:"bg-gray-700/50 rounded p-2 border border-gray-600",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsx(k,{name:"Users",size:14,className:"text-blue-400"}),a.jsx("span",{className:"text-xs text-gray-300",children:""})]}),a.jsxs("span",{className:"text-sm font-bold text-white font-mono",children:[j," "]})]}),t.populationCost&&t.populationCost>1&&a.jsxs("div",{className:"flex items-center justify-between mt-1 pt-1 border-t border-gray-700",children:[a.jsx("span",{className:"text-[9px] text-gray-400",children:""}),a.jsxs("span",{className:"text-xs text-white font-mono",children:[t.populationCost," /"]})]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-2 pt-2",children:[a.jsxs("button",{onClick:()=>{u&&(u(t.id),m())},disabled:!b||!u,className:`flex items-center justify-center gap-2 px-4 py-3 rounded-lg font-bold text-sm transition-all ${b&&u?"bg-green-600 hover:bg-green-500 text-white shadow-lg hover:shadow-xl active:scale-95":"bg-gray-600 text-gray-400 cursor-not-allowed"}`,children:[a.jsx(k,{name:"Plus",size:18}),a.jsx("span",{children:""})]}),a.jsxs("button",{onClick:()=>{p&&(p(t.id),m())},disabled:!_||!p,className:`flex items-center justify-center gap-2 px-4 py-3 rounded-lg font-bold text-sm transition-all ${_&&p?"bg-red-600 hover:bg-red-500 text-white shadow-lg hover:shadow-xl active:scale-95":"bg-gray-600 text-gray-400 cursor-not-allowed"}`,children:[a.jsx(k,{name:"Minus",size:18}),a.jsx("span",{children:""})]})]})]})},ZS=Ln.reduce((t,s)=>{if(!s.requiresTech)return t;const r=s.requiresTech;return t[r]||(t[r]=[]),t[r].push(s.name||s.id),t},{}),QS=({tech:t,status:s,resources:r,market:o,onResearch:c,onClose:u})=>{if(!t)return a.jsxs("div",{className:"text-center text-gray-400 py-8",children:[a.jsx(k,{name:"AlertCircle",size:32,className:"mx-auto mb-2"}),a.jsx("p",{children:""})]});const p=Ci(t.cost,o),m=s==="unlocked",h=ZS[t.id]||[],x=!m&&Object.entries(t.cost).every(([g,b])=>(r[g]||0)>=b)&&(r.silver||0)>=p;return a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center gap-2 pb-2 border-b border-gray-700",children:[a.jsx("div",{className:"w-12 h-12 icon-metal-container icon-metal-container-lg rounded-lg flex items-center justify-center flex-shrink-0",children:m?a.jsx(k,{name:"Check",size:24,className:"text-green-400 icon-metal-green"}):a.jsx(k,{name:"Lightbulb",size:24,className:"text-blue-400 icon-metal-blue"})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("h2",{className:"text-lg font-bold text-white leading-tight flex items-center gap-2 font-decorative",children:[t.name,m&&a.jsx("span",{className:"text-xs px-2 py-0.5 bg-green-600 text-white rounded",children:""})]}),a.jsx("p",{className:"text-xs text-gray-400 leading-tight truncate",children:t.desc})]})]}),t.effect&&a.jsxs("div",{className:"bg-blue-900/30 rounded p-2 border border-blue-500/30",children:[a.jsxs("h3",{className:"text-[10px] font-bold text-white mb-1.5 flex items-center gap-1 font-decorative",children:[a.jsx(k,{name:"Sparkles",size:12,className:"text-blue-400"}),""]}),a.jsx("p",{className:"text-xs text-blue-300 leading-relaxed",children:t.effect})]}),h.length>0&&a.jsxs("div",{className:"bg-amber-900/30 rounded p-2 border border-amber-500/30",children:[a.jsxs("h3",{className:"text-[10px] font-bold text-white mb-1.5 flex items-center gap-1 font-decorative",children:[a.jsx(k,{name:"Building",size:12,className:"text-amber-400"}),""]}),a.jsx("div",{className:"flex flex-wrap gap-1",children:h.map((g,b)=>a.jsx("span",{className:"text-xs px-2 py-0.5 bg-amber-900/40 border border-amber-600/40 rounded text-amber-300",children:g},b))})]}),!m&&a.jsxs("div",{className:"bg-gray-700/50 rounded p-2 border border-gray-600",children:[a.jsxs("h3",{className:"text-[10px] font-bold text-white mb-1.5 flex items-center gap-1 font-decorative",children:[a.jsx(k,{name:"Package",size:12,className:"text-purple-400"}),""]}),a.jsxs("div",{className:"space-y-1",children:[Object.entries(t.cost).map(([g,b])=>{const j=Re[g],_=(r[g]||0)>=b;return a.jsx("div",{className:"bg-gray-800/40 rounded px-2 py-1",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsx(k,{name:j?.icon||"Box",size:14,className:j?.color||"text-gray-400"}),a.jsx("span",{className:"text-xs text-gray-300",children:j?.name||g})]}),a.jsxs("span",{className:`text-xs font-bold font-mono ${_?"text-green-400":"text-red-400"}`,children:[Math.round(b)," (",Math.round(r[g]||0),")"]})]})},g)}),a.jsx("div",{className:"bg-gray-800/40 rounded px-2 py-1 border-t border-gray-700 mt-1",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsx(k,{name:"Coins",size:14,className:"text-yellow-400"}),a.jsx("span",{className:"text-xs text-gray-300",children:""})]}),a.jsx("span",{className:`text-xs font-bold font-mono ${(r.silver||0)>=p?"text-green-400":"text-red-400"}`,children:vr(p)})]})})]})]}),m&&a.jsxs("div",{className:"bg-green-900/20 border border-green-500/30 rounded p-3 text-center",children:[a.jsx(k,{name:"CheckCircle",size:32,className:"text-green-400 mx-auto mb-2"}),a.jsx("p",{className:"text-sm font-bold text-green-300",children:""}),a.jsx("p",{className:"text-xs text-gray-400 mt-1",children:""})]}),!m&&a.jsx("div",{className:"pt-2",children:a.jsxs("button",{onClick:()=>{c&&(c(t.id),u())},disabled:!x||!c,className:`w-full flex items-center justify-center gap-2 px-4 py-3 rounded-lg font-bold text-sm transition-all ${x&&c?"bg-blue-600 hover:bg-blue-500 text-white shadow-lg hover:shadow-xl active:scale-95":"bg-gray-600 text-gray-400 cursor-not-allowed"}`,children:[a.jsx(k,{name:"Lightbulb",size:18}),a.jsx("span",{children:""})]})})]})},Op=t=>{const s=Math.round(t*100);return s>0?`+${s}%`:`${s}%`},My=t=>Re[t]?.name||t,JS=t=>Ke[t]?.name||t,KS=t=>[/\s*[+-]?\d+%/,/\s*[+-]?\d+%/,/\s*[+-]?\d+%/].some(r=>r.test(t)),_y=t=>!t||!Array.isArray(t)?[]:t.filter(s=>!KS(s)),eA=({decree:t,onToggle:s,onClose:r})=>{if(!t)return a.jsxs("div",{className:"text-center text-gray-400 py-8",children:[a.jsx(k,{name:"AlertCircle",size:32,className:"mx-auto mb-2"}),a.jsx("p",{children:""})]});const o=t.active,c=t.modifiers&&(t.modifiers.resourceDemandMod||t.modifiers.stratumDemandMod||t.modifiers.resourceSupplyMod),u=c?_y(t.effects):t.effects,p=c?_y(t.drawbacks):t.drawbacks;return a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center gap-2 pb-2 border-b border-gray-700",children:[a.jsx("div",{className:"w-12 h-12 icon-metal-container icon-metal-container-lg rounded-lg flex items-center justify-center flex-shrink-0",children:o?a.jsx(k,{name:"Check",size:24,className:"text-green-400 icon-metal-green"}):a.jsx(k,{name:"FileText",size:24,className:"text-purple-400 icon-metal-purple"})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("h2",{className:"text-lg font-bold text-white leading-tight flex items-center gap-2 font-decorative",children:[t.name,o&&a.jsx("span",{className:"text-xs px-2 py-0.5 bg-green-600 text-white rounded",children:""})]}),a.jsx("p",{className:"text-xs text-gray-400 leading-tight",children:t.desc})]})]}),a.jsx("div",{className:"bg-gray-700/50 rounded p-2 border border-gray-600",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-xs text-gray-400",children:""}),a.jsxs("span",{className:"text-xs font-bold text-white",children:[t.category==="economy"&&"",t.category==="military"&&"",t.category==="culture"&&"",t.category==="social"&&""]})]})}),u&&u.length>0&&a.jsxs("div",{className:"bg-green-900/20 border border-green-500/30 rounded p-2",children:[a.jsxs("h3",{className:"text-[10px] font-bold text-white mb-1.5 flex items-center gap-1 font-decorative",children:[a.jsx(k,{name:"TrendingUp",size:12,className:"text-green-400"}),""]}),a.jsx("div",{className:"space-y-1",children:u.map((m,h)=>a.jsxs("div",{className:"flex items-start gap-1.5 bg-green-900/20 rounded px-2 py-1",children:[a.jsx(k,{name:"Plus",size:14,className:"text-green-400 flex-shrink-0 mt-0.5"}),a.jsx("span",{className:"text-xs text-green-300 leading-relaxed",children:m})]},h))})]}),p&&p.length>0&&a.jsxs("div",{className:"bg-red-900/20 border border-red-500/30 rounded p-2",children:[a.jsxs("h3",{className:"text-[10px] font-bold text-white mb-1.5 flex items-center gap-1 font-decorative",children:[a.jsx(k,{name:"TrendingDown",size:12,className:"text-red-400"}),""]}),a.jsx("div",{className:"space-y-1",children:p.map((m,h)=>a.jsxs("div",{className:"flex items-start gap-1.5 bg-red-900/20 rounded px-2 py-1",children:[a.jsx(k,{name:"Minus",size:14,className:"text-red-400 flex-shrink-0 mt-0.5"}),a.jsx("span",{className:"text-xs text-red-300 leading-relaxed",children:m})]},h))})]}),t.unlockEpoch!==void 0&&t.unlockEpoch>0&&a.jsx("div",{className:"bg-gray-700/50 rounded p-2 border border-gray-600",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-xs text-gray-400",children:""}),a.jsxs("span",{className:"text-xs font-bold text-purple-300",children:[" ",t.unlockEpoch+1]})]})}),t.modifiers&&(t.modifiers.resourceDemandMod||t.modifiers.stratumDemandMod||t.modifiers.resourceSupplyMod)&&a.jsxs("div",{className:"bg-blue-900/20 border border-blue-500/30 rounded p-2",children:[a.jsxs("h3",{className:"text-[10px] font-bold text-white mb-1.5 flex items-center gap-1 font-decorative",children:[a.jsx(k,{name:"BarChart3",size:12,className:"text-blue-400"}),""]}),a.jsxs("div",{className:"space-y-2",children:[t.modifiers.resourceDemandMod&&Object.keys(t.modifiers.resourceDemandMod).length>0&&a.jsxs("div",{className:"space-y-1",children:[a.jsx("div",{className:"text-[10px] text-gray-400",children:""}),a.jsx("div",{className:"flex flex-wrap gap-1",children:Object.entries(t.modifiers.resourceDemandMod).map(([m,h])=>a.jsxs("span",{className:`text-[10px] px-1.5 py-0.5 rounded ${h>0?"bg-orange-900/30 text-orange-300":"bg-cyan-900/30 text-cyan-300"}`,children:[My(m)," ",Op(h)]},m))})]}),t.modifiers.resourceSupplyMod&&Object.keys(t.modifiers.resourceSupplyMod).length>0&&a.jsxs("div",{className:"space-y-1",children:[a.jsx("div",{className:"text-[10px] text-gray-400",children:""}),a.jsx("div",{className:"flex flex-wrap gap-1",children:Object.entries(t.modifiers.resourceSupplyMod).map(([m,h])=>a.jsxs("span",{className:`text-[10px] px-1.5 py-0.5 rounded ${h>0?"bg-green-900/30 text-green-300":"bg-red-900/30 text-red-300"}`,children:[My(m)," ",Op(h)]},m))})]}),t.modifiers.stratumDemandMod&&Object.keys(t.modifiers.stratumDemandMod).length>0&&a.jsxs("div",{className:"space-y-1",children:[a.jsx("div",{className:"text-[10px] text-gray-400",children:""}),a.jsx("div",{className:"flex flex-wrap gap-1",children:Object.entries(t.modifiers.stratumDemandMod).map(([m,h])=>a.jsxs("span",{className:`text-[10px] px-1.5 py-0.5 rounded ${h>0?"bg-purple-900/30 text-purple-300":"bg-teal-900/30 text-teal-300"}`,children:[JS(m)," ",Op(h)]},m))})]})]})]}),a.jsxs("div",{className:`rounded p-3 border ${o?"bg-green-900/20 border-green-500/30":"bg-gray-700/50 border-gray-600"}`,children:[a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[a.jsx(k,{name:o?"CheckCircle":"Circle",size:20,className:o?"text-green-400":"text-gray-400"}),a.jsx("span",{className:`text-sm font-bold ${o?"text-green-300":"text-gray-300"}`,children:o?"":""})]}),a.jsx("p",{className:"text-xs text-gray-400 leading-relaxed",children:o?"":'""'}),"      "]}),a.jsx("div",{className:"pt-2",children:a.jsxs("button",{onClick:()=>{s&&(s(t.id),r())},disabled:!s,className:`w-full flex items-center justify-center gap-2 px-4 py-3 rounded-lg font-bold text-sm transition-all ${s?o?"bg-red-600 hover:bg-red-500 text-white shadow-lg hover:shadow-xl active:scale-95":"bg-green-600 hover:bg-green-500 text-white shadow-lg hover:shadow-xl active:scale-95":"bg-gray-600 text-gray-400 cursor-not-allowed"}`,children:[a.jsx(k,{name:o?"XCircle":"CheckCircle",size:18}),a.jsx("span",{children:o?"":""})]})})]})},tA=({event:t,onSelectOption:s,onClose:r,nations:o=[]})=>{if(!t)return null;const c=o.filter(E=>E.visible!==!1),u=t._resolvedRandomNation,p=E=>{if(!c.length&&E!=="all")return null;switch(E){case"random":return u?`${u.name}`:"";case"all":return null;case"hostile":{const T=c.filter(D=>(D.relation||50)<30);return T.length===0?"":`${T.map(D=>D.name).join("")}`}case"friendly":{const T=c.filter(D=>(D.relation||50)>=60);return T.length===0?"":`${T.map(D=>D.name).join("")}`}case"strongest":return c.length===0?null:`${c.reduce((D,O)=>(D.wealth||0)>(O.wealth||0)?D:O).name}`;case"weakest":return c.length===0?null:`${c.reduce((D,O)=>(D.wealth||0)<(O.wealth||0)?D:O).name}`;default:{const T=c.find(D=>D.id===E);return T?`${T.name}`:null}}},m=E=>!["random","all","hostile","friendly","strongest","weakest"].includes(E),h=E=>Re&&Re[E]?.name||E,x=E=>Ke&&Ke[E]?.name||E,g=E=>{const T=Math.round(E*100);return`${T>0?"+":""}${T}%`},b={random:"",all:"",hostile:"",friendly:"",strongest:"",weakest:""},j={relation:{icon:"Globe2",labelSuffix:"",positiveClass:"bg-sky-900/50 text-sky-300 border border-sky-500/40",negativeClass:"bg-rose-900/50 text-rose-300 border border-rose-500/40",formatter:E=>`${E>0?"+":""}${E}`},aggression:{icon:"Flame",labelSuffix:"",positiveClass:"bg-red-900/50 text-red-300 border border-red-500/40",negativeClass:"bg-green-900/50 text-green-300 border border-green-500/40",formatter:E=>g(E)},wealth:{icon:"Coins",labelSuffix:"",positiveClass:"bg-amber-900/50 text-amber-200 border border-amber-500/40",negativeClass:"bg-slate-900/50 text-slate-200 border border-slate-500/40",formatter:E=>`${E>0?"+":""}${E}`},volatility:{icon:"Activity",labelSuffix:"",positiveClass:"bg-orange-900/50 text-orange-300 border border-orange-500/40",negativeClass:"bg-cyan-900/50 text-cyan-300 border border-cyan-500/40",formatter:E=>g(E)}},_=(E,T=[])=>{if(m(E)){const I=c.find(Z=>Z.id===E);return I?I.name:E}const D=b[E]||"",O=p(E);let q=D;if(O&&(q=`${D}${O}`),E==="all"&&T.length>0){const I=T.map(Z=>b[Z]||Z).join("");q+=`${I}`}return q},N=(E,T,D)=>{if(!E)return null;const O=j[T];if(!O)return null;const q=Array.isArray(E.exclude)?E.exclude:[],I=Object.entries(E).filter(([Z])=>Z!=="exclude"&&!Z.startsWith("_"));return I.length?I.map(([Z,Y],U)=>{const S=typeof Y=="number"&&!isNaN(Y)?Y:0,Q=_(Z,q),Ne=S>0?O.positiveClass:O.negativeClass;return a.jsxs("span",{className:`inline-flex items-center gap-1 text-[10px] px-2 py-0.5 rounded-md ${Ne} font-sans`,children:[a.jsx(k,{name:O.icon,size:10}),a.jsx("span",{className:"font-medium",children:`${Q}${O.labelSuffix||""}`}),a.jsx("span",{className:"font-mono font-bold",children:O.formatter(S)})]},`${D}-${T}-${Z}-${U}`)}):null},M=(E,T,D)=>{if(!E)return null;const O=T==="war",q=O?"bg-red-900/50 text-red-200 border border-red-500/40":"bg-emerald-900/50 text-emerald-200 border border-emerald-500/40",I=O?"Swords":"HandHeart",Z=O?"":"",Y=_(E);return a.jsxs("span",{className:`inline-flex items-center gap-1 text-[10px] px-2 py-0.5 rounded-md ${q} font-sans`,children:[a.jsx(k,{name:I,size:10}),a.jsx("span",{className:"font-medium",children:Y}),a.jsx("span",{className:"font-mono font-bold",children:Z})]},`${D}-${T}`)},R=E=>{s(t.id,E),r()};return a.jsxs("div",{className:"space-y-3 font-sans",children:[a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx("div",{className:`flex-shrink-0 w-14 h-14 rounded-xl flex items-center justify-center shadow-lg border ${t.isDiplomaticEvent?"bg-gradient-to-br from-blue-600/80 to-purple-700/80 border-blue-400/30":"bg-gradient-to-br from-ancient-gold/60 to-ancient-bronze/60 border-ancient-gold/40"}`,children:a.jsx(k,{name:t.icon,size:28,className:"text-white drop-shadow-lg"})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h2",{className:"text-lg font-bold text-ancient leading-tight font-decorative",children:t.name}),a.jsx("div",{className:"flex items-center gap-2 mt-1",children:t.isDiplomaticEvent&&a.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 text-[10px] font-semibold bg-blue-600/20 text-blue-300 rounded border border-blue-500/30 font-sans",children:[a.jsx(k,{name:"Globe",size:10}),""]})})]})]}),a.jsx("div",{className:"glass-ancient rounded-xl p-3 border border-ancient-gold/20 font-sans",children:a.jsx("p",{className:"text-sm text-ancient-parchment leading-relaxed font-sans",children:t.description})}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("h3",{className:"text-xs font-bold text-ancient-stone uppercase tracking-wider flex items-center gap-1.5",children:[a.jsx(k,{name:"Target",size:12,className:"text-ancient-gold "}),""]}),t.options.map(E=>a.jsx("button",{onClick:()=>R(E),className:"w-full text-left glass-ancient hover:bg-ancient-gold/10 rounded-xl p-3 border border-ancient-gold/20 hover:border-ancient-gold/40 transition-all group hover:shadow-glow-gold font-sans",children:a.jsxs("div",{className:"flex items-start justify-between gap-2",children:[a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h4",{className:"text-sm font-bold text-ancient-parchment group-hover:text-ancient transition-colors leading-tight font-sans",children:E.text}),E.description&&a.jsx("p",{className:"text-[11px] text-ancient-stone mt-1 leading-snug font-sans",children:E.description}),a.jsxs("div",{className:"flex flex-wrap gap-1.5 mt-2",children:[E.effects.resources&&Object.entries(E.effects.resources).map(([T,D])=>a.jsxs("span",{className:`inline-flex items-center gap-1 text-[10px] px-2 py-0.5 rounded-md ${D>0?"bg-green-900/50 text-green-300 border border-green-500/40":"bg-red-900/50 text-red-300 border border-red-500/40"} font-sans`,children:[a.jsx(k,{name:Re[T]?.icon||"Package",size:10}),a.jsx("span",{className:"font-medium",children:h(T)}),a.jsxs("span",{className:"font-mono font-bold",children:[D>0?"+":"",D]})]},T)),E.effects.resourcePercent&&Object.entries(E.effects.resourcePercent).map(([T,D])=>a.jsxs("span",{className:`inline-flex items-center gap-1 text-[10px] px-2 py-0.5 rounded-md ${D>0?"bg-green-900/50 text-green-300 border border-green-500/40":"bg-red-900/50 text-red-300 border border-red-500/40"} font-sans`,children:[a.jsx(k,{name:Re[T]?.icon||"Package",size:10}),a.jsx("span",{className:"font-medium",children:h(T)}),a.jsx("span",{className:"font-mono font-bold",children:g(D)})]},`pct-${T}`)),E.effects.population&&a.jsxs("span",{className:`inline-flex items-center gap-1 text-[10px] px-2 py-0.5 rounded-md ${E.effects.population>0?"bg-green-900/50 text-green-300 border border-green-500/40":"bg-red-900/50 text-red-300 border border-red-500/40"} font-sans`,children:[a.jsx(k,{name:"Users",size:10}),a.jsx("span",{className:"font-medium",children:""}),a.jsxs("span",{className:"font-mono font-bold",children:[E.effects.population>0?"+":"",E.effects.population]})]}),E.effects.populationPercent&&a.jsxs("span",{className:`inline-flex items-center gap-1 text-[10px] px-2 py-0.5 rounded-md ${E.effects.populationPercent>0?"bg-green-900/50 text-green-300 border border-green-500/40":"bg-red-900/50 text-red-300 border border-red-500/40"} font-sans`,children:[a.jsx(k,{name:"Users",size:10}),a.jsx("span",{className:"font-medium",children:""}),a.jsx("span",{className:"font-mono font-bold",children:g(E.effects.populationPercent)})]}),E.effects.stability&&a.jsxs("span",{className:`inline-flex items-center gap-1 text-[10px] px-2 py-0.5 rounded-md ${E.effects.stability>0?"bg-green-900/50 text-green-300 border border-green-500/40":"bg-red-900/50 text-red-300 border border-red-500/40"} font-sans`,children:[a.jsx(k,{name:"TrendingUp",size:10}),a.jsx("span",{className:"font-medium",children:""}),a.jsxs("span",{className:"font-mono font-bold",children:[E.effects.stability>0?"+":"",E.effects.stability]})]}),E.effects.approval&&Object.entries(E.effects.approval).map(([T,D])=>a.jsxs("span",{className:`inline-flex items-center gap-1 text-[10px] px-2 py-0.5 rounded-md ${D>0?"bg-blue-900/50 text-blue-300 border border-blue-500/40":"bg-orange-900/50 text-orange-300 border border-orange-500/40"} font-sans`,children:[a.jsx(k,{name:Ke[T]?.icon||"User",size:10}),a.jsxs("span",{className:"font-medium",children:[x(T),""]}),a.jsxs("span",{className:"font-mono font-bold",children:[D>0?"+":"",D]})]},T)),E.effects.resourceDemandMod&&Object.entries(E.effects.resourceDemandMod).map(([T,D])=>a.jsxs("span",{className:`inline-flex items-center gap-1 text-[10px] px-2 py-0.5 rounded-md ${D>0?"bg-purple-900/50 text-purple-300 border border-purple-500/40":"bg-cyan-900/50 text-cyan-300 border border-cyan-500/40"} font-sans`,title:"",children:[a.jsx(k,{name:"TrendingUp",size:10}),a.jsxs("span",{className:"font-medium",children:[h(T),""]}),a.jsx("span",{className:"font-mono font-bold",children:g(D)}),a.jsx(k,{name:"Clock",size:8,className:"opacity-60"})]},`demand-${T}`)),E.effects.stratumDemandMod&&Object.entries(E.effects.stratumDemandMod).map(([T,D])=>a.jsxs("span",{className:`inline-flex items-center gap-1 text-[10px] px-2 py-0.5 rounded-md ${D>0?"bg-purple-900/50 text-purple-300 border border-purple-500/40":"bg-cyan-900/50 text-cyan-300 border border-cyan-500/40"} font-sans`,title:"",children:[a.jsx(k,{name:"ShoppingCart",size:10}),a.jsxs("span",{className:"font-medium",children:[x(T),""]}),a.jsx("span",{className:"font-mono font-bold",children:g(D)}),a.jsx(k,{name:"Clock",size:8,className:"opacity-60"})]},`stratumDemand-${T}`)),E.effects.buildingProductionMod&&Object.entries(E.effects.buildingProductionMod).map(([T,D])=>{const O=Ln.find(Z=>Z.id===T),q={gather:"",industry:"",civic:"",all:""},I=O?.name||q[T]||T;return a.jsxs("span",{className:`inline-flex items-center gap-1 text-[10px] px-2 py-0.5 rounded-md ${D>0?"bg-emerald-900/50 text-emerald-300 border border-emerald-500/40":"bg-rose-900/50 text-rose-300 border border-rose-500/40"} font-sans`,title:"",children:[a.jsx(k,{name:"Factory",size:10}),a.jsxs("span",{className:"font-medium",children:[I,""]}),a.jsx("span",{className:"font-mono font-bold",children:g(D)}),a.jsx(k,{name:"Clock",size:8,className:"opacity-60"})]},`production-${T}`)}),N(E.effects.nationRelation,"relation",`option-${E.id}`),N(E.effects.nationAggression,"aggression",`option-${E.id}`),N(E.effects.nationWealth,"wealth",`option-${E.id}`),N(E.effects.nationMarketVolatility,"volatility",`option-${E.id}`),M(E.effects.triggerWar,"war",`option-${E.id}`),M(E.effects.triggerPeace,"peace",`option-${E.id}`)]}),E.randomEffects&&E.randomEffects.length>0&&a.jsxs("div",{className:"mt-2 pt-2 border-t border-ancient-gold/10",children:[a.jsxs("div",{className:"flex items-center gap-1 mb-1.5",children:[a.jsx(k,{name:"Dices",size:10,className:"text-yellow-400"}),a.jsx("span",{className:"text-[10px] text-yellow-400 font-medium font-sans",children:""})]}),E.randomEffects.map((T,D)=>a.jsxs("div",{className:"mb-1.5 last:mb-0",children:[a.jsxs("span",{className:"text-[9px] text-yellow-300/70 font-medium font-sans",children:[Math.round(T.chance*100),"% "]}),a.jsxs("div",{className:"flex flex-wrap gap-1 mt-0.5",children:[T.effects.resources&&Object.entries(T.effects.resources).map(([O,q])=>a.jsxs("span",{className:`inline-flex items-center gap-1 text-[9px] px-1.5 py-0.5 rounded ${q>0?"bg-green-900/30 text-green-400 border border-green-500/30":"bg-red-900/30 text-red-400 border border-red-500/30"} font-sans`,children:[a.jsx(k,{name:Re[O]?.icon||"Package",size:9}),a.jsx("span",{children:h(O)}),a.jsxs("span",{className:"font-mono font-bold",children:[q>0?"+":"",q]})]},`rand-res-${D}-${O}`)),T.effects.resourcePercent&&Object.entries(T.effects.resourcePercent).map(([O,q])=>a.jsxs("span",{className:`inline-flex items-center gap-1 text-[9px] px-1.5 py-0.5 rounded ${q>0?"bg-green-900/30 text-green-400 border border-green-500/30":"bg-red-900/30 text-red-400 border border-red-500/30"} font-sans`,children:[a.jsx(k,{name:Re[O]?.icon||"Package",size:9}),a.jsx("span",{children:h(O)}),a.jsx("span",{className:"font-mono font-bold",children:g(q)})]},`rand-res-pct-${D}-${O}`)),T.effects.population&&a.jsxs("span",{className:`inline-flex items-center gap-1 text-[9px] px-1.5 py-0.5 rounded ${T.effects.population>0?"bg-green-900/30 text-green-400 border border-green-500/30":"bg-red-900/30 text-red-400 border border-red-500/30"} font-sans`,children:[a.jsx(k,{name:"Users",size:9}),a.jsx("span",{children:""}),a.jsxs("span",{className:"font-mono font-bold",children:[T.effects.population>0?"+":"",T.effects.population]})]}),T.effects.populationPercent&&a.jsxs("span",{className:`inline-flex items-center gap-1 text-[9px] px-1.5 py-0.5 rounded ${T.effects.populationPercent>0?"bg-green-900/30 text-green-400 border border-green-500/30":"bg-red-900/30 text-red-400 border border-red-500/30"} font-sans`,children:[a.jsx(k,{name:"Users",size:9}),a.jsx("span",{children:""}),a.jsx("span",{className:"font-mono font-bold",children:g(T.effects.populationPercent)})]}),T.effects.stability&&a.jsxs("span",{className:`inline-flex items-center gap-1 text-[9px] px-1.5 py-0.5 rounded ${T.effects.stability>0?"bg-green-900/30 text-green-400 border border-green-500/30":"bg-red-900/30 text-red-400 border border-red-500/30"} font-sans`,children:[a.jsx(k,{name:"TrendingUp",size:9}),a.jsx("span",{children:""}),a.jsxs("span",{className:"font-mono font-bold",children:[T.effects.stability>0?"+":"",T.effects.stability]})]}),T.effects.approval&&Object.entries(T.effects.approval).map(([O,q])=>a.jsxs("span",{className:`inline-flex items-center gap-1 text-[9px] px-1.5 py-0.5 rounded ${q>0?"bg-blue-900/30 text-blue-400 border border-blue-500/30":"bg-orange-900/30 text-orange-400 border border-orange-500/30"} font-sans`,children:[a.jsx(k,{name:Ke[O]?.icon||"User",size:9}),a.jsx("span",{children:x(O)}),a.jsxs("span",{className:"font-mono font-bold",children:[q>0?"+":"",q]})]},`rand-app-${D}-${O}`)),N(T.effects.nationRelation,"relation",`random-${E.id}-${D}`),N(T.effects.nationAggression,"aggression",`random-${E.id}-${D}`),N(T.effects.nationWealth,"wealth",`random-${E.id}-${D}`),N(T.effects.nationMarketVolatility,"volatility",`random-${E.id}-${D}`),M(T.effects.triggerWar,"war",`random-${E.id}-${D}`),M(T.effects.triggerPeace,"peace",`random-${E.id}-${D}`)]})]},D))]})]}),a.jsx(k,{name:"ChevronRight",size:16,className:"text-ancient-stone group-hover:text-ancient-gold transition-colors flex-shrink-0 mt-0.5"})]})},E.id))]}),a.jsx("div",{className:"glass-ancient rounded-xl p-2.5 border border-blue-500/20 font-sans",children:a.jsxs("div",{className:"flex items-start gap-2",children:[a.jsx(k,{name:"Info",size:14,className:"text-blue-400 flex-shrink-0 mt-0.5"}),a.jsx("p",{className:"text-blue-300 text-[11px] leading-snug font-sans",children:""})]})})]})};function aA(){const t=R5();return t?a.jsx(nA,{gameState:t}):(console.error("gameState is null or undefined"),a.jsx("div",{className:"min-h-screen bg-gray-900 text-white flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx("h1",{className:"text-2xl font-bold mb-4",children:""}),a.jsx("p",{children:""})]})}))}function nA({gameState:t}){C3(t.epoch);const s=B=>{t?.setLogs&&t.setLogs(Ue=>[B,...Ue].slice(0,8))},r=B=>{if(!B)return"";const Ue=(ft,$t)=>{const It=$t>0?"+":"";return["production","industry","cultureBonus","scienceBonus","taxIncome","militaryBonus","stability"].includes(ft)?`${It}${($t*100).toFixed(0)}%`:`${It}${$t}`};return Object.entries(B).map(([ft,$t])=>{switch(ft){case"categories":return Object.entries($t).map(([oe,Ye])=>`${Ln.find(Pe=>Pe.category===oe)?.categoryName||oe} ${Ue(ft,Ye)}`).join("");case"maxPop":return` ${Ue(ft,$t)}`;default:return`${{production:"",industry:"",cultureBonus:"",scienceBonus:"",taxIncome:"",militaryBonus:"",stability:""}[ft]||ft} ${Ue(ft,$t)}`}}).join("")},o=_3(t,s);N3(t,s,o);const{playSound:c,SOUND_TYPES:u}=Mf(),[p,m]=$.useState(!1),h=$.useRef(null),[x,g]=$.useState(!1),[b,j]=$.useState(null);$.useEffect(()=>{const B=t.daysElapsed||0;if(h.current==null){h.current=B;return}if(t.isPaused||t.currentEvent)return;B-h.current>=30&&(h.current=B,Math.random()<.1&&o.triggerRandomEvent())},[t.daysElapsed,t.isPaused,t.currentEvent,o]);const[_,N]=$.useState(!1),[M,R]=$.useState(!1),[E,T]=$.useState(!1),[D,O]=$.useState({type:null,data:null}),q=B=>{if(!B)return;const Ue={...B,activatedAt:t.daysElapsed||0};t.setActiveFestivalEffects($t=>[...$t,Ue]),t.setFestivalModal(null),t.setIsPaused(t.pausedBeforeEvent);const ht=B.type==="permanent"?"":"",ft=r(B.effects);s(` ${B.name}(${ht})${ft}`)},I=(B,Ue)=>{const ht=Ue||{},It=((t.currentEvent&&t.currentEvent.id===B?t.currentEvent:null)||vf.find(Ye=>Ye.id===B))?.name,oe=ht.text;if(o.handleEventOption(B,Ue),c(u.CLICK),t.setIsPaused(t.pausedBeforeEvent),It){const Ye=oe?`${oe}`:"";s(` ${It}${Ye}`)}else oe&&s(` ${oe}`)},Z=()=>{t.setShowTutorial(!1),localStorage.setItem("tutorial_completed","true"),s(" ")},Y=()=>{t.setShowTutorial(!1),localStorage.setItem("tutorial_completed","true"),s(" ")},U=()=>{t.setShowTutorial(!0),s(" ")},S=B=>{t.setClicks(Ue=>[...Ue,{id:Date.now(),x:B.clientX,y:B.clientY,text:"+1",color:"text-white"}]),t.setResources(Ue=>({...Ue,silver:(Ue.silver||0)+1}))},Q=B=>{const Ue=Ln.find(ht=>ht.id===B);Ue&&O({type:"building",data:Ue})},ne=()=>O({type:null,data:null}),Ne=B=>{O({type:"stratum",data:B})},$e=B=>{O({type:"unit",data:B})},de=(B,Ue)=>{O({type:"tech",data:{tech:B,status:Ue}})},P=B=>{O({type:"decree",data:B})},z=()=>{const B=t.army||{},Ue=Object.values(B).reduce((ft,$t)=>ft+($t||0),0);let ht=0;return Object.entries(t.buildings||{}).forEach(([ft,$t])=>{if(!$t)return;const It=Ln.find(oe=>oe.id===ft);It?.output?.militaryCapacity&&(ht+=It.output.militaryCapacity*$t)}),ht<=0?Ue>0?.5:0:Math.min(1,Ue/ht)},V=B=>Math.max(0,Math.min(100,B??0)),F=(B,Ue)=>{console.log("[STRATEGIC ACTION] Executing:",B,"on",Ue);const ht=Tl[B];if(!ht){s(` ${B}`);return}const ft=Ke[Ue]?.name||Ue,$t=`${B}_${Ue}`,It={resources:t.resources,organizationStates:t.rebellionStates,popStructure:t.popStructure,actionCooldowns:t.actionCooldowns||{},actionUsage:t.actionUsage||{},population:t.population||0,militaryPower:z(),classApproval:t.classApproval||{},classInfluence:t.classInfluence||{},nations:t.nations||[]},oe=WT(B,Ue,It);if(!oe.success){s(`${ft}: ${oe.message}`);return}oe.effects.resourceCost&&t.setResources(Pe=>{const lt={...Pe};return oe.effects.resourceCost.silver&&(lt.silver=Math.max(0,(lt.silver||0)-oe.effects.resourceCost.silver)),oe.effects.resourceCost.culture&&(lt.culture=Math.max(0,(lt.culture||0)-oe.effects.resourceCost.culture)),lt}),ht.cooldown>0&&t.setActionCooldowns(Pe=>({...Pe||{},[$t]:ht.cooldown})),t.setActionUsage(Pe=>({...Pe||{},[$t]:(Pe&&Pe[$t]||0)+1})),(oe.effects.organizationChanges&&Object.keys(oe.effects.organizationChanges).length>0||oe.effects.resistanceChange)&&t.setRebellionStates(Pe=>{const lt={...Pe};if(oe.effects.organizationChanges&&Object.entries(oe.effects.organizationChanges).forEach(([Vt,oa])=>{const Ka=lt[Vt]||{},gn=V((Ka.organization||0)+oa),Zt=Fr(gn);lt[Vt]={...Ka,organization:gn,stage:Zt,phase:wl(Zt)}}),oe.effects.resistanceChange){const Vt=Ue,oa=lt[Vt]||{},Ka=oa.resistance||0;lt[Vt]={...oa,resistance:Math.min(100,Ka+oe.effects.resistanceChange)}}return lt}),Array.isArray(oe.effects.specialEffects)&&oe.effects.specialEffects.forEach(Pe=>{if(Pe){if(Pe.type==="organizationPause"&&Pe.stratum&&Pe.duration)t.setRebellionStates(lt=>({...lt,[Pe.stratum]:{...lt?.[Pe.stratum]||{},organizationPaused:Math.max(Pe.duration,lt?.[Pe.stratum]?.organizationPaused||0)}}));else if(Pe.type==="promiseTask"&&Pe.stratum){const lt=Ke[Pe.stratum]?.name||Pe.stratum,Vt={nations:t.nations,taxPolicies:t.taxPolicies,market:t.market,classWealth:t.classWealth,classApproval:t.classApproval,needsReport:{},tradeRoutes:t.tradeRoutes,classIncome:t.classIncome||{},popStructure:t.popStructure},oa=h3({stratumKey:Pe.stratum,stratumName:lt,currentDay:t.daysElapsed||0,failurePenalty:Pe.failurePenalty||{organization:50},context:Vt});if(oa){t.setPromiseTasks(gn=>[...gn||[],oa]);const Ka=oa.maintainDuration>0?`${oa.maintainDuration}`:"";s(` ${lt}${oa.description}${Ka}`)}}else if(Pe.type==="divideEffect"&&Pe.target&&Pe.rival){const lt=Ke[Pe.target]?.name||Pe.target,Vt=Ke[Pe.rival]?.name||Pe.rival;s(` ${lt}  ${Vt} `)}}}),oe.effects.approvalChanges&&Object.keys(oe.effects.approvalChanges).length>0&&Object.entries(oe.effects.approvalChanges).forEach(([Pe,lt])=>{lt.value!==0&&t.setActiveEventEffects(Vt=>({...Vt,approval:{...Vt.approval||{},[Pe]:{value:(Vt.approval?.[Pe]?.value||0)+lt.value,duration:lt.duration||30,source:`:${ht.name}`}}}))}),oe.effects.stabilityChange&&t.setStability(Pe=>Math.max(0,Math.min(100,Pe+oe.effects.stabilityChange)));const Ye=[];oe.effects.resourceCost?.silver&&Ye.push(`${oe.effects.resourceCost.silver}`),oe.effects.resourceCost?.culture&&Ye.push(`${oe.effects.resourceCost.culture}`);const bt=Ye.length>0?` (${Ye.join("")})`:"";s(`${oe.message}${bt}`)},re=z(),C=t.taxes||{total:0,breakdown:{headTax:0,industryTax:0,subsidy:0},efficiency:1},L=jf(t.army||{}),ie=t.market?.prices?.food??(Re.food?.basePrice||1),H=t.militaryWageRatio||1,ve=L*ie*H,me=t.tradeStats||{tradeTax:0},X=me.tradeTax||0,qe=t.playerInstallmentPayment&&t.playerInstallmentPayment.remainingDays>0?t.playerInstallmentPayment.amount:0,fe=C.total+X-ve-qe,Je=id(t.daysElapsed||0),tt=t.hasAutoSave(),Mt=()=>{t.saveGame()},jt=()=>{t.loadGame({source:"manual"})},ot=()=>{if(!t.hasAutoSave()){s(" ");return}t.loadGame({source:"auto"})};return a.jsxs("div",{className:"min-h-screen font-epic text-theme-text transition-all duration-1000 relative",children:[a.jsx(ff,{opacity:.03,className:"fixed inset-0 z-0 text-ancient-gold"}),t.clicks.map(B=>a.jsx(kT,{...B,onComplete:()=>t.setClicks(Ue=>Ue.filter(ht=>ht.id!==B.id))},B.id)),a.jsx("div",{className:"fixed top-0 left-0 right-0 z-50",children:a.jsx(PT,{gameState:t,taxes:C,netSilverPerDay:fe,tradeStats:me,armyFoodNeed:L,playerInstallmentPayment:t.playerInstallmentPayment,onResourceDetailClick:B=>t.setResourceDetailView(B),onPopulationDetailClick:()=>t.setPopulationDetailView(!0),onStrataClick:()=>m(!0),onMarketClick:()=>g(!0),onEmpireSceneClick:()=>T(!0),gameControls:a.jsx(ry,{isPaused:t.isPaused,gameSpeed:t.gameSpeed,onPauseToggle:()=>t.setIsPaused(!t.isPaused),onSpeedChange:B=>t.setGameSpeed(B),onSave:Mt,onLoadManual:jt,onLoadAuto:ot,onSettings:()=>N(!0),onReset:()=>t.resetGame(),onTutorial:U,onWiki:()=>R(!0),autoSaveAvailable:tt,onTriggerEvent:o.triggerRandomEvent})})}),a.jsx("div",{className:"lg:hidden fixed bottom-[68px] right-2 z-40",style:{paddingBottom:"env(safe-area-inset-bottom, 0px)"},children:a.jsx("div",{className:"scale-[0.9] origin-bottom-right",children:a.jsx(ry,{isPaused:t.isPaused,gameSpeed:t.gameSpeed,onPauseToggle:()=>t.setIsPaused(!t.isPaused),onSpeedChange:B=>t.setGameSpeed(B),onSave:Mt,onLoadManual:jt,onLoadAuto:ot,onSettings:()=>N(!0),onReset:()=>t.resetGame(),onTutorial:U,onWiki:()=>R(!0),menuDirection:"up",autoSaveAvailable:tt,onTriggerEvent:o.triggerRandomEvent})})}),a.jsx("div",{className:"h-14 sm:h-16 lg:h-20"}),a.jsx("main",{className:"max-w-[1920px] mx-auto px-2 sm:px-4 py-2 sm:py-4 pb-24 lg:pb-4","data-epoch":t.epoch,children:a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-[2fr_8fr] lg:grid-cols-12 gap-3 sm:gap-4",children:[a.jsxs("aside",{className:"hidden md:block md:col-span-1 lg:col-span-2 space-y-4 order-2 md:order-1 lg:order-1",children:[a.jsx(AT,{variant:"ancient",className:"p-2 animate-fade-in-up",children:a.jsx(oy,{resources:t.resources,rates:t.rates,market:t.market,epoch:t.epoch,onDetailClick:B=>t.setResourceDetailView(B)})}),a.jsx(cy,{popStructure:t.popStructure,classApproval:t.classApproval,classInfluence:t.classInfluence,stability:t.stability,population:t.population,activeBuffs:t.activeBuffs,activeDebuffs:t.activeDebuffs,classWealth:t.classWealth,classWealthDelta:t.classWealthDelta,classShortages:t.classShortages,classIncome:t.classIncome,classExpense:t.classExpense,classLivingStandard:t.classLivingStandard,rebellionStates:t.rebellionStates,dayScale:1,onDetailClick:Ne}),a.jsxs("button",{onClick:S,className:"relative w-full py-3 btn-epic rounded-xl font-bold shadow-epic active:scale-95 transition-all flex items-center justify-center gap-2 overflow-hidden group",children:[a.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-emerald-600/20 via-emerald-500/30 to-emerald-600/20 animate-shimmer"}),a.jsx(k,{name:"Pickaxe",size:16,className:"relative z-10"}),a.jsx("span",{className:"relative z-10",children:""})]})]}),a.jsx("section",{className:"md:col-span-1 lg:col-span-8 space-y-3 sm:space-y-4 order-1 md:order-2 lg:order-2",children:a.jsxs("div",{className:"relative glass-epic rounded-2xl border border-theme-border shadow-monument overflow-hidden min-h-[500px] animate-epic-entrance",children:[a.jsx(ff,{opacity:.02,className:"absolute inset-0 text-ancient-gold"}),a.jsx("div",{className:"absolute top-0 left-0 right-0 h-px bg-gradient-to-r from-transparent via-ancient-gold/50 to-transparent"}),a.jsxs("div",{className:"hidden lg:flex border-b border-theme-border bg-gradient-to-r from-theme-surface/60 via-theme-surface-alt/40 to-theme-surface/60 overflow-x-auto relative",children:[a.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-px bg-gradient-to-r from-transparent via-theme-accent/40 to-transparent"}),[{id:"build",label:"",icon:"Hammer"},{id:"military",label:"",icon:"Swords"},{id:"tech",label:"",icon:"Cpu"},{id:"politics",label:"",icon:"Gavel"},{id:"diplo",label:"",icon:"Globe"}].map(B=>a.jsxs("button",{onClick:()=>t.setActiveTab(B.id),className:`relative flex-1 min-w-[80px] py-2.5 flex items-center justify-center gap-2 text-sm font-bold transition-all group ${t.activeTab===B.id?"border-b-2 shadow-glow":"text-gray-400 hover:text-theme-accent"}`,style:t.activeTab===B.id?{color:"var(--theme-accent)",borderColor:"var(--theme-primary)"}:{},children:[t.activeTab===B.id&&a.jsx("div",{className:"absolute inset-0 bg-gradient-to-b from-theme-primary/15 to-transparent"}),a.jsx(k,{name:B.icon,size:16,className:"relative z-10"}),a.jsx("span",{className:"relative z-10 tab-title-serif",children:B.label}),t.activeTab!==B.id&&a.jsx("div",{className:"absolute inset-0 bg-theme-primary/0 group-hover:bg-theme-primary/5 transition-colors"})]},B.id))]}),a.jsx("div",{className:"p-3 sm:p-4 relative",children:a.jsx(Ro,{mode:"wait",children:a.jsxs(As.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.2},children:[t.activeTab==="build"&&a.jsx(eS,{buildings:t.buildings,resources:t.resources,epoch:t.epoch,techsUnlocked:t.techsUnlocked,popStructure:t.popStructure,jobFill:t.jobFill,onBuy:o.buyBuilding,onSell:o.sellBuilding,market:t.market,onShowDetails:Q}),t.activeTab==="military"&&a.jsx(aS,{army:t.army,militaryQueue:t.militaryQueue,resources:t.resources,epoch:t.epoch,population:t.population,buildings:t.buildings,nations:t.nations,selectedTarget:t.selectedTarget,onRecruit:o.recruitUnit,onDisband:o.disbandUnit,onCancelTraining:o.cancelTraining,onSelectTarget:t.setSelectedTarget,onLaunchBattle:o.launchBattle,market:t.market,militaryWageRatio:t.militaryWageRatio,onUpdateWageRatio:t.setMilitaryWageRatio,techsUnlocked:t.techsUnlocked,onShowUnitDetails:$e}),t.activeTab==="tech"&&a.jsx(rS,{techsUnlocked:t.techsUnlocked,epoch:t.epoch,resources:t.resources,population:t.population,onResearch:o.researchTech,onUpgradeEpoch:o.upgradeEpoch,canUpgradeEpoch:o.canUpgradeEpoch,market:t.market,onShowTechDetails:de}),t.activeTab==="politics"&&a.jsx(dS,{decrees:t.decrees,onToggle:o.toggleDecree,taxPolicies:t.taxPolicies,onUpdateTaxPolicies:t.setTaxPolicies,popStructure:t.popStructure,buildings:t.buildings,market:t.market,epoch:t.epoch,techsUnlocked:t.techsUnlocked,onShowDecreeDetails:P,jobFill:t.jobFill,jobsAvailable:t.jobsAvailable}),t.activeTab==="diplo"&&a.jsx(gS,{nations:t.nations,epoch:t.epoch,market:t.market,resources:t.resources,daysElapsed:t.daysElapsed,onDiplomaticAction:o.handleDiplomaticAction,tradeRoutes:t.tradeRoutes,onTradeRouteAction:o.handleTradeRouteAction,playerInstallmentPayment:t.playerInstallmentPayment,jobsAvailable:t.jobsAvailable,popStructure:t.popStructure,taxPolicies:t.taxPolicies})]},t.activeTab)})})]})}),a.jsxs("aside",{className:"hidden lg:block lg:col-span-2 order-3 space-y-4",children:[a.jsx("div",{className:"bg-gray-900/60 backdrop-blur-md rounded-xl border border-white/10 shadow-glass overflow-hidden",children:a.jsx(dy,{daysElapsed:t.daysElapsed,season:Je.season,population:t.population,stability:t.stability,wealth:t.resources.silver,epoch:t.epoch})}),a.jsx(XT,{logs:t.logs}),a.jsxs("details",{className:"glass-ancient rounded-xl border border-blue-500/20 shadow-md group",children:[a.jsxs("summary",{className:"px-3 py-2 cursor-pointer flex items-center justify-between text-xs font-bold text-blue-300 hover:text-blue-200 transition-colors",children:[a.jsxs("span",{className:"flex items-center gap-2",children:[a.jsx(k,{name:"Lightbulb",size:12}),""]}),a.jsx(k,{name:"ChevronDown",size:12,className:"transform group-open:rotate-180 transition-transform"})]}),a.jsxs("div",{className:"px-3 pb-3 text-[10px] text-gray-300 space-y-1.5",children:[a.jsxs("p",{children:[" ",a.jsx("span",{className:"text-white",children:""}),""]}),a.jsxs("p",{children:[" ",a.jsx("span",{className:"text-white",children:""}),""]}),a.jsxs("p",{children:[" ",a.jsx("span",{className:"text-white",children:""}),""]})]})]}),a.jsxs("details",{className:"glass-ancient rounded-xl border border-emerald-500/20 shadow-md group",children:[a.jsxs("summary",{className:"px-3 py-2 cursor-pointer flex items-center justify-between text-xs font-bold text-emerald-300 hover:text-emerald-200 transition-colors",children:[a.jsxs("span",{className:"flex items-center gap-2",children:[a.jsx(k,{name:"BookOpen",size:12}),""]}),a.jsx(k,{name:"ChevronDown",size:12,className:"transform group-open:rotate-180 transition-transform"})]}),a.jsxs("div",{className:"px-3 pb-3 text-[10px] text-gray-200 space-y-1.5",children:[a.jsxs("p",{children:[a.jsx("span",{className:"text-white font-semibold",children:"1."})," "]}),a.jsxs("p",{children:[a.jsx("span",{className:"text-white font-semibold",children:"2."})," "]}),a.jsxs("p",{children:[a.jsx("span",{className:"text-white font-semibold",children:"3."})," "]}),a.jsxs("p",{children:[a.jsx("span",{className:"text-white font-semibold",children:"4."})," "]})]})]})]})]})}),a.jsx(RT,{activeTab:t.activeTab,onTabChange:B=>t.setActiveTab(B),epoch:t.epoch}),a.jsx(mr,{isOpen:D.type==="building",onClose:ne,title:D.data?.name||"",showHeader:!1,children:D.type==="building"&&a.jsx(zT,{building:D.data,gameState:t,onBuy:o.buyBuilding,onSell:o.sellBuilding,taxPolicies:t.taxPolicies,onUpdateTaxPolicies:t.setTaxPolicies})}),a.jsx(mr,{isOpen:D.type==="stratum",onClose:ne,title:"",showHeader:!0,children:D.type==="stratum"&&a.jsx(FT,{stratumKey:D.data,popStructure:t.popStructure,population:t.population,classApproval:t.classApproval,classInfluence:t.classInfluence,classWealth:t.classWealth,classWealthDelta:t.classWealthDelta,classIncome:t.classIncome,classExpense:t.classExpense,classShortages:t.classShortages,classLivingStandard:t.classLivingStandard,rebellionStates:t.rebellionStates,actionCooldowns:t.actionCooldowns,actionUsage:t.actionUsage,activeBuffs:t.activeBuffs,activeDebuffs:t.activeDebuffs,dayScale:1,daysElapsed:t.daysElapsed||0,taxPolicies:t.taxPolicies,onUpdateTaxPolicies:t.setTaxPolicies,onStrategicAction:F,resources:t.resources,militaryPower:re,promiseTasks:t.promiseTasks,nations:t.nations,epoch:t.epoch,techsUnlocked:t.techsUnlocked,onClose:ne})}),a.jsx(mr,{isOpen:D.type==="unit",onClose:ne,title:"",showHeader:!0,children:D.type==="unit"&&a.jsx(XS,{unit:D.data,resources:t.resources,market:t.market,militaryWageRatio:t.militaryWageRatio,army:t.army,onRecruit:o.recruitUnit,onDisband:o.disbandUnit,onClose:ne})}),a.jsx(mr,{isOpen:D.type==="tech",onClose:ne,title:"",showHeader:!0,children:D.type==="tech"&&D.data&&a.jsx(QS,{tech:D.data.tech,status:D.data.status,resources:t.resources,market:t.market,onResearch:o.researchTech,onClose:ne})}),a.jsx(mr,{isOpen:D.type==="decree",onClose:ne,title:"",showHeader:!0,children:D.type==="decree"&&a.jsx(eA,{decree:D.data,onToggle:o.toggleDecree,onClose:ne})}),a.jsx(mr,{isOpen:p,onClose:()=>m(!1),title:"",showHeader:!0,children:a.jsx(cy,{popStructure:t.popStructure,classApproval:t.classApproval,classInfluence:t.classInfluence,stability:t.stability,population:t.population,activeBuffs:t.activeBuffs,activeDebuffs:t.activeDebuffs,classWealth:t.classWealth,classWealthDelta:t.classWealthDelta,classShortages:t.classShortages,classIncome:t.classIncome,classExpense:t.classExpense,classLivingStandard:t.classLivingStandard,rebellionStates:t.rebellionStates,dayScale:1,onDetailClick:Ne,hideTitle:!0})}),a.jsx(mr,{isOpen:x,onClose:()=>g(!1),title:"",showHeader:!0,children:a.jsx(oy,{resources:t.resources,rates:t.rates,market:t.market,epoch:t.epoch,title:"",showDetailedMobile:!0,onDetailClick:B=>{g(!1),t.setResourceDetailView(B)}})}),a.jsx(mr,{isOpen:E,onClose:()=>T(!1),title:` - ${Je.season}  ${Je.year}`,showHeader:!0,children:a.jsxs("div",{className:"space-y-4",children:[a.jsx("div",{className:"bg-gray-900/60 backdrop-blur-md rounded-lg border border-white/10 shadow-glass overflow-hidden",children:a.jsx(dy,{daysElapsed:t.daysElapsed,season:Je.season,population:t.population,stability:t.stability,wealth:t.resources.silver,epoch:t.epoch})}),t.activeFestivalEffects&&t.activeFestivalEffects.length>0&&a.jsxs("div",{className:"bg-gray-900/60 backdrop-blur-md rounded-lg border border-ancient-gold/30 shadow-glass overflow-hidden",children:[a.jsx("div",{className:"px-3 py-2 border-b border-ancient-gold/20 bg-gradient-to-r from-ancient-gold/10 to-transparent",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(k,{name:"Sparkles",size:14,className:"text-ancient-gold"}),a.jsx("span",{className:"text-sm font-bold text-ancient-gold",children:""})]})}),a.jsx("div",{className:"p-3 space-y-2 max-h-64 overflow-y-auto",children:[...t.activeFestivalEffects].sort((B,Ue)=>(Ue.activatedAt||0)-(B.activatedAt||0)).map((B,Ue)=>{const ht=Math.floor((B.activatedAt||0)/360)+1,ft=B.type==="permanent",$t=!ft&&t.daysElapsed-(B.activatedAt||0)>=(B.duration||360),It=`${B.id}-${Ue}`,oe=b===It;return a.jsxs("div",{className:`p-2 rounded-lg border transition-all ${$t?"bg-gray-800/40 border-gray-600/30 opacity-60":ft?"bg-purple-900/20 border-purple-500/30":"bg-yellow-900/20 border-yellow-500/30"}`,children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:`flex-shrink-0 w-8 h-8 rounded-full flex items-center justify-center ${ft?"bg-purple-500/20":"bg-yellow-500/20"}`,children:a.jsx(k,{name:B.icon||"Star",size:14,className:ft?"text-purple-400":"text-yellow-400"})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-xs font-semibold text-ancient-parchment truncate",children:B.name}),a.jsx("span",{className:`text-[9px] px-1.5 py-0.5 rounded ${$t?"bg-gray-600/30 text-gray-400":ft?"bg-purple-500/30 text-purple-300":"bg-yellow-500/30 text-yellow-300"}`,children:$t?"":ft?"":""})]}),a.jsxs("div",{className:"text-[10px] text-ancient-stone mt-0.5",children:[" ",ht," "]})]}),a.jsx("button",{onClick:()=>j(oe?null:It),className:"text-[10px] text-gray-400 hover:text-white transition-colors p-1 rounded-md",children:a.jsx(k,{name:oe?"ChevronUp":"ChevronDown",size:12})})]}),oe&&a.jsx("div",{className:"mt-2 pt-2 border-t border-white/10 text-xs text-gray-300",children:a.jsxs("p",{children:[a.jsx("strong",{children:""}),r(B.effects)]})})]},It)})})]}),(!t.activeFestivalEffects||t.activeFestivalEffects.length===0)&&a.jsxs("div",{className:"bg-gray-900/60 backdrop-blur-md rounded-lg border border-gray-700/30 shadow-glass p-4 text-center",children:[a.jsx(k,{name:"Calendar",size:24,className:"text-ancient-stone mx-auto mb-2 opacity-50"}),a.jsx("p",{className:"text-xs text-ancient-stone",children:""}),a.jsx("p",{className:"text-[10px] text-gray-500 mt-1",children:""})]})]})}),a.jsx(ST,{notifications:t.battleNotifications||[],onViewDetail:B=>{t.setBattleResult(B.result),o.dismissBattleNotification(B.id)},onDismiss:B=>{o.dismissBattleNotification(B)},onDismissAll:()=>{o.dismissAllBattleNotifications()}}),t.battleResult&&a.jsx(yS,{result:t.battleResult,onClose:()=>t.setBattleResult(null)}),t.stratumDetailView&&a.jsx(vS,{stratumKey:t.stratumDetailView,popStructure:t.popStructure,classApproval:t.classApproval,classInfluence:t.classInfluence,classWealth:t.classWealth,classWealthHistory:t.classWealthHistory,totalInfluence:t.totalInfluence,totalWealth:t.totalWealth,activeBuffs:t.activeBuffs,activeDebuffs:t.activeDebuffs,epoch:t.epoch,techsUnlocked:t.techsUnlocked,history:t.history,stability:t.stability,onClose:()=>t.setStratumDetailView(null)}),t.resourceDetailView&&a.jsx(NS,{resourceKey:t.resourceDetailView,resources:t.resources,market:t.market,buildings:t.buildings,popStructure:t.popStructure,wealth:t.classWealth,army:t.army,history:t.history,onClose:()=>t.setResourceDetailView(null),taxPolicies:t.taxPolicies,onUpdateTaxPolicies:t.setTaxPolicies,activeDebuffs:t.activeDebuffs}),t.populationDetailView&&a.jsx(MS,{isOpen:t.populationDetailView,onClose:()=>t.setPopulationDetailView(!1),population:t.population,maxPop:t.maxPop,popStructure:t.popStructure,history:t.history}),t.festivalModal&&a.jsx(_S,{festivalOptions:t.festivalModal.options,year:t.festivalModal.year,epoch:t.epoch,onSelect:q}),a.jsx(mr,{isOpen:!!t.currentEvent,onClose:()=>t.setCurrentEvent(null),title:"",showHeader:!0,preventBackdropClose:!0,showCloseButton:!t.currentEvent?.options?.length,preventEscapeClose:!!t.currentEvent?.options?.length,children:t.currentEvent&&a.jsx(tA,{event:t.currentEvent,onSelectOption:I,onClose:()=>t.setCurrentEvent(null),nations:t.nations})}),a.jsx(ES,{show:t.showTutorial,onComplete:Z,onSkip:Y,onOpenWiki:()=>R(!0)}),a.jsx(BS,{show:M,onClose:()=>R(!1)}),_&&a.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[a.jsx("div",{className:"absolute inset-0 bg-black/70",onClick:()=>N(!1),"aria-hidden":"true"}),a.jsx("div",{className:"relative w-full max-w-lg z-10",children:a.jsx(ZT,{isAutoSaveEnabled:t.isAutoSaveEnabled,autoSaveInterval:t.autoSaveInterval,onToggleAutoSave:t.setIsAutoSaveEnabled,onIntervalChange:t.setAutoSaveInterval,lastAutoSaveTime:t.lastAutoSaveTime,onManualSave:Mt,onManualLoad:jt,onAutoLoad:ot,autoSaveAvailable:tt,isSaving:t.isSaving,timeSettings:t.eventEffectSettings,onTimeSettingsChange:t.setEventEffectSettings,onClose:()=>N(!1)})})]})]})}window.addEventListener("error",t=>{console.error("Global error:",t.error)});window.addEventListener("unhandledrejection",t=>{console.error("Unhandled promise rejection:",t.reason)});const zp=document.getElementById("root");if(!zp)console.error("Root element not found!"),document.body.innerHTML='<div style="color: white; background: #1a1a1a; padding: 20px; font-family: sans-serif;"><h1></h1><p> index.html </p></div>';else try{Kv.createRoot(zp).render(a.jsx(aA,{})),console.log("App rendered successfully")}catch(t){console.error("Failed to render app:",t),zp.innerHTML='<div style="color: white; background: #1a1a1a; padding: 20px; font-family: sans-serif;"><h1></h1><p>'+t.message+"</p></div>"}
